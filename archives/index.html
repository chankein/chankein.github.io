
<!DOCTYPE html>
<html lang="zh-tw">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
      var algoliaIndex = algoliaIndex || {};
      algoliaIndex = {
        appId: 'AWFC86Q51O',
        apiKey: '9c1ab8f9e66ebcc69cfba3a8f2cc9e4b',
        indexName: 'MyBlog',
        hits: {}
      };
    </script>
  

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>所有文章 - Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Kein&#39;s blog">
<meta property="og:url" content="https://chankein.github.io/archives/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Kein Chan">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../#about"
            >
        
        
            <img class="header-picture" src="../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2025/05/15/git-flow/"
                            aria-label=": git flow"
                        >
                            git flow
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-15T22:53:48+08:00">
	
		    2025 年 5 月 15 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/git/">git</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Git-Flow"><a href="#Git-Flow" class="headerlink" title="Git Flow"></a>Git Flow</h2><p>Git Flow 是一种基于 Git 的分支模型，旨在帮助团队更好地管理和发布软件。</p>
<p>Git Flow 由 Vincent Driessen 在 2010 年提出，并通过一套标准的分支命名和工作流程，使开发、测试和发布过程更加有序和高效。</p>
<p>Git Flow 主要由以下几类分支组成：<code>master</code>、<code>develop</code>、<code>feature</code>、<code>release</code>、<code>hotfix</code>。</p>
<h2 id="Git-Flow-安装"><a href="#Git-Flow-安装" class="headerlink" title="Git Flow 安装"></a>Git Flow 安装</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p><strong>Debian&#x2F;Ubuntu:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git-flow</span><br></pre></td></tr></table></figure>

<p><strong>Fedora:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install gitflow</span><br><span class="line">sudo apt-get install git-flow</span><br></pre></td></tr></table></figure>

<h3 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h3><p>在 macOS 上，你可以使用 Homebrew 来安装 Git Flow:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install git-flow</span><br></pre></td></tr></table></figure>

<h3 id="源码安装"><a href="#源码安装" class="headerlink" title="源码安装"></a>源码安装</h3><p>如果你的发行版的包管理器中没有 Git Flow，你也可以从源代码进行安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/nvie/gitflow.git</span><br><span class="line">cd gitflow</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p>安装完成后，你可以通过以下命令验证 Git Flow 是否成功安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow version</span><br></pre></td></tr></table></figure>

<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>在 Windows 上，你可以通过以下方式安装 Git Flow：</p>
<ul>
<li><p><strong>使用 Git for Windows</strong>: Git for Windows 包含了 Git Flow。你可以从 <a target="_blank" rel="noopener" href="https://gitforwindows.org/">Git for Windows</a> 安装 Git，然后使用 Git Bash 来使用 Git Flow。</p>
</li>
<li><p><strong>使用 Scoop</strong>: 如果你使用 Scoop 包管理工具，可以通过以下命令安装 Git Flow：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install git-flow</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>使用 Chocolatey</strong>: 如果你使用 Chocolatey 包管理工具，可以通过以下命令安装 Git Flow：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install gitflow</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="Git-Flow-分支模型"><a href="#Git-Flow-分支模型" class="headerlink" title="Git Flow 分支模型"></a>Git Flow 分支模型</h2><p><strong><code>master</code> 分支</strong>：</p>
<ul>
<li>永远保持稳定和可发布的状态。</li>
<li>每次发布一个新的版本时，都会从 <code>develop</code> 分支合并到 <code>master</code> 分支。</li>
</ul>
<p><strong><code>develop</code> 分支</strong>：</p>
<ul>
<li>用于集成所有的开发分支。</li>
<li>代表了最新的开发进度。</li>
<li>功能分支、发布分支和修复分支都从这里分支出去，最终合并回这里。</li>
</ul>
<p><strong><code>feature</code> 分支</strong>：</p>
<ul>
<li>用于开发新功能。</li>
<li>从 <code>develop</code> 分支创建，开发完成后合并回 <code>develop</code> 分支。</li>
<li>命名规范：<code>feature/feature-name</code>。</li>
</ul>
<p><strong><code>release</code> 分支</strong>：</p>
<ul>
<li>用于准备新版本的发布。</li>
<li>从 <code>develop</code> 分支创建，进行最后的测试和修复，然后合并回 <code>develop</code> 和 <code>master</code> 分支，并打上版本标签。</li>
<li>命名规范：<code>release/release-name</code>。</li>
</ul>
<p><strong><code>hotfix</code> 分支</strong>：</p>
<ul>
<li>用于修复紧急问题。</li>
<li>从 <code>master</code> 分支创建，修复完成后合并回 <code>master</code> 和 <code>develop</code> 分支，并打上版本标签。</li>
<li>命名规范：<code>hotfix/hotfix-name</code>。</li>
</ul>
<p><img src="https://www.runoob.com/wp-content/uploads/2024/07/git-flow.png"></p>
<h3 id="分支操作原理"><a href="#分支操作原理" class="headerlink" title="分支操作原理"></a>分支操作原理</h3><ul>
<li>Master 分支上的每个 Commit 应打上 Tag，Develop 分支基于 Master 创建。</li>
<li>Feature 分支完成后合并回 Develop 分支，并通常删除该分支。</li>
<li>Release 分支基于 Develop 创建，用于测试和修复 Bug，发布后合并回 Master 和 Develop，并打 Tag 标记版本号。</li>
<li>Hotfix 分支基于 Master 创建，完成后合并回 Master 和 Develop，并打 Tag 1。</li>
</ul>
<h3 id="Git-Flow-命令示例"><a href="#Git-Flow-命令示例" class="headerlink" title="Git Flow 命令示例"></a>Git Flow 命令示例</h3><ul>
<li>开始 Feature 分支：<code>git flow feature start MYFEATURE</code></li>
<li>完成 Feature 分支：<code>git flow feature finish MYFEATURE</code></li>
<li>开始 Release 分支：<code>git flow release start RELEASE [BASE]</code></li>
<li>完成 Release 分支：合并到 Master 和 Develop，打 Tag，删除 Release 分支。</li>
<li>开始 Hotfix 分支：<code>git flow hotfix start HOTFIX [BASE]</code></li>
<li>完成 Hotfix 分支：合并到 Master 和 Develop，打 Tag，删除 Hotfix 分支。</li>
</ul>
<h3 id="Git-Flow-工作流程"><a href="#Git-Flow-工作流程" class="headerlink" title="Git Flow 工作流程"></a>Git Flow 工作流程</h3><h4 id="1-初始化-Git-Flow"><a href="#1-初始化-Git-Flow" class="headerlink" title="1. 初始化 Git Flow"></a>1. 初始化 Git Flow</h4><p>首先，在项目中初始化 Git Flow。可以使用 Git Flow 插件（例如 <code>git-flow</code>）来简化操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow init</span><br></pre></td></tr></table></figure>

<p>初始化时，你需要设置分支命名规则和默认分支。</p>
<h4 id="2-创建功能分支"><a href="#2-创建功能分支" class="headerlink" title="2. 创建功能分支"></a>2. 创建功能分支</h4><p>当开始开发一个新功能时，从 <code>develop</code> 分支创建一个功能分支。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow feature start feature-name</span><br></pre></td></tr></table></figure>

<p>完成开发后，将功能分支合并回 <code>develop</code> 分支，并删除功能分支。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow feature finish feature-name</span><br></pre></td></tr></table></figure>

<h4 id="3-创建发布分支"><a href="#3-创建发布分支" class="headerlink" title="3. 创建发布分支"></a>3. 创建发布分支</h4><p>当准备发布一个新版本时，从 <code>develop</code> 分支创建一个发布分支。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow release start release-name</span><br></pre></td></tr></table></figure>

<p>在发布分支上进行最后的测试和修复，准备好发布后，将发布分支合并回 <code>develop</code> 和 <code>master</code> 分支，并打上版本标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow release finish release-name</span><br></pre></td></tr></table></figure>

<h4 id="4-创建修复分支"><a href="#4-创建修复分支" class="headerlink" title="4. 创建修复分支"></a>4. 创建修复分支</h4><p>当发现需要紧急修复的问题时，从 <code>master</code> 分支创建一个修复分支。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow hotfix start hotfix-name</span><br></pre></td></tr></table></figure>

<p>修复完成后，将修复分支合并回 <code>master</code> 和 <code>develop</code> 分支，并打上版本标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow hotfix finish hotfix-name</span><br></pre></td></tr></table></figure>

<h3 id="实例操作"><a href="#实例操作" class="headerlink" title="实例操作"></a>实例操作</h3><p>以下是一个实际使用 Git Flow 的综合实例。</p>
<p><strong>初始化 Git Flow</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git flow init</span><br></pre></td></tr></table></figure>

<p><strong>创建和完成功能分支</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git flow feature start new-feature # 开发新功能</span><br><span class="line">git flow feature finish new-feature</span><br></pre></td></tr></table></figure>

<p><strong>创建和完成发布分支</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git flow release start v1.0.0 # 测试和修复</span><br><span class="line">git flow release finish v1.0.0</span><br></pre></td></tr></table></figure>

<p><strong>创建和完成修复分支</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git flow hotfix start hotfix-1.0.1. # 修复紧急问题</span><br><span class="line">git flow hotfix finish hotfix-1.0.1</span><br></pre></td></tr></table></figure>

<h3 id="优点和缺点"><a href="#优点和缺点" class="headerlink" title="优点和缺点"></a>优点和缺点</h3><p><strong>优点</strong></p>
<ul>
<li><strong>明确的分支模型</strong>：清晰的分支命名和使用规则，使得开发过程井然有序。</li>
<li><strong>隔离开发和发布</strong>：开发和发布过程分离，减少了开发中的不确定性对发布的影响。</li>
<li><strong>版本管理</strong>：每次发布和修复都会打上版本标签，方便回溯和管理。</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li><strong>复杂性</strong>：对于小型团队或简单项目，Git Flow 的分支模型可能显得过于复杂。</li>
<li><strong>频繁的合并</strong>：在大型团队中，频繁的分支合并可能导致合并冲突增加。</li>
</ul>
<p>Git Flow 是一种结构化的分支管理模型，通过定义明确的分支和工作流程，帮助团队更好地管理软件开发和发布过程。虽然它增加了一定的复杂性，但对于大型项目和团队协作，Git Flow 提供了强大的支持和管理能力。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2025/05/15/git-flow/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2025/05/15/git-rebase/"
                            aria-label=": git rebase"
                        >
                            git rebase
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-15T22:51:00+08:00">
	
		    2025 年 5 月 15 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/git/">git</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="变基"><a href="#变基" class="headerlink" title="变基"></a>变基</h2><p>在 Git 中整合来自不同分支的修改主要有两种方法：<code>merge</code> 以及 <code>rebase</code>。 在本节中我们将学习什么是“变基”，怎样使用“变基”，并将展示该操作的惊艳之处，以及指出在何种情况下你应避免使用它。</p>
<h3 id="变基的基本操作"><a href="#变基的基本操作" class="headerlink" title="变基的基本操作"></a>变基的基本操作</h3><p>请回顾之前在 <a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/ch00/_basic_merging">分支的合并</a> 中的一个例子，你会看到开发任务分叉到两个不同分支，又各自提交了更新。</p>
<p><img src="https://git-scm.com/book/zh/v2/images/basic-rebase-1.png" alt="分叉的提交历史。"></p>
<p>Figure 35. 分叉的提交历史</p>
<p>之前介绍过，整合分支最容易的方法是 <code>merge</code> 命令。 它会把两个分支的最新快照（<code>C3</code> 和 <code>C4</code>）以及二者最近的共同祖先（<code>C2</code>）进行三方合并，合并的结果是生成一个新的快照（并提交）。</p>
<p><img src="https://git-scm.com/book/zh/v2/images/basic-rebase-2.png" alt="通过合并操作来整合分叉了的历史。"></p>
<p>Figure 36. 通过合并操作来整合分叉的历史</p>
<p>其实，还有一种方法：你可以提取在 <code>C4</code> 中引入的补丁和修改，然后在 <code>C3</code> 的基础上应用一次。 在 Git 中，这种操作就叫做 <strong>变基（rebase）</strong>。 你可以使用 <code>rebase</code> 命令将提交到某一分支上的所有修改都移至另一分支上，就好像“重新播放”一样。</p>
<p>在这个例子中，你可以检出 <code>experiment</code> 分支，然后将它变基到 <code>master</code> 分支上：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout experiment</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git rebase master</span></span><br><span class="line">First, rewinding head to replay your work on top of it...</span><br><span class="line">Applying: added staged command</span><br></pre></td></tr></table></figure>

<p>它的原理是首先找到这两个分支（即当前分支 <code>experiment</code>、变基操作的目标基底分支 <code>master</code>） 的最近共同祖先 <code>C2</code>，然后对比当前分支相对于该祖先的历次提交，提取相应的修改并存为临时文件， 然后将当前分支指向目标基底 <code>C3</code>, 最后以此将之前另存为临时文件的修改依序应用。 （译注：写明了 commit id，以便理解，下同）</p>
<p><img src="https://git-scm.com/book/zh/v2/images/basic-rebase-3.png" alt="将 &#96;C4&#96; 中的修改变基到 &#96;C3&#96; 上。"></p>
<p>Figure 37. 将 <code>C4</code> 中的修改变基到 <code>C3</code> 上</p>
<p>现在回到 <code>master</code> 分支，进行一次快进合并。</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge experiment</span></span><br></pre></td></tr></table></figure>

<p><img src="https://git-scm.com/book/zh/v2/images/basic-rebase-4.png" alt="&#96;master&#96; 分支的快进合并。"></p>
<p>Figure 38. <code>master</code> 分支的快进合并</p>
<p>此时，<code>C4&#39;</code> 指向的快照就和 <a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/ch00/ebasing-merging-example">the merge example</a> 中 <code>C5</code> 指向的快照一模一样了。 这两种整合方法的最终结果没有任何区别，但是变基使得提交历史更加整洁。 你在查看一个经过变基的分支的历史记录时会发现，尽管实际的开发工作是并行的， 但它们看上去就像是串行的一样，提交历史是一条直线没有分叉。</p>
<p>一般我们这样做的目的是为了确保在向远程分支推送时能保持提交历史的整洁——例如向某个其他人维护的项目贡献代码时。 在这种情况下，你首先在自己的分支里进行开发，当开发完成时你需要先将你的代码变基到 <code>origin/master</code> 上，然后再向主项目提交修改。 这样的话，该项目的维护者就不再需要进行整合工作，只需要快进合并便可。</p>
<p>请注意，无论是通过变基，还是通过三方合并，整合的最终结果所指向的快照始终是一样的，只不过提交历史不同罢了。 变基是将一系列提交按照原有次序依次应用到另一分支上，而合并是把最终结果合在一起。</p>
<h3 id="更有趣的变基例子"><a href="#更有趣的变基例子" class="headerlink" title="更有趣的变基例子"></a>更有趣的变基例子</h3><p>在对两个分支进行变基时，所生成的“重放”并不一定要在目标分支上应用，你也可以指定另外的一个分支进行应用。 就像 <a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/ch00/bdiag_e">从一个主题分支里再分出一个主题分支的提交历史</a> 中的例子那样。 你创建了一个主题分支 <code>server</code>，为服务端添加了一些功能，提交了 <code>C3</code> 和 <code>C4</code>。 然后从 <code>C3</code> 上创建了主题分支 <code>client</code>，为客户端添加了一些功能，提交了 <code>C8</code> 和 <code>C9</code>。 最后，你回到 <code>server</code> 分支，又提交了 <code>C10</code>。</p>
<p><img src="https://git-scm.com/book/zh/v2/images/interesting-rebase-1.png" alt="从一个主题分支里再分出一个主题分支的提交历史。"></p>
<p>Figure 39. 从一个主题分支里再分出一个主题分支的提交历史</p>
<p>假设你希望将 <code>client</code> 中的修改合并到主分支并发布，但暂时并不想合并 <code>server</code> 中的修改， 因为它们还需要经过更全面的测试。这时，你就可以使用 <code>git rebase</code> 命令的 <code>--onto</code> 选项， 选中在 <code>client</code> 分支里但不在 <code>server</code> 分支里的修改（即 <code>C8</code> 和 <code>C9</code>），将它们在 <code>master</code> 分支上重放：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git rebase --onto master server client</span></span><br></pre></td></tr></table></figure>

<p>以上命令的意思是：“取出 <code>client</code> 分支，找出它从 <code>server</code> 分支分歧之后的补丁， 然后把这些补丁在 <code>master</code> 分支上重放一遍，让 <code>client</code> 看起来像直接基于 <code>master</code> 修改一样”。这理解起来有一点复杂，不过效果非常酷。</p>
<p><img src="https://git-scm.com/book/zh/v2/images/interesting-rebase-2.png" alt="截取主题分支上的另一个主题分支，然后变基到其他分支。"></p>
<p>Figure 40. 截取主题分支上的另一个主题分支，然后变基到其他分支</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge client</span></span><br></pre></td></tr></table></figure>

<p><img src="https://git-scm.com/book/zh/v2/images/interesting-rebase-3.png" alt="快进合并 &#96;master&#96; 分支，使之包含来自 &#96;client&#96; 分支的修改。"></p>
<p>Figure 41. 快进合并 <code>master</code> 分支，使之包含来自 <code>client</code> 分支的修改</p>
<p>接下来你决定将 <code>server</code> 分支中的修改也整合进来。 使用 <code>git rebase &lt;basebranch&gt; &lt;topicbranch&gt;</code> 命令可以直接将主题分支 （即本例中的 <code>server</code>）变基到目标分支（即 <code>master</code>）上。 这样做能省去你先切换到 <code>server</code> 分支，再对其执行变基命令的多个步骤。</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git rebase master server</span></span><br></pre></td></tr></table></figure>

<p><img src="https://git-scm.com/book/zh/v2/images/interesting-rebase-4.png" alt="将 &#96;server&#96; 中的修改变基到 &#96;master&#96; 上。"></p>
<p>Figure 42. 将 <code>server</code> 中的修改变基到 <code>master</code> 上</p>
<p>然后就可以快进合并主分支 <code>master</code> 了：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge server</span></span><br></pre></td></tr></table></figure>

<p>至此，<code>client</code> 和 <code>server</code> 分支中的修改都已经整合到主分支里了， 你可以删除这两个分支，最终提交历史会变成图 <a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/ch00/bdiag_i">最终的提交历史</a> 中的样子：</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -d client</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -d server</span></span><br></pre></td></tr></table></figure>

<p><img src="https://git-scm.com/book/zh/v2/images/interesting-rebase-5.png" alt="最终的提交历史。"></p>
<p>Figure 43. 最终的提交历史</p>
<h3 id="变基的风险"><a href="#变基的风险" class="headerlink" title="变基的风险"></a>变基的风险</h3><p>呃，奇妙的变基也并非完美无缺，要用它得遵守一条准则：</p>
<p><strong>如果提交存在于你的仓库之外，而别人可能基于这些提交进行开发，那么不要执行变基。</strong></p>
<p>如果你遵循这条金科玉律，就不会出差错。 否则，人民群众会仇恨你，你的朋友和家人也会嘲笑你，唾弃你。</p>
<p>变基操作的实质是丢弃一些现有的提交，然后相应地新建一些内容一样但实际上不同的提交。 如果你已经将提交推送至某个仓库，而其他人也已经从该仓库拉取提交并进行了后续工作，此时，如果你用 <code>git rebase</code> 命令重新整理了提交并再次推送，你的同伴因此将不得不再次将他们手头的工作与你的提交进行整合，如果接下来你还要拉取并整合他们修改过的提交，事情就会变得一团糟。</p>
<p>让我们来看一个在公开的仓库上执行变基操作所带来的问题。 假设你从一个中央服务器克隆然后在它的基础上进行了一些开发。 你的提交历史如图所示：</p>
<p><img src="https://git-scm.com/book/zh/v2/images/perils-of-rebasing-1.png" alt="克隆一个仓库，然后在它的基础上进行了一些开发。"></p>
<p>Figure 44. 克隆一个仓库，然后在它的基础上进行了一些开发</p>
<p>然后，某人又向中央服务器提交了一些修改，其中还包括一次合并。 你抓取了这些在远程分支上的修改，并将其合并到你本地的开发分支，然后你的提交历史就会变成这样：</p>
<p><img src="https://git-scm.com/book/zh/v2/images/perils-of-rebasing-2.png" alt="抓取别人的提交，合并到自己的开发分支。"></p>
<p>Figure 45. 抓取别人的提交，合并到自己的开发分支</p>
<p>接下来，这个人又决定把合并操作回滚，改用变基；继而又用 <code>git push --force</code> 命令覆盖了服务器上的提交历史。 之后你从服务器抓取更新，会发现多出来一些新的提交。</p>
<p><img src="https://git-scm.com/book/zh/v2/images/perils-of-rebasing-3.png" alt="有人推送了经过变基的提交，并丢弃了你的本地开发所基于的一些提交。"></p>
<p>Figure 46. 有人推送了经过变基的提交，并丢弃了你的本地开发所基于的一些提交</p>
<p>结果就是你们两人的处境都十分尴尬。 如果你执行 <code>git pull</code> 命令，你将合并来自两条提交历史的内容，生成一个新的合并提交，最终仓库会如图所示：</p>
<p><img src="https://git-scm.com/book/zh/v2/images/perils-of-rebasing-4.png" alt="你将相同的内容又合并了一次，生成了一个新的提交。"></p>
<p>Figure 47. 你将相同的内容又合并了一次，生成了一个新的提交</p>
<p>此时如果你执行 <code>git log</code> 命令，你会发现有两个提交的作者、日期、日志居然是一样的，这会令人感到混乱。 此外，如果你将这一堆又推送到服务器上，你实际上是将那些已经被变基抛弃的提交又找了回来，这会令人感到更加混乱。 很明显对方并不想在提交历史中看到 <code>C4</code> 和 <code>C6</code>，因为之前就是他把这两个提交通过变基丢弃的。</p>
<h3 id="用变基解决变基"><a href="#用变基解决变基" class="headerlink" title="用变基解决变基"></a>用变基解决变基</h3><p>如果你 <strong>真的</strong> 遭遇了类似的处境，Git 还有一些高级魔法可以帮到你。 如果团队中的某人强制推送并覆盖了一些你所基于的提交，你需要做的就是检查你做了哪些修改，以及他们覆盖了哪些修改。</p>
<p>实际上，Git 除了对整个提交计算 SHA-1 校验和以外，也对本次提交所引入的修改计算了校验和——即 “patch-id”。</p>
<p>如果你拉取被覆盖过的更新并将你手头的工作基于此进行变基的话，一般情况下 Git 都能成功分辨出哪些是你的修改，并把它们应用到新分支上。</p>
<ul>
<li><p>检查哪些提交是我们的分支上独有的（C2，C3，C4，C6，C7）</p>
</li>
<li><p>检查其中哪些提交不是合并操作的结果（C2，C3，C4）</p>
</li>
<li><p>检查哪些提交在对方覆盖更新时并没有被纳入目标分支（只有 C2 和 C3，因为 C4 其实就是 C4’）</p>
</li>
<li><p>把查到的这些提交应用在 <code>teamone/master</code> 上面</p>
</li>
</ul>
<p><img src="https://git-scm.com/book/zh/v2/images/perils-of-rebasing-5.png" alt="在一个被变基然后强制推送的分支上再次执行变基。"></p>
<p>Figure 48. 在一个被变基然后强制推送的分支上再次执行变基</p>
<p>要想上述方案有效，还需要对方在变基时确保 <code>C4&#39;</code> 和 <code>C4</code> 是几乎一样的。 否则变基操作将无法识别，并新建另一个类似 <code>C4</code> 的补丁（而这个补丁很可能无法整洁的整合入历史，因为补丁中的修改已经存在于某个地方了）。</p>
<p>在本例中另一种简单的方法是使用 <code>git pull --rebase</code> 命令而不是直接 <code>git pull</code>。 又或者你可以自己手动完成这个过程，先 <code>git fetch</code>，再 <code>git rebase teamone/master</code>。</p>
<p>如果你习惯使用 <code>git pull</code> ，同时又希望默认使用选项 <code>--rebase</code>，你可以执行这条语句 <code>git config --global pull.rebase true</code> 来更改 <code>pull.rebase</code> 的默认配置。</p>
<p>如果你只对不会离开你电脑的提交执行变基，那就不会有事。 如果你对已经推送过的提交执行变基，但别人没有基于它的提交，那么也不会有事。 如果你对已经推送至共用仓库的提交上执行变基命令，并因此丢失了一些别人的开发所基于的提交， 那你就有大麻烦了，你的同事也会因此鄙视你。</p>
<p>如果你或你的同事在某些情形下决意要这么做，请一定要通知每个人执行 <code>git pull --rebase</code> 命令，这样尽管不能避免伤痛，但能有所缓解。</p>
<h3 id="变基-vs-合并"><a href="#变基-vs-合并" class="headerlink" title="变基 vs. 合并"></a>变基 vs. 合并</h3><p>至此，你已在实战中学习了变基和合并的用法，你一定会想问，到底哪种方式更好。 在回答这个问题之前，让我们退后一步，想讨论一下提交历史到底意味着什么。</p>
<p>有一种观点认为，仓库的提交历史即是 <strong>记录实际发生过什么</strong>。 它是针对历史的文档，本身就有价值，不能乱改。 从这个角度看来，改变提交历史是一种亵渎，你使用 <em>谎言</em> 掩盖了实际发生过的事情。 如果由合并产生的提交历史是一团糟怎么办？ 既然事实就是如此，那么这些痕迹就应该被保留下来，让后人能够查阅。</p>
<p>另一种观点则正好相反，他们认为提交历史是 <strong>项目过程中发生的事</strong>。 没人会出版一本书的第一版草稿，软件维护手册也是需要反复修订才能方便使用。 持这一观点的人会使用 <code>rebase</code> 及 <code>filter-branch</code> 等工具来编写故事，怎么方便后来的读者就怎么写。</p>
<p>现在，让我们回到之前的问题上来，到底合并还是变基好？希望你能明白，这并没有一个简单的答案。 Git 是一个非常强大的工具，它允许你对提交历史做许多事情，但每个团队、每个项目对此的需求并不相同。 既然你已经分别学习了两者的用法，相信你能够根据实际情况作出明智的选择。</p>
<p>总的原则是，只对尚未推送或分享给别人的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作，这样，你才能享受到两种方式带来的便利。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2025/05/15/git-rebase/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2025/05/15/Linux-cheat-sheet/"
                            aria-label=": Linux cheat sheet"
                        >
                            Linux cheat sheet
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-15T21:37:03+08:00">
	
		    2025 年 5 月 15 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><img src="/assets/images/Linux-Commands_Cheat-Sheet.png" alt="image"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2025/05/15/Linux-cheat-sheet/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2025/05/14/git-cheat-sheet/"
                            aria-label=": git cheat sheet"
                        >
                            git cheat sheet
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-14T08:57:44+08:00">
	
		    2025 年 5 月 14 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/git/">git</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><img src="/assets/images/gitcheatsheet.png" alt="image"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2025/05/14/git-cheat-sheet/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2025/05/12/vim%E6%95%99%E7%A8%8B/"
                            aria-label=": vim教程"
                        >
                            vim教程
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-12T16:01:20+08:00">
	
		    2025 年 5 月 12 日
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Vim-编辑器使用笔记整理"><a href="#Vim-编辑器使用笔记整理" class="headerlink" title="Vim 编辑器使用笔记整理"></a>Vim 编辑器使用笔记整理</h1><h2 id="1-退出-Vim"><a href="#1-退出-Vim" class="headerlink" title="1. 退出 Vim"></a>1. 退出 Vim</h2><h3 id="命令行模式退出方式"><a href="#命令行模式退出方式" class="headerlink" title="命令行模式退出方式"></a>命令行模式退出方式</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>:wq</code></td>
<td>保存并退出</td>
</tr>
<tr>
<td><code>:q!</code></td>
<td>强制退出，不保存</td>
</tr>
<tr>
<td><code>:q</code></td>
<td>退出(未修改时)</td>
</tr>
<tr>
<td><code>:wq!</code></td>
<td>强制保存并退出</td>
</tr>
<tr>
<td><code>:w &lt;文件路径&gt;</code></td>
<td>另存为指定文件</td>
</tr>
<tr>
<td><code>:saveas 文件路径</code></td>
<td>另存为指定文件</td>
</tr>
<tr>
<td><code>:x</code></td>
<td>保存并退出(类似:wq)</td>
</tr>
</tbody></table>
<h3 id="普通模式退出方式"><a href="#普通模式退出方式" class="headerlink" title="普通模式退出方式"></a>普通模式退出方式</h3><ul>
<li>输入 <code>Shift+zz</code> 即可保存退出</li>
</ul>
<h2 id="2-删除文本"><a href="#2-删除文本" class="headerlink" title="2. 删除文本"></a>2. 删除文本</h2><h3 id="普通模式删除命令"><a href="#普通模式删除命令" class="headerlink" title="普通模式删除命令"></a>普通模式删除命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>x</code></td>
<td>删除游标所在字符</td>
</tr>
<tr>
<td><code>X</code></td>
<td>删除游标前一个字符</td>
</tr>
<tr>
<td><code>Delete</code></td>
<td>同 <code>x</code></td>
</tr>
<tr>
<td><code>dd</code></td>
<td>删除整行</td>
</tr>
<tr>
<td><code>dw</code></td>
<td>删除一个单词(不适用中文)</td>
</tr>
<tr>
<td><code>d$</code> 或 <code>D</code></td>
<td>删除至行尾</td>
</tr>
<tr>
<td><code>d^</code></td>
<td>删除至行首</td>
</tr>
<tr>
<td><code>dG</code></td>
<td>删除到文档结尾</td>
</tr>
<tr>
<td><code>d1G</code></td>
<td>删除至文档开头</td>
</tr>
<tr>
<td><code>:%d</code></td>
<td>清空整个文档内容（删除所有行）</td>
</tr>
<tr>
<td><code>:1,$d</code></td>
<td>同 <code>:%d</code>，删除从第一行到最后一行</td>
</tr>
<tr>
<td><code>ggdG</code></td>
<td>普通模式下清空文档的快捷方式（先跳转到首行，然后删除到末尾）</td>
</tr>
</tbody></table>
<p>注意：这些命令会立即生效且不可撤销，使用前请确保已保存重要内容</p>
<h3 id="数字前缀用法"><a href="#数字前缀用法" class="headerlink" title="数字前缀用法"></a>数字前缀用法</h3><ul>
<li><code>2dd</code> 表示一次删除2行</li>
<li><code>3dw</code> 表示删除3个单词</li>
</ul>
<h2 id="3-重复执行命令"><a href="#3-重复执行命令" class="headerlink" title="3. 重复执行命令"></a>3. 重复执行命令</h2><ul>
<li>普通模式下 <code>.</code> (小数点)表示重复上一次命令</li>
<li>数字前缀：<code>10x</code> 删除10个连续字符</li>
</ul>
<h2 id="4-游标跳转"><a href="#4-游标跳转" class="headerlink" title="4. 游标跳转"></a>4. 游标跳转</h2><h3 id="行间跳转"><a href="#行间跳转" class="headerlink" title="行间跳转"></a>行间跳转</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>nG</code></td>
<td>跳转到第n行(需先<code>:set nu</code>显示行号)</td>
</tr>
<tr>
<td><code>gg</code></td>
<td>跳转到第一行</td>
</tr>
<tr>
<td><code>G</code></td>
<td>跳转到最后一行</td>
</tr>
</tbody></table>
<h3 id="行内跳转"><a href="#行内跳转" class="headerlink" title="行内跳转"></a>行内跳转</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>w</code></td>
<td>到下一个单词开头</td>
</tr>
<tr>
<td><code>e</code></td>
<td>到当前单词结尾</td>
</tr>
<tr>
<td><code>b</code></td>
<td>到前一个单词开头</td>
</tr>
<tr>
<td><code>ge</code></td>
<td>到前一个单词结尾</td>
</tr>
<tr>
<td><code>0</code> 或 <code>^</code></td>
<td>到行头</td>
</tr>
<tr>
<td><code>$</code></td>
<td>到行尾</td>
</tr>
<tr>
<td><code>f&lt;字母&gt;</code></td>
<td>向后搜索字母并跳转</td>
</tr>
<tr>
<td><code>F&lt;字母&gt;</code></td>
<td>向前搜索字母并跳转</td>
</tr>
<tr>
<td><code>t&lt;字母&gt;</code></td>
<td>向后搜索字母并跳转到匹配前</td>
</tr>
<tr>
<td><code>T&lt;字母&gt;</code></td>
<td>向前搜索字母并跳转到匹配后</td>
</tr>
</tbody></table>
<h2 id="5-复制粘贴和剪切"><a href="#5-复制粘贴和剪切" class="headerlink" title="5. 复制粘贴和剪切"></a>5. 复制粘贴和剪切</h2><h3 id="复制命令-yank"><a href="#复制命令-yank" class="headerlink" title="复制命令(yank)"></a>复制命令(yank)</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>yy</code></td>
<td>复制整行(3yy复制3行)</td>
</tr>
<tr>
<td><code>y^</code></td>
<td>复制至行首</td>
</tr>
<tr>
<td><code>y$</code></td>
<td>复制至行尾</td>
</tr>
<tr>
<td><code>yw</code></td>
<td>复制一个单词</td>
</tr>
<tr>
<td><code>yG</code></td>
<td>复制至文本末</td>
</tr>
<tr>
<td><code>y1G</code></td>
<td>复制至文本开头</td>
</tr>
</tbody></table>
<h3 id="粘贴命令"><a href="#粘贴命令" class="headerlink" title="粘贴命令"></a>粘贴命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>p</code></td>
<td>粘贴至光标后</td>
</tr>
<tr>
<td><code>P</code></td>
<td>粘贴至光标前</td>
</tr>
</tbody></table>
<h2 id="6-替换和撤销"><a href="#6-替换和撤销" class="headerlink" title="6. 替换和撤销"></a>6. 替换和撤销</h2><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>r+&lt;字母&gt;</code></td>
<td>替换游标所在字母</td>
</tr>
<tr>
<td><code>R</code></td>
<td>连续替换(按Esc结束)</td>
</tr>
<tr>
<td><code>cc</code></td>
<td>替换整行</td>
</tr>
<tr>
<td><code>cw</code></td>
<td>替换一个单词</td>
</tr>
<tr>
<td><code>C</code></td>
<td>替换至行末</td>
</tr>
<tr>
<td><code>~</code></td>
<td>反转字母大小写</td>
</tr>
<tr>
<td><code>u</code></td>
<td>撤销操作</td>
</tr>
<tr>
<td><code>U</code></td>
<td>撤销当前行所有修改</td>
</tr>
<tr>
<td><code>Ctrl+r</code></td>
<td>重做(redo)</td>
</tr>
</tbody></table>
<h2 id="7-缩进调整"><a href="#7-缩进调整" class="headerlink" title="7. 缩进调整"></a>7. 缩进调整</h2><h3 id="缩进命令"><a href="#缩进命令" class="headerlink" title="缩进命令"></a>缩进命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>&gt;&gt;</code></td>
<td>整行向右缩进</td>
</tr>
<tr>
<td><code>&lt;&lt;</code></td>
<td>整行向左回退</td>
</tr>
<tr>
<td><code>:set shiftwidth=n</code></td>
<td>设置缩进字符数</td>
</tr>
</tbody></table>
<h3 id="文本位置调整"><a href="#文本位置调整" class="headerlink" title="文本位置调整"></a>文本位置调整</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>:ce</code></td>
<td>本行内容居中</td>
</tr>
<tr>
<td><code>:ri</code></td>
<td>本行文本靠右</td>
</tr>
<tr>
<td><code>:le</code></td>
<td>本行内容靠左</td>
</tr>
</tbody></table>
<h2 id="8-查找功能"><a href="#8-查找功能" class="headerlink" title="8. 查找功能"></a>8. 查找功能</h2><h3 id="基本查找"><a href="#基本查找" class="headerlink" title="基本查找"></a>基本查找</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>/字符串</code></td>
<td>向下查找</td>
</tr>
<tr>
<td><code>?字符串</code></td>
<td>向上查找</td>
</tr>
<tr>
<td><code>n</code></td>
<td>继续查找</td>
</tr>
<tr>
<td><code>N</code></td>
<td>反向查找</td>
</tr>
</tbody></table>
<h3 id="高级查找"><a href="#高级查找" class="headerlink" title="高级查找"></a>高级查找</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td>向后查找当前单词</td>
</tr>
<tr>
<td><code>#</code></td>
<td>向前查找当前单词</td>
</tr>
<tr>
<td><code>g*</code></td>
<td>向后查找部分匹配单词</td>
</tr>
<tr>
<td><code>g#</code></td>
<td>向前查找部分匹配单词</td>
</tr>
</tbody></table>
<h2 id="9-多文件编辑"><a href="#9-多文件编辑" class="headerlink" title="9. 多文件编辑"></a>9. 多文件编辑</h2><h3 id="多文件操作"><a href="#多文件操作" class="headerlink" title="多文件操作"></a>多文件操作</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>:n</code></td>
<td>编辑下一个文件</td>
</tr>
<tr>
<td><code>:N</code></td>
<td>编辑上一个文件</td>
</tr>
<tr>
<td><code>:e 文件名</code></td>
<td>打开新文件</td>
</tr>
<tr>
<td><code>:e#</code></td>
<td>回到前一个文件</td>
</tr>
<tr>
<td><code>:ls</code></td>
<td>列出编辑过的文档</td>
</tr>
<tr>
<td><code>:b 文件名/编号</code></td>
<td>切换到指定文件</td>
</tr>
<tr>
<td><code>:bd 文件名/编号</code></td>
<td>从列表删除文件</td>
</tr>
<tr>
<td><code>:f</code></td>
<td>显示当前文件名</td>
</tr>
</tbody></table>
<h3 id="文件恢复"><a href="#文件恢复" class="headerlink" title="文件恢复"></a>文件恢复</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim -r 文件名</span><br><span class="line">:ewcover 文件名</span><br></pre></td></tr></table></figure>

<h2 id="10-可视模式"><a href="#10-可视模式" class="headerlink" title="10. 可视模式"></a>10. 可视模式</h2><h3 id="进入可视模式"><a href="#进入可视模式" class="headerlink" title="进入可视模式"></a>进入可视模式</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>v</code></td>
<td>字符选择模式</td>
</tr>
<tr>
<td><code>V</code></td>
<td>行选择模式</td>
</tr>
<tr>
<td><code>Ctrl+v</code></td>
<td>区域选择模式</td>
</tr>
</tbody></table>
<h3 id="可视模式操作"><a href="#可视模式操作" class="headerlink" title="可视模式操作"></a>可视模式操作</h3><ul>
<li><code>d</code> 删除选中区域</li>
<li><code>y</code> 复制选中区域</li>
</ul>
<h2 id="11-视窗操作"><a href="#11-视窗操作" class="headerlink" title="11. 视窗操作"></a>11. 视窗操作</h2><h3 id="窗口分割"><a href="#窗口分割" class="headerlink" title="窗口分割"></a>窗口分割</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>:new</code></td>
<td>新建窗口</td>
</tr>
<tr>
<td><code>:sp 文件名</code></td>
<td>水平分割窗口</td>
</tr>
<tr>
<td><code>:vsp 文件名</code></td>
<td>垂直分割窗口</td>
</tr>
<tr>
<td><code>Ctrl+w s</code></td>
<td>水平分割当前窗口</td>
</tr>
<tr>
<td><code>Ctrl+w v</code></td>
<td>垂直分割当前窗口</td>
</tr>
</tbody></table>
<h3 id="窗口切换"><a href="#窗口切换" class="headerlink" title="窗口切换"></a>窗口切换</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>Ctrl+w j/k/h/l</code></td>
<td>向下&#x2F;上&#x2F;左&#x2F;右切换窗口</td>
</tr>
<tr>
<td><code>Ctrl+w q</code></td>
<td>关闭当前窗口</td>
</tr>
<tr>
<td><code>Ctrl+w o</code></td>
<td>只保留当前窗口</td>
</tr>
</tbody></table>
<h2 id="12-其他功能"><a href="#12-其他功能" class="headerlink" title="12. 其他功能"></a>12. 其他功能</h2><h3 id="文档加密"><a href="#文档加密" class="headerlink" title="文档加密"></a>文档加密</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim -x 文件名</span><br></pre></td></tr></table></figure>

<h3 id="执行外部命令"><a href="#执行外部命令" class="headerlink" title="执行外部命令"></a>执行外部命令</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:!命令</span><br><span class="line">:<span class="keyword">w</span> 文件名  # 另存为</span><br></pre></td></tr></table></figure>

<h3 id="帮助系统"><a href="#帮助系统" class="headerlink" title="帮助系统"></a>帮助系统</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:F1        # 打开帮助</span><br><span class="line">:h 主题    # 查看特定帮助</span><br><span class="line">:ver       # 显示版本</span><br></pre></td></tr></table></figure>

<h3 id="功能设定"><a href="#功能设定" class="headerlink" title="功能设定"></a>功能设定</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">set</span> <span class="keyword">nu</span>    # 显示行号</span><br><span class="line">:<span class="keyword">set</span> ai    # 自动缩进</span><br><span class="line">:<span class="keyword">set</span> aw    # 自动保存</span><br><span class="line">:<span class="keyword">set</span> cin   # C语言风格缩进</span><br></pre></td></tr></table></figure>

<blockquote>
<p>提示：所有设置可通过修改 <code>~/.vimrc</code> 文件永久保存</p>
</blockquote>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2025/05/12/vim%E6%95%99%E7%A8%8B/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/01/12/VPC/"
                            aria-label=": VPC"
                        >
                            VPC
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-12T23:15:39+08:00">
	
		    2021 年 1 月 12 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/AWS/">AWS</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <ol>
<li><p>Security Group(SG):</p>
<ol>
<li>所有设定默认是拒绝，只可以设定许可规则，拒否ルールは指定できません。</li>
<li>特征是不单可以指定CIDR等IP,还可以指定SG</li>
<li>安全组是有状态的 — 如果您从实例发送一个请求，则无论入站安全组规则如何，都将允许该请求的响应流量流入。如果是为响应已允许的入站流量，则该响应可以出站，此时可忽略出站规则。セキュリティグループはステートフルです。</li>
</ol>
</li>
<li><p>Access Control List(ACL):</p>
<ol>
<li>VPC 自动带有可修改的默认网络 ACL。默认情况下，它允许所有入站和出站 IPv4 流量以及 IPv6 流量 (如果适用)。</li>
<li>可以创建自定义网络 ACL 并将其与子网相关联。默认情况下，每个自定义网络 ACL 都拒绝所有入站和出站流量，直至您添加规则。</li>
<li>VPC 中的每个子网都必须与一个网络 ACL 相关联。如果您没有明确地将子网与网络 ACL 相关联，则子网将自动与默认网络 ACL 关联。</li>
<li>可以将网络 ACL 与多个子网关联。但是，一个子网一次只能与一个网络 ACL 关联。当您将一个网络 ACL 与一个子网关联时，将删除之前的关联。</li>
<li>网络 ACL 包含规则的编号列表。我们按顺序评估（从编号最小的规则开始）规则，以判断是否允许流量进入或离开任何与网络 ACL 关联的子网。您可以使用的最高规则编号为 32766。我们建议您开始先以增量方式创建规则（例如，以 10 或 100 的增量增加），这样您可以在稍后需要时插入新的规则。</li>
<li>网络 ACL 有单独的入站和出站规则，每项规则都或是允许或是拒绝数据流。</li>
<li>网络 ACL 没有任何状态，这意味着对允许入站数据流的响应会随着出站数据流规则的变化而改变（反之亦然）。(ネットワーク ACL はステートレスです。許可されているインバウンドトラフィックに対する応答は、アウトバウンドトラフィックのルールに従います（その逆の場合も同様です）。)</li>
<li>ルール番号。ルールは、最も低い番号のルールから評価されます。ルールがトラフィックに一致すると、それと相反するより高い数値のルールの有無にかかわらず、すぐに適用されます。</li>
<li>タイプ。トラフィックのタイプ（SSH など）。また、すべてのトラフィックまたはカスタム範囲を指定することもできます。</li>
</ol>
</li>
</ol>
<p>セキュリティグループはステートフルです。（レスポンスでも明示する必要なしで許可。）<br>ACLはステートレスです。（レスポンスでも明示する必要ある。）</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/01/12/VPC/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2020/11/17/linux/17-%E7%B3%BB%E7%BB%9F%E7%BB%B4%E6%8A%A4/"
                            aria-label=": 17.系统维护"
                        >
                            17.系统维护
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-17T14:01:48+08:00">
	
		    2020 年 11 月 17 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="从源代码安装软件笔记整理"><a href="#从源代码安装软件笔记整理" class="headerlink" title="从源代码安装软件笔记整理"></a>从源代码安装软件笔记整理</h1><h2 id="1-安装C语言开源软件的三个主要步骤"><a href="#1-安装C语言开源软件的三个主要步骤" class="headerlink" title="1. 安装C语言开源软件的三个主要步骤"></a>1. 安装C语言开源软件的三个主要步骤</h2><ol>
<li>解压源代码</li>
<li>编译成二进制文件</li>
<li>将二进制文件安装到适当的文件夹</li>
</ol>
<h2 id="2-解压源代码"><a href="#2-解压源代码" class="headerlink" title="2. 解压源代码"></a>2. 解压源代码</h2><h3 id="常用解压命令"><a href="#常用解压命令" class="headerlink" title="常用解压命令"></a>常用解压命令</h3><table>
<thead>
<tr>
<th>命令格式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>gunzip [文件名]</code></td>
<td>解压.gz文件</td>
</tr>
<tr>
<td><code>gzip [option] [文件名]</code></td>
<td>压缩&#x2F;解压文件</td>
</tr>
<tr>
<td><code>bunzip [文件名]</code></td>
<td>解压.bz2文件</td>
</tr>
<tr>
<td><code>bzip [option] [文件名]</code></td>
<td>压缩&#x2F;解压文件</td>
</tr>
</tbody></table>
<h3 id="gzip-bzip-选项说明"><a href="#gzip-bzip-选项说明" class="headerlink" title="gzip&#x2F;bzip 选项说明"></a>gzip&#x2F;bzip 选项说明</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-d</code></td>
<td>解压压缩文件</td>
</tr>
<tr>
<td><code>-c</code></td>
<td>解压压缩文件到标准输出</td>
</tr>
</tbody></table>
<h2 id="3-patch命令"><a href="#3-patch命令" class="headerlink" title="3. patch命令"></a>3. patch命令</h2><p>用于应用补丁文件</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-d 文件夹</code></td>
<td>移动到指定文件夹后处理</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>修正patch文件内的path: <br><code>-p0</code>: 不修正path <br><code>-p1</code>: 删除最初的’&#x2F;‘ <br><code>-p2</code>: 删除下一级文件夹</td>
</tr>
<tr>
<td><code>patch</code></td>
<td>应用补丁</td>
</tr>
<tr>
<td><code>-C</code></td>
<td>测试(不实际应用补丁)</td>
</tr>
<tr>
<td><code>-R</code></td>
<td>取消补丁，恢复到补丁前状态</td>
</tr>
</tbody></table>
<h2 id="4-生成Makefile"><a href="#4-生成Makefile" class="headerlink" title="4. 生成Makefile"></a>4. 生成Makefile</h2><p>运行config脚本根据环境配置config文件:</p>
<h3 id="config脚本主要选项"><a href="#config脚本主要选项" class="headerlink" title="config脚本主要选项"></a>config脚本主要选项</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>--help</code></td>
<td>显示帮助说明</td>
</tr>
<tr>
<td><code>--prefix=文件夹</code></td>
<td>指定安装目标的top路径</td>
</tr>
</tbody></table>
<h2 id="5-编译和安装"><a href="#5-编译和安装" class="headerlink" title="5. 编译和安装"></a>5. 编译和安装</h2><h3 id="make命令"><a href="#make命令" class="headerlink" title="make命令"></a>make命令</h3><p>根据当前文件夹内的Makefile编译源代码</p>
<p>基本格式：</p>
<pre><code class="language-bash">make [option] [目标]
</code></pre>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2020/11/17/linux/17-%E7%B3%BB%E7%BB%9F%E7%BB%B4%E6%8A%A4/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2020/11/16/linux/16-%E7%BD%91%E7%BB%9C/"
                            aria-label=": 16.网络"
                        >
                            16.网络
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-16T14:01:40+08:00">
	
		    2020 年 11 月 16 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-网络设备管理"><a href="#1-网络设备管理" class="headerlink" title="1. 网络设备管理"></a>1. 网络设备管理</h2><h3 id="1-1-网络接口命名规则"><a href="#1-1-网络接口命名规则" class="headerlink" title="1.1 网络接口命名规则"></a>1.1 网络接口命名规则</h3><table>
<thead>
<tr>
<th>接口名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>eth0</code></td>
<td>第一个 Ethernet 接口</td>
</tr>
<tr>
<td><code>eth1</code></td>
<td>第二个 Ethernet 接口</td>
</tr>
<tr>
<td><code>ppp0</code></td>
<td>第一个 PPP 接口</td>
</tr>
<tr>
<td><code>lo</code></td>
<td>Loopback 接口</td>
</tr>
</tbody></table>
<h3 id="1-2-网络设备识别命令"><a href="#1-2-网络设备识别命令" class="headerlink" title="1.2 网络设备识别命令"></a>1.2 网络设备识别命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep eth  <span class="comment"># 查看内核识别的网络设备</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3-网络接口配置命令"><a href="#1-3-网络接口配置命令" class="headerlink" title="1.3 网络接口配置命令"></a>1.3 网络接口配置命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig [-a] [IF名] [参数]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-a</code></td>
<td>显示所有接口</td>
</tr>
<tr>
<td><code>IF名</code></td>
<td>指定接口名称</td>
</tr>
<tr>
<td><code>IP地址</code></td>
<td>设置 IP 地址</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td>设置子网掩码</td>
</tr>
<tr>
<td><code>up</code></td>
<td>激活接口（等价于 <code>ifup</code>）</td>
</tr>
<tr>
<td><code>down</code></td>
<td>停止接口（等价于 <code>ifdown</code>）</td>
</tr>
</tbody></table>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 192.168.120.27 netmask 255.255.255.0 up</span><br></pre></td></tr></table></figure>

<h3 id="1-4-NIC-组合与虚拟网络接口"><a href="#1-4-NIC-组合与虚拟网络接口" class="headerlink" title="1.4 NIC 组合与虚拟网络接口"></a>1.4 NIC 组合与虚拟网络接口</h3><ul>
<li><strong>NIC 组合</strong>：允许将多个物理以太网适配器分组为虚拟网络适配器，提高性能和容错能力。</li>
<li><strong>MAC 地址设置</strong>：在 “交换机独立” 模式下，团队会将 MAC 地址设置为出站流量。</li>
<li><strong>IP 别名</strong>：在同一个网卡上分配不同 IP 地址。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0:0 192.168.0.1 netmask 255.255.255.0 up</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-ARP-协议管理"><a href="#2-ARP-协议管理" class="headerlink" title="2. ARP 协议管理"></a>2. ARP 协议管理</h2><h3 id="2-1-ARP-协议简介"><a href="#2-1-ARP-协议简介" class="headerlink" title="2.1 ARP 协议简介"></a>2.1 ARP 协议简介</h3><p>ARP (Address Resolution Protocol) 用于将 IP 地址解析为 MAC 地址。</p>
<h3 id="2-2-ARP-命令"><a href="#2-2-ARP-命令" class="headerlink" title="2.2 ARP 命令"></a>2.2 ARP 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp [option]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-a [host]</code></td>
<td>显示指定主机或全部 ARP 表</td>
</tr>
<tr>
<td><code>-f 文件名</code></td>
<td>从文件读取主机:MAC 对应表</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示 IP 地址而非主机名</td>
</tr>
<tr>
<td><code>-d [host]</code></td>
<td>删除指定主机的 ARP 记录</td>
</tr>
<tr>
<td><code>-i [IF名]</code></td>
<td>指定接口</td>
</tr>
<tr>
<td><code>-s [host] [MAC地址]</code></td>
<td>添加主机和 MAC 地址的对应关系</td>
</tr>
</tbody></table>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp -s h001.example.com 00:01:02:03:04:05</span><br></pre></td></tr></table></figure>

<h3 id="2-3-ARP-监视工具"><a href="#2-3-ARP-监视工具" class="headerlink" title="2.3 ARP 监视工具"></a>2.3 ARP 监视工具</h3><ul>
<li><code>arpwatch</code>：监视网络中的 ARP 活动。</li>
</ul>
<h2 id="3-网络管理命令"><a href="#3-网络管理命令" class="headerlink" title="3. 网络管理命令"></a>3. 网络管理命令</h2><h3 id="3-1-Ping-命令"><a href="#3-1-Ping-命令" class="headerlink" title="3.1 Ping 命令"></a>3.1 Ping 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping [host名或IP] [option]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-n</code></td>
<td>不解析主机名，显示 IP 地址</td>
</tr>
<tr>
<td><code>-c 次数</code></td>
<td>发送指定次数的 ICMP 包</td>
</tr>
<tr>
<td><code>-i 间隔</code></td>
<td>按指定间隔发送 ICMP 包</td>
</tr>
</tbody></table>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping -c 4 192.168.1.1</span><br></pre></td></tr></table></figure>

<h3 id="3-2-Traceroute-命令"><a href="#3-2-Traceroute-命令" class="headerlink" title="3.2 Traceroute 命令"></a>3.2 Traceroute 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute [option] [host名或IP]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-i [IF]</code></td>
<td>指定接口</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示 IP 地址而非主机名</td>
</tr>
</tbody></table>
<h3 id="3-3-Tcpdump-命令"><a href="#3-3-Tcpdump-命令" class="headerlink" title="3.3 Tcpdump 命令"></a>3.3 Tcpdump 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump [option] [条件式]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-i IF名</code></td>
<td>指定监视的接口</td>
</tr>
<tr>
<td><code>-s 比特数</code></td>
<td>指定从包中提取的比特数</td>
</tr>
<tr>
<td><code>-X</code></td>
<td>显示十六进制和 ASCII 文本</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>不解析 ARP 地址</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>缓存标准输出</td>
</tr>
<tr>
<td><code>-t</code></td>
<td>不显示时间</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>显示详细信息</td>
</tr>
</tbody></table>
<p><strong>条件式</strong>:</p>
<ul>
<li><code>port</code>：指定端口</li>
</ul>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -nli eth0 port 53</span><br></pre></td></tr></table></figure>

<h3 id="3-4-Wireshark"><a href="#3-4-Wireshark" class="headerlink" title="3.4 Wireshark"></a>3.4 Wireshark</h3><ul>
<li>图形化网络监视工具。</li>
</ul>
<h3 id="3-5-Netstat-命令"><a href="#3-5-Netstat-命令" class="headerlink" title="3.5 Netstat 命令"></a>3.5 Netstat 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat [option]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-a</code></td>
<td>显示所有 socket</td>
</tr>
<tr>
<td><code>-c</code></td>
<td>每秒刷新</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>显示接口状态</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>只显示监听状态的端口</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示地址和端口</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>显示 PID 和进程</td>
</tr>
<tr>
<td><code>-r</code></td>
<td>显示路由表</td>
</tr>
<tr>
<td><code>-t</code></td>
<td>显示 TCP 连接</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>显示 UDP 连接</td>
</tr>
</tbody></table>
<h3 id="3-6-IP-命令"><a href="#3-6-IP-命令" class="headerlink" title="3.6 IP 命令"></a>3.6 IP 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip [option] 操作对象 [命令] [设备]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-s</code></td>
<td>显示状态</td>
</tr>
<tr>
<td><code>-r</code></td>
<td>解析名称</td>
</tr>
</tbody></table>
<p><strong>操作对象</strong>:</p>
<ul>
<li><code>link</code>：接口详细信息</li>
<li><code>addr</code>：IP 地址</li>
<li><code>route</code>：路由表</li>
<li><code>neigh</code>：ARP 缓存</li>
</ul>
<p><strong>命令</strong>:</p>
<ul>
<li><code>show</code>：显示指定对象</li>
<li><code>add</code>：设置指定对象的参数</li>
</ul>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip <span class="built_in">link</span> show eth0</span><br></pre></td></tr></table></figure>

<h2 id="4-路由设置"><a href="#4-路由设置" class="headerlink" title="4. 路由设置"></a>4. 路由设置</h2><h3 id="4-1-Route-命令"><a href="#4-1-Route-命令" class="headerlink" title="4.1 Route 命令"></a>4.1 Route 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route [option]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>-n</code></td>
<td>不解析主机名</td>
</tr>
<tr>
<td><code>-F</code></td>
<td>显示内核路由表</td>
</tr>
<tr>
<td><code>-C</code></td>
<td>显示内核路由缓存</td>
</tr>
</tbody></table>
<p><strong>路由表项目</strong>:</p>
<ul>
<li><code>Destination</code>：目标网络或主机</li>
<li><code>Gateway</code>：网关</li>
<li><code>Genmask</code>：目标子网掩码</li>
<li><code>Flags</code>：路由状态（U:有效, H:目标主机, G:使用网关, !:无效）</li>
<li><code>Metric</code>：到达目标的距离</li>
<li><code>Ref</code>：路由引用数</li>
<li><code>Use</code>：路径引用次数</li>
<li><code>Iface</code>：使用的接口</li>
</ul>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">route add -net 192.168.100.0 netmask 255.255.255.0 gw 172.16.0.1</span><br><span class="line">route add default gw 192.168.0.50</span><br><span class="line">route del -net 192.168.100.0 netmask 255.255.255.0 gw 172.16.0.1</span><br></pre></td></tr></table></figure>

<h2 id="5-无线网络设置"><a href="#5-无线网络设置" class="headerlink" title="5. 无线网络设置"></a>5. 无线网络设置</h2><h3 id="5-1-无线规格与安全标准"><a href="#5-1-无线规格与安全标准" class="headerlink" title="5.1 无线规格与安全标准"></a>5.1 无线规格与安全标准</h3><table>
<thead>
<tr>
<th>规格</th>
<th>频率</th>
<th>传送速度</th>
</tr>
</thead>
<tbody><tr>
<td>IEEE 802.11a</td>
<td>5.2GHz</td>
<td>54Mbps</td>
</tr>
<tr>
<td>IEEE 802.11b</td>
<td>2.4GHz</td>
<td>11Mbps</td>
</tr>
<tr>
<td>IEEE 802.11g</td>
<td>2.4GHz</td>
<td>54Mbps</td>
</tr>
<tr>
<td>IEEE 802.11n</td>
<td>2.4GHz&#x2F;5GHz</td>
<td>600Mbps</td>
</tr>
<tr>
<td>IEEE 802.11ac</td>
<td>5GHz</td>
<td>433Mbps~7Gbps</td>
</tr>
</tbody></table>
<p><strong>安全标准</strong>:</p>
<ul>
<li><strong>WEP</strong>：使用 RC4 算法，存在漏洞。</li>
<li><strong>WPA</strong>：多种加密技术（TKIP, AES），用户认证由 IEEE 802.1x 等实现。WPA-AES 比 WPA-TKIP 更安全。</li>
</ul>
<h3 id="5-2-无线接口状态确认"><a href="#5-2-无线接口状态确认" class="headerlink" title="5.2 无线接口状态确认"></a>5.2 无线接口状态确认</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iwconfig [wlanN] [essid ESSID] [key [s:]WEP key]</span><br></pre></td></tr></table></figure>
<p><strong>示例</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iwconfig wlan0 essid <span class="string">&quot;windsor&quot;</span></span><br><span class="line">iwconfig wlan0 key s:abc12345</span><br></pre></td></tr></table></figure>

<h3 id="5-3-获取无线接口信息"><a href="#5-3-获取无线接口信息" class="headerlink" title="5.3 获取无线接口信息"></a>5.3 获取无线接口信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iwlist [无线IF] [参数]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>scanning [essid ID]</code></td>
<td>显示可接入的热点列表</td>
</tr>
<tr>
<td><code>channel</code></td>
<td>显示可设置的频道</td>
</tr>
<tr>
<td><code>rate</code></td>
<td>显示传送速度</td>
</tr>
</tbody></table>
<h2 id="6-高级网络设置"><a href="#6-高级网络设置" class="headerlink" title="6. 高级网络设置"></a>6. 高级网络设置</h2><h3 id="6-1-网络相关文件"><a href="#6-1-网络相关文件" class="headerlink" title="6.1 网络相关文件"></a>6.1 网络相关文件</h3><table>
<thead>
<tr>
<th>文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/hostname</code></td>
<td>记录主机名</td>
</tr>
<tr>
<td><code>/etc/hosts</code></td>
<td>记录主机名、别名和 IP 的对应关系</td>
</tr>
<tr>
<td><code>/etc/networks</code></td>
<td>记录网络和 IP 的对应关系</td>
</tr>
<tr>
<td><code>/etc/nsswitch.conf</code></td>
<td>规定信息查找顺序</td>
</tr>
<tr>
<td><code>/etc/resolv.conf</code></td>
<td>记录 DNS 服务器和域名</td>
</tr>
<tr>
<td><code>/etc/sysconfig/network</code></td>
<td>网络功能、主机名、默认网关等设置</td>
</tr>
<tr>
<td><code>/etc/sysconfig/network-scripts/</code></td>
<td>存放网络接口设置文件</td>
</tr>
<tr>
<td><code>/etc/network/interfaces</code></td>
<td>Debian 系统的网络接口设置文件</td>
</tr>
</tbody></table>
<h3 id="6-2-配置文件示例"><a href="#6-2-配置文件示例" class="headerlink" title="6.2 配置文件示例"></a>6.2 配置文件示例</h3><p><strong>&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth0</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth0</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=192.168.0.6</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">NETWORK=192.168.0.0</span><br><span class="line">BROADCAST=192.168.0.255</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure>

<p><strong>&#x2F;etc&#x2F;network&#x2F;interfaces (Debian)</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line">allow-hotplug eth0</span><br><span class="line">iface eth0 inet static </span><br><span class="line">    address 192.168.0.6</span><br><span class="line">    netmask 255.255.255.0</span><br><span class="line">    gateway 192.168.0.1</span><br><span class="line">    dns-domain example.com</span><br><span class="line">    dns-nameservers 192.168.1.1</span><br></pre></td></tr></table></figure>

<h2 id="7-网络问题排查"><a href="#7-网络问题排查" class="headerlink" title="7. 网络问题排查"></a>7. 网络问题排查</h2><h3 id="7-1-排查步骤"><a href="#7-1-排查步骤" class="headerlink" title="7.1 排查步骤"></a>7.1 排查步骤</h3><ol>
<li><p><strong>Ping 测试</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping 172.16.0.1</span><br><span class="line">ping h001.s16.la.net</span><br></pre></td></tr></table></figure>
<ul>
<li>如果 IP 能 Ping 通，但主机名失败，可能是 DNS 问题，检查 <code>/etc/resolv.conf</code>。</li>
</ul>
</li>
<li><p><strong>局域网连通但无法访问互联网</strong>：</p>
<ul>
<li>检查默认网关或路由表：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route</span><br></pre></td></tr></table></figure></li>
<li>如果没有默认路由，添加默认网关：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route add default gw 172.16.0.1</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>网络连接不通</strong>：</p>
<ul>
<li>使用 <code>traceroute</code> 或 <code>tracepath</code> 查看路径：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute www.lpi.jp</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>网络接口问题</strong>：</p>
<ul>
<li>检查网卡状态：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure></li>
<li>如果只显示 <code>lo</code>，启动接口：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifup eth0</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">ifconfig eth0 up</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3 id="7-2-需要确认的配置文件"><a href="#7-2-需要确认的配置文件" class="headerlink" title="7.2 需要确认的配置文件"></a>7.2 需要确认的配置文件</h3><table>
<thead>
<tr>
<th>文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/resolv.conf</code></td>
<td>DNS 服务器设置</td>
</tr>
<tr>
<td><code>/etc/sysconfig/network-scripts/*</code></td>
<td>网络接口设置（RHEL&#x2F;CentOS）</td>
</tr>
<tr>
<td><code>/etc/network/interfaces</code></td>
<td>网络接口设置（Debian）</td>
</tr>
<tr>
<td><code>/etc/hosts.allow</code>, <code>/etc/hosts.deny</code></td>
<td>连接控制</td>
</tr>
</tbody></table>
<hr>
<p><strong>补充说明</strong>：</p>
<ul>
<li><strong>IP 别名</strong>：允许在同一个网卡上分配多个 IP 地址，常用于服务器提供多种服务。</li>
<li><strong>ARP 缓存</strong>：存储 IP 地址与 MAC 地址的映射关系，可通过 <code>arp -d</code> 手动清除缓存。</li>
<li><strong>无线安全</strong>：建议使用 WPA2 或 WPA3 加密方式，避免使用不安全的 WEP。</li>
<li><strong>路由表</strong>：理解目标网络、网关、子网掩码和接口的关系，确保数据包正确转发。</li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2020/11/16/linux/16-%E7%BD%91%E7%BB%9C/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2020/11/15/linux/15-%E9%AB%98%E5%BA%A6%E7%9A%84%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"
                            aria-label=": 15.高度的存储管理"
                        >
                            15.高度的存储管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-15T14:01:30+08:00">
	
		    2020 年 11 月 15 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="1-RAID-冗余磁盘阵列"><a href="#1-RAID-冗余磁盘阵列" class="headerlink" title="1. RAID (冗余磁盘阵列)"></a>1. RAID (冗余磁盘阵列)</h1><p>RAID（Redundant Arrays of Inexpensive Disks）是一种将多个硬盘组合以提高性能或数据冗余的技术。</p>
<h2 id="Linux-上的-RAID"><a href="#Linux-上的-RAID" class="headerlink" title="Linux 上的 RAID"></a>Linux 上的 RAID</h2><p>在 Linux 上应用 RAID，有软件 RAID 和硬件 RAID 之分。通常，硬件 RAID 会被视作 SCSI 设备。</p>
<h2 id="RAID-各个等级："><a href="#RAID-各个等级：" class="headerlink" title="RAID 各个等级："></a>RAID 各个等级：</h2><ul>
<li><p><strong>RAID 0 (条带化)</strong></p>
<ul>
<li>多个硬盘组合成一个大磁盘，没有备份，提供较好的性能但没有容灾能力。</li>
<li>示例：三台 100GB 硬盘组成一个 300GB 的 RAID 0。</li>
</ul>
</li>
<li><p><strong>RAID 1 (镜像)</strong></p>
<ul>
<li>多台硬盘写入相同数据，提供冗余备份。</li>
<li>示例：三个 100GB 硬盘组成一个 100GB 的 RAID 1。</li>
</ul>
</li>
<li><p><strong>RAID 4</strong></p>
<ul>
<li>至少需要 3 台硬盘，其中一台用作备份分区。性能瓶颈在于备份分区。</li>
<li>示例：三个 100GB 硬盘组成一个 200GB 的 RAID 4。</li>
</ul>
</li>
<li><p><strong>RAID 5</strong></p>
<ul>
<li>使用分布式备份技术，性能较 RAID 4 好，且不需要专门的备份硬盘。</li>
<li>示例：三个 100GB 硬盘组成一个 200GB 的 RAID 5。</li>
</ul>
</li>
<li><p><strong>其他 RAID 等级：</strong></p>
<ul>
<li><strong>RAID LINEAR</strong>：类似 RAID 0。</li>
<li><strong>RAID 0+1 (RAID01)</strong>：RAID 0 组成的 RAID 1。</li>
<li><strong>RAID 10 (RAID+0)</strong>：RAID 1 组成的 RAID 0。</li>
<li><strong>RAID 6</strong>：比 RAID 5 多一台备份区。</li>
</ul>
</li>
</ul>
<h2 id="mdadm-命令控制-RAID-阵列"><a href="#mdadm-命令控制-RAID-阵列" class="headerlink" title="mdadm 命令控制 RAID 阵列"></a><code>mdadm</code> 命令控制 RAID 阵列</h2><p><code>mdadm [option] [设备名]</code></p>
<h3 id="常用选项："><a href="#常用选项：" class="headerlink" title="常用选项："></a>常用选项：</h3><table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>-C</code>, <code>--create</code></td>
<td>创建 RAID 阵列并生成相关设备</td>
</tr>
<tr>
<td><code>-a</code></td>
<td>自动生成必要的设备文件</td>
</tr>
<tr>
<td><code>-c</code></td>
<td>指定 Chunk 大小</td>
</tr>
<tr>
<td><code>-l</code>, <code>--level</code></td>
<td>指定 RAID 级别</td>
</tr>
<tr>
<td><code>-n</code>, <code>--raid-devices</code></td>
<td>指定 RAID 阵列中的设备数量</td>
</tr>
<tr>
<td><code>-x</code>, <code>--spare-devices</code></td>
<td>指定备用设备数量</td>
</tr>
<tr>
<td><code>--manage</code></td>
<td>管理 RAID 阵列</td>
</tr>
<tr>
<td><code>-a</code>, <code>--add</code></td>
<td>添加设备</td>
</tr>
<tr>
<td><code>-r</code>, <code>--remove</code></td>
<td>删除设备</td>
</tr>
<tr>
<td><code>-f</code>, <code>--fail</code></td>
<td>标记设备为失效</td>
</tr>
<tr>
<td><code>--query</code></td>
<td>查询 RAID 状态</td>
</tr>
<tr>
<td><code>--detail</code></td>
<td>查看 RAID 详细状态</td>
</tr>
<tr>
<td><code>--stop</code></td>
<td>停止指定的 RAID 阵列</td>
</tr>
<tr>
<td><code>--stop --scan</code></td>
<td>停止所有 RAID 阵列</td>
</tr>
</tbody></table>
<hr>
<h1 id="2-LVM-逻辑卷管理"><a href="#2-LVM-逻辑卷管理" class="headerlink" title="2. LVM (逻辑卷管理)"></a>2. LVM (逻辑卷管理)</h1><p>LVM 是 Linux 下的一种磁盘管理工具，可以灵活地管理硬盘、分区和逻辑卷。</p>
<h3 id="LVM-结构："><a href="#LVM-结构：" class="headerlink" title="LVM 结构："></a>LVM 结构：</h3><ol>
<li><strong>PV (Physical Volume)</strong>：一个硬盘或一个分区作为物理空间。</li>
<li><strong>PE (Physical Extent)</strong>：PV 组成 PE。</li>
<li><strong>VG (Volume Group)</strong>：PE 组成 VG。</li>
<li><strong>LV (Logical Volume)</strong>：VG 内的 PE 分配为 LV。</li>
</ol>
<h3 id="创建-LVM："><a href="#创建-LVM：" class="headerlink" title="创建 LVM："></a>创建 LVM：</h3><ol>
<li><p>准备 LVM 用的分区：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sda</span><br><span class="line">fdisk /dev/sdb</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化 PV：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvcreate /dev/sda1 /dev/sdb1</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 VG：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vgcreate testvg /dev/sda1 /dev/sdb1</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 LV：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lvcreate -L 1G -n lv01 testvg</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建文件系统并挂载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mke2fs -j /dev/testvg/lv01</span><br><span class="line">mount /dev/testvg/lv01 /mnt</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="管理-LVM："><a href="#管理-LVM：" class="headerlink" title="管理 LVM："></a>管理 LVM：</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>pvdisplay</code></td>
<td>显示物理 PV 信息</td>
</tr>
<tr>
<td><code>pvscan</code></td>
<td>显示 PV 状态</td>
</tr>
<tr>
<td><code>pvmove</code></td>
<td>移动 PV 中的 PE</td>
</tr>
<tr>
<td><code>pvremove</code></td>
<td>删除 PV</td>
</tr>
<tr>
<td><code>vgextend</code></td>
<td>扩展 VG</td>
</tr>
<tr>
<td><code>vgreduce</code></td>
<td>缩小 VG</td>
</tr>
<tr>
<td><code>vgdisplay</code></td>
<td>显示 VG 详情</td>
</tr>
<tr>
<td><code>lvdisplay</code></td>
<td>显示 LV 详情</td>
</tr>
<tr>
<td><code>lvextend</code></td>
<td>扩展 LV</td>
</tr>
<tr>
<td><code>lvreduce</code></td>
<td>缩小 LV</td>
</tr>
<tr>
<td><code>lvremove</code></td>
<td>删除 LV</td>
</tr>
<tr>
<td><code>lvcreate -s</code></td>
<td>创建快照</td>
</tr>
</tbody></table>
<hr>
<h1 id="3-访问记忆装置"><a href="#3-访问记忆装置" class="headerlink" title="3. 访问记忆装置"></a>3. 访问记忆装置</h1><h3 id="设备文件说明："><a href="#设备文件说明：" class="headerlink" title="设备文件说明："></a>设备文件说明：</h3><table>
<thead>
<tr>
<th>设备文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>/dev/hda</code></td>
<td>IDE 主硬盘</td>
</tr>
<tr>
<td><code>/dev/hdb</code></td>
<td>IDE 从硬盘</td>
</tr>
<tr>
<td><code>/dev/sda</code></td>
<td>第一个 SCSI&#x2F;STAT&#x2F;USB 硬盘</td>
</tr>
<tr>
<td><code>/dev/sdb</code></td>
<td>第二个 SCSI&#x2F;STAT&#x2F;USB 硬盘</td>
</tr>
<tr>
<td><code>/dev/sr0</code></td>
<td>第一个 SCSI&#x2F;STAT&#x2F;USB CD&#x2F;DVD</td>
</tr>
<tr>
<td><code>/dev/st0</code></td>
<td>第一个 SCSI 磁带设备</td>
</tr>
</tbody></table>
<h3 id="硬盘管理："><a href="#硬盘管理：" class="headerlink" title="硬盘管理："></a>硬盘管理：</h3><p>Linux 将 IDE 以外的硬盘识别为 SCSI 设备。硬盘的数据传送模式有 PIO（Programmed I&#x2F;O）和 DMA（Direct Memory Access）模式。通常使用 DMA 模式。</p>
<h3 id="检查-DMA-模式："><a href="#检查-DMA-模式：" class="headerlink" title="检查 DMA 模式："></a>检查 DMA 模式：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -i /dev/sda</span><br></pre></td></tr></table></figure>

<h3 id="硬盘控制："><a href="#硬盘控制：" class="headerlink" title="硬盘控制："></a>硬盘控制：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -d1 /dev/sda  <span class="comment"># 启用 DMA 模式</span></span><br></pre></td></tr></table></figure>

<h3 id="使用-SCSI-STAT-USB："><a href="#使用-SCSI-STAT-USB：" class="headerlink" title="使用 SCSI&#x2F;STAT&#x2F;USB："></a>使用 SCSI&#x2F;STAT&#x2F;USB：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdparm [option] [设备文件]</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="4-iSCSI-Internet-Small-Computer-System-Interface"><a href="#4-iSCSI-Internet-Small-Computer-System-Interface" class="headerlink" title="4. iSCSI (Internet Small Computer System Interface)"></a>4. iSCSI (Internet Small Computer System Interface)</h1><p>iSCSI 是基于 TCP&#x2F;IP 的 SCSI 协议，可以使远程存储设备像本地设备一样使用。</p>
<h2 id="iSCSI-配置步骤："><a href="#iSCSI-配置步骤：" class="headerlink" title="iSCSI 配置步骤："></a>iSCSI 配置步骤：</h2><ol>
<li><p>配置 <code>targets.conf</code> 文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">target</span> <span class="attr">iqn.2014.01.com.example.lpic:target0</span>&gt;</span></span><br><span class="line">   backing-store /dev/sdb2</span><br><span class="line">   initiator-address 192.168.11.2</span><br><span class="line">   initiator-address 192.168.11.4</span><br><span class="line">   incominguser centuser password</span><br><span class="line"><span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动 iSCSI target 服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service tgtd start</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>tgtadm</code> 命令查看 target 状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tgtadm --mode target --op show</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>iscsiadm</code> 从 initiator 查询 target：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m discovery -t sendtargets -p 192.168.11.3</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置认证方式：<br>修改 <code>/etc/iscsi/iscid.conf</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node.session.auth.authmethod = CHAP</span><br><span class="line">node.session.auth.username = centuser</span><br><span class="line">node.session.auth.password = password</span><br></pre></td></tr></table></figure>
</li>
<li><p>登录 iSCSI：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m node --login</span><br></pre></td></tr></table></figure>

<p>登录后，使用 <code>cat /proc/partitions</code> 查看 iSCSI 目标是否添加成功。</p>
</li>
</ol>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2020/11/15/linux/15-%E9%AB%98%E5%BA%A6%E7%9A%84%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2020/11/14/linux/14-%E8%AE%BE%E5%A4%87%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"
                            aria-label=": 14.设备和文件系统"
                        >
                            14.设备和文件系统
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-14T14:01:10+08:00">
	
		    2020 年 11 月 14 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-文件系统基础"><a href="#1-文件系统基础" class="headerlink" title="1. 文件系统基础"></a>1. 文件系统基础</h2><h3 id="etc-fstab-文件格式解析"><a href="#etc-fstab-文件格式解析" class="headerlink" title="&#x2F;etc&#x2F;fstab 文件格式解析"></a>&#x2F;etc&#x2F;fstab 文件格式解析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设备/标签/UUID  挂载点  文件系统类型  挂载选项  dump标志  fsck顺序</span><br></pre></td></tr></table></figure>

<p><strong>字段说明：</strong></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>设备标识</td>
<td>&#x2F;dev&#x2F;sda1, UUID&#x3D;xxxx, LABEL&#x3D;root</td>
</tr>
<tr>
<td>2</td>
<td>挂载路径</td>
<td>&#x2F;, &#x2F;home, &#x2F;boot</td>
</tr>
<tr>
<td>3</td>
<td>文件系统类型</td>
<td>ext4, xfs, nfs</td>
</tr>
<tr>
<td>4</td>
<td>挂载选项</td>
<td>defaults, noatime</td>
</tr>
<tr>
<td>5</td>
<td>dump备份标志</td>
<td>0(不备份), 1(备份)</td>
</tr>
<tr>
<td>6</td>
<td>fsck检查顺序</td>
<td>0(不检查), 1(优先), 2(次级)</td>
</tr>
</tbody></table>
<h3 id="文件系统类型对比"><a href="#文件系统类型对比" class="headerlink" title="文件系统类型对比"></a>文件系统类型对比</h3><table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>ext4</td>
<td>日志式, 最大16TB文件</td>
<td>通用Linux系统</td>
</tr>
<tr>
<td>XFS</td>
<td>高性能, 最大8EB文件</td>
<td>大文件处理</td>
</tr>
<tr>
<td>Btrfs</td>
<td>写时复制, 快照功能</td>
<td>高级存储需求</td>
</tr>
<tr>
<td>FAT32</td>
<td>兼容性好</td>
<td>U盘&#x2F;移动设备</td>
</tr>
<tr>
<td>NTFS</td>
<td>Windows兼容</td>
<td>双系统共享分区</td>
</tr>
</tbody></table>
<h3 id="常用挂载选项"><a href="#常用挂载选项" class="headerlink" title="常用挂载选项"></a>常用挂载选项</h3><table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
<th>性能影响</th>
</tr>
</thead>
<tbody><tr>
<td>async</td>
<td>异步写入</td>
<td>提升性能</td>
</tr>
<tr>
<td>noatime</td>
<td>不更新访问时间</td>
<td>显著提升</td>
</tr>
<tr>
<td>nodiratime</td>
<td>不更新目录访问时间</td>
<td>小幅提升</td>
</tr>
<tr>
<td>discard</td>
<td>TRIM支持(SSD)</td>
<td>延长SSD寿命</td>
</tr>
<tr>
<td>data&#x3D;writeback</td>
<td>ext4日志模式</td>
<td>性能最佳</td>
</tr>
</tbody></table>
<p><strong>查看支持的文件系统：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/filesystems</span><br></pre></td></tr></table></figure>

<p><strong>查看已挂载文件系统：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/mtab   <span class="comment"># 或</span></span><br><span class="line"><span class="built_in">cat</span> /proc/mounts</span><br></pre></td></tr></table></figure>

<h2 id="2-挂载管理命令"><a href="#2-挂载管理命令" class="headerlink" title="2. 挂载管理命令"></a>2. 挂载管理命令</h2><h3 id="mount-命令详解"><a href="#mount-命令详解" class="headerlink" title="mount 命令详解"></a>mount 命令详解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount [选项] [设备] [挂载点]</span><br></pre></td></tr></table></figure>

<p><strong>常用选项：</strong></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-t</td>
<td>指定文件系统类型</td>
</tr>
<tr>
<td>-o</td>
<td>指定挂载选项(多选项用逗号分隔)</td>
</tr>
<tr>
<td>-a</td>
<td>挂载&#x2F;etc&#x2F;fstab中所有文件系统</td>
</tr>
<tr>
<td>–bind</td>
<td>目录绑定挂载</td>
</tr>
<tr>
<td>-l</td>
<td>显示标签</td>
</tr>
</tbody></table>
<p><strong>示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t ext4 -o noatime /dev/sdb1 /mnt/data</span><br></pre></td></tr></table></figure>

<h3 id="umount-命令"><a href="#umount-命令" class="headerlink" title="umount 命令"></a>umount 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount [选项] [设备|挂载点]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>卸载所有文件系统</td>
</tr>
<tr>
<td>-t</td>
<td>按类型卸载</td>
</tr>
<tr>
<td>-l</td>
<td>延迟卸载(强制)</td>
</tr>
<tr>
<td>-f</td>
<td>强制卸载</td>
</tr>
</tbody></table>
<p><strong>强制卸载流程：</strong></p>
<ol>
<li><code>fuser -vm /mountpoint</code> 查看占用进程</li>
<li><code>kill -9 PID</code> 结束进程</li>
<li><code>umount -f /mountpoint</code></li>
</ol>
<h2 id="3-SWAP-管理"><a href="#3-SWAP-管理" class="headerlink" title="3. SWAP 管理"></a>3. SWAP 管理</h2><h3 id="创建SWAP文件"><a href="#创建SWAP文件" class="headerlink" title="创建SWAP文件"></a>创建SWAP文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建1GB交换文件</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1M count=1024</span><br><span class="line"><span class="built_in">chmod</span> 600 /swapfile</span><br><span class="line">mkswap /swapfile</span><br><span class="line">swapon /swapfile</span><br></pre></td></tr></table></figure>

<h3 id="SWAP管理命令"><a href="#SWAP管理命令" class="headerlink" title="SWAP管理命令"></a>SWAP管理命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td><code>swapon -a</code></td>
<td>启用所有swap</td>
</tr>
<tr>
<td><code>swapon -s</code></td>
<td>查看swap使用</td>
</tr>
<tr>
<td><code>swapoff -a</code></td>
<td>禁用所有swap</td>
</tr>
</tbody></table>
<p><strong>优化建议：</strong></p>
<ul>
<li>物理内存&lt;8GB时，SWAP&#x3D;1.5倍内存</li>
<li>物理内存≥8GB时，SWAP&#x3D;8GB</li>
</ul>
<h2 id="4-文件系统创建与维护"><a href="#4-文件系统创建与维护" class="headerlink" title="4. 文件系统创建与维护"></a>4. 文件系统创建与维护</h2><h3 id="创建工具对比"><a href="#创建工具对比" class="headerlink" title="创建工具对比"></a>创建工具对比</h3><table>
<thead>
<tr>
<th>命令</th>
<th>对应文件系统</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>mkfs.ext4</td>
<td>ext4</td>
<td>默认日志模式</td>
</tr>
<tr>
<td>mkfs.xfs</td>
<td>XFS</td>
<td>高性能大文件</td>
</tr>
<tr>
<td>mkfs.btrfs</td>
<td>Btrfs</td>
<td>高级功能支持</td>
</tr>
</tbody></table>
<p><strong>ext4创建示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 -b 4096 -m 1 -L DATA /dev/sdb1</span><br></pre></td></tr></table></figure>

<p><strong>XFS创建示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs -f -L BIGDATA /dev/sdc1</span><br></pre></td></tr></table></figure>

<h3 id="文件系统检查"><a href="#文件系统检查" class="headerlink" title="文件系统检查"></a>文件系统检查</h3><p><strong>ext系列检查：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fsck -y /dev/sda1   <span class="comment"># 自动修复</span></span><br><span class="line">e2fsck -f /dev/sda1 <span class="comment"># 强制检查</span></span><br></pre></td></tr></table></figure>

<p><strong>XFS检查：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_repair /dev/sdb1</span><br></pre></td></tr></table></figure>

<p><strong>检查时机：</strong></p>
<ul>
<li>异常关机后</li>
<li>定期维护时(建议每6个月)</li>
<li>出现I&#x2F;O错误时</li>
</ul>
<h2 id="5-高级文件系统特性"><a href="#5-高级文件系统特性" class="headerlink" title="5. 高级文件系统特性"></a>5. 高级文件系统特性</h2><h3 id="ext4-特性管理"><a href="#ext4-特性管理" class="headerlink" title="ext4 特性管理"></a>ext4 特性管理</h3><p><strong>转换ext3→ext4：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -O extent,uninit_bg,dir_index /dev/sda1</span><br><span class="line">fsck -pf /dev/sda1</span><br></pre></td></tr></table></figure>

<p><strong>调整参数：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -c 30 -i 7d /dev/sda1  <span class="comment"># 每30次挂载或7天检查</span></span><br><span class="line">tune2fs -m 5 /dev/sda1         <span class="comment"># 保留5%空间</span></span><br></pre></td></tr></table></figure>

<h3 id="XFS-高级功能"><a href="#XFS-高级功能" class="headerlink" title="XFS 高级功能"></a>XFS 高级功能</h3><p><strong>查看信息：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xfs_info /dev/sdb1</span><br><span class="line">xfs_admin -l /dev/sdb1</span><br></pre></td></tr></table></figure>

<p><strong>备份恢复：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xfsdump -l 0 -f /backup/root.xfsdump /dev/sda1</span><br><span class="line">xfsrestore -f /backup/root.xfsdump /mnt/restore</span><br></pre></td></tr></table></figure>

<h2 id="6-光盘与加密文件系统"><a href="#6-光盘与加密文件系统" class="headerlink" title="6. 光盘与加密文件系统"></a>6. 光盘与加密文件系统</h2><h3 id="光盘制作"><a href="#光盘制作" class="headerlink" title="光盘制作"></a>光盘制作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建ISO</span></span><br><span class="line">mkisofs -JR -V <span class="string">&quot;BACKUP_2023&quot;</span> -o backup.iso /backup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 刻录光盘</span></span><br><span class="line">cdrecord -v dev=1,0,0 speed=24 backup.iso</span><br></pre></td></tr></table></figure>

<h3 id="加密文件系统"><a href="#加密文件系统" class="headerlink" title="加密文件系统"></a>加密文件系统</h3><p><strong>LUKS加密：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cryptsetup luksFormat /dev/sdb1</span><br><span class="line">cryptsetup luksOpen /dev/sdb1 secret</span><br><span class="line">mkfs.ext4 /dev/mapper/secret</span><br><span class="line">mount /dev/mapper/secret /mnt/secure</span><br></pre></td></tr></table></figure>

<p><strong>关闭加密卷：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">umount /mnt/secure</span><br><span class="line">cryptsetup luksClose secret</span><br></pre></td></tr></table></figure>

<h2 id="7-磁盘健康监控"><a href="#7-磁盘健康监控" class="headerlink" title="7. 磁盘健康监控"></a>7. 磁盘健康监控</h2><h3 id="S-M-A-R-T-监控"><a href="#S-M-A-R-T-监控" class="headerlink" title="S.M.A.R.T. 监控"></a>S.M.A.R.T. 监控</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smartctl -a /dev/sda          <span class="comment"># 查看详细信息</span></span><br><span class="line">smartctl -H /dev/sda          <span class="comment"># 健康状态</span></span><br><span class="line">smartctl -t long /dev/sda     <span class="comment"># 启动长测试</span></span><br></pre></td></tr></table></figure>

<p><strong>关键监控指标：</strong></p>
<ul>
<li>Reallocated_Sector_Ct</li>
<li>Current_Pending_Sector</li>
<li>Temperature_Celsius</li>
</ul>
<h2 id="8-故障处理流程"><a href="#8-故障处理流程" class="headerlink" title="8. 故障处理流程"></a>8. 故障处理流程</h2><h3 id="文件系统修复步骤"><a href="#文件系统修复步骤" class="headerlink" title="文件系统修复步骤"></a>文件系统修复步骤</h3><ol>
<li><p><strong>卸载文件系统</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount /dev/sda1</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>进入单用户模式</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">init 1</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>执行检查修复</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsck -y /dev/sda1</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>严重损坏时</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">debugfs /dev/sda1</span><br><span class="line">&gt; lsdel      <span class="comment"># 查看已删除inode</span></span><br><span class="line">&gt; dump &lt;inode&gt; /tmp/recover_file</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="应急恢复方案"><a href="#应急恢复方案" class="headerlink" title="应急恢复方案"></a>应急恢复方案</h3><table>
<thead>
<tr>
<th>问题现象</th>
<th>解决方案</th>
</tr>
</thead>
<tbody><tr>
<td>无法挂载</td>
<td><code>fsck -y /dev/sdX</code></td>
</tr>
<tr>
<td>Superblock损坏</td>
<td><code>e2fsck -b 32768 /dev/sdX</code></td>
</tr>
<tr>
<td>只读文件系统</td>
<td><code>mount -o remount,rw /</code></td>
</tr>
</tbody></table>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2020/11/14/linux/14-%E8%AE%BE%E5%A4%87%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="page/2/"
                aria-label="下一頁"
            >
              <span>下一頁</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">第 1 頁 共 5 頁</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macao
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/linux%E5%9F%BA%E7%A1%80/"
                            aria-label=": linux基础"
                        >
                            <h3 class="media-heading">linux基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/iptables/"
                            aria-label=": iptables"
                        >
                            <h3 class="media-heading">iptables</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/08/12/git%E6%95%99%E7%A8%8B/"
                            aria-label=": git教程"
                        >
                            <h3 class="media-heading">git教程</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年8月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/01/18/Java%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B/"
                            aria-label=": Java变量类型"
                        >
                            <h3 class="media-heading">Java变量类型</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年1月18日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/12/%E6%95%B0%E5%AD%A6/markdown-latex%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BC%8F%E5%86%99%E6%B3%95/"
                            aria-label=": LaTeX的写法"
                        >
                            <h3 class="media-heading">LaTeX的写法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/13/%E6%95%B0%E5%AD%A6/0-%E4%B8%AD%E5%AD%A6%E6%95%B0%E5%AD%A6%E5%A4%8D%E4%B9%A0/"
                            aria-label=": 0.中学数学复习"
                        >
                            <h3 class="media-heading">0.中学数学复习</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月13日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/1-%E5%88%9D%E7%AD%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%BC%E6%95%B0%E6%8E%A8%E5%AF%BC/"
                            aria-label=": 1.初等函数的导数推导"
                        >
                            <h3 class="media-heading">1.初等函数的导数推导</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/2-%E5%87%BD%E6%95%B0%E7%9A%84%E6%B1%82%E5%AF%BC%E6%B3%95%E5%88%99/"
                            aria-label=": 2.函数的求导法则"
                        >
                            <h3 class="media-heading">2.函数的求导法则</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/3-%E8%8E%B1%E5%B8%83%E5%B0%BC%E5%85%B9%E5%85%AC%E5%BC%8F/"
                            aria-label=": 3.莱布尼兹公式"
                        >
                            <h3 class="media-heading">3.莱布尼兹公式</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/4-%E5%BE%AE%E5%88%86/"
                            aria-label=": 4.微分"
                        >
                            <h3 class="media-heading">4.微分</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 42 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
