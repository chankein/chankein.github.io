
<!DOCTYPE html>
<html lang="zh-tw">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
      var algoliaIndex = algoliaIndex || {};
      algoliaIndex = {
        appId: 'AWFC86Q51O',
        apiKey: '9c1ab8f9e66ebcc69cfba3a8f2cc9e4b',
        indexName: 'MyBlog',
        hits: {}
      };
    </script>
  

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>所有文章 - Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Kein&#39;s blog">
<meta property="og:url" content="https://chankein.github.io/archives/page/2/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Kein Chan">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../../../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../../../#about"
            >
        
        
            <img class="header-picture" src="../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../../../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/11/10/linux/13-%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/"
                            aria-label=": 13.系统启动"
                        >
                            13.系统启动
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-10T14:01:10+08:00">
	
		    2020 年 11 月 10 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-系统启动流程"><a href="#1-系统启动流程" class="headerlink" title="1. 系统启动流程"></a>1. 系统启动流程</h2><h3 id="1-1-启动阶段详解"><a href="#1-1-启动阶段详解" class="headerlink" title="1.1 启动阶段详解"></a>1.1 启动阶段详解</h3><table>
<thead>
<tr>
<th>阶段</th>
<th>组件</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>BIOS</td>
<td>- 硬件自检(POST)<br>- 读取CMOS设置<br>- 检测启动设备顺序<br>- 加载MBR中的BootLoader</td>
</tr>
<tr>
<td>2</td>
<td>MBR</td>
<td>- 512字节(启动代码+分区表)<br>- 包含第一阶段BootLoader<br>- 标识活动分区</td>
</tr>
<tr>
<td>3</td>
<td>BootLoader</td>
<td>- 阶段1: MBR中的初始代码<br>- 阶段1.5: 文件系统识别<br>- 阶段2: 加载内核(&#x2F;boot&#x2F;grub&#x2F;)</td>
</tr>
<tr>
<td>4</td>
<td>内核</td>
<td>- 硬件检测与初始化<br>- 加载驱动模块<br>- 挂载根文件系统<br>- 启动init进程(PID&#x3D;1)</td>
</tr>
<tr>
<td>5</td>
<td>init进程</td>
<td>- 根据&#x2F;etc&#x2F;inittab初始化系统<br>- 启动运行级别对应服务<br>- 生成所有后续进程</td>
</tr>
</tbody></table>
<h3 id="1-2-inittab-文件格式"><a href="#1-2-inittab-文件格式" class="headerlink" title="1.2 inittab 文件格式"></a>1.2 inittab 文件格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id:runlevels:action:process</span><br></pre></td></tr></table></figure>

<h4 id="主要action类型"><a href="#主要action类型" class="headerlink" title="主要action类型"></a>主要action类型</h4><table>
<thead>
<tr>
<th>action</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>boot</td>
<td>系统启动时执行，不等待完成</td>
</tr>
<tr>
<td>bootwait</td>
<td>系统启动时执行，等待完成</td>
</tr>
<tr>
<td>ctrlaltdel</td>
<td>捕获Ctrl+Alt+Del组合键</td>
</tr>
<tr>
<td>initdefault</td>
<td>设置默认运行级别</td>
</tr>
<tr>
<td>once</td>
<td>进入运行级别时执行一次</td>
</tr>
<tr>
<td>respawn</td>
<td>进程终止后自动重启</td>
</tr>
<tr>
<td>sysinit</td>
<td>系统初始化脚本</td>
</tr>
<tr>
<td>wait</td>
<td>进入运行级别时执行并等待</td>
</tr>
</tbody></table>
<h3 id="1-3-运行级别管理"><a href="#1-3-运行级别管理" class="headerlink" title="1.3 运行级别管理"></a>1.3 运行级别管理</h3><h4 id="标准运行级别"><a href="#标准运行级别" class="headerlink" title="标准运行级别"></a>标准运行级别</h4><table>
<thead>
<tr>
<th>级别</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>关机</td>
</tr>
<tr>
<td>1&#x2F;S</td>
<td>单用户模式</td>
</tr>
<tr>
<td>2</td>
<td>多用户无NFS</td>
</tr>
<tr>
<td>3</td>
<td>完整多用户模式</td>
</tr>
<tr>
<td>4</td>
<td>自定义</td>
</tr>
<tr>
<td>5</td>
<td>图形界面</td>
</tr>
<tr>
<td>6</td>
<td>重启</td>
</tr>
</tbody></table>
<h4 id="服务管理脚本"><a href="#服务管理脚本" class="headerlink" title="服务管理脚本"></a>服务管理脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/service [<span class="built_in">command</span>]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>启动服务</td>
</tr>
<tr>
<td>stop</td>
<td>停止服务</td>
</tr>
<tr>
<td>restart</td>
<td>重启服务</td>
</tr>
<tr>
<td>reload</td>
<td>重载配置</td>
</tr>
<tr>
<td>status</td>
<td>查看状态</td>
</tr>
</tbody></table>
<h4 id="服务自启动管理"><a href="#服务自启动管理" class="headerlink" title="服务自启动管理"></a>服务自启动管理</h4><p><strong>RedHat系(chkconfig):</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig [选项] 服务名 [on|off]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>–list</td>
<td>显示服务状态</td>
</tr>
<tr>
<td>–level</td>
<td>指定运行级别</td>
</tr>
<tr>
<td>–add</td>
<td>添加服务</td>
</tr>
<tr>
<td>–del</td>
<td>删除服务</td>
</tr>
</tbody></table>
<p><strong>Debian系(update-rc.d):</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d [选项] 服务名 [commands]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>模拟执行</td>
</tr>
<tr>
<td>-f</td>
<td>强制操作</td>
</tr>
<tr>
<td>remove</td>
<td>删除链接</td>
</tr>
</tbody></table>
<h3 id="1-4-Upstart-事件驱动"><a href="#1-4-Upstart-事件驱动" class="headerlink" title="1.4 Upstart 事件驱动"></a>1.4 Upstart 事件驱动</h3><p><strong>主要命令:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">initctl [<span class="built_in">command</span>] job</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>启动作业</td>
</tr>
<tr>
<td>stop</td>
<td>停止作业</td>
</tr>
<tr>
<td>restart</td>
<td>重启作业</td>
</tr>
<tr>
<td>status</td>
<td>查看状态</td>
</tr>
<tr>
<td>list</td>
<td>列出所有作业</td>
</tr>
</tbody></table>
<p><strong>配置文件位置:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init/*.conf</span><br></pre></td></tr></table></figure>

<h2 id="2-GRUB-引导加载器"><a href="#2-GRUB-引导加载器" class="headerlink" title="2. GRUB 引导加载器"></a>2. GRUB 引导加载器</h2><h3 id="2-1-GRUB-Legacy-vs-GRUB2"><a href="#2-1-GRUB-Legacy-vs-GRUB2" class="headerlink" title="2.1 GRUB Legacy vs GRUB2"></a>2.1 GRUB Legacy vs GRUB2</h3><table>
<thead>
<tr>
<th>特性</th>
<th>GRUB Legacy</th>
<th>GRUB2</th>
</tr>
</thead>
<tbody><tr>
<td>版本</td>
<td>0.9x</td>
<td>1.9x</td>
</tr>
<tr>
<td>配置文件</td>
<td>menu.lst</td>
<td>grub.cfg</td>
</tr>
<tr>
<td>生成方式</td>
<td>直接编辑</td>
<td>update-grub</td>
</tr>
<tr>
<td>分区表示</td>
<td>(hd0,0)</td>
<td>hd0,msdos1</td>
</tr>
</tbody></table>
<h3 id="2-2-GRUB-Legacy-配置"><a href="#2-2-GRUB-Legacy-配置" class="headerlink" title="2.2 GRUB Legacy 配置"></a>2.2 GRUB Legacy 配置</h3><p><strong>&#x2F;boot&#x2F;grub&#x2F;menu.lst 示例:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">timeout 5</span><br><span class="line">default 0</span><br><span class="line">title CentOS</span><br><span class="line">root (hd0,0)</span><br><span class="line">kernel /vmlinuz ro root=/dev/sda1</span><br><span class="line">initrd /initrd.img</span><br></pre></td></tr></table></figure>

<p><strong>常用命令:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grub&gt; root (hd0,0)     <span class="comment"># 设置根分区</span></span><br><span class="line">grub&gt; setup (hd0)      <span class="comment"># 安装到MBR</span></span><br><span class="line">grub&gt; <span class="built_in">cat</span> /grub/menu.lst <span class="comment"># 查看配置</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-GRUB2-配置"><a href="#2-3-GRUB2-配置" class="headerlink" title="2.3 GRUB2 配置"></a>2.3 GRUB2 配置</h3><p><strong>&#x2F;etc&#x2F;default&#x2F;grub 关键参数:</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>GRUB_DEFAULT</td>
<td>默认启动项</td>
</tr>
<tr>
<td>GRUB_TIMEOUT</td>
<td>菜单超时</td>
</tr>
<tr>
<td>GRUB_CMDLINE_LINUX</td>
<td>内核参数</td>
</tr>
</tbody></table>
<p><strong>生成配置:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-grub</span><br></pre></td></tr></table></figure>

<h3 id="2-4-内核启动参数"><a href="#2-4-内核启动参数" class="headerlink" title="2.4 内核启动参数"></a>2.4 内核启动参数</h3><table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>root&#x3D;&#x2F;dev&#x2F;sda1</td>
<td>指定根分区</td>
</tr>
<tr>
<td>ro&#x2F;rw</td>
<td>只读&#x2F;读写挂载</td>
</tr>
<tr>
<td>init&#x3D;&#x2F;bin&#x2F;bash</td>
<td>指定初始化程序</td>
</tr>
<tr>
<td>single</td>
<td>单用户模式</td>
</tr>
<tr>
<td>mem&#x3D;1024M</td>
<td>限制内存大小</td>
</tr>
</tbody></table>
<p><strong>查看当前参数:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/cmdline</span><br></pre></td></tr></table></figure>

<h2 id="3-其他引导加载器"><a href="#3-其他引导加载器" class="headerlink" title="3. 其他引导加载器"></a>3. 其他引导加载器</h2><h3 id="3-1-LILO-配置"><a href="#3-1-LILO-配置" class="headerlink" title="3.1 LILO 配置"></a>3.1 LILO 配置</h3><p><strong>&#x2F;etc&#x2F;lilo.conf 示例:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">boot=/dev/sda</span><br><span class="line">map=/boot/map</span><br><span class="line">default=linux</span><br><span class="line">image=/boot/vmlinuz</span><br><span class="line">label=linux</span><br><span class="line">root=/dev/sda1</span><br></pre></td></tr></table></figure>

<p><strong>应用配置:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lilo -v</span><br></pre></td></tr></table></figure>

<h3 id="3-2-SYSLINUX-系列"><a href="#3-2-SYSLINUX-系列" class="headerlink" title="3.2 SYSLINUX 系列"></a>3.2 SYSLINUX 系列</h3><table>
<thead>
<tr>
<th>类型</th>
<th>文件系统</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>SYSLINUX</td>
<td>FAT</td>
<td>USB启动</td>
</tr>
<tr>
<td>ISOLINUX</td>
<td>ISO9660</td>
<td>光盘启动</td>
</tr>
<tr>
<td>EXTLINUX</td>
<td>ext2&#x2F;3&#x2F;4</td>
<td>硬盘启动</td>
</tr>
<tr>
<td>PXELINUX</td>
<td>网络</td>
<td>网络启动</td>
</tr>
</tbody></table>
<p><strong>PXE启动环境搭建:</strong></p>
<ol>
<li>安装必要服务:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install dhcp tftp-server syslinux</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>配置DHCP:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename &quot;pxelinux.0&quot;;</span><br><span class="line">next-server 192.168.1.100;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>准备TFTP目录:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/</span><br><span class="line"><span class="built_in">mkdir</span> /var/lib/tftpboot/pxelinux.cfg</span><br></pre></td></tr></table></figure>

<h2 id="4-系统恢复方法"><a href="#4-系统恢复方法" class="headerlink" title="4. 系统恢复方法"></a>4. 系统恢复方法</h2><h3 id="4-1-救援模式操作"><a href="#4-1-救援模式操作" class="headerlink" title="4.1 救援模式操作"></a>4.1 救援模式操作</h3><ol>
<li>使用安装介质启动</li>
<li>进入救援模式</li>
<li>挂载原系统:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chroot</span> /mnt/sysimage</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>修复引导:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grub-install /dev/sda</span><br></pre></td></tr></table></figure>

<h3 id="4-2-常见修复场景"><a href="#4-2-常见修复场景" class="headerlink" title="4.2 常见修复场景"></a>4.2 常见修复场景</h3><table>
<thead>
<tr>
<th>问题</th>
<th>解决方案</th>
</tr>
</thead>
<tbody><tr>
<td>MBR损坏</td>
<td><code>dd if=/usr/share/syslinux/mbr.bin of=/dev/sda</code></td>
</tr>
<tr>
<td>GRUB损坏</td>
<td><code>grub-install /dev/sda</code></td>
</tr>
<tr>
<td>文件系统错误</td>
<td><code>fsck -y /dev/sda1</code></td>
</tr>
<tr>
<td>密码重置</td>
<td><code>init=/bin/bash</code> 启动后修改密码</td>
</tr>
</tbody></table>
<h2 id="5-启动优化技巧"><a href="#5-启动优化技巧" class="headerlink" title="5. 启动优化技巧"></a>5. 启动优化技巧</h2><ol>
<li><strong>并行启动</strong>:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/init/rc-sysinit.conf</span><br><span class="line"><span class="comment"># 修改为:</span></span><br><span class="line"><span class="built_in">env</span> DEFAULT_RUNLEVEL=2</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>禁用不需要的服务</strong>:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list | grep 3:on</span><br><span class="line">chkconfig servicename off</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>使用readahead</strong>:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service readahead-early restart</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><strong>SSD优化</strong>:<br>在&#x2F;etc&#x2F;fstab添加:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">noatime,discard</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/11/10/linux/13-%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/11/08/linux/12-%E5%86%85%E6%A0%B8/"
                            aria-label=": 12.内核"
                        >
                            12.内核
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-08T21:06:24+08:00">
	
		    2020 年 11 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-内核版本管理"><a href="#1-内核版本管理" class="headerlink" title="1. 内核版本管理"></a>1. 内核版本管理</h2><h3 id="版本号说明"><a href="#版本号说明" class="headerlink" title="版本号说明"></a>版本号说明</h3><ul>
<li><p><strong>2.X.Y 旧版本格式</strong>：</p>
<ul>
<li>X：偶数表示稳定版，奇数表示开发版</li>
<li>Y：修订版本号</li>
<li>后缀说明：<ul>
<li><code>-rcN</code>：Release Candidate（候选版本）</li>
<li><code>-gitN</code>：开发中的Git版本</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>3.0+ 新版本分类</strong>：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Prepatch</td>
<td>稳定版前的测试版本</td>
</tr>
<tr>
<td>Mainline</td>
<td>包含新特性的主线开发版本</td>
</tr>
<tr>
<td>Stable</td>
<td>稳定版本</td>
</tr>
<tr>
<td>Longterm</td>
<td>长期支持版本(LTS)</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="版本查询命令"><a href="#版本查询命令" class="headerlink" title="版本查询命令"></a>版本查询命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> [选项]</span><br></pre></td></tr></table></figure>

<h4 id="常用选项"><a href="#常用选项" class="headerlink" title="常用选项"></a>常用选项</h4><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示全部系统信息</td>
</tr>
<tr>
<td>-r</td>
<td>显示内核版本</td>
</tr>
<tr>
<td>-m</td>
<td>显示硬件架构</td>
</tr>
</tbody></table>
<h4 id="其他查询方式"><a href="#其他查询方式" class="headerlink" title="其他查询方式"></a>其他查询方式</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看/proc版本信息</span></span><br><span class="line"><span class="built_in">cat</span> /proc/version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Makefile查看</span></span><br><span class="line"><span class="built_in">head</span> -4 /usr/src/linux/Makefile</span><br></pre></td></tr></table></figure>

<h2 id="2-内核模块管理"><a href="#2-内核模块管理" class="headerlink" title="2. 内核模块管理"></a>2. 内核模块管理</h2><h3 id="核心命令对比"><a href="#核心命令对比" class="headerlink" title="核心命令对比"></a>核心命令对比</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>lsmod</td>
<td>显示已加载模块</td>
<td>读取&#x2F;proc&#x2F;modules</td>
</tr>
<tr>
<td>insmod</td>
<td>加载单个模块</td>
<td>不处理依赖关系</td>
</tr>
<tr>
<td>rmmod</td>
<td>卸载模块</td>
<td>需确保无依赖</td>
</tr>
<tr>
<td>modprobe</td>
<td>智能加载&#x2F;卸载模块</td>
<td>自动处理依赖关系</td>
</tr>
<tr>
<td>depmod</td>
<td>生成模块依赖关系文件</td>
<td>创建modules.dep</td>
</tr>
</tbody></table>
<h3 id="命令详解"><a href="#命令详解" class="headerlink" title="命令详解"></a>命令详解</h3><h4 id="lsmod-输出说明"><a href="#lsmod-输出说明" class="headerlink" title="lsmod 输出说明"></a>lsmod 输出说明</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Module                  Size  Used by    Dependent modules</span><br></pre></td></tr></table></figure>
<ul>
<li>显示模块名、大小、引用计数和被哪些模块使用</li>
</ul>
<h4 id="modinfo-模块信息"><a href="#modinfo-模块信息" class="headerlink" title="modinfo 模块信息"></a>modinfo 模块信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modinfo [选项] 模块名</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示作者信息</td>
</tr>
<tr>
<td>-d</td>
<td>显示描述信息</td>
</tr>
<tr>
<td>-l</td>
<td>显示许可证信息</td>
</tr>
<tr>
<td>-n</td>
<td>显示模块文件路径</td>
</tr>
</tbody></table>
<h4 id="modprobe-高级用法"><a href="#modprobe-高级用法" class="headerlink" title="modprobe 高级用法"></a>modprobe 高级用法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modprobe [选项] 模块名</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>加载所有匹配模块</td>
</tr>
<tr>
<td>-c</td>
<td>显示当前配置</td>
</tr>
<tr>
<td>-l</td>
<td>列出所有可用模块</td>
</tr>
<tr>
<td>-r</td>
<td>递归卸载模块及依赖</td>
</tr>
<tr>
<td>-t 类型</td>
<td>仅操作指定类型模块</td>
</tr>
<tr>
<td>–show-depends</td>
<td>显示模块依赖关系</td>
</tr>
</tbody></table>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><ul>
<li><code>/etc/modprobe.conf</code>：模块别名和参数配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias eth0 e1000</span><br><span class="line">options e1000 speed=1000 duplex=full</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-内核编译流程"><a href="#3-内核编译流程" class="headerlink" title="3. 内核编译流程"></a>3. 内核编译流程</h2><h3 id="编译步骤"><a href="#编译步骤" class="headerlink" title="编译步骤"></a>编译步骤</h3><ol>
<li><strong>准备源代码</strong></li>
<li><strong>配置内核</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">make oldconfig    <span class="comment"># 基于旧配置更新</span></span><br><span class="line">make menuconfig  <span class="comment"># 文本界面配置</span></span><br><span class="line">make xconfig     <span class="comment"># Qt图形界面配置</span></span><br><span class="line">make gconfig     <span class="comment"># GTK图形界面配置</span></span><br></pre></td></tr></table></figure></li>
<li><strong>编译内核</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make           <span class="comment"># 编译内核和模块</span></span><br><span class="line">make bzImage   <span class="comment"># 仅编译内核</span></span><br><span class="line">make modules   <span class="comment"># 仅编译模块</span></span><br></pre></td></tr></table></figure></li>
<li><strong>安装组件</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make modules_install  <span class="comment"># 安装模块到/lib/modules/</span></span><br><span class="line">make install          <span class="comment"># 自动安装内核</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="手动安装示例"><a href="#手动安装示例" class="headerlink" title="手动安装示例"></a>手动安装示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制内核文件</span></span><br><span class="line"><span class="built_in">cp</span> <span class="built_in">arch</span>/x86/boot/bzImage /boot/vmlinuz-2.6.32</span><br><span class="line"><span class="built_in">cp</span> System.map /boot/System.map-2.6.32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建链接</span></span><br><span class="line"><span class="built_in">ln</span> -s /boot/vmlinuz-2.6.32 /boot/vmlinuz</span><br><span class="line"><span class="built_in">ln</span> -s /boot/System.map-2.6.32 /boot/System.map</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成initramfs</span></span><br><span class="line">mkinitramfs -o /boot/initrd-2.6.32.img 2.6.32</span><br></pre></td></tr></table></figure>

<h3 id="其他make目标"><a href="#其他make目标" class="headerlink" title="其他make目标"></a>其他make目标</h3><table>
<thead>
<tr>
<th>目标</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>clean</td>
<td>清除编译文件</td>
</tr>
<tr>
<td>mrproper</td>
<td>彻底清除(含配置)</td>
</tr>
<tr>
<td>rpm-pkg</td>
<td>生成RPM包</td>
</tr>
<tr>
<td>deb-pkg</td>
<td>生成Debian包</td>
</tr>
</tbody></table>
<h2 id="4-内核参数调优"><a href="#4-内核参数调优" class="headerlink" title="4. 内核参数调优"></a>4. 内核参数调优</h2><h3 id="proc-sys-关键参数"><a href="#proc-sys-关键参数" class="headerlink" title="&#x2F;proc&#x2F;sys 关键参数"></a>&#x2F;proc&#x2F;sys 关键参数</h3><table>
<thead>
<tr>
<th>路径</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>kernel&#x2F;ctrl-alt-del</td>
<td>Ctrl+Alt+Del行为</td>
</tr>
<tr>
<td>kernel&#x2F;shmall</td>
<td>共享内存页数上限</td>
</tr>
<tr>
<td>kernel&#x2F;shmmax</td>
<td>共享内存段最大大小</td>
</tr>
<tr>
<td>net&#x2F;ipv4&#x2F;ip_forward</td>
<td>IP转发开关(1&#x2F;0)</td>
</tr>
<tr>
<td>fs&#x2F;file-max</td>
<td>系统最大文件句柄数</td>
</tr>
</tbody></table>
<h3 id="sysctl-工具"><a href="#sysctl-工具" class="headerlink" title="sysctl 工具"></a>sysctl 工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl [选项] [参数=值]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示所有可用参数</td>
</tr>
<tr>
<td>-p</td>
<td>从&#x2F;etc&#x2F;sysctl.conf加载配置</td>
</tr>
<tr>
<td>-w</td>
<td>临时修改参数</td>
</tr>
</tbody></table>
<h3 id="initramfs-管理"><a href="#initramfs-管理" class="headerlink" title="initramfs 管理"></a>initramfs 管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建initramfs</span></span><br><span class="line">mkinitramfs -o initrd.img 3.16.0-4-amd64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压分析</span></span><br><span class="line"><span class="built_in">mkdir</span> initrd &amp;&amp; <span class="built_in">cd</span> initrd</span><br><span class="line">zcat ../initrd.img | cpio -<span class="built_in">id</span></span><br></pre></td></tr></table></figure>

<h2 id="5-内核调试与设备管理"><a href="#5-内核调试与设备管理" class="headerlink" title="5. 内核调试与设备管理"></a>5. 内核调试与设备管理</h2><h3 id="proc-关键文件"><a href="#proc-关键文件" class="headerlink" title="&#x2F;proc 关键文件"></a>&#x2F;proc 关键文件</h3><table>
<thead>
<tr>
<th>文件</th>
<th>内容说明</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;proc&#x2F;cpuinfo</td>
<td>CPU详细信息</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;meminfo</td>
<td>内存使用情况</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;modules</td>
<td>已加载模块列表</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;partitions</td>
<td>分区信息</td>
</tr>
</tbody></table>
<h3 id="硬件信息工具"><a href="#硬件信息工具" class="headerlink" title="硬件信息工具"></a>硬件信息工具</h3><h4 id="lspci"><a href="#lspci" class="headerlink" title="lspci"></a>lspci</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci [选项]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-vv</td>
<td>超详细输出</td>
</tr>
<tr>
<td>-t</td>
<td>树状显示设备层级</td>
</tr>
</tbody></table>
<h4 id="lsusb"><a href="#lsusb" class="headerlink" title="lsusb"></a>lsusb</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsusb [选项]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-v</td>
<td>详细输出设备描述符</td>
</tr>
<tr>
<td>-t</td>
<td>树状显示USB设备拓扑</td>
</tr>
</tbody></table>
<h3 id="udev-设备管理"><a href="#udev-设备管理" class="headerlink" title="udev 设备管理"></a>udev 设备管理</h3><h4 id="规则文件示例"><a href="#规则文件示例" class="headerlink" title="规则文件示例"></a>规则文件示例</h4><p><code>/etc/udev/rules.d/70-persistent-net.rules</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, </span><br><span class="line">ATTR&#123;address&#125;==&quot;08:00:27:aa:11:3c&quot;, NAME=&quot;eth0&quot;</span><br></pre></td></tr></table></figure>

<h4 id="udevadm-工具"><a href="#udevadm-工具" class="headerlink" title="udevadm 工具"></a>udevadm 工具</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udevadm info [选项]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示父设备属性</td>
</tr>
<tr>
<td>-n</td>
<td>指定设备节点路径</td>
</tr>
</tbody></table>
<h4 id="实时监控"><a href="#实时监控" class="headerlink" title="实时监控"></a>实时监控</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udevadm monitor</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/11/08/linux/12-%E5%86%85%E6%A0%B8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/11/07/linux/11-%E6%80%A7%E8%83%BD%E6%B5%8B%E5%AE%9A/"
                            aria-label=": 11.性能测定"
                        >
                            11.性能测定
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-07T21:06:24+08:00">
	
		    2020 年 11 月 7 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-top-命令-实时进程监控"><a href="#1-top-命令-实时进程监控" class="headerlink" title="1. top 命令 - 实时进程监控"></a>1. top 命令 - 实时进程监控</h2><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top [选项]</span><br></pre></td></tr></table></figure>

<h3 id="常用选项"><a href="#常用选项" class="headerlink" title="常用选项"></a>常用选项</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-b</td>
<td>批处理模式（非交互式）</td>
</tr>
<tr>
<td>-d 秒</td>
<td>设置刷新间隔时间</td>
</tr>
<tr>
<td>-n 次数</td>
<td>指定刷新次数后退出</td>
</tr>
<tr>
<td>-u 用户</td>
<td>只显示指定用户的进程</td>
</tr>
<tr>
<td>-p PID</td>
<td>只监控指定PID的进程</td>
</tr>
</tbody></table>
<h3 id="显示字段说明"><a href="#显示字段说明" class="headerlink" title="显示字段说明"></a>显示字段说明</h3><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>PID</td>
<td>进程ID</td>
</tr>
<tr>
<td>PPID</td>
<td>父进程ID</td>
</tr>
<tr>
<td>USER</td>
<td>进程所有者</td>
</tr>
<tr>
<td>RUSER</td>
<td>实际用户名</td>
</tr>
<tr>
<td>UID</td>
<td>用户ID</td>
</tr>
<tr>
<td>GROUP</td>
<td>所属组</td>
</tr>
<tr>
<td>PR</td>
<td>优先级</td>
</tr>
<tr>
<td>NI</td>
<td>nice值</td>
</tr>
<tr>
<td>VIRT</td>
<td>虚拟内存使用量(KB)</td>
</tr>
<tr>
<td>RES</td>
<td>物理内存使用量(KB)</td>
</tr>
<tr>
<td>SHR</td>
<td>共享内存大小(KB)</td>
</tr>
<tr>
<td>S</td>
<td>进程状态</td>
</tr>
<tr>
<td>TTY</td>
<td>关联终端</td>
</tr>
<tr>
<td>%CPU</td>
<td>CPU使用率</td>
</tr>
<tr>
<td>%MEM</td>
<td>内存使用率</td>
</tr>
<tr>
<td>TIME+</td>
<td>CPU占用时间累计</td>
</tr>
<tr>
<td>COMMAND</td>
<td>执行的命令</td>
</tr>
</tbody></table>
<h3 id="交互式操作"><a href="#交互式操作" class="headerlink" title="交互式操作"></a>交互式操作</h3><table>
<thead>
<tr>
<th>按键</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>空格&#x2F;Enter</td>
<td>立即刷新</td>
</tr>
<tr>
<td>f</td>
<td>选择显示字段</td>
</tr>
<tr>
<td>o</td>
<td>修改排序字段</td>
</tr>
<tr>
<td>l</td>
<td>切换负载显示</td>
</tr>
<tr>
<td>m</td>
<td>切换内存显示</td>
</tr>
<tr>
<td>u</td>
<td>筛选用户进程</td>
</tr>
<tr>
<td>t</td>
<td>切换CPU状态显示</td>
</tr>
<tr>
<td>P</td>
<td>按CPU%排序</td>
</tr>
<tr>
<td>M</td>
<td>按内存%排序</td>
</tr>
<tr>
<td>N</td>
<td>按PID排序</td>
</tr>
<tr>
<td>T</td>
<td>按运行时间排序</td>
</tr>
<tr>
<td>W</td>
<td>保存当前配置</td>
</tr>
<tr>
<td>k</td>
<td>结束进程</td>
</tr>
<tr>
<td>h&#x2F;?</td>
<td>帮助信息</td>
</tr>
<tr>
<td>q</td>
<td>退出程序</td>
</tr>
<tr>
<td>A</td>
<td>切换显示模式</td>
</tr>
<tr>
<td>d&#x2F;s</td>
<td>修改刷新间隔</td>
</tr>
<tr>
<td>&lt;&#x2F;&gt;</td>
<td>切换排序顺序</td>
</tr>
</tbody></table>
<h2 id="2-vmstat-系统资源监控"><a href="#2-vmstat-系统资源监控" class="headerlink" title="2. vmstat - 系统资源监控"></a>2. vmstat - 系统资源监控</h2><h3 id="基本用法-1"><a href="#基本用法-1" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat [刷新间隔(秒)] [刷新次数]</span><br></pre></td></tr></table></figure>

<h3 id="输出字段说明"><a href="#输出字段说明" class="headerlink" title="输出字段说明"></a>输出字段说明</h3><table>
<thead>
<tr>
<th>类别</th>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>procs</td>
<td>r</td>
<td>运行队列中的进程数（若持续超过CPU核心数表示CPU瓶颈）</td>
</tr>
<tr>
<td></td>
<td>b</td>
<td>等待I&#x2F;O的进程数</td>
</tr>
<tr>
<td>memory</td>
<td>swpd</td>
<td>使用的swap空间大小</td>
</tr>
<tr>
<td></td>
<td>free</td>
<td>空闲内存</td>
</tr>
<tr>
<td></td>
<td>buff</td>
<td>用作buffer的内存</td>
</tr>
<tr>
<td></td>
<td>cache</td>
<td>用作cache的内存</td>
</tr>
<tr>
<td>swap</td>
<td>si</td>
<td>每秒从swap读入内存量</td>
</tr>
<tr>
<td></td>
<td>so</td>
<td>每秒从内存写入swap量</td>
</tr>
<tr>
<td>io</td>
<td>bi</td>
<td>块设备每秒接收的块数</td>
</tr>
<tr>
<td></td>
<td>bo</td>
<td>块设备每秒发送的块数</td>
</tr>
<tr>
<td>system</td>
<td>in</td>
<td>每秒中断数</td>
</tr>
<tr>
<td></td>
<td>cs</td>
<td>每秒上下文切换数</td>
</tr>
<tr>
<td>cpu</td>
<td>us</td>
<td>用户空间CPU时间占比</td>
</tr>
<tr>
<td></td>
<td>sy</td>
<td>内核空间CPU时间占比</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>CPU空闲时间占比</td>
</tr>
<tr>
<td></td>
<td>wa</td>
<td>I&#x2F;O等待时间占比</td>
</tr>
<tr>
<td></td>
<td>st</td>
<td>虚拟机偷取时间占比</td>
</tr>
</tbody></table>
<h2 id="3-iostat-I-O监控"><a href="#3-iostat-I-O监控" class="headerlink" title="3. iostat - I&#x2F;O监控"></a>3. iostat - I&#x2F;O监控</h2><h3 id="基本用法-2"><a href="#基本用法-2" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat [选项] [间隔秒数] [次数]</span><br></pre></td></tr></table></figure>

<h3 id="常用选项-1"><a href="#常用选项-1" class="headerlink" title="常用选项"></a>常用选项</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>只显示CPU统计</td>
</tr>
<tr>
<td>-d</td>
<td>只显示磁盘统计</td>
</tr>
<tr>
<td>-k</td>
<td>以KB为单位显示</td>
</tr>
<tr>
<td>-t</td>
<td>显示时间戳</td>
</tr>
</tbody></table>
<h3 id="CPU统计字段"><a href="#CPU统计字段" class="headerlink" title="CPU统计字段"></a>CPU统计字段</h3><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>%user</td>
<td>用户进程CPU占比</td>
</tr>
<tr>
<td>%nice</td>
<td>调整优先级进程的CPU占比</td>
</tr>
<tr>
<td>%system</td>
<td>内核CPU占比</td>
</tr>
<tr>
<td>%iowait</td>
<td>I&#x2F;O等待占比</td>
</tr>
<tr>
<td>%steal</td>
<td>虚拟机占用占比</td>
</tr>
<tr>
<td>%idle</td>
<td>空闲占比</td>
</tr>
</tbody></table>
<h3 id="磁盘统计字段"><a href="#磁盘统计字段" class="headerlink" title="磁盘统计字段"></a>磁盘统计字段</h3><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>tps</td>
<td>每秒I&#x2F;O请求数</td>
</tr>
<tr>
<td>Blk_read&#x2F;s</td>
<td>每秒读取块数</td>
</tr>
<tr>
<td>Blk_wrtn&#x2F;s</td>
<td>每秒写入块数</td>
</tr>
<tr>
<td>Blk_read</td>
<td>总读取块数</td>
</tr>
<tr>
<td>Blk_wrtn</td>
<td>总写入块数</td>
</tr>
</tbody></table>
<h2 id="4-sar-系统活动报告"><a href="#4-sar-系统活动报告" class="headerlink" title="4. sar - 系统活动报告"></a>4. sar - 系统活动报告</h2><h3 id="基本用法-3"><a href="#基本用法-3" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar [选项] [-s 开始时间] [-e 结束时间] [-f 日志文件] [间隔] [次数]</span><br></pre></td></tr></table></figure>

<h3 id="常用选项-2"><a href="#常用选项-2" class="headerlink" title="常用选项"></a>常用选项</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-A</td>
<td>显示所有报告</td>
</tr>
<tr>
<td>-b</td>
<td>I&#x2F;O和传输速率统计</td>
</tr>
<tr>
<td>-c</td>
<td>进程创建统计</td>
</tr>
<tr>
<td>-f 文件</td>
<td>指定日志文件</td>
</tr>
<tr>
<td>-n DEV</td>
<td>网络设备统计</td>
</tr>
<tr>
<td>-n EDEV</td>
<td>网络错误统计</td>
</tr>
<tr>
<td>-r</td>
<td>内存和swap统计</td>
</tr>
<tr>
<td>-u</td>
<td>CPU利用率</td>
</tr>
<tr>
<td>-P ALL</td>
<td>每个CPU核心统计</td>
</tr>
<tr>
<td>-R</td>
<td>内存统计</td>
</tr>
<tr>
<td>-W</td>
<td>swap统计</td>
</tr>
</tbody></table>
<h3 id="详细字段说明"><a href="#详细字段说明" class="headerlink" title="详细字段说明"></a>详细字段说明</h3><h4 id="sar-b-I-O统计"><a href="#sar-b-I-O统计" class="headerlink" title="sar -b (I&#x2F;O统计)"></a>sar -b (I&#x2F;O统计)</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>tps</td>
<td>每秒I&#x2F;O请求数</td>
</tr>
<tr>
<td>rtps</td>
<td>每秒读请求数</td>
</tr>
<tr>
<td>wtps</td>
<td>每秒写请求数</td>
</tr>
<tr>
<td>bread&#x2F;s</td>
<td>每秒读取块数</td>
</tr>
<tr>
<td>bwrtn&#x2F;s</td>
<td>每秒写入块数</td>
</tr>
</tbody></table>
<h4 id="sar-n-DEV-网络统计"><a href="#sar-n-DEV-网络统计" class="headerlink" title="sar -n DEV (网络统计)"></a>sar -n DEV (网络统计)</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>IFACE</td>
<td>网络接口名</td>
</tr>
<tr>
<td>rxpck&#x2F;s</td>
<td>每秒接收包数</td>
</tr>
<tr>
<td>txpck&#x2F;s</td>
<td>每秒发送包数</td>
</tr>
<tr>
<td>rxkB&#x2F;s</td>
<td>每秒接收KB数</td>
</tr>
<tr>
<td>txkB&#x2F;s</td>
<td>每秒发送KB数</td>
</tr>
</tbody></table>
<h4 id="sar-r-内存统计"><a href="#sar-r-内存统计" class="headerlink" title="sar -r (内存统计)"></a>sar -r (内存统计)</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>kbmemfree</td>
<td>空闲内存(KB)</td>
</tr>
<tr>
<td>kbmemused</td>
<td>已用内存(KB)</td>
</tr>
<tr>
<td>%memused</td>
<td>内存使用率</td>
</tr>
<tr>
<td>kbbuffers</td>
<td>buffer使用量(KB)</td>
</tr>
<tr>
<td>kbcached</td>
<td>cache使用量(KB)</td>
</tr>
</tbody></table>
<h2 id="5-系统负载命令"><a href="#5-系统负载命令" class="headerlink" title="5. 系统负载命令"></a>5. 系统负载命令</h2><h3 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h3><p>显示：</p>
<ol>
<li>系统运行时间</li>
<li>登录用户数</li>
<li>1&#x2F;5&#x2F;15分钟平均负载</li>
</ol>
<h3 id="w-命令"><a href="#w-命令" class="headerlink" title="w 命令"></a>w 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w [选项] [用户名]</span><br></pre></td></tr></table></figure>

<h4 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h4><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-h</td>
<td>不显示标题</td>
</tr>
<tr>
<td>-s</td>
<td>精简格式(不显示登录时间&#x2F;JCPU&#x2F;PCPU)</td>
</tr>
</tbody></table>
<h4 id="输出字段"><a href="#输出字段" class="headerlink" title="输出字段"></a>输出字段</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>USER</td>
<td>用户名</td>
</tr>
<tr>
<td>TTY</td>
<td>终端名</td>
</tr>
<tr>
<td>FROM</td>
<td>远程主机</td>
</tr>
<tr>
<td>LOGIN@</td>
<td>登录时间</td>
</tr>
<tr>
<td>IDLE</td>
<td>空闲时间</td>
</tr>
<tr>
<td>JCPU</td>
<td>该终端所有进程CPU时间</td>
</tr>
<tr>
<td>PCPU</td>
<td>当前进程CPU时间</td>
</tr>
<tr>
<td>WHAT</td>
<td>正在执行的命令</td>
</tr>
</tbody></table>
<h2 id="6-进程监控"><a href="#6-进程监控" class="headerlink" title="6. 进程监控"></a>6. 进程监控</h2><h3 id="ps-命令"><a href="#ps-命令" class="headerlink" title="ps 命令"></a>ps 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps [选项]</span><br></pre></td></tr></table></figure>

<h4 id="常用选项-3"><a href="#常用选项-3" class="headerlink" title="常用选项"></a>常用选项</h4><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>e</td>
<td>显示环境变量</td>
</tr>
<tr>
<td>x</td>
<td>包括无终端进程</td>
</tr>
<tr>
<td>u</td>
<td>显示用户信息</td>
</tr>
<tr>
<td>r</td>
<td>只显示运行中进程</td>
</tr>
<tr>
<td>l</td>
<td>长格式显示</td>
</tr>
<tr>
<td>U 用户</td>
<td>筛选指定用户</td>
</tr>
<tr>
<td>-C 命令</td>
<td>筛选指定命令</td>
</tr>
<tr>
<td>-e</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>-f</td>
<td>完整格式显示</td>
</tr>
<tr>
<td>-l</td>
<td>长格式显示</td>
</tr>
<tr>
<td>-p PID</td>
<td>筛选指定PID</td>
</tr>
<tr>
<td>-t tty</td>
<td>筛选指定终端</td>
</tr>
</tbody></table>
<h4 id="显示字段"><a href="#显示字段" class="headerlink" title="显示字段"></a>显示字段</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>USER</td>
<td>用户名</td>
</tr>
<tr>
<td>PID</td>
<td>进程ID</td>
</tr>
<tr>
<td>PPID</td>
<td>父进程ID</td>
</tr>
<tr>
<td>%CPU</td>
<td>CPU使用率</td>
</tr>
<tr>
<td>%MEM</td>
<td>内存使用率</td>
</tr>
<tr>
<td>VSZ</td>
<td>虚拟内存大小</td>
</tr>
<tr>
<td>RSS</td>
<td>物理内存大小</td>
</tr>
<tr>
<td>TTY</td>
<td>关联终端</td>
</tr>
<tr>
<td>STAT</td>
<td>进程状态</td>
</tr>
<tr>
<td>START</td>
<td>启动时间</td>
</tr>
<tr>
<td>TIME</td>
<td>CPU占用时间</td>
</tr>
<tr>
<td>COMMAND</td>
<td>执行的命令</td>
</tr>
</tbody></table>
<h3 id="其他进程工具"><a href="#其他进程工具" class="headerlink" title="其他进程工具"></a>其他进程工具</h3><ul>
<li><code>pstree</code>：以树状显示进程关系</li>
<li><code>lsof</code>：列出打开的文件</li>
</ul>
<h2 id="7-内存监控"><a href="#7-内存监控" class="headerlink" title="7. 内存监控"></a>7. 内存监控</h2><h3 id="free-命令"><a href="#free-命令" class="headerlink" title="free 命令"></a>free 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free [选项]</span><br></pre></td></tr></table></figure>

<h4 id="选项-1"><a href="#选项-1" class="headerlink" title="选项"></a>选项</h4><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-b</td>
<td>以字节显示</td>
</tr>
<tr>
<td>-k</td>
<td>以KB显示(默认)</td>
</tr>
<tr>
<td>-m</td>
<td>以MB显示</td>
</tr>
<tr>
<td>-t</td>
<td>显示总计行</td>
</tr>
<tr>
<td>-o</td>
<td>不显示buffer行</td>
</tr>
<tr>
<td>-s 秒</td>
<td>持续监控间隔</td>
</tr>
</tbody></table>
<h4 id="输出字段-1"><a href="#输出字段-1" class="headerlink" title="输出字段"></a>输出字段</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>total</td>
<td>总内存量</td>
</tr>
<tr>
<td>used</td>
<td>已用量(含buffer&#x2F;cache)</td>
</tr>
<tr>
<td>free</td>
<td>空闲量(含buffer&#x2F;cache)</td>
</tr>
<tr>
<td>shared</td>
<td>共享内存</td>
</tr>
<tr>
<td>buffers</td>
<td>buffer缓存</td>
</tr>
<tr>
<td>cached</td>
<td>page cache</td>
</tr>
<tr>
<td>-&#x2F;+ buffers&#x2F;cache</td>
<td>实际内存使用</td>
</tr>
<tr>
<td>used</td>
<td>不含buffer&#x2F;cache的用量</td>
</tr>
<tr>
<td>free</td>
<td>含buffer&#x2F;cache的空闲量</td>
</tr>
</tbody></table>
<h2 id="8-磁盘与网络监控"><a href="#8-磁盘与网络监控" class="headerlink" title="8. 磁盘与网络监控"></a>8. 磁盘与网络监控</h2><h3 id="df-命令"><a href="#df-命令" class="headerlink" title="df 命令"></a>df 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> [选项] [目录]</span><br></pre></td></tr></table></figure>

<h4 id="选项-2"><a href="#选项-2" class="headerlink" title="选项"></a>选项</h4><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示所有文件系统</td>
</tr>
<tr>
<td>-h</td>
<td>人性化显示(1024进制)</td>
</tr>
<tr>
<td>-H</td>
<td>人性化显示(1000进制)</td>
</tr>
<tr>
<td>-i</td>
<td>显示inode信息</td>
</tr>
<tr>
<td>-l</td>
<td>只显示本地文件系统</td>
</tr>
<tr>
<td>-m</td>
<td>以MB为单位显示</td>
</tr>
</tbody></table>
<h3 id="网络测试工具"><a href="#网络测试工具" class="headerlink" title="网络测试工具"></a>网络测试工具</h3><ul>
<li><code>netserver</code>：启动测试服务(监听12865端口)</li>
<li><code>netperf</code>：网络性能测试客户端</li>
</ul>
<h2 id="9-高级监控系统"><a href="#9-高级监控系统" class="headerlink" title="9. 高级监控系统"></a>9. 高级监控系统</h2><h3 id="collectd"><a href="#collectd" class="headerlink" title="collectd"></a>collectd</h3><p>监控项目包括：</p>
<ul>
<li>CPU使用率</li>
<li>系统温度和风扇状态</li>
<li>进程状态</li>
<li>网络流量和延迟</li>
<li>Web服务器状态(APACHE&#x2F;Nginx)</li>
<li>DNS服务器状态</li>
<li>数据库状态</li>
<li>SWAP使用情况</li>
<li>用户登录情况</li>
</ul>
<h3 id="Nagios"><a href="#Nagios" class="headerlink" title="Nagios"></a>Nagios</h3><p>功能特点：</p>
<ul>
<li>网络服务监控</li>
<li>系统资源监控</li>
<li>基于Web的监控界面</li>
<li>邮件&#x2F;SMS告警通知</li>
<li>自定义事件处理</li>
<li>日志自动轮转</li>
<li>支持分层主机结构</li>
</ul>
<h3 id="可视化工具"><a href="#可视化工具" class="headerlink" title="可视化工具"></a>可视化工具</h3><ul>
<li><strong>MRTG</strong>：网络流量可视化</li>
<li><strong>Cacti</strong>：MRTG的增强替代品，提供更丰富的监控功能</li>
</ul>
<pre><code>
</code></pre>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/11/07/linux/11-%E6%80%A7%E8%83%BD%E6%B5%8B%E5%AE%9A/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/06/24/linux/10-%E5%AE%89%E5%85%A8/"
                            aria-label=": 10.安全"
                        >
                            10.安全
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-06-24T21:06:24+08:00">
	
		    2020 年 6 月 24 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="守护进程管理与系统安全笔记整理"><a href="#守护进程管理与系统安全笔记整理" class="headerlink" title="守护进程管理与系统安全笔记整理"></a>守护进程管理与系统安全笔记整理</h1><h2 id="守护进程管理"><a href="#守护进程管理" class="headerlink" title="守护进程管理"></a>守护进程管理</h2><h3 id="Super-Server-超级服务器"><a href="#Super-Server-超级服务器" class="headerlink" title="Super Server (超级服务器)"></a>Super Server (超级服务器)</h3><ul>
<li><strong>作用</strong>：代替其他服务监视服务请求，建立连接后转交给实际服务处理</li>
<li><strong>优势</strong>：降低系统负载，不需要为每个服务都启动独立进程</li>
</ul>
<h3 id="inetd-Internet-Daemon"><a href="#inetd-Internet-Daemon" class="headerlink" title="inetd (Internet Daemon)"></a>inetd (Internet Daemon)</h3><ul>
<li>传统的超级服务器守护进程</li>
<li>配置文件：<code>/etc/inetd.conf</code></li>
</ul>
<h4 id="inetd-conf-字段说明"><a href="#inetd-conf-字段说明" class="headerlink" title="inetd.conf 字段说明"></a>inetd.conf 字段说明</h4><table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>service_name</td>
<td><code>/etc/services</code>中定义的服务名</td>
</tr>
<tr>
<td>socket_type</td>
<td>socket类型(TCP&#x3D;stream, UDP&#x3D;dgram)</td>
</tr>
<tr>
<td>protocol</td>
<td>协议类型(通常TCP&#x2F;UDP)</td>
</tr>
<tr>
<td>flags</td>
<td>请求处理方式(wait&#x3D;等待处理完成, nowait&#x3D;立即处理下一个)</td>
</tr>
<tr>
<td>user</td>
<td>执行用户</td>
</tr>
<tr>
<td>program</td>
<td>程序绝对路径</td>
</tr>
<tr>
<td>args</td>
<td>转发参数</td>
</tr>
</tbody></table>
<h4 id="重启inetd"><a href="#重启inetd" class="headerlink" title="重启inetd"></a>重启inetd</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -HUP inetd的PID</span><br><span class="line">killall -HUP inetd</span><br><span class="line">/etc/init.d/inetd restart</span><br></pre></td></tr></table></figure>

<h3 id="TCP-Wrapper"><a href="#TCP-Wrapper" class="headerlink" title="TCP Wrapper"></a>TCP Wrapper</h3><ul>
<li>访问控制机制，检查顺序：<ol>
<li>先查<code>/etc/hosts.allow</code> → 匹配则允许</li>
<li>再查<code>/etc/hosts.deny</code> → 匹配则拒绝</li>
<li>都不匹配则允许</li>
</ol>
</li>
</ul>
<h4 id="通配符说明"><a href="#通配符说明" class="headerlink" title="通配符说明"></a>通配符说明</h4><table>
<thead>
<tr>
<th>通配符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ALL</td>
<td>所有服务和主机</td>
</tr>
<tr>
<td>A EXCEPT B</td>
<td>除B以外的A</td>
</tr>
<tr>
<td>LOCAL</td>
<td>本地主机(不含.)</td>
</tr>
<tr>
<td>PARANOID</td>
<td>主机名与DNS解析IP不一致的情况</td>
</tr>
</tbody></table>
<h4 id="示例配置"><a href="#示例配置" class="headerlink" title="示例配置"></a>示例配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">in.telnetd: .lpic.jp  # 允许lpic.jp域访问telnet</span><br><span class="line">ALL: 192.168.2.      # 允许192.168.2.x网段所有服务</span><br></pre></td></tr></table></figure>

<h3 id="xinetd-扩展的inetd"><a href="#xinetd-扩展的inetd" class="headerlink" title="xinetd (扩展的inetd)"></a>xinetd (扩展的inetd)</h3><ul>
<li>更安全的超级服务器，支持分服务配置</li>
<li>主配置文件：<code>/etc/xinetd.conf</code></li>
<li>服务配置文件：<code>/etc/xinetd.d/</code></li>
</ul>
<h4 id="xinetd-conf-主要参数"><a href="#xinetd-conf-主要参数" class="headerlink" title="xinetd.conf 主要参数"></a>xinetd.conf 主要参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">default</span><br><span class="line">&#123;</span><br><span class="line">    instance = 60               <span class="comment"># 最大守护进程数</span></span><br><span class="line">    log_type = SYSLOG authpriv  <span class="comment"># 日志类型</span></span><br><span class="line">    log_on_success = HOST PID   <span class="comment"># 成功日志内容</span></span><br><span class="line">    log_on_failure = HOST       <span class="comment"># 失败日志内容</span></span><br><span class="line">    cps = 25 30                 <span class="comment"># 每秒最大连接数(超限后暂停30秒)</span></span><br><span class="line">&#125;</span><br><span class="line">includedir /etc/xinetd.d        <span class="comment"># 包含服务配置目录</span></span><br></pre></td></tr></table></figure>

<h4 id="服务配置示例-telnet"><a href="#服务配置示例-telnet" class="headerlink" title="服务配置示例(telnet)"></a>服务配置示例(telnet)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">service telnet</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">disable</span> = no</span><br><span class="line">    socket_type = stream</span><br><span class="line">    <span class="built_in">wait</span> = no</span><br><span class="line">    user = root</span><br><span class="line">    server = /usr/sbin/in.telnetd</span><br><span class="line">    log_on_failure += USERID</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="重启xinetd"><a href="#重启xinetd" class="headerlink" title="重启xinetd"></a>重启xinetd</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/xinetd restart</span><br></pre></td></tr></table></figure>

<h2 id="端口安全"><a href="#端口安全" class="headerlink" title="端口安全"></a>端口安全</h2><h3 id="检查开放端口"><a href="#检查开放端口" class="headerlink" title="检查开放端口"></a>检查开放端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -atun       <span class="comment"># 显示所有TCP/UDP端口</span></span><br><span class="line">lsof -i -n          <span class="comment"># 查看网络连接</span></span><br><span class="line">lsof -i :22         <span class="comment"># 查看指定端口</span></span><br><span class="line">lsof -c ssh         <span class="comment"># 查看指定进程</span></span><br></pre></td></tr></table></figure>

<h3 id="nmap-扫描"><a href="#nmap-扫描" class="headerlink" title="nmap 扫描"></a>nmap 扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 目标主机       <span class="comment"># 扫描主机开放端口</span></span><br></pre></td></tr></table></figure>

<h3 id="查找特殊权限文件"><a href="#查找特殊权限文件" class="headerlink" title="查找特殊权限文件"></a>查找特殊权限文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u+s -<span class="built_in">ls</span>   <span class="comment"># 查找SUID文件</span></span><br><span class="line">find / -perm -g+s -<span class="built_in">ls</span>   <span class="comment"># 查找SGID文件</span></span><br><span class="line">find / -perm -o+t -<span class="built_in">ls</span>   <span class="comment"># 查找sticky bit文件</span></span><br></pre></td></tr></table></figure>

<h2 id="用户安全"><a href="#用户安全" class="headerlink" title="用户安全"></a>用户安全</h2><h3 id="密码有效期设置-chage"><a href="#密码有效期设置-chage" class="headerlink" title="密码有效期设置(chage)"></a>密码有效期设置(chage)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chage [选项] 用户名</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>显示有效期</td>
</tr>
<tr>
<td>-m 天数</td>
<td>密码最小使用天数</td>
</tr>
<tr>
<td>-M 天数</td>
<td>密码最大有效期</td>
</tr>
<tr>
<td>-d 日期</td>
<td>最后修改日期</td>
</tr>
<tr>
<td>-W 天数</td>
<td>密码过期前警告天数</td>
</tr>
<tr>
<td>-I 天数</td>
<td>密码过期后锁定前天数</td>
</tr>
<tr>
<td>-E 日期</td>
<td>账号失效日期</td>
</tr>
</tbody></table>
<h3 id="禁止登录方法"><a href="#禁止登录方法" class="headerlink" title="禁止登录方法"></a>禁止登录方法</h3><ol>
<li>创建<code>/etc/nologin</code>文件：禁止所有非root用户登录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /etc/nologin</span><br></pre></td></tr></table></figure></li>
<li>修改用户shell：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -s /sbin/nologin 用户名  <span class="comment"># 禁止指定用户登录</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="su-sudo"><a href="#su-sudo" class="headerlink" title="su&#x2F;sudo"></a>su&#x2F;sudo</h3><h4 id="su-切换用户"><a href="#su-切换用户" class="headerlink" title="su (切换用户)"></a>su (切换用户)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - 用户名   <span class="comment"># 完全切换(加载环境变量)</span></span><br><span class="line">su 用户名     <span class="comment"># 部分切换(保留当前环境)</span></span><br></pre></td></tr></table></figure>

<h4 id="sudo-超级用户权限"><a href="#sudo-超级用户权限" class="headerlink" title="sudo (超级用户权限)"></a>sudo (超级用户权限)</h4><ul>
<li>配置文件：<code>/etc/sudoers</code> (使用<code>visudo</code>编辑)</li>
<li>示例配置：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 允许student用户执行shutdown</span></span><br><span class="line">student ALL=(ALL) /sbin/shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许wheel组成员执行所有命令且不输密码</span></span><br><span class="line">%wheel ALL=(ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="资源限制-ulimit"><a href="#资源限制-ulimit" class="headerlink" title="资源限制(ulimit)"></a>资源限制(ulimit)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> [选项] [限制值]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示所有限制</td>
</tr>
<tr>
<td>-c size</td>
<td>核心文件大小</td>
</tr>
<tr>
<td>-f size</td>
<td>最大文件大小</td>
</tr>
<tr>
<td>-n num</td>
<td>打开文件数限制</td>
</tr>
<tr>
<td>-u num</td>
<td>用户最大进程数</td>
</tr>
<tr>
<td>-v size</td>
<td>最大虚拟内存</td>
</tr>
</tbody></table>
<h2 id="OpenSSH-安全"><a href="#OpenSSH-安全" class="headerlink" title="OpenSSH 安全"></a>OpenSSH 安全</h2><h3 id="SSH密钥文件"><a href="#SSH密钥文件" class="headerlink" title="SSH密钥文件"></a>SSH密钥文件</h3><table>
<thead>
<tr>
<th>文件名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ssh_host_key</td>
<td>SSH1私钥</td>
</tr>
<tr>
<td>ssh_host_dsa_key</td>
<td>SSH2 DSA私钥</td>
</tr>
<tr>
<td>ssh_host_rsa_key</td>
<td>SSH2 RSA私钥</td>
</tr>
<tr>
<td>*.pub</td>
<td>对应公钥</td>
</tr>
</tbody></table>
<h3 id="sshd配置-etc-ssh-sshd-config"><a href="#sshd配置-etc-ssh-sshd-config" class="headerlink" title="sshd配置(&#x2F;etc&#x2F;ssh&#x2F;sshd_config)"></a>sshd配置(&#x2F;etc&#x2F;ssh&#x2F;sshd_config)</h3><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Port</td>
<td>SSH端口(默认22)</td>
</tr>
<tr>
<td>Protocol</td>
<td>SSH版本(1,2)</td>
</tr>
<tr>
<td>HostKey</td>
<td>私钥文件路径</td>
</tr>
<tr>
<td>PermitRootLogin</td>
<td>是否允许root登录</td>
</tr>
<tr>
<td>RSAAuthentication</td>
<td>是否启用SSH1公钥认证</td>
</tr>
<tr>
<td>PubkeyAuthentication</td>
<td>是否启用SSH2公钥认证</td>
</tr>
<tr>
<td>AuthorizedKeysFile</td>
<td>授权公钥文件路径</td>
</tr>
<tr>
<td>PermitEmptyPasswords</td>
<td>是否允许空密码</td>
</tr>
<tr>
<td>PasswordAuthentication</td>
<td>是否启用密码认证</td>
</tr>
<tr>
<td>X11Forwarding</td>
<td>是否允许X11转发</td>
</tr>
</tbody></table>
<h3 id="SSH密钥认证流程"><a href="#SSH密钥认证流程" class="headerlink" title="SSH密钥认证流程"></a>SSH密钥认证流程</h3><ol>
<li>客户端生成密钥对：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa   <span class="comment"># 生成RSA密钥对</span></span><br></pre></td></tr></table></figure></li>
<li>上传公钥到服务器：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id 用户名@服务器</span><br></pre></td></tr></table></figure></li>
<li>服务器端公钥存储在：<code>~/.ssh/authorized_keys</code></li>
</ol>
<h3 id="SSH实用命令"><a href="#SSH实用命令" class="headerlink" title="SSH实用命令"></a>SSH实用命令</h3><h4 id="scp-安全复制"><a href="#scp-安全复制" class="headerlink" title="scp (安全复制)"></a>scp (安全复制)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp 文件 用户@主机:路径   <span class="comment"># 上传</span></span><br><span class="line">scp -r 目录 用户@主机:路径 <span class="comment"># 递归复制目录</span></span><br></pre></td></tr></table></figure>

<h4 id="ssh-agent-密钥代理"><a href="#ssh-agent-密钥代理" class="headerlink" title="ssh-agent (密钥代理)"></a>ssh-agent (密钥代理)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> `ssh-agent`   <span class="comment"># 启动代理</span></span><br><span class="line">ssh-add            <span class="comment"># 添加密钥</span></span><br><span class="line">ssh-add -l         <span class="comment"># 列出已加载密钥</span></span><br></pre></td></tr></table></figure>

<h4 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地端口转发</span></span><br><span class="line">ssh -L 本地端口:远程主机:远程端口 用户@网关</span><br><span class="line"></span><br><span class="line"><span class="comment"># X11转发</span></span><br><span class="line">ssh -X 用户@主机</span><br></pre></td></tr></table></figure>

<h2 id="GnuPG-文件加密"><a href="#GnuPG-文件加密" class="headerlink" title="GnuPG 文件加密"></a>GnuPG 文件加密</h2><h3 id="密钥管理"><a href="#密钥管理" class="headerlink" title="密钥管理"></a>密钥管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-key              <span class="comment"># 生成密钥对</span></span><br><span class="line">gpg --list-keys            <span class="comment"># 列出密钥</span></span><br><span class="line">gpg --<span class="built_in">export</span> -a <span class="string">&quot;用户&quot;</span> &gt; pubkey.asc  <span class="comment"># 导出公钥</span></span><br><span class="line">gpg --import pubkey.asc    <span class="comment"># 导入公钥</span></span><br></pre></td></tr></table></figure>

<h3 id="文件加密-解密"><a href="#文件加密-解密" class="headerlink" title="文件加密&#x2F;解密"></a>文件加密&#x2F;解密</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加密文件(给指定用户)</span></span><br><span class="line">gpg -e -a -r 接收者邮件 文件</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密文件</span></span><br><span class="line">gpg 加密文件.asc</span><br></pre></td></tr></table></figure>

<h3 id="密钥吊销"><a href="#密钥吊销" class="headerlink" title="密钥吊销"></a>密钥吊销</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-revoke 用户邮件 &gt; revoke.asc  <span class="comment"># 生成吊销证书</span></span><br><span class="line">gpg --import revoke.asc                 <span class="comment"># 导入吊销证书</span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/06/24/linux/10-%E5%AE%89%E5%85%A8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/06/18/linux/9-TCP-IP/"
                            aria-label=": 9.TCP-IP"
                        >
                            9.TCP-IP
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-06-18T19:06:24+08:00">
	
		    2020 年 6 月 18 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="TCP-IP-基础笔记整理"><a href="#TCP-IP-基础笔记整理" class="headerlink" title="TCP&#x2F;IP 基础笔记整理"></a>TCP&#x2F;IP 基础笔记整理</h1><h2 id="IPv4-地址分类"><a href="#IPv4-地址分类" class="headerlink" title="IPv4 地址分类"></a>IPv4 地址分类</h2><h3 id="标准分类"><a href="#标准分类" class="headerlink" title="标准分类"></a>标准分类</h3><table>
<thead>
<tr>
<th>类别</th>
<th>IP 地址范围</th>
<th>子网掩码</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>0.0.0.0 ~ 127.255.255.255</td>
<td>255.0.0.0</td>
</tr>
<tr>
<td>B</td>
<td>128.0.0.0 ~ 191.255.255.255</td>
<td>255.255.0.0</td>
</tr>
<tr>
<td>C</td>
<td>192.0.0.0 ~ 223.255.255.255</td>
<td>255.255.255.0</td>
</tr>
</tbody></table>
<h3 id="私有地址范围"><a href="#私有地址范围" class="headerlink" title="私有地址范围"></a>私有地址范围</h3><table>
<thead>
<tr>
<th>类别</th>
<th>IP 地址范围</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>10.0.0.0 ~ 10.255.255.255</td>
</tr>
<tr>
<td>B</td>
<td>172.16.0.0 ~ 172.31.255.255</td>
</tr>
<tr>
<td>C</td>
<td>192.168.0.0 ~ 192.168.255.255</td>
</tr>
</tbody></table>
<h2 id="CIDR-Classless-Inter-Domain-Routing"><a href="#CIDR-Classless-Inter-Domain-Routing" class="headerlink" title="CIDR (Classless Inter-Domain Routing)"></a>CIDR (Classless Inter-Domain Routing)</h2><ul>
<li>无类别域间路由</li>
<li>允许更灵活的子网划分方式，不再受传统 A&#x2F;B&#x2F;C 类限制</li>
</ul>
<h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><ul>
<li>128 比特地址，用 16 进制表示，分为 8 个 block</li>
<li>表示规则：<ol>
<li>每个 block 开头的 0 可以省略</li>
<li>连续的 0 可以用 <code>::</code> 表示，但整个地址中 <code>::</code> 只能出现一次</li>
</ol>
</li>
</ul>
<h3 id="IPv6-地址类型"><a href="#IPv6-地址类型" class="headerlink" title="IPv6 地址类型"></a>IPv6 地址类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>单播地址 (Unicast)</td>
<td>标识单个接口，类似 IPv4 单播地址</td>
</tr>
<tr>
<td>组播地址 (Multicast)</td>
<td>标识一组接口，类似 IPv4 组播地址</td>
</tr>
<tr>
<td>任播地址 (Anycast)</td>
<td>新增类型，数据包发送给最近的一个接口</td>
</tr>
</tbody></table>
<h2 id="端口-Port"><a href="#端口-Port" class="headerlink" title="端口 (Port)"></a>端口 (Port)</h2><ul>
<li><code>/etc/services</code>：端口与服务对应关系文件</li>
<li>常用端口：</li>
</ul>
<table>
<thead>
<tr>
<th>端口</th>
<th>协议</th>
<th>服务</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>20</td>
<td>TCP</td>
<td>FTP</td>
<td>文件传输(数据)</td>
</tr>
<tr>
<td>21</td>
<td>TCP</td>
<td>FTP</td>
<td>文件传输(控制)</td>
</tr>
<tr>
<td>22</td>
<td>TCP</td>
<td>SSH</td>
<td>安全Shell</td>
</tr>
<tr>
<td>23</td>
<td>TCP</td>
<td>Telnet</td>
<td>远程登录</td>
</tr>
<tr>
<td>25</td>
<td>TCP&#x2F;UDP</td>
<td>SMTP</td>
<td>邮件发送</td>
</tr>
<tr>
<td>53</td>
<td>TCP&#x2F;UDP</td>
<td>DNS</td>
<td>域名解析</td>
</tr>
<tr>
<td>80</td>
<td>TCP</td>
<td>HTTP</td>
<td>Web服务</td>
</tr>
<tr>
<td>110</td>
<td>TCP</td>
<td>POP3</td>
<td>邮件接收</td>
</tr>
<tr>
<td>119</td>
<td>TCP</td>
<td>NNTP</td>
<td>网络新闻</td>
</tr>
<tr>
<td>139</td>
<td>TCP&#x2F;UDP</td>
<td>NetBIOS</td>
<td>Windows网络</td>
</tr>
<tr>
<td>143</td>
<td>TCP</td>
<td>IMAP</td>
<td>邮件访问</td>
</tr>
<tr>
<td>161</td>
<td>UDP</td>
<td>SNMP</td>
<td>网络管理</td>
</tr>
<tr>
<td>443</td>
<td>TCP</td>
<td>HTTPS</td>
<td>安全Web</td>
</tr>
<tr>
<td>465</td>
<td>TCP</td>
<td>SMTPS</td>
<td>安全SMTP</td>
</tr>
<tr>
<td>993</td>
<td>TCP</td>
<td>IMAPS</td>
<td>安全IMAP</td>
</tr>
<tr>
<td>995</td>
<td>TCP</td>
<td>POP3S</td>
<td>安全POP3</td>
</tr>
</tbody></table>
<h2 id="nsswitch-conf-文件"><a href="#nsswitch-conf-文件" class="headerlink" title="nsswitch.conf 文件"></a>nsswitch.conf 文件</h2><p>控制各种系统数据库的搜索顺序和方法</p>
<h3 id="1-信息类型-Info"><a href="#1-信息类型-Info" class="headerlink" title="1. 信息类型(Info)"></a>1. 信息类型(Info)</h3><ul>
<li><code>automount</code>：自动挂载信息</li>
<li><code>bootparams</code>：引导选项</li>
<li><code>ethers</code>：MAC地址</li>
<li><code>group</code>：用户组信息</li>
<li><code>hosts</code>：主机名和IP</li>
<li><code>networks</code>：网络信息</li>
<li><code>passwd</code>：用户信息</li>
<li><code>protocols</code>：网络协议</li>
<li><code>publickey</code>：NIS+&#x2F;NFS公钥</li>
<li><code>rpc</code>：远程过程调用</li>
<li><code>services</code>：网络服务</li>
<li><code>shadow</code>：用户密码信息</li>
<li><code>aliases</code>：邮件别名</li>
</ul>
<h3 id="2-搜索方法-method"><a href="#2-搜索方法-method" class="headerlink" title="2. 搜索方法(method)"></a>2. 搜索方法(method)</h3><ul>
<li><code>files</code>：搜索本地文件</li>
<li><code>nis</code>：搜索NIS数据库</li>
<li><code>dns</code>：查询DNS</li>
<li><code>compat</code>：兼容模式(±语法)</li>
</ul>
<h3 id="3-搜索顺序"><a href="#3-搜索顺序" class="headerlink" title="3. 搜索顺序"></a>3. 搜索顺序</h3><p>从左到右依次尝试，先找到的结果优先</p>
<h3 id="4-动作项-action"><a href="#4-动作项-action" class="headerlink" title="4. 动作项([action])"></a>4. 动作项([action])</h3><p>格式：<code>[[!]STATUS=action]</code></p>
<ul>
<li>STATUS：<ul>
<li><code>NOTFOUND</code>：未找到</li>
<li><code>SUCCESS</code>：成功找到</li>
<li><code>UNAVAIL</code>：永久不可用</li>
<li><code>TRYAGAIN</code>：临时不可用</li>
</ul>
</li>
<li>action：<ul>
<li><code>return</code>：返回结果</li>
<li><code>continue</code>：继续尝试下个方法</li>
</ul>
</li>
</ul>
<h3 id="5-compat方法"><a href="#5-compat方法" class="headerlink" title="5. compat方法"></a>5. compat方法</h3><p>在passwd&#x2F;group&#x2F;shadow文件中使用<code>+</code>和<code>-</code>来合并NIS信息</p>
<h2 id="网络故障排除命令"><a href="#网络故障排除命令" class="headerlink" title="网络故障排除命令"></a>网络故障排除命令</h2><h3 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping 主机名或IP地址</span><br><span class="line">ping -c 次数 目标  <span class="comment"># 指定发送次数</span></span><br><span class="line">ping -i 间隔 目标  <span class="comment"># 指定发送间隔</span></span><br></pre></td></tr></table></figure>
<ul>
<li>TTL：ICMP包最大生存时间</li>
<li>time：响应时间</li>
</ul>
<h3 id="traceroute-tracepath"><a href="#traceroute-tracepath" class="headerlink" title="traceroute&#x2F;tracepath"></a>traceroute&#x2F;tracepath</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">traceroute 主机名或IP地址</span><br><span class="line">tracepath 主机名或IP地址 [端口]</span><br></pre></td></tr></table></figure>
<ul>
<li>显示到达目标的路径</li>
</ul>
<h3 id="host"><a href="#host" class="headerlink" title="host"></a>host</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host [选项] 主机名或IP [DNS服务器]</span><br><span class="line">host -v 目标  <span class="comment"># 显示详细信息</span></span><br></pre></td></tr></table></figure>
<ul>
<li>查询DNS信息</li>
</ul>
<h3 id="hostname"><a href="#hostname" class="headerlink" title="hostname"></a>hostname</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostname  <span class="comment"># 显示当前主机名</span></span><br><span class="line">hostname 新主机名  <span class="comment"># 设置主机名</span></span><br></pre></td></tr></table></figure>

<h3 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">netstat -a  <span class="comment"># 显示所有socket</span></span><br><span class="line">netstat -c  <span class="comment"># 实时更新</span></span><br><span class="line">netstat -i  <span class="comment"># 显示接口状态</span></span><br><span class="line">netstat -n  <span class="comment"># 显示数字地址</span></span><br><span class="line">netstat -p  <span class="comment"># 显示PID/进程名</span></span><br><span class="line">netstat -r  <span class="comment"># 显示路由表</span></span><br><span class="line">netstat -t  <span class="comment"># 只显示TCP</span></span><br><span class="line">netstat -u  <span class="comment"># 只显示UDP</span></span><br></pre></td></tr></table></figure>

<h3 id="route"><a href="#route" class="headerlink" title="route"></a>route</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">route  <span class="comment"># 显示路由表</span></span><br><span class="line">route add -net 目标网络 netmask 子网掩码 gw 网关</span><br><span class="line">route add default gw 默认网关</span><br><span class="line">route del -net 目标网络</span><br></pre></td></tr></table></figure>

<p>路由表字段说明：</p>
<ul>
<li>Destination：目标网络&#x2F;主机</li>
<li>Gateway：网关</li>
<li>Genmask：子网掩码</li>
<li>Flags：标志(U&#x3D;有效,H&#x3D;主机,G&#x3D;网关)</li>
<li>Metric：距离</li>
<li>Ref：引用数</li>
<li>Use：使用计数</li>
<li>Iface：接口</li>
</ul>
<h3 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig 接口名 IP地址 netmask 子网掩码</span><br><span class="line">ifconfig 接口名 up/down  <span class="comment"># 启用/禁用接口</span></span><br></pre></td></tr></table></figure>

<h3 id="ifup-ifdown"><a href="#ifup-ifdown" class="headerlink" title="ifup&#x2F;ifdown"></a>ifup&#x2F;ifdown</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifup 接口名  <span class="comment"># 启用接口</span></span><br><span class="line">ifdown 接口名  <span class="comment"># 禁用接口</span></span><br></pre></td></tr></table></figure>

<h2 id="网络服务命令"><a href="#网络服务命令" class="headerlink" title="网络服务命令"></a>网络服务命令</h2><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 主机 [端口]  <span class="comment"># 默认端口23</span></span><br></pre></td></tr></table></figure>

<h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ftp 主机</span><br><span class="line"><span class="comment"># 常用命令：</span></span><br><span class="line"><span class="built_in">ls</span>      <span class="comment"># 列出远程文件</span></span><br><span class="line"><span class="built_in">pwd</span>     <span class="comment"># 显示远程当前目录</span></span><br><span class="line">get     <span class="comment"># 下载文件</span></span><br><span class="line">mget    <span class="comment"># 下载多个文件</span></span><br><span class="line">put     <span class="comment"># 上传文件</span></span><br><span class="line">ascii   <span class="comment"># ASCII传输模式</span></span><br><span class="line">binary  <span class="comment"># 二进制传输模式</span></span><br><span class="line">quit    <span class="comment"># 退出</span></span><br></pre></td></tr></table></figure>

<h3 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dig [选项] @DNS服务器 主机名 域名 [查询类型]</span><br><span class="line">dig -x IP地址  <span class="comment"># 反向查询</span></span><br><span class="line"><span class="comment"># 查询类型：</span></span><br><span class="line">a    <span class="comment"># IP地址</span></span><br><span class="line">any  <span class="comment"># 所有信息</span></span><br><span class="line">mx   <span class="comment"># 邮件服务器</span></span><br><span class="line">ns   <span class="comment"># 名称服务器</span></span><br></pre></td></tr></table></figure>

<h3 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whois 目标 [@whois服务器]</span><br></pre></td></tr></table></figure>
<ul>
<li>查询域名注册信息</li>
</ul>
<h2 id="网络配置文件"><a href="#网络配置文件" class="headerlink" title="网络配置文件"></a>网络配置文件</h2><h3 id="etc-hostname"><a href="#etc-hostname" class="headerlink" title="&#x2F;etc&#x2F;hostname"></a>&#x2F;etc&#x2F;hostname</h3><ul>
<li>存储主机名</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windsor.lpic.jp</span><br></pre></td></tr></table></figure>

<h3 id="etc-hosts"><a href="#etc-hosts" class="headerlink" title="&#x2F;etc&#x2F;hosts"></a>&#x2F;etc&#x2F;hosts</h3><ul>
<li>主机名与IP映射</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 localhost.localdomain localhost</span><br><span class="line">192.168.0.1 windsor.example.com windsor</span><br></pre></td></tr></table></figure>

<h3 id="etc-nsswitch-conf"><a href="#etc-nsswitch-conf" class="headerlink" title="&#x2F;etc&#x2F;nsswitch.conf"></a>&#x2F;etc&#x2F;nsswitch.conf</h3><ul>
<li>名称服务切换配置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hosts: files ldap dns  # 先查本地文件，再LDAP，最后DNS</span><br></pre></td></tr></table></figure>

<h3 id="etc-resolv-conf"><a href="#etc-resolv-conf" class="headerlink" title="&#x2F;etc&#x2F;resolv.conf"></a>&#x2F;etc&#x2F;resolv.conf</h3><ul>
<li>DNS配置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">domain lpic.jp</span><br><span class="line">search lpic.jp</span><br><span class="line">nameserver 192.168.1.253</span><br><span class="line">nameserver 192.168.1.2</span><br></pre></td></tr></table></figure>

<h3 id="etc-sysconfig-network"><a href="#etc-sysconfig-network" class="headerlink" title="&#x2F;etc&#x2F;sysconfig&#x2F;network"></a>&#x2F;etc&#x2F;sysconfig&#x2F;network</h3><ul>
<li>基本网络设置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NETWORKING=YES</span><br><span class="line">HOSTNAME=lpic.example.net</span><br><span class="line">GATEWAY=192.168.0.254</span><br></pre></td></tr></table></figure>

<h3 id="etc-sysconfig-network-scripts"><a href="#etc-sysconfig-network-scripts" class="headerlink" title="&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;"></a>&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;</h3><ul>
<li>网络接口配置文件(如ifcfg-eth0)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth0</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=192.168.0.6</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">NETWORK=192.168.0.0</span><br><span class="line">BROADCAST=192.168.0.255</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/06/18/linux/9-TCP-IP/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/05/24/linux/8-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/"
                            aria-label=": 8.系统管理"
                        >
                            8.系统管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-24T20:06:24+08:00">
	
		    2020 年 5 月 24 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Linux-用户、群组与系统管理"><a href="#Linux-用户、群组与系统管理" class="headerlink" title="Linux 用户、群组与系统管理"></a>Linux 用户、群组与系统管理</h1><h2 id="1-用户和群组管理"><a href="#1-用户和群组管理" class="headerlink" title="1. 用户和群组管理"></a>1. 用户和群组管理</h2><h3 id="1-1-用户配置文件"><a href="#1-1-用户配置文件" class="headerlink" title="1.1 用户配置文件"></a>1.1 用户配置文件</h3><h4 id="etc-passwd-文件格式"><a href="#etc-passwd-文件格式" class="headerlink" title="&#x2F;etc&#x2F;passwd 文件格式"></a>&#x2F;etc&#x2F;passwd 文件格式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lpic:x:500:500:LPI linux:/home/lpic:/bin/bash</span><br><span class="line">↑    ↑ ↑   ↑   ↑         ↑          ↑</span><br><span class="line">│    │ │   │   │         │          └─ 默认shell</span><br><span class="line">│    │ │   │   │         └─────────── 家目录</span><br><span class="line">│    │ │   │   └───────────────────── 用户备注信息(GECOS)</span><br><span class="line">│    │ │   └───────────────────────── 主组GID</span><br><span class="line">│    │ └───────────────────────────── 用户UID</span><br><span class="line">│    └─────────────────────────────── 密码占位符(实际在/etc/shadow)</span><br><span class="line">└──────────────────────────────────── 用户名</span><br></pre></td></tr></table></figure>

<h4 id="etc-shadow-文件"><a href="#etc-shadow-文件" class="headerlink" title="&#x2F;etc&#x2F;shadow 文件"></a>&#x2F;etc&#x2F;shadow 文件</h4><ul>
<li>存储用户密码哈希值</li>
<li>只有root用户可访问</li>
<li>包含密码过期时间等安全信息</li>
</ul>
<h4 id="etc-group-文件格式"><a href="#etc-group-文件格式" class="headerlink" title="&#x2F;etc&#x2F;group 文件格式"></a>&#x2F;etc&#x2F;group 文件格式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">staff:x:500:linux,lpic</span><br><span class="line">↑     ↑ ↑   ↑</span><br><span class="line">│     │ │   └───────────── 附加组成员</span><br><span class="line">│     │ └───────────────── 组GID</span><br><span class="line">│     └─────────────────── 组密码占位符</span><br><span class="line">└───────────────────────── 组名</span><br></pre></td></tr></table></figure>

<h3 id="1-2-用户管理命令"><a href="#1-2-用户管理命令" class="headerlink" title="1.2 用户管理命令"></a>1.2 用户管理命令</h3><h4 id="useradd-添加用户"><a href="#useradd-添加用户" class="headerlink" title="useradd - 添加用户"></a>useradd - 添加用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -c <span class="string">&quot;开发人员&quot;</span> -d /home/dev -g staff -G developers -s /bin/bash -m devuser</span><br></pre></td></tr></table></figure>
<p>常用选项：</p>
<ul>
<li><code>-c</code>：用户备注信息</li>
<li><code>-d</code>：指定家目录路径</li>
<li><code>-g</code>：指定主组</li>
<li><code>-G</code>：指定附加组</li>
<li><code>-s</code>：指定登录shell</li>
<li><code>-m</code>：自动创建家目录(从&#x2F;etc&#x2F;skel复制模板)</li>
</ul>
<h4 id="usermod-修改用户"><a href="#usermod-修改用户" class="headerlink" title="usermod - 修改用户"></a>usermod - 修改用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -c <span class="string">&quot;高级开发&quot;</span> -G managers -s /bin/zsh devuser</span><br></pre></td></tr></table></figure>
<p>常用选项：</p>
<ul>
<li><code>-c</code>：备注:指定备注</li>
<li><code>-d</code>：path:home目录</li>
<li><code>-g</code>：组名&#x2F;GID:所属主组</li>
<li><code>-G</code>：组名&#x2F;GID:其他所属组</li>
<li><code>-s</code>：path: login shell</li>
<li><code>-L</code>：锁定用户密码</li>
<li><code>-U</code>：解锁用户密码</li>
</ul>
<h4 id="userdel-删除用户"><a href="#userdel-删除用户" class="headerlink" title="userdel - 删除用户"></a>userdel - 删除用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel -r devuser  <span class="comment"># 删除用户并移除家目录</span></span><br></pre></td></tr></table></figure>

<h4 id="passwd-密码管理"><a href="#passwd-密码管理" class="headerlink" title="passwd - 密码管理"></a>passwd - 密码管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">passwd devuser      <span class="comment"># 设置密码</span></span><br><span class="line">passwd -l devuser   <span class="comment"># 锁定账户</span></span><br><span class="line">passwd -u devuser   <span class="comment"># 解锁账户</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3-群组管理命令"><a href="#1-3-群组管理命令" class="headerlink" title="1.3 群组管理命令"></a>1.3 群组管理命令</h3><h4 id="groupadd-添加组"><a href="#groupadd-添加组" class="headerlink" title="groupadd - 添加组"></a>groupadd - 添加组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd developers</span><br></pre></td></tr></table></figure>

<h4 id="groupmod-修改组"><a href="#groupmod-修改组" class="headerlink" title="groupmod - 修改组"></a>groupmod - 修改组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod -g 1001 -n devgroup developers</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-g</code>：修改GID</li>
<li><code>-n</code>：修改组名</li>
</ul>
<h4 id="groupdel-删除组"><a href="#groupdel-删除组" class="headerlink" title="groupdel - 删除组"></a>groupdel - 删除组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel devgroup</span><br></pre></td></tr></table></figure>

<h4 id="id-查看用户信息"><a href="#id-查看用户信息" class="headerlink" title="id - 查看用户信息"></a>id - 查看用户信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">id</span> devuser  <span class="comment"># 显示用户UID、GID和所属组</span></span><br></pre></td></tr></table></figure>

<h2 id="2-系统时间管理"><a href="#2-系统时间管理" class="headerlink" title="2. 系统时间管理"></a>2. 系统时间管理</h2><h3 id="2-1-date-系统时间"><a href="#2-1-date-系统时间" class="headerlink" title="2.1 date - 系统时间"></a>2.1 date - 系统时间</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> 093017002012.30    <span class="comment"># 设置为2012年9月30日17:00:30</span></span><br><span class="line"><span class="built_in">date</span> <span class="string">&quot;+%Y/%m/%d (%a)&quot;</span>   <span class="comment"># 格式化为&quot;2023/05/15 (Mon)&quot;</span></span><br></pre></td></tr></table></figure>

<p>常用格式符号：</p>
<ul>
<li><code>%Y</code>：4位年份</li>
<li><code>%m</code>：2位月份</li>
<li><code>%d</code>：2位日期</li>
<li><code>%H</code>：24小时制小时</li>
<li><code>%M</code>：分钟</li>
<li><code>%a</code>：星期缩写</li>
</ul>
<h3 id="2-2-hwclock-硬件时钟"><a href="#2-2-hwclock-硬件时钟" class="headerlink" title="2.2 hwclock - 硬件时钟"></a>2.2 hwclock - 硬件时钟</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hwclock --show          <span class="comment"># 显示硬件时钟</span></span><br><span class="line">hwclock --systohc       <span class="comment"># 系统时间同步到硬件时钟</span></span><br><span class="line">hwclock --hctosys       <span class="comment"># 硬件时钟同步到系统时间</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-NTP时间同步"><a href="#2-3-NTP时间同步" class="headerlink" title="2.3 NTP时间同步"></a>2.3 NTP时间同步</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ntpdate time.server.lpic.jp  <span class="comment"># 手动同步时间</span></span><br><span class="line">service ntpd start           <span class="comment"># 启动NTP服务</span></span><br></pre></td></tr></table></figure>

<p>NTP配置文件(<code>/etc/ntp.conf</code>)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driftfile /etc/ntp.drift</span><br><span class="line">logfile /var/log/ntp.log</span><br><span class="line">server ntp.server.lpic.jp</span><br></pre></td></tr></table></figure>

<h2 id="3-系统日志管理"><a href="#3-系统日志管理" class="headerlink" title="3. 系统日志管理"></a>3. 系统日志管理</h2><h3 id="3-1-syslog-配置"><a href="#3-1-syslog-配置" class="headerlink" title="3.1 syslog 配置"></a>3.1 syslog 配置</h3><p>配置文件：<code>/etc/syslog.conf</code></p>
<p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">facility.priority    log_location</span><br></pre></td></tr></table></figure>

<h4 id="facility-设施-类型："><a href="#facility-设施-类型：" class="headerlink" title="facility(设施)类型："></a>facility(设施)类型：</h4><ul>
<li><code>auth</code>&#x2F;<code>authpriv</code>：认证相关</li>
<li><code>cron</code>：定时任务</li>
<li><code>daemon</code>：守护进程</li>
<li><code>kern</code>：内核消息</li>
<li><code>mail</code>：邮件系统</li>
<li><code>syslog</code>：syslog自身</li>
<li><code>local0</code>-<code>local7</code>：自定义设施</li>
</ul>
<h4 id="priority-优先级-："><a href="#priority-优先级-：" class="headerlink" title="priority(优先级)："></a>priority(优先级)：</h4><ul>
<li><code>emerg</code>：紧急情况</li>
<li><code>alert</code>：需要立即处理</li>
<li><code>crit</code>：严重错误</li>
<li><code>err</code>：一般错误</li>
<li><code>warning</code>：警告</li>
<li><code>notice</code>：重要通知</li>
<li><code>info</code>：一般信息</li>
<li><code>debug</code>：调试信息</li>
</ul>
<h4 id="输出目标："><a href="#输出目标：" class="headerlink" title="输出目标："></a>输出目标：</h4><ul>
<li>文件名：如<code>/var/log/messages</code></li>
<li><code>@host</code>：远程syslog服务器</li>
<li>用户名：发送到用户终端</li>
<li><code>*</code>：所有用户终端</li>
</ul>
<h3 id="3-2-logger-命令"><a href="#3-2-logger-命令" class="headerlink" title="3.2 logger 命令"></a>3.2 logger 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logger -p syslog.info -t TEST <span class="string">&quot;测试日志消息&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-常用日志文件"><a href="#3-3-常用日志文件" class="headerlink" title="3.3 常用日志文件"></a>3.3 常用日志文件</h3><ul>
<li><code>/var/log/secure</code>：认证日志</li>
<li><code>/var/log/messages</code>：系统消息</li>
<li><code>/var/log/boot.log</code>：启动日志</li>
</ul>
<h3 id="3-4-用户登录信息"><a href="#3-4-用户登录信息" class="headerlink" title="3.4 用户登录信息"></a>3.4 用户登录信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">who</span>          <span class="comment"># 显示当前登录用户</span></span><br><span class="line">w            <span class="comment"># 显示详细登录信息</span></span><br><span class="line">last         <span class="comment"># 显示登录历史</span></span><br><span class="line">lastlog      <span class="comment"># 显示用户最近登录时间</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-日志轮转"><a href="#3-5-日志轮转" class="headerlink" title="3.5 日志轮转"></a>3.5 日志轮转</h3><p>配置文件：<code>/etc/logrotate.conf</code></p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">weekly</span><br><span class="line">rotate 4</span><br><span class="line">create</span><br><span class="line">compress</span><br><span class="line"></span><br><span class="line">/var/log/wtmp &#123;</span><br><span class="line">    monthly</span><br><span class="line">    create 0664 root utmp</span><br><span class="line">    rotate 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-邮件系统"><a href="#4-邮件系统" class="headerlink" title="4. 邮件系统"></a>4. 邮件系统</h2><h3 id="4-1-邮件组件"><a href="#4-1-邮件组件" class="headerlink" title="4.1 邮件组件"></a>4.1 邮件组件</h3><ul>
<li><strong>MTA</strong>(邮件传输代理)：sendmail&#x2F;postfix&#x2F;exim</li>
<li><strong>MDA</strong>(邮件投递代理)：procmail</li>
<li><strong>MUA</strong>(邮件用户代理)：mail&#x2F;mutt&#x2F;thunderbird</li>
</ul>
<h3 id="4-2-启动MTA"><a href="#4-2-启动MTA" class="headerlink" title="4.2 启动MTA"></a>4.2 启动MTA</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service sendmail start</span><br><span class="line">service postfix start</span><br><span class="line">service exim4 start</span><br></pre></td></tr></table></figure>

<h3 id="4-3-mail-命令"><a href="#4-3-mail-命令" class="headerlink" title="4.3 mail 命令"></a>4.3 mail 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mail -s <span class="string">&quot;测试邮件&quot;</span> user@example.com</span><br><span class="line">邮件正文...</span><br><span class="line">.   <span class="comment"># 单独一行输入点结束</span></span><br><span class="line">Cc: <span class="comment"># 抄送地址(可选)</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-邮件转发"><a href="#4-4-邮件转发" class="headerlink" title="4.4 邮件转发"></a>4.4 邮件转发</h3><h4 id="etc-aliases"><a href="#etc-aliases" class="headerlink" title="&#x2F;etc&#x2F;aliases"></a>&#x2F;etc&#x2F;aliases</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root: admin,lpic</span><br></pre></td></tr></table></figure>
<p>更新别名数据库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newaliases</span><br></pre></td></tr></table></figure>

<h4 id="用户-forward文件"><a href="#用户-forward文件" class="headerlink" title="用户.forward文件"></a>用户.forward文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/home/user/.forward:</span><br><span class="line">user2@example.com</span><br></pre></td></tr></table></figure>

<h2 id="5-打印系统"><a href="#5-打印系统" class="headerlink" title="5. 打印系统"></a>5. 打印系统</h2><h3 id="5-1-CUPS打印系统"><a href="#5-1-CUPS打印系统" class="headerlink" title="5.1 CUPS打印系统"></a>5.1 CUPS打印系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service cups start  <span class="comment"># 启动CUPS服务</span></span><br></pre></td></tr></table></figure>

<p>主要配置文件：</p>
<ul>
<li><code>/etc/cups/cupsd.conf</code>：服务配置</li>
<li><code>/etc/cups/printers.conf</code>：打印机配置</li>
<li><code>/etc/cups/ppd/</code>：PPD驱动文件</li>
</ul>
<h3 id="5-2-打印命令"><a href="#5-2-打印命令" class="headerlink" title="5.2 打印命令"></a>5.2 打印命令</h3><h4 id="lpr-打印文件"><a href="#lpr-打印文件" class="headerlink" title="lpr - 打印文件"></a>lpr - 打印文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpr -P LaserJet -#2 document.pdf</span><br></pre></td></tr></table></figure>

<h4 id="lpq-查看打印队列"><a href="#lpq-查看打印队列" class="headerlink" title="lpq - 查看打印队列"></a>lpq - 查看打印队列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpq -P LaserJet</span><br></pre></td></tr></table></figure>

<h4 id="lprm-删除打印任务"><a href="#lprm-删除打印任务" class="headerlink" title="lprm - 删除打印任务"></a>lprm - 删除打印任务</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lprm -P LaserJet 123  <span class="comment"># 删除指定任务</span></span><br><span class="line">lprm -P LaserJet -    <span class="comment"># 删除用户所有任务</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-Web管理界面"><a href="#5-3-Web管理界面" class="headerlink" title="5.3 Web管理界面"></a>5.3 Web管理界面</h3><p>访问：<a target="_blank" rel="noopener" href="http://localhost:631/">http://localhost:631</a></p>
<h2 id="6-定时任务管理"><a href="#6-定时任务管理" class="headerlink" title="6. 定时任务管理"></a>6. 定时任务管理</h2><h3 id="6-1-cron-定时任务系统"><a href="#6-1-cron-定时任务系统" class="headerlink" title="6.1 cron 定时任务系统"></a>6.1 cron 定时任务系统</h3><h4 id="crontab-命令"><a href="#crontab-命令" class="headerlink" title="crontab 命令"></a>crontab 命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab -e            <span class="comment"># 编辑当前用户的crontab</span></span><br><span class="line">crontab -l            <span class="comment"># 列出当前用户的crontab</span></span><br><span class="line">crontab -r            <span class="comment"># 删除当前用户的crontab</span></span><br><span class="line">crontab -u user -e    <span class="comment"># 编辑指定用户的crontab(root权限)</span></span><br></pre></td></tr></table></figure>

<h4 id="crontab-文件格式"><a href="#crontab-文件格式" class="headerlink" title="crontab 文件格式"></a>crontab 文件格式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* * * * * command_to_execute</span><br><span class="line">│ │ │ │ │</span><br><span class="line">│ │ │ │ └── 星期几 (0-6, 0=星期日)</span><br><span class="line">│ │ │ └──── 月份 (1-12)</span><br><span class="line">│ │ └────── 日 (1-31)</span><br><span class="line">│ └──────── 小时 (0-23)</span><br><span class="line">└────────── 分钟 (0-59)</span><br></pre></td></tr></table></figure>

<p>特殊字符：</p>
<ul>
<li><code>*</code>：所有有效值</li>
<li><code>,</code>：值列表分隔符(如1,3,5)</li>
<li><code>-</code>：范围(如1-5)</li>
<li><code>/</code>：步长(如*&#x2F;2表示每2个单位)</li>
</ul>
<h4 id="系统cron目录"><a href="#系统cron目录" class="headerlink" title="系统cron目录"></a>系统cron目录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/etc/crontab           <span class="comment"># 系统级crontab文件</span></span><br><span class="line">/etc/cron.d/           <span class="comment"># 系统cron片段</span></span><br><span class="line">/etc/cron.hourly/      <span class="comment"># 每小时执行</span></span><br><span class="line">/etc/cron.daily/       <span class="comment"># 每天执行</span></span><br><span class="line">/etc/cron.weekly/      <span class="comment"># 每周执行</span></span><br><span class="line">/etc/cron.monthly/     <span class="comment"># 每月执行</span></span><br></pre></td></tr></table></figure>

<h4 id="anacron"><a href="#anacron" class="headerlink" title="anacron"></a>anacron</h4><ul>
<li>用于在系统停机后执行错过的定时任务</li>
<li>配置文件：<code>/etc/anacrontab</code></li>
</ul>
<h3 id="6-2-at-一次性任务"><a href="#6-2-at-一次性任务" class="headerlink" title="6.2 at 一次性任务"></a>6.2 at 一次性任务</h3><h4 id="at-命令"><a href="#at-命令" class="headerlink" title="at 命令"></a>at 命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">at 17:00 tomorrow      <span class="comment"># 创建定时任务</span></span><br><span class="line">at -f job.sh 23:00     <span class="comment"># 从文件读取任务</span></span><br><span class="line">atq                    <span class="comment"># 查看待执行任务(at -l)</span></span><br><span class="line">atrm 3                 <span class="comment"># 删除任务3(at -d 3)</span></span><br></pre></td></tr></table></figure>

<h4 id="时间格式"><a href="#时间格式" class="headerlink" title="时间格式"></a>时间格式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HH:MM                  # 24小时制(如23:00)</span><br><span class="line">noon/midnight          # 中午12点/午夜12点</span><br><span class="line">today/tomorrow         # 今天/明天</span><br><span class="line">now + count time-units # 如now + 3 days</span><br></pre></td></tr></table></figure>

<h3 id="6-3-batch-低负荷执行"><a href="#6-3-batch-低负荷执行" class="headerlink" title="6.3 batch 低负荷执行"></a>6.3 batch 低负荷执行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">batch                  <span class="comment"># 进入交互式输入模式</span></span><br><span class="line">batch -f job.sh        <span class="comment"># 从文件读取任务</span></span><br></pre></td></tr></table></figure>

<h3 id="6-4-访问控制"><a href="#6-4-访问控制" class="headerlink" title="6.4 访问控制"></a>6.4 访问控制</h3><h4 id="cron-访问控制"><a href="#cron-访问控制" class="headerlink" title="cron 访问控制"></a>cron 访问控制</h4><ol>
<li>如存在<code>/etc/cron.allow</code>，仅允许文件内用户</li>
<li>如无allow文件，检查<code>/etc/cron.deny</code>，拒绝文件内用户</li>
<li>如两者都不存在，默认行为取决于系统配置</li>
</ol>
<h4 id="at-访问控制"><a href="#at-访问控制" class="headerlink" title="at 访问控制"></a>at 访问控制</h4><ol>
<li>如存在<code>/etc/at.allow</code>，仅允许文件内用户</li>
<li>如无allow文件，检查<code>/etc/at.deny</code>，拒绝文件内用户</li>
<li>如两者都不存在，默认只有root可用</li>
</ol>
<h2 id="7-本地化与国际化"><a href="#7-本地化与国际化" class="headerlink" title="7. 本地化与国际化"></a>7. 本地化与国际化</h2><h3 id="7-1-本地化变量"><a href="#7-1-本地化变量" class="headerlink" title="7.1 本地化变量"></a>7.1 本地化变量</h3><table>
<thead>
<tr>
<th>变量</th>
<th>作用域</th>
</tr>
</thead>
<tbody><tr>
<td><code>LC_CTYPE</code></td>
<td>字符分类和大小写转换</td>
</tr>
<tr>
<td><code>LC_COLLATE</code></td>
<td>排序和比较规则</td>
</tr>
<tr>
<td><code>LC_MESSAGES</code></td>
<td>系统消息语言</td>
</tr>
<tr>
<td><code>LC_MONETARY</code></td>
<td>货币格式</td>
</tr>
<tr>
<td><code>LC_NUMERIC</code></td>
<td>数字格式</td>
</tr>
<tr>
<td><code>LC_TIME</code></td>
<td>日期时间格式</td>
</tr>
<tr>
<td><code>LC_ALL</code></td>
<td>覆盖所有LC_*设置</td>
</tr>
<tr>
<td><code>LANG</code></td>
<td>默认设置(未被LC_*覆盖时使用)</td>
</tr>
</tbody></table>
<h3 id="7-2-常用locale设置"><a href="#7-2-常用locale设置" class="headerlink" title="7.2 常用locale设置"></a>7.2 常用locale设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C/POSIX               <span class="comment"># 最小locale</span></span><br><span class="line">en_US.utf8            <span class="comment"># 英文(美国)</span></span><br><span class="line">ja_JP.utf8            <span class="comment"># 日文(UTF-8)</span></span><br><span class="line">ja_JP.eucJP           <span class="comment"># 日文(EUC-JP)</span></span><br><span class="line">zh_CN.utf8            <span class="comment"># 中文(简体)</span></span><br></pre></td></tr></table></figure>

<h3 id="7-3-locale-命令"><a href="#7-3-locale-命令" class="headerlink" title="7.3 locale 命令"></a>7.3 locale 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">locale -a             <span class="comment"># 列出可用locale</span></span><br><span class="line">locale -m             <span class="comment"># 列出可用字符编码</span></span><br><span class="line">locale                <span class="comment"># 显示当前locale设置</span></span><br></pre></td></tr></table></figure>

<h3 id="7-4-字符编码"><a href="#7-4-字符编码" class="headerlink" title="7.4 字符编码"></a>7.4 字符编码</h3><table>
<thead>
<tr>
<th>编码</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>ASCII</td>
<td>7位英文字符</td>
</tr>
<tr>
<td>ISO-8859</td>
<td>8位扩展ASCII</td>
</tr>
<tr>
<td>UTF-8</td>
<td>Unicode编码</td>
</tr>
<tr>
<td>EUC-JP</td>
<td>Linux日文编码</td>
</tr>
<tr>
<td>Shift_JIS</td>
<td>Windows&#x2F;Mac日文编码</td>
</tr>
<tr>
<td>ISO-2022-JP</td>
<td>邮件用日文编码</td>
</tr>
</tbody></table>
<h3 id="7-5-iconv-编码转换"><a href="#7-5-iconv-编码转换" class="headerlink" title="7.5 iconv 编码转换"></a>7.5 iconv 编码转换</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iconv -f eucjp -t utf8 input.txt &gt; output.txt  <span class="comment"># EUC-JP转UTF-8</span></span><br><span class="line">iconv -l                                      <span class="comment"># 列出支持编码</span></span><br></pre></td></tr></table></figure>

<h2 id="8-时区设置"><a href="#8-时区设置" class="headerlink" title="8. 时区设置"></a>8. 时区设置</h2><h3 id="8-1-时区文件"><a href="#8-1-时区文件" class="headerlink" title="8.1 时区文件"></a>8.1 时区文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/zoneinfo/   <span class="comment"># 所有时区定义文件</span></span><br><span class="line">/etc/localtime         <span class="comment"># 系统当前时区链接</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-设置时区方法"><a href="#8-2-设置时区方法" class="headerlink" title="8.2 设置时区方法"></a>8.2 设置时区方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1: 复制时区文件</span></span><br><span class="line"><span class="built_in">cp</span> /usr/share/zoneinfo/Asia/Tokyo /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2: 创建符号链接</span></span><br><span class="line"><span class="built_in">ln</span> -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法3: 临时设置(当前会话有效)</span></span><br><span class="line"><span class="built_in">export</span> TZ=<span class="string">&quot;Asia/Tokyo&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3-时区配置工具"><a href="#8-3-时区配置工具" class="headerlink" title="8.3 时区配置工具"></a>8.3 时区配置工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tzselect   <span class="comment"># 交互式时区选择</span></span><br><span class="line">tzconfig   <span class="comment"># 时区配置工具(部分发行版)</span></span><br><span class="line">dpkg-reconfigure tzdata  <span class="comment"># Debian系重新配置时区</span></span><br><span class="line">timedatectl set-timezone Asia/Tokyo  <span class="comment"># systemd系统设置时区</span></span><br></pre></td></tr></table></figure>

<h2 id="9-打印系统补充"><a href="#9-打印系统补充" class="headerlink" title="9. 打印系统补充"></a>9. 打印系统补充</h2><h3 id="9-1-CUPS-Web管理界面"><a href="#9-1-CUPS-Web管理界面" class="headerlink" title="9.1 CUPS Web管理界面"></a>9.1 CUPS Web管理界面</h3><p>访问：<code>http://localhost:631</code></p>
<h3 id="9-2-打印命令补充"><a href="#9-2-打印命令补充" class="headerlink" title="9.2 打印命令补充"></a>9.2 打印命令补充</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lpstat -p -d          <span class="comment"># 显示打印机状态和默认打印机</span></span><br><span class="line">lpoptions -d LaserJet <span class="comment"># 设置默认打印机</span></span><br></pre></td></tr></table></figure>

<h3 id="9-3-打印系统日志"><a href="#9-3-打印系统日志" class="headerlink" title="9.3 打印系统日志"></a>9.3 打印系统日志</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/cups/        <span class="comment"># CUPS日志目录</span></span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/05/24/linux/8-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/05/08/linux/7-XWindow/"
                            aria-label=": 7.XWindow"
                        >
                            7.XWindow
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T20:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># X Window 系统架构详解</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 基础架构</span></span><br></pre></td></tr></table></figure>
<p>localhost(X server) –X protocol– remotehost(X client)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 核心组件说明</span><br><span class="line">1. **X Server**：</span><br><span class="line">   - 负责硬件管理（显卡、显示器、输入设备等）</span><br><span class="line">   - 屏幕绘制与渲染</span><br><span class="line">   - 提供字体服务功能</span><br><span class="line">   - 典型实现：Xorg</span><br><span class="line"></span><br><span class="line">2. **X Client**：</span><br><span class="line">   - 应用程序逻辑处理</span><br><span class="line">   - 响应X Server的事件请求</span><br><span class="line">   - 例如：xterm、Firefox等GUI程序</span><br><span class="line"></span><br><span class="line">3. **X Window Manager**：</span><br><span class="line">   - 特殊的X Client</span><br><span class="line">   - 负责管理窗口布局、装饰和交互</span><br><span class="line">   - 常见WM：twm、KWin、Metacity等</span><br><span class="line"></span><br><span class="line">4. **Display Manager**：</span><br><span class="line">   - 提供图形化登录界面</span><br><span class="line">   - 负责加载用户选择的WM和语言环境</span><br><span class="line">   - 常见实现：GDM、KDM、XDM</span><br><span class="line"></span><br><span class="line">## startx 启动流程</span><br><span class="line"></span><br><span class="line">### 命令语法</span><br><span class="line">```bash</span><br><span class="line">startx [X client 参数] -- [X server 参数]</span><br></pre></td></tr></table></figure>

<h3 id="X-server-参数查找顺序"><a href="#X-server-参数查找顺序" class="headerlink" title="X server 参数查找顺序"></a>X server 参数查找顺序</h3><ol>
<li>startx 命令行参数</li>
<li>用户主目录 <code>~/.xserverrc</code></li>
<li>系统默认 <code>/etc/X11/xinit/xserverrc</code></li>
<li>最终回退 <code>/usr/bin/X</code> (X server可执行文件)</li>
</ol>
<h3 id="X-client-参数查找顺序"><a href="#X-client-参数查找顺序" class="headerlink" title="X client 参数查找顺序"></a>X client 参数查找顺序</h3><ol>
<li>startx 命令行参数</li>
<li>用户主目录 <code>~/.xinitrc</code></li>
<li>系统默认 <code>/etc/X11/xinit/xinitrc</code></li>
<li>最终回退 <code>xterm</code> (基础终端模拟器)</li>
</ol>
<h3 id="底层调用"><a href="#底层调用" class="headerlink" title="底层调用"></a>底层调用</h3><p>startx 最终调用 <code>xinit</code> 启动X系统：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit [client option] -- [server or display option]</span><br></pre></td></tr></table></figure>

<p>默认等效命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit /etc/X11/xinit/xinitrc -- /usr/bin/X</span><br></pre></td></tr></table></figure>

<p>最小化启动示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit xterm -geometry +1+1 -n login -display :0 -- X :0</span><br></pre></td></tr></table></figure>

<h2 id="配置文件体系"><a href="#配置文件体系" class="headerlink" title="配置文件体系"></a>配置文件体系</h2><h3 id="核心配置文件"><a href="#核心配置文件" class="headerlink" title="核心配置文件"></a>核心配置文件</h3><ul>
<li>主配置文件：<code>/etc/X11/xorg.conf</code></li>
<li>模块目录：<code>/usr/lib64/xorg/modules/</code></li>
<li>字体目录：<code>/usr/share/X11/fonts/</code></li>
<li>显卡驱动：<code>/usr/lib64/xorg/modules/drivers/</code></li>
</ul>
<h3 id="配置段落-Section"><a href="#配置段落-Section" class="headerlink" title="配置段落(Section)"></a>配置段落(Section)</h3><table>
<thead>
<tr>
<th>Section名称</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td>Module</td>
<td>X Server加载的功能模块</td>
</tr>
<tr>
<td>InputDevice</td>
<td>输入设备配置（键盘&#x2F;鼠标）</td>
</tr>
<tr>
<td>Files</td>
<td>字体和颜色资源路径</td>
</tr>
<tr>
<td>Monitor</td>
<td>显示器参数（刷新率等）</td>
</tr>
<tr>
<td>Device</td>
<td>显卡芯片组配置</td>
</tr>
<tr>
<td>Screen</td>
<td>显示分辨率和色深设置</td>
</tr>
<tr>
<td>ServerLayout</td>
<td>各模块的组合配置</td>
</tr>
</tbody></table>
<h3 id="配置生成工具"><a href="#配置生成工具" class="headerlink" title="配置生成工具"></a>配置生成工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Xorg -configure</span><br><span class="line"><span class="comment"># 生成测试配置文件：/root/xorg.conf.new</span></span><br><span class="line"><span class="comment"># 测试命令：X -config /root/xorg.conf.new</span></span><br></pre></td></tr></table></figure>

<h2 id="实用命令工具"><a href="#实用命令工具" class="headerlink" title="实用命令工具"></a>实用命令工具</h2><h3 id="显示调节"><a href="#显示调节" class="headerlink" title="显示调节"></a>显示调节</h3><ul>
<li><code>xvidtune</code>：GUI显示器频率调节工具</li>
<li><code>xhost</code>：X server访问控制<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xhost +hostname  <span class="comment"># 添加访问权限</span></span><br><span class="line">xhost -hostname  <span class="comment"># 移除访问权限</span></span><br><span class="line">xhost +          <span class="comment"># 允许所有主机</span></span><br><span class="line">xhost -          <span class="comment"># 禁用所有远程访问</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DISPLAY=localhost:0  <span class="comment"># 指定显示目标</span></span><br><span class="line"><span class="built_in">export</span> DISPLAY</span><br></pre></td></tr></table></figure>

<h3 id="信息查询"><a href="#信息查询" class="headerlink" title="信息查询"></a>信息查询</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td>showrgb</td>
<td>显示可用RGB颜色值</td>
</tr>
<tr>
<td>xlsclients</td>
<td>列出运行中的X客户端</td>
</tr>
<tr>
<td>xwininfo</td>
<td>查询窗口几何属性</td>
</tr>
<tr>
<td>xdpyinfo</td>
<td>显示X Server详细信息</td>
</tr>
</tbody></table>
<h2 id="显示管理器-XDM"><a href="#显示管理器-XDM" class="headerlink" title="显示管理器(XDM)"></a>显示管理器(XDM)</h2><h3 id="类型对比"><a href="#类型对比" class="headerlink" title="类型对比"></a>类型对比</h3><table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>XDM</td>
<td>基础X Display Manager</td>
</tr>
<tr>
<td>GDM</td>
<td>GNOME显示管理器</td>
</tr>
<tr>
<td>KDM</td>
<td>KDE显示管理器</td>
</tr>
</tbody></table>
<h3 id="XDM启动流程"><a href="#XDM启动流程" class="headerlink" title="XDM启动流程"></a>XDM启动流程</h3><ol>
<li>启动XDM服务</li>
<li>加载 <code>/etc/X11/Xsession</code></li>
<li>执行 <code>/etc/X11/xinit/xinitrc.d/</code> 下脚本</li>
<li>读取用户配置 <code>~/.xsession</code></li>
<li>加载 <code>~/.Xclients</code> 或 <code>/etc/X11/xinit/Xclients</code></li>
</ol>
<h3 id="关键配置文件"><a href="#关键配置文件" class="headerlink" title="关键配置文件"></a>关键配置文件</h3><table>
<thead>
<tr>
<th>文件名</th>
<th>用途描述</th>
</tr>
</thead>
<tbody><tr>
<td>xdm-config</td>
<td>基础配置和访问控制</td>
</tr>
<tr>
<td>Xaccess</td>
<td>主机访问权限设置</td>
</tr>
<tr>
<td>Xresources</td>
<td>登录界面样式和X资源定义</td>
</tr>
<tr>
<td>Xservers</td>
<td>X Server与Display映射</td>
</tr>
<tr>
<td>Xsetup_0</td>
<td>登录前环境设置（如壁纸）</td>
</tr>
<tr>
<td>Xsession</td>
<td>会话启动流程控制</td>
</tr>
</tbody></table>
<h2 id="窗口管理器列表"><a href="#窗口管理器列表" class="headerlink" title="窗口管理器列表"></a>窗口管理器列表</h2><table>
<thead>
<tr>
<th>名称</th>
<th>特点描述</th>
</tr>
</thead>
<tbody><tr>
<td>twm</td>
<td>最基本的窗口管理器</td>
</tr>
<tr>
<td>fvwm</td>
<td>轻量级窗口管理器</td>
</tr>
<tr>
<td>sawfish</td>
<td>GNOME集成WM</td>
</tr>
<tr>
<td>enlightenment</td>
<td>高定制化WM</td>
</tr>
<tr>
<td>metacity</td>
<td>GNOME默认WM</td>
</tr>
<tr>
<td>fluxbox</td>
<td>轻量级高自由度WM</td>
</tr>
<tr>
<td>WindowMaker</td>
<td>NeXTSTEP风格WM</td>
</tr>
<tr>
<td>KWin</td>
<td>KDE标准窗口管理器</td>
</tr>
</tbody></table>
<h2 id="辅助功能技术"><a href="#辅助功能技术" class="headerlink" title="辅助功能技术"></a>辅助功能技术</h2><h3 id="AccessX-功能"><a href="#AccessX-功能" class="headerlink" title="AccessX 功能"></a>AccessX 功能</h3><table>
<thead>
<tr>
<th>功能</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>粘滞键</td>
<td>分离组合键输入</td>
</tr>
<tr>
<td>慢速键</td>
<td>调整按键响应时间</td>
</tr>
<tr>
<td>防反弹键</td>
<td>防止重复输入</td>
</tr>
<tr>
<td>切换键</td>
<td>切换状态声音反馈</td>
</tr>
<tr>
<td>鼠标键</td>
<td>键盘模拟鼠标操作</td>
</tr>
</tbody></table>
<h3 id="其他辅助工具"><a href="#其他辅助工具" class="headerlink" title="其他辅助工具"></a>其他辅助工具</h3><ul>
<li><strong>高对比度显示</strong>：增强视觉可读性</li>
<li><strong>屏幕阅读器</strong>：Orca等文本转语音工具</li>
<li><strong>盲文显示器</strong>：触觉输出设备</li>
<li><strong>屏幕放大镜</strong>：视觉辅助工具</li>
<li><strong>屏幕键盘</strong>：GOK等虚拟输入工具</li>
</ul>
<h3 id="专用软件"><a href="#专用软件" class="headerlink" title="专用软件"></a>专用软件</h3><ul>
<li><strong>Orca</strong>：GNOME屏幕阅读器和放大镜</li>
<li><strong>GOK</strong>：GNOME屏幕键盘</li>
<li><strong>emacspeak</strong>：为Emacs添加语音功能</li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/05/08/linux/7-XWindow/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/05/08/linux/6-Shell%E5%8F%98%E9%87%8F%E4%B8%8EShell%E8%84%9A%E6%9C%AC/"
                            aria-label=": 6.Shell变量与Shell脚本"
                        >
                            6.Shell变量与Shell脚本
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T19:16:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Shell变量与Shell脚本"><a href="#Shell变量与Shell脚本" class="headerlink" title="Shell变量与Shell脚本"></a>Shell变量与Shell脚本</h1><h2 id="Bash设定文档"><a href="#Bash设定文档" class="headerlink" title="Bash设定文档"></a>Bash设定文档</h2><ul>
<li><strong>&#x2F;etc&#x2F;profile</strong>: 登录时执行，适用于所有用户</li>
<li><strong>~&#x2F;.bash_profile</strong>: 登录时执行</li>
<li><strong>~&#x2F;.bash_login</strong>: 当 <code>~/.bash_profile</code> 不存在时，登录时执行</li>
<li><strong>~&#x2F;.profile</strong>: 当 <code>~/.bash_profile</code> 和 <code>~/.bash_login</code> 都不存在时，登录时执行</li>
<li><strong>~&#x2F;.bashrc</strong>: 每次启动 Bash 时执行</li>
<li><strong>~&#x2F;.bash_logout</strong>: 登出时执行</li>
</ul>
<h2 id="Shell环境定制化"><a href="#Shell环境定制化" class="headerlink" title="Shell环境定制化"></a>Shell环境定制化</h2><h3 id="export命令"><a href="#export命令" class="headerlink" title="export命令"></a><code>export</code>命令</h3><p>用于将shell变量转化为环境变量，使得该变量能够被其他程序或子进程访问。</p>
<h3 id="set命令"><a href="#set命令" class="headerlink" title="set命令"></a><code>set</code>命令</h3><ul>
<li><p><code>set</code>: 显示打印当前的环境变量和Shell变量</p>
</li>
<li><p><code>set [-o] [+o] option</code>：</p>
<ul>
<li><code>-o</code>：启用该选项</li>
<li><code>+o</code>：禁用该选项</li>
<li>常用选项：<ul>
<li><code>allexport</code>: 自动将变量导出为环境变量</li>
<li><code>emacs</code>: 设置Emacs风格的键绑定</li>
<li><code>ignoreeof</code>: 禁止通过 Ctrl+D 退出Shell</li>
<li><code>noclobber</code>: 禁止文件重定向覆盖文件</li>
<li><code>noglob</code>: 禁用元字符解析</li>
<li><code>vi</code>: 设置vi风格的键绑定</li>
</ul>
</li>
</ul>
</li>
<li><p><code>set -o</code>: 显示或更改选项的状态</p>
</li>
</ul>
<h3 id="printenv命令"><a href="#printenv命令" class="headerlink" title="printenv命令"></a><code>printenv</code>命令</h3><p>用于打印当前的环境变量。</p>
<h3 id="alias-unalias"><a href="#alias-unalias" class="headerlink" title="alias&#x2F;unalias"></a><code>alias</code>&#x2F;<code>unalias</code></h3><ul>
<li><code>alias</code>: 设置命令别名</li>
<li><code>unalias</code>: 取消命令别名</li>
<li>临时解除别名：可以使用反斜杠 <code>\</code>，例如：<code>alias ls=&#39;ls -l&#39;</code> 后，<code>&#39;\ls&#39;</code> 会执行原始的 <code>ls</code> 命令。</li>
</ul>
<h2 id="定义Shell函数"><a href="#定义Shell函数" class="headerlink" title="定义Shell函数"></a>定义Shell函数</h2><ul>
<li><p>定义函数语法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> [函数名] () &#123;</span><br><span class="line">    运行内容;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<code>&#123;</code> 和 <code>&#125;</code> 前后需要有空格。</p>
</li>
<li><p>定义变量：<code>$变量名</code></p>
</li>
<li><p>函数名不能与变量名重名。</p>
</li>
<li><p>查看已定义的函数：<code>declare -f</code></p>
</li>
<li><p>删除函数：<code>unset</code></p>
</li>
</ul>
<h2 id="Shell脚本"><a href="#Shell脚本" class="headerlink" title="Shell脚本"></a>Shell脚本</h2><h3 id="执行Shell脚本"><a href="#执行Shell脚本" class="headerlink" title="执行Shell脚本"></a>执行Shell脚本</h3><ul>
<li>脚本命令可以分行书写，并逐行执行。</li>
<li>运行脚本时，如果没有执行权限，只需要文件的读取权限和文件夹的运行权限即可。<ul>
<li>使用 <code>source [脚本名]</code> 或简化版 <code>.[脚本名]</code> 执行脚本。</li>
<li>如果脚本有执行权限，可以省略 <code>source</code>，例如：<code>./[脚本名]</code>。</li>
<li>如果脚本不在 <code>PATH</code> 环境变量指定的文件夹中，需要显式指定脚本路径，或者在当前目录使用 <code>./</code>。</li>
</ul>
</li>
</ul>
<h3 id="传入Shell脚本的变量"><a href="#传入Shell脚本的变量" class="headerlink" title="传入Shell脚本的变量"></a>传入Shell脚本的变量</h3><ul>
<li><code>$0</code>：脚本文件名（全路径）</li>
<li><code>$1</code>：第一个传入的变量值</li>
<li><code>$2</code>：第二个传入的变量值</li>
<li><code>#$</code>：传入的变量数量</li>
<li><code>$@</code>：所有传入的变量值（空格分隔）</li>
<li><code>$*</code>：所有变量值（以系统默认的分隔符分隔）</li>
<li>脚本执行结束后的返回状态：<code>echo $?</code>。正常执行返回0，错误返回1。</li>
</ul>
<h3 id="文件检查"><a href="#文件检查" class="headerlink" title="文件检查"></a>文件检查</h3><p>使用 <code>test</code> 命令或者 <code>[</code> <code>]</code> 语法进行文件检查：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> 条件文</span><br><span class="line">[ 条件文 ]</span><br></pre></td></tr></table></figure>

<h4 id="常见条件文："><a href="#常见条件文：" class="headerlink" title="常见条件文："></a>常见条件文：</h4><ul>
<li><code>-f 文件名</code>：检查文件是否存在且为普通文件</li>
<li><code>-d 文件夹名</code>：检查文件夹是否存在</li>
<li><code>-r 文件名</code>：检查文件是否有读取权限</li>
<li><code>-w 文件名</code>：检查文件是否有写入权限</li>
<li><code>-x 文件名</code>：检查文件是否有执行权限</li>
<li><code>-s 文件名</code>：检查文件是否为空</li>
<li><code>-L 文件名</code>：检查是否为软链接</li>
<li><code>-e 文件名</code>：检查文件是否存在</li>
<li><code>文件名1 -nt 文件名2</code>：文件1是否比文件2新</li>
<li><code>文件名1 -ot 文件名2</code>：文件1是否比文件2旧</li>
<li>数值比较：<code>-eq</code>, <code>-ge</code>, <code>-gt</code>, <code>-le</code>, <code>-lt</code>, <code>-ne</code>（等于、大于等于、大于、小于等于、小于、不等于）</li>
<li>字符串比较：<code>-n</code>（字符串长度大于0），<code>-z</code>（字符串长度为0）</li>
<li>字符串相等：<code>字符串1 = 字符串2</code></li>
<li>字符串不等：<code>字符串1 != 字符串2</code></li>
<li>逻辑操作：<ul>
<li><code>!</code>：条件非</li>
<li><code>-a</code>：与（and）</li>
<li><code>-o</code>：或（or）</li>
</ul>
</li>
</ul>
<h2 id="条件分歧"><a href="#条件分歧" class="headerlink" title="条件分歧"></a>条件分歧</h2><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a><code>if</code>语句</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件式</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    执行文1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    执行文2</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件式; <span class="keyword">then</span></span><br><span class="line">    执行文1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    执行文2</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a><code>case</code>语句</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> 式 <span class="keyword">in</span></span><br><span class="line">    值1)</span><br><span class="line">        执行文1 ;;</span><br><span class="line">    值2)</span><br><span class="line">        执行文2 ;;</span><br><span class="line">    *)</span><br><span class="line">        执行其他文 ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<p>注意：每个 <code>执行文</code> 后面要有 <code>;;</code>，并且最后使用 <code>esac</code> 结束。</p>
<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a><code>for</code>循环</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量名 <span class="keyword">in</span> 变量值列表</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    执行文</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> Vine SUSE Gentoo</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$var</span> Linux</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>变量值列表可以通过空格分隔，也可以使用 <code>seq</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">seq</span> 10 15`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h3 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a><code>while</code>循环</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件文</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    执行文</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h3 id="read命令"><a href="#read命令" class="headerlink" title="read命令"></a><code>read</code>命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;Who are you?:&#x27;</span></span><br><span class="line"><span class="built_in">read</span> username</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello, <span class="variable">$username</span>!&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>如果 <code>echo</code> 后面跟 <code>-n</code>，则输入的提示信息和用户输入将在同一行显示。</li>
</ul>
<h2 id="指定执行Shell类型"><a href="#指定执行Shell类型" class="headerlink" title="指定执行Shell类型"></a>指定执行Shell类型</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br></pre></td></tr></table></figure>
<p>此行用于指定脚本执行时使用的Shell解释器。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/05/08/linux/6-Shell%E5%8F%98%E9%87%8F%E4%B8%8EShell%E8%84%9A%E6%9C%AC/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/05/08/linux/5-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"
                            aria-label=": 5.文件系统与存储管理"
                        >
                            5.文件系统与存储管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T19:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-磁盘配额管理"><a href="#1-磁盘配额管理" class="headerlink" title="1. 磁盘配额管理"></a>1. 磁盘配额管理</h2><h3 id="1-1-配额概念与类型"><a href="#1-1-配额概念与类型" class="headerlink" title="1.1 配额概念与类型"></a>1.1 配额概念与类型</h3><h4 id="配额类型说明"><a href="#配额类型说明" class="headerlink" title="配额类型说明"></a>配额类型说明</h4><ul>
<li><strong>硬限制(Hard Limit)</strong>：用户绝对不能超过的磁盘空间限制</li>
<li><strong>软限制(Soft Limit)</strong>：允许用户暂时超过的限制，系统会发出警告</li>
<li><strong>宽限期(Grace Period)</strong>：超过软限制后允许保留的时间（默认7天）</li>
</ul>
<h3 id="1-2-配额实施完整步骤"><a href="#1-2-配额实施完整步骤" class="headerlink" title="1.2 配额实施完整步骤"></a>1.2 配额实施完整步骤</h3><ol>
<li><p><strong>修改fstab文件</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在/etc/fstab中添加usrquota和/或grpquota选项</span></span><br><span class="line">/dev/sda1 /home ext4 defaults,usrquota,grpquota 0 2</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>重新挂载文件系统</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">umount /home</span><br><span class="line">mount -o remount /home</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>创建配额文件</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /home/aquota.user /home/aquota.group</span><br><span class="line"><span class="built_in">chmod</span> 600 /home/aquota.*</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>初始化配额数据库</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quotacheck -cugm /home</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>启用配额系统</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quotaon -avug</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>为用户设置配额</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edquota username</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-3-配额管理命令详解"><a href="#1-3-配额管理命令详解" class="headerlink" title="1.3 配额管理命令详解"></a>1.3 配额管理命令详解</h3><h4 id="quota-显示配额信息"><a href="#quota-显示配额信息" class="headerlink" title="quota - 显示配额信息"></a>quota - 显示配额信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">quota -u username  <span class="comment"># 显示用户配额</span></span><br><span class="line">quota -g groupname <span class="comment"># 显示组配额</span></span><br><span class="line">quota -v           <span class="comment"># 显示详细信息</span></span><br></pre></td></tr></table></figure>

<h4 id="quotacheck-检查配额"><a href="#quotacheck-检查配额" class="headerlink" title="quotacheck - 检查配额"></a>quotacheck - 检查配额</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quotacheck -avug  <span class="comment"># 检查所有文件系统配额</span></span><br><span class="line">quotacheck -cug /home  <span class="comment"># 检查指定文件系统</span></span><br></pre></td></tr></table></figure>

<h4 id="quotaon-quotaoff-启用-禁用配额"><a href="#quotaon-quotaoff-启用-禁用配额" class="headerlink" title="quotaon&#x2F;quotaoff - 启用&#x2F;禁用配额"></a>quotaon&#x2F;quotaoff - 启用&#x2F;禁用配额</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quotaon -avug     <span class="comment"># 启用所有配额</span></span><br><span class="line">quotaoff /home    <span class="comment"># 禁用指定文件系统配额</span></span><br></pre></td></tr></table></figure>

<h4 id="edquota-编辑配额"><a href="#edquota-编辑配额" class="headerlink" title="edquota - 编辑配额"></a>edquota - 编辑配额</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">edquota -u username  <span class="comment"># 编辑用户配额</span></span><br><span class="line">edquota -p template_user new_user  <span class="comment"># 复制配额设置</span></span><br><span class="line">edquota -t           <span class="comment"># 修改宽限期</span></span><br></pre></td></tr></table></figure>

<h4 id="repquota-报告配额状态"><a href="#repquota-报告配额状态" class="headerlink" title="repquota - 报告配额状态"></a>repquota - 报告配额状态</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">repquota -a       <span class="comment"># 报告所有文件系统配额状态</span></span><br><span class="line">repquota -u /home <span class="comment"># 报告/home的用户配额</span></span><br></pre></td></tr></table></figure>

<h2 id="2-文件系统层次标准-FHS"><a href="#2-文件系统层次标准-FHS" class="headerlink" title="2. 文件系统层次标准(FHS)"></a>2. 文件系统层次标准(FHS)</h2><h3 id="2-1-核心目录结构"><a href="#2-1-核心目录结构" class="headerlink" title="2.1 核心目录结构"></a>2.1 核心目录结构</h3><table>
<thead>
<tr>
<th>目录</th>
<th>完整描述</th>
<th>典型内容</th>
</tr>
</thead>
<tbody><tr>
<td><code>/bin</code></td>
<td>基础命令二进制文件</td>
<td>ls, cp, mv等基本命令</td>
</tr>
<tr>
<td><code>/sbin</code></td>
<td>系统管理二进制文件</td>
<td>fdisk, fsck, ifconfig等</td>
</tr>
<tr>
<td><code>/etc</code></td>
<td>系统配置文件</td>
<td>passwd, fstab, network等配置文件</td>
</tr>
<tr>
<td><code>/dev</code></td>
<td>设备文件</td>
<td>sda, tty, null等设备节点</td>
</tr>
<tr>
<td><code>/lib</code></td>
<td>系统库文件</td>
<td>系统运行所需共享库</td>
</tr>
<tr>
<td><code>/mnt</code></td>
<td>临时挂载点</td>
<td>临时挂载文件系统的目录</td>
</tr>
<tr>
<td><code>/opt</code></td>
<td>可选应用软件包</td>
<td>第三方应用程序</td>
</tr>
<tr>
<td><code>/proc</code></td>
<td>进程和内核信息</td>
<td>虚拟文件系统，提供系统信息</td>
</tr>
<tr>
<td><code>/root</code></td>
<td>root用户主目录</td>
<td>root用户的个人文件和配置</td>
</tr>
<tr>
<td><code>/boot</code></td>
<td>启动加载文件</td>
<td>vmlinuz, initramfs, grub等</td>
</tr>
<tr>
<td><code>/home</code></td>
<td>用户主目录</td>
<td>普通用户的个人目录</td>
</tr>
<tr>
<td><code>/tmp</code></td>
<td>临时文件</td>
<td>系统重启后通常清空</td>
</tr>
<tr>
<td><code>/var</code></td>
<td>可变数据文件</td>
<td>日志、邮件、数据库等</td>
</tr>
<tr>
<td><code>/usr</code></td>
<td>用户程序资源</td>
<td>应用程序、文档、库文件等</td>
</tr>
</tbody></table>
<h2 id="3-分区与文件系统管理"><a href="#3-分区与文件系统管理" class="headerlink" title="3. 分区与文件系统管理"></a>3. 分区与文件系统管理</h2><h3 id="3-1-分区管理"><a href="#3-1-分区管理" class="headerlink" title="3.1 分区管理"></a>3.1 分区管理</h3><h4 id="fdisk-完整操作流程"><a href="#fdisk-完整操作流程" class="headerlink" title="fdisk 完整操作流程"></a>fdisk 完整操作流程</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sdb</span><br></pre></td></tr></table></figure>
<p>交互命令列表：</p>
<ul>
<li><code>n</code>：创建新分区</li>
<li><code>d</code>：删除分区</li>
<li><code>p</code>：显示分区表</li>
<li><code>t</code>：更改分区类型</li>
<li><code>a</code>：切换启动标志</li>
<li><code>w</code>：写入并退出</li>
<li><code>q</code>：不保存退出</li>
<li><code>m</code>：显示帮助菜单</li>
</ul>
<h3 id="3-2-文件系统创建与管理"><a href="#3-2-文件系统创建与管理" class="headerlink" title="3.2 文件系统创建与管理"></a>3.2 文件系统创建与管理</h3><h4 id="mkfs-命令集"><a href="#mkfs-命令集" class="headerlink" title="mkfs 命令集"></a>mkfs 命令集</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkfs -t ext4 /dev/sdb1      <span class="comment"># 创建ext4文件系统</span></span><br><span class="line">mkfs.ext4 /dev/sdb1         <span class="comment"># 同上</span></span><br><span class="line">mkfs.xfs /dev/sdb2          <span class="comment"># 创建XFS文件系统</span></span><br><span class="line">mkfs.btrfs /dev/sdb3        <span class="comment"># 创建Btrfs文件系统</span></span><br></pre></td></tr></table></figure>

<h4 id="交换空间管理"><a href="#交换空间管理" class="headerlink" title="交换空间管理"></a>交换空间管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkswap /dev/sdb4            <span class="comment"># 创建交换分区</span></span><br><span class="line">swapon /dev/sdb4            <span class="comment"># 启用交换分区</span></span><br><span class="line">swapon -s                   <span class="comment"># 显示交换空间状态</span></span><br><span class="line">swapoff /dev/sdb4           <span class="comment"># 禁用交换分区</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-文件系统检查与维护"><a href="#3-3-文件系统检查与维护" class="headerlink" title="3.3 文件系统检查与维护"></a>3.3 文件系统检查与维护</h3><h4 id="fsck-系列命令"><a href="#fsck-系列命令" class="headerlink" title="fsck 系列命令"></a>fsck 系列命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fsck /dev/sdb1              <span class="comment"># 基本文件系统检查</span></span><br><span class="line">fsck -y /dev/sdb1           <span class="comment"># 自动修复错误</span></span><br><span class="line">e2fsck -p /dev/sdb1         <span class="comment"># ext文件系统自动修复</span></span><br><span class="line">xfs_repair /dev/sdb2        <span class="comment"># XFS文件系统修复</span></span><br></pre></td></tr></table></figure>

<h4 id="tune2fs-调整参数"><a href="#tune2fs-调整参数" class="headerlink" title="tune2fs 调整参数"></a>tune2fs 调整参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -c 30 /dev/sdb1     <span class="comment"># 设置每30次挂载后检查</span></span><br><span class="line">tune2fs -i 15d /dev/sdb1    <span class="comment"># 设置15天间隔检查</span></span><br><span class="line">tune2fs -L DATA /dev/sdb1   <span class="comment"># 设置卷标为DATA</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-空间监控命令"><a href="#3-4-空间监控命令" class="headerlink" title="3.4 空间监控命令"></a>3.4 空间监控命令</h3><h4 id="df-详细用法"><a href="#df-详细用法" class="headerlink" title="df 详细用法"></a>df 详细用法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h                       <span class="comment"># 人类可读格式</span></span><br><span class="line"><span class="built_in">df</span> -i                       <span class="comment"># 显示inode使用情况</span></span><br><span class="line"><span class="built_in">df</span> -T                       <span class="comment"># 显示文件系统类型</span></span><br><span class="line"><span class="built_in">df</span> --total                  <span class="comment"># 显示总计信息</span></span><br></pre></td></tr></table></figure>

<h4 id="du-详细用法"><a href="#du-详细用法" class="headerlink" title="du 详细用法"></a>du 详细用法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">du</span> -sh /var/log             <span class="comment"># 显示目录总大小</span></span><br><span class="line"><span class="built_in">du</span> -ah /home                <span class="comment"># 显示所有文件和目录大小</span></span><br><span class="line"><span class="built_in">du</span> -csh *                   <span class="comment"># 显示当前目录各项目大小和总计</span></span><br><span class="line"><span class="built_in">du</span> --max-depth=1 /usr       <span class="comment"># 只显示一级子目录大小</span></span><br></pre></td></tr></table></figure>

<h2 id="4-文件搜索命令"><a href="#4-文件搜索命令" class="headerlink" title="4. 文件搜索命令"></a>4. 文件搜索命令</h2><h3 id="4-1-find-命令完整用法"><a href="#4-1-find-命令完整用法" class="headerlink" title="4.1 find 命令完整用法"></a>4.1 find 命令完整用法</h3><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find [路径] [选项] [操作]</span><br></pre></td></tr></table></figure>

<h4 id="常用示例"><a href="#常用示例" class="headerlink" title="常用示例"></a>常用示例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;*.conf&quot;</span>               <span class="comment"># 按名称查找</span></span><br><span class="line">find /home -user alice              <span class="comment"># 按属主查找</span></span><br><span class="line">find /var/log -mtime -7             <span class="comment"># 查找7天内修改的文件</span></span><br><span class="line">find /tmp -size +10M                <span class="comment"># 查找大于10MB的文件</span></span><br><span class="line">find . -perm 644                    <span class="comment"># 查找权限为644的文件</span></span><br><span class="line">find /etc -<span class="built_in">type</span> f -<span class="built_in">exec</span> grep -l <span class="string">&quot;error&quot;</span> &#123;&#125; \;  <span class="comment"># 结合grep</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-locate-updatedb-系统"><a href="#4-2-locate-updatedb-系统" class="headerlink" title="4.2 locate&#x2F;updatedb 系统"></a>4.2 locate&#x2F;updatedb 系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">locate passwd              <span class="comment"># 快速查找文件</span></span><br><span class="line">updatedb                   <span class="comment"># 更新数据库</span></span><br><span class="line">updatedb -e /mnt           <span class="comment"># 排除/mnt目录</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-which-whereis-type"><a href="#4-3-which-whereis-type" class="headerlink" title="4.3 which&#x2F;whereis&#x2F;type"></a>4.3 which&#x2F;whereis&#x2F;type</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> <span class="built_in">ls</span>                   <span class="comment"># 查找命令路径</span></span><br><span class="line">whereis python             <span class="comment"># 查找命令相关文件</span></span><br><span class="line"><span class="built_in">type</span> -a <span class="built_in">cd</span>                 <span class="comment"># 显示命令类型</span></span><br></pre></td></tr></table></figure>

<h2 id="5-挂载管理"><a href="#5-挂载管理" class="headerlink" title="5. 挂载管理"></a>5. 挂载管理</h2><h3 id="5-1-挂载选项详解"><a href="#5-1-挂载选项详解" class="headerlink" title="5.1 挂载选项详解"></a>5.1 挂载选项详解</h3><table>
<thead>
<tr>
<th>选项</th>
<th>完整描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>async/sync</code></td>
<td>异步&#x2F;同步写入</td>
</tr>
<tr>
<td><code>auto/noauto</code></td>
<td>是否允许mount -a自动挂载</td>
</tr>
<tr>
<td><code>exec/noexec</code></td>
<td>是否允许执行二进制文件</td>
</tr>
<tr>
<td><code>ro/rw</code></td>
<td>只读&#x2F;读写模式</td>
</tr>
<tr>
<td><code>suid/nosuid</code></td>
<td>是否允许SUID&#x2F;SGID</td>
</tr>
<tr>
<td><code>user/nouser</code></td>
<td>是否允许普通用户挂载</td>
</tr>
<tr>
<td><code>defaults</code></td>
<td>默认选项(rw,suid,dev,exec,auto,nouser,async)</td>
</tr>
</tbody></table>
<h3 id="5-2-mount-umount-完整用法"><a href="#5-2-mount-umount-完整用法" class="headerlink" title="5.2 mount&#x2F;umount 完整用法"></a>5.2 mount&#x2F;umount 完整用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sdb1 /mnt/data           <span class="comment"># 基本挂载</span></span><br><span class="line">mount -o remount,ro /mnt/data       <span class="comment"># 重新挂载为只读</span></span><br><span class="line">mount -t nfs server:/share /mnt/nfs <span class="comment"># 挂载NFS</span></span><br><span class="line">umount /mnt/data                    <span class="comment"># 卸载</span></span><br><span class="line">umount -l /mnt/data                 <span class="comment"># 延迟卸载</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-etc-fstab-文件格式"><a href="#5-3-etc-fstab-文件格式" class="headerlink" title="5.3 &#x2F;etc&#x2F;fstab 文件格式"></a>5.3 &#x2F;etc&#x2F;fstab 文件格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 设备文件/挂载点/文件系统类型/选项/备份标记/检查顺序</span><br><span class="line">/dev/sdb1  /data  ext4  defaults  0  2</span><br><span class="line">UUID=xxxx  /home  xfs   defaults  0  1</span><br></pre></td></tr></table></figure>

<h2 id="6-逻辑卷管理-LVM"><a href="#6-逻辑卷管理-LVM" class="headerlink" title="6. 逻辑卷管理(LVM)"></a>6. 逻辑卷管理(LVM)</h2><h3 id="6-1-LVM-基本概念"><a href="#6-1-LVM-基本概念" class="headerlink" title="6.1 LVM 基本概念"></a>6.1 LVM 基本概念</h3><ol>
<li><strong>PV(Physical Volume)</strong>：物理卷，实际存储设备</li>
<li><strong>VG(Volume Group)</strong>：卷组，由PV组成的存储池</li>
<li><strong>LV(Logical Volume)</strong>：逻辑卷，从VG划分的可挂载空间</li>
<li><strong>PE(Physical Extent)</strong>：物理块，LVM最小分配单元(默认4MB)</li>
<li><strong>LE(Logical Extent)</strong>：逻辑块，与PE一一对应</li>
</ol>
<h3 id="6-2-LVM-完整操作流程"><a href="#6-2-LVM-完整操作流程" class="headerlink" title="6.2 LVM 完整操作流程"></a>6.2 LVM 完整操作流程</h3><h4 id="物理卷-PV-管理"><a href="#物理卷-PV-管理" class="headerlink" title="物理卷(PV)管理"></a>物理卷(PV)管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pvcreate /dev/sdb /dev/sdc          <span class="comment"># 创建PV</span></span><br><span class="line">pvdisplay                           <span class="comment"># 显示PV信息</span></span><br><span class="line">pvmove /dev/sdb                     <span class="comment"># 迁移PV数据</span></span><br><span class="line">pvremove /dev/sdb                   <span class="comment"># 删除PV</span></span><br></pre></td></tr></table></figure>

<h4 id="卷组-VG-管理"><a href="#卷组-VG-管理" class="headerlink" title="卷组(VG)管理"></a>卷组(VG)管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vgcreate vg_data /dev/sdb /dev/sdc  <span class="comment"># 创建VG</span></span><br><span class="line">vgextend vg_data /dev/sdd           <span class="comment"># 扩展VG</span></span><br><span class="line">vgreduce vg_data /dev/sdb           <span class="comment"># 缩减VG</span></span><br><span class="line">vgdisplay                           <span class="comment"># 显示VG信息</span></span><br><span class="line">vgremove vg_data                    <span class="comment"># 删除VG</span></span><br></pre></td></tr></table></figure>

<h4 id="逻辑卷-LV-管理"><a href="#逻辑卷-LV-管理" class="headerlink" title="逻辑卷(LV)管理"></a>逻辑卷(LV)管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lvcreate -L 50G -n lv_home vg_data  <span class="comment"># 创建50G逻辑卷</span></span><br><span class="line">lvextend -L +10G /dev/vg_data/lv_home <span class="comment"># 扩展10G</span></span><br><span class="line">lvreduce -L -5G /dev/vg_data/lv_home <span class="comment"># 缩减5G</span></span><br><span class="line">lvresize -L 60G /dev/vg_data/lv_home <span class="comment"># 调整到60G</span></span><br><span class="line">lvdisplay                           <span class="comment"># 显示LV信息</span></span><br><span class="line">lvremove /dev/vg_data/lv_home       <span class="comment"># 删除LV</span></span><br></pre></td></tr></table></figure>

<h4 id="文件系统扩展"><a href="#文件系统扩展" class="headerlink" title="文件系统扩展"></a>文件系统扩展</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于ext2/3/4文件系统</span></span><br><span class="line">resize2fs /dev/vg_data/lv_home</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于XFS文件系统</span></span><br><span class="line">xfs_growfs /dev/vg_data/lv_home</span><br></pre></td></tr></table></figure>

<h3 id="6-3-LVM-快照功能"><a href="#6-3-LVM-快照功能" class="headerlink" title="6.3 LVM 快照功能"></a>6.3 LVM 快照功能</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lvcreate -L 10G -s -n snap_home /dev/vg_data/lv_home  <span class="comment"># 创建快照</span></span><br><span class="line">mount /dev/vg_data/snap_home /mnt/snapshot           <span class="comment"># 挂载快照</span></span><br><span class="line">umount /mnt/snapshot                                 <span class="comment"># 卸载快照</span></span><br><span class="line">lvremove /dev/vg_data/snap_home                      <span class="comment"># 删除快照</span></span><br></pre></td></tr></table></figure>

<h3 id="6-4-LVM-信息查看命令"><a href="#6-4-LVM-信息查看命令" class="headerlink" title="6.4 LVM 信息查看命令"></a>6.4 LVM 信息查看命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pvs        <span class="comment"># 简要PV信息</span></span><br><span class="line">vgs        <span class="comment"># 简要VG信息</span></span><br><span class="line">lvs        <span class="comment"># 简要LV信息</span></span><br><span class="line">pvdisplay  <span class="comment"># 详细PV信息</span></span><br><span class="line">vgdisplay  <span class="comment"># 详细VG信息</span></span><br><span class="line">lvdisplay  <span class="comment"># 详细LV信息</span></span><br><span class="line">lsblk      <span class="comment"># 块设备层次结构</span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/05/08/linux/5-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../2020/05/08/linux/4-%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E7%AE%A1%E7%90%86/"
                            aria-label=": 4.文件和程序管理"
                        >
                            4.文件和程序管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T16:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-用户权限管理"><a href="#1-用户权限管理" class="headerlink" title="1. 用户权限管理"></a>1. 用户权限管理</h2><h3 id="1-1-文件权限基础"><a href="#1-1-文件权限基础" class="headerlink" title="1.1 文件权限基础"></a>1.1 文件权限基础</h3><h4 id="权限表示法"><a href="#权限表示法" class="headerlink" title="权限表示法"></a>权限表示法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">d rwx r-x r--</span><br><span class="line">↑ ↑   ↑   ↑</span><br><span class="line">│ │   │   └─ 其他用户权限(r--)</span><br><span class="line">│ │   └─── 所属组权限(r-x)</span><br><span class="line">│ └────── 所有者权限(rwx)</span><br><span class="line">└──────── 文件类型(d=目录)</span><br></pre></td></tr></table></figure>

<h4 id="权限数值"><a href="#权限数值" class="headerlink" title="权限数值"></a>权限数值</h4><ul>
<li>r(读): 4</li>
<li>w(写): 2</li>
<li>x(执行): 1</li>
</ul>
<h3 id="1-2-chmod-命令"><a href="#1-2-chmod-命令" class="headerlink" title="1.2 chmod 命令"></a>1.2 chmod 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> [选项] 权限 文件</span><br></pre></td></tr></table></figure>

<h4 id="常用选项"><a href="#常用选项" class="headerlink" title="常用选项"></a>常用选项</h4><ul>
<li><code>-R</code>: 递归修改目录下所有文件</li>
</ul>
<h4 id="权限设置方法"><a href="#权限设置方法" class="headerlink" title="权限设置方法"></a>权限设置方法</h4><ol>
<li><p><strong>符号法</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> u+x file      <span class="comment"># 给所有者添加执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> g-w file      <span class="comment"># 移除组的写权限</span></span><br><span class="line"><span class="built_in">chmod</span> o=rx file     <span class="comment"># 设置其他用户为读执行</span></span><br><span class="line"><span class="built_in">chmod</span> a+r file      <span class="comment"># 给所有用户添加读权限</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>数字法</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 755 file      <span class="comment"># rwxr-xr-x</span></span><br><span class="line"><span class="built_in">chmod</span> 644 file      <span class="comment"># rw-r--r--</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-3-特殊权限"><a href="#1-3-特殊权限" class="headerlink" title="1.3 特殊权限"></a>1.3 特殊权限</h3><table>
<thead>
<tr>
<th>权限</th>
<th>数值</th>
<th>设置方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>SUID</td>
<td>4000</td>
<td><code>u+s</code></td>
<td>执行时以文件所有者权限运行</td>
</tr>
<tr>
<td>SGID</td>
<td>2000</td>
<td><code>g+s</code></td>
<td>执行时以文件所属组权限运行</td>
</tr>
<tr>
<td>Sticky</td>
<td>1000</td>
<td><code>o+t</code></td>
<td>目录中文件只有所有者能删除</td>
</tr>
</tbody></table>
<h3 id="1-4-umask-命令"><a href="#1-4-umask-命令" class="headerlink" title="1.4 umask 命令"></a>1.4 umask 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">umask</span>           <span class="comment"># 查看当前umask值</span></span><br><span class="line"><span class="built_in">umask</span> 022       <span class="comment"># 设置新的umask值</span></span><br></pre></td></tr></table></figure>
<ul>
<li>文件默认权限: <code>666 - umask</code></li>
<li>目录默认权限: <code>777 - umask</code></li>
</ul>
<h3 id="1-5-ACL-高级权限控制"><a href="#1-5-ACL-高级权限控制" class="headerlink" title="1.5 ACL 高级权限控制"></a>1.5 ACL 高级权限控制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setfacl -m u:user:rwx file   <span class="comment"># 添加用户ACL</span></span><br><span class="line">setfacl -x u:user file       <span class="comment"># 删除用户ACL</span></span><br><span class="line">getfacl file                 <span class="comment"># 查看ACL权限</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6-所有权管理"><a href="#1-6-所有权管理" class="headerlink" title="1.6 所有权管理"></a>1.6 所有权管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> user:group file        <span class="comment"># 修改所有者和组</span></span><br><span class="line"><span class="built_in">chown</span> -R user:group <span class="built_in">dir</span>      <span class="comment"># 递归修改</span></span><br><span class="line"><span class="built_in">chgrp</span> group file             <span class="comment"># 修改文件所属组</span></span><br></pre></td></tr></table></figure>

<h2 id="2-链接管理"><a href="#2-链接管理" class="headerlink" title="2. 链接管理"></a>2. 链接管理</h2><h3 id="2-1-链接类型对比"><a href="#2-1-链接类型对比" class="headerlink" title="2.1 链接类型对比"></a>2.1 链接类型对比</h3><table>
<thead>
<tr>
<th>特性</th>
<th>硬链接</th>
<th>软链接</th>
</tr>
</thead>
<tbody><tr>
<td>inode</td>
<td>相同</td>
<td>不同</td>
</tr>
<tr>
<td>跨文件系统</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>链接目录</td>
<td>不允许</td>
<td>允许</td>
</tr>
<tr>
<td>原文件删除</td>
<td>仍可访问</td>
<td>失效</td>
</tr>
</tbody></table>
<h3 id="2-2-ln-命令"><a href="#2-2-ln-命令" class="headerlink" title="2.2 ln 命令"></a>2.2 ln 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> <span class="built_in">source</span> <span class="built_in">link</span>        <span class="comment"># 创建硬链接</span></span><br><span class="line"><span class="built_in">ln</span> -s <span class="built_in">source</span> <span class="built_in">link</span>     <span class="comment"># 创建软链接</span></span><br></pre></td></tr></table></figure>

<h2 id="3-进程管理"><a href="#3-进程管理" class="headerlink" title="3. 进程管理"></a>3. 进程管理</h2><h3 id="3-1-ps-命令"><a href="#3-1-ps-命令" class="headerlink" title="3.1 ps 命令"></a>3.1 ps 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps aux       <span class="comment"># 查看所有进程</span></span><br><span class="line">ps -ef       <span class="comment"># 完整格式显示</span></span><br><span class="line">ps -u user   <span class="comment"># 查看指定用户进程</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-top-命令"><a href="#3-2-top-命令" class="headerlink" title="3.2 top 命令"></a>3.2 top 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top          <span class="comment"># 动态查看进程</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>r</code>: 调整进程优先级</li>
<li><code>k</code>: 终止进程</li>
<li><code>q</code>: 退出</li>
</ul>
<h3 id="3-3-进程控制"><a href="#3-3-进程控制" class="headerlink" title="3.3 进程控制"></a>3.3 进程控制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -9 PID          <span class="comment"># 强制终止进程</span></span><br><span class="line">killall process      <span class="comment"># 终止同名所有进程</span></span><br><span class="line">pkill pattern        <span class="comment"># 按模式终止进程</span></span><br></pre></td></tr></table></figure>

<h4 id="常用信号"><a href="#常用信号" class="headerlink" title="常用信号"></a>常用信号</h4><table>
<thead>
<tr>
<th>信号</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>HUP</td>
<td>1</td>
<td>重新加载配置</td>
</tr>
<tr>
<td>INT</td>
<td>2</td>
<td>中断(Ctrl+C)</td>
</tr>
<tr>
<td>KILL</td>
<td>9</td>
<td>强制终止</td>
</tr>
<tr>
<td>TERM</td>
<td>15</td>
<td>正常终止</td>
</tr>
</tbody></table>
<h3 id="3-4-作业控制"><a href="#3-4-作业控制" class="headerlink" title="3.4 作业控制"></a>3.4 作业控制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &amp;       <span class="comment"># 后台运行</span></span><br><span class="line"><span class="built_in">fg</span> %1          <span class="comment"># 前台恢复作业1</span></span><br><span class="line"><span class="built_in">bg</span> %2          <span class="comment"># 后台继续作业2</span></span><br><span class="line"><span class="built_in">jobs</span>           <span class="comment"># 查看后台作业</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-优先级管理"><a href="#3-5-优先级管理" class="headerlink" title="3.5 优先级管理"></a>3.5 优先级管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nice</span> -n 10 <span class="built_in">command</span>   <span class="comment"># 启动低优先级进程</span></span><br><span class="line">renice 15 -p PID     <span class="comment"># 调整运行中进程优先级</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-终端复用器"><a href="#3-6-终端复用器" class="headerlink" title="3.6 终端复用器"></a>3.6 终端复用器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux                <span class="comment"># 启动新会话</span></span><br></pre></td></tr></table></figure>
<p>常用快捷键:</p>
<ul>
<li><code>Ctrl+b c</code>: 新建窗口</li>
<li><code>Ctrl+b %</code>: 垂直分割</li>
<li><code>Ctrl+b &quot;</code>: 水平分割</li>
<li><code>Ctrl+b d</code>: 分离会话</li>
</ul>
<h2 id="4-压缩与归档"><a href="#4-压缩与归档" class="headerlink" title="4. 压缩与归档"></a>4. 压缩与归档</h2><h3 id="4-1-单文件压缩"><a href="#4-1-单文件压缩" class="headerlink" title="4.1 单文件压缩"></a>4.1 单文件压缩</h3><h4 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gzip file            <span class="comment"># 压缩为file.gz</span></span><br><span class="line">gunzip file.gz       <span class="comment"># 解压</span></span><br><span class="line">gzip -d file.gz      <span class="comment"># 解压(同上)</span></span><br></pre></td></tr></table></figure>

<h4 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bzip2 file           <span class="comment"># 压缩为file.bz2</span></span><br><span class="line">bunzip2 file.bz2     <span class="comment"># 解压</span></span><br></pre></td></tr></table></figure>

<h4 id="xz"><a href="#xz" class="headerlink" title="xz"></a>xz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xz file              <span class="comment"># 压缩为file.xz</span></span><br><span class="line">unxz file.xz         <span class="comment"># 解压</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-归档工具"><a href="#4-2-归档工具" class="headerlink" title="4.2 归档工具"></a>4.2 归档工具</h3><h4 id="tar-命令"><a href="#tar-命令" class="headerlink" title="tar 命令"></a>tar 命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包压缩</span></span><br><span class="line">tar czvf archive.tar.gz <span class="built_in">dir</span>/     <span class="comment"># gzip压缩</span></span><br><span class="line">tar cjvf archive.tar.bz2 <span class="built_in">dir</span>/    <span class="comment"># bzip2压缩</span></span><br><span class="line">tar cJvf archive.tar.xz <span class="built_in">dir</span>/     <span class="comment"># xz压缩</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar xzvf archive.tar.gz          <span class="comment"># 解压gzip</span></span><br><span class="line">tar xjvf archive.tar.bz2         <span class="comment"># 解压bzip2</span></span><br><span class="line">tar xJvf archive.tar.xz          <span class="comment"># 解压xz</span></span><br></pre></td></tr></table></figure>

<h4 id="cpio-命令"><a href="#cpio-命令" class="headerlink" title="cpio 命令"></a>cpio 命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . | cpio -ov &gt; backup.cpio      <span class="comment"># 创建归档</span></span><br><span class="line">cpio -idv &lt; backup.cpio              <span class="comment"># 解压归档</span></span><br></pre></td></tr></table></figure>

<h4 id="dd-命令"><a href="#dd-命令" class="headerlink" title="dd 命令"></a>dd 命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda of=disk.img bs=1M     <span class="comment"># 创建磁盘映像</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=disk.img of=/dev/sdb           <span class="comment"># 恢复磁盘映像</span></span><br></pre></td></tr></table></figure>

<h2 id="5-实用技巧"><a href="#5-实用技巧" class="headerlink" title="5. 实用技巧"></a>5. 实用技巧</h2><h3 id="5-1-nohup-命令"><a href="#5-1-nohup-命令" class="headerlink" title="5.1 nohup 命令"></a>5.1 nohup 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> <span class="built_in">command</span> &amp;      <span class="comment"># 退出终端后继续运行</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-watch-命令"><a href="#5-2-watch-命令" class="headerlink" title="5.2 watch 命令"></a>5.2 watch 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 5 <span class="string">&#x27;ls -l&#x27;</span>   <span class="comment"># 每5秒执行一次命令</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-文件传输"><a href="#5-3-文件传输" class="headerlink" title="5.3 文件传输"></a>5.3 文件传输</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=file.iso | ssh user@host <span class="string">&quot;dd of=file.iso&quot;</span>  <span class="comment"># 通过SSH传输文件</span></span><br></pre></td></tr></table></figure>


                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../2020/05/08/linux/4-%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E7%AE%A1%E7%90%86/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="../../"
                aria-label="上一頁"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>上一頁</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="../3/"
                aria-label="下一頁"
            >
              <span>下一頁</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">第 2 頁 共 5 頁</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macao
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/linux%E5%9F%BA%E7%A1%80/"
                            aria-label=": linux基础"
                        >
                            <h3 class="media-heading">linux基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/iptables/"
                            aria-label=": iptables"
                        >
                            <h3 class="media-heading">iptables</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/08/12/git%E6%95%99%E7%A8%8B/"
                            aria-label=": git教程"
                        >
                            <h3 class="media-heading">git教程</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年8月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/01/18/Java%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B/"
                            aria-label=": Java变量类型"
                        >
                            <h3 class="media-heading">Java变量类型</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年1月18日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/12/%E6%95%B0%E5%AD%A6/markdown-latex%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BC%8F%E5%86%99%E6%B3%95/"
                            aria-label=": LaTeX的写法"
                        >
                            <h3 class="media-heading">LaTeX的写法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/13/%E6%95%B0%E5%AD%A6/0-%E4%B8%AD%E5%AD%A6%E6%95%B0%E5%AD%A6%E5%A4%8D%E4%B9%A0/"
                            aria-label=": 0.中学数学复习"
                        >
                            <h3 class="media-heading">0.中学数学复习</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月13日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/1-%E5%88%9D%E7%AD%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%BC%E6%95%B0%E6%8E%A8%E5%AF%BC/"
                            aria-label=": 1.初等函数的导数推导"
                        >
                            <h3 class="media-heading">1.初等函数的导数推导</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/2-%E5%87%BD%E6%95%B0%E7%9A%84%E6%B1%82%E5%AF%BC%E6%B3%95%E5%88%99/"
                            aria-label=": 2.函数的求导法则"
                        >
                            <h3 class="media-heading">2.函数的求导法则</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/3-%E8%8E%B1%E5%B8%83%E5%B0%BC%E5%85%B9%E5%85%AC%E5%BC%8F/"
                            aria-label=": 3.莱布尼兹公式"
                        >
                            <h3 class="media-heading">3.莱布尼兹公式</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/4-%E5%BE%AE%E5%88%86/"
                            aria-label=": 4.微分"
                        >
                            <h3 class="media-heading">4.微分</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 42 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../../../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
