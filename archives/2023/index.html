
<!DOCTYPE html>
<html lang="zh-tw">
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">

    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    
      <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/locale/zh-tw.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script>
      window.algoliaConfig = {
        appId: 'AWFC86Q51O',
        apiKey: 'c9d952906eb1b154d75cf863e75c1ede',
        indexName: 'MyBlog'
      };
      var algoliaIndex = algoliasearch(
        algoliaConfig.appId,
        algoliaConfig.apiKey
      ).initIndex(algoliaConfig.indexName);
    </script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>所有文章: 2023 - Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Kein&#39;s blog">
<meta property="og:url" content="https://chankein.github.io/archives/2023/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Kein Chan">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../../#about"
            >
        
        
            <img class="header-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>分享一些技術教程,命令備忘(cheat-sheet)等</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/10/25/SwiftUI%E5%85%A8%E9%9D%A2%E6%8C%87%E5%8D%97-%E8%A7%86%E5%9B%BE-%E4%BF%AE%E9%A5%B0%E7%AC%A6-%E7%BB%84%E4%BB%B6%E4%B8%8EMVVM%E6%9E%B6%E6%9E%84/"
                            aria-label=": SwiftUI全面指南:视图,修饰符,组件与MVVM架构"
                        >
                            SwiftUI全面指南:视图,修饰符,组件与MVVM架构
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-10-25T00:14:52+08:00">
	
		    2023 年 10 月 25 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/SwiftUI/">SwiftUI</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>SwiftUI 是 Apple 推出的声明式框架，用于构建用户界面（UI）。 自2019年首次发布以来，SwiftUI 已成为 iOS、macOS、watchOS 和 tvOS 应用开发的重要工具。 本文将深入介绍 SwiftUI 的基本概念，包括视图(View)、修饰符(Modifiers)、内置修饰符、如何自定义视图、 组件化开发以及 MVVM 架构在 SwiftUI 中的应用。无论你是刚开始学习 SwiftUI，还是希望巩固基础，这篇指南都将为你提供有价值的知识。</p>
<h2 id="什么是-SwiftUI​">什么是 SwiftUI<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#what-is-swiftui" title="什么是 SwiftUI的直接链接">​</a></h2>
<p>SwiftUI 是 Apple 推出的用于构建用户界面的框架，采用声明式语法，使开发者能够更简洁、高效地创建复杂的界面。与传统的 UIKit 不同，SwiftUI 允许开发者通过声明视图的状态和布局来自动管理 UI 更新，从而减少了大量的样板代码。</p>
<h3 id="SwiftUI-的优势​">SwiftUI 的优势<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#swiftui-%E7%9A%84%E4%BC%98%E5%8A%BF" title="SwiftUI 的优势的直接链接">​</a></h3>
<ul>
<li><strong>声明式语法</strong>：通过描述界面的状态，SwiftUI 自动处理界面的更新。</li>
<li><strong>跨平台支持</strong>：适用于 iOS、macOS、watchOS 和 tvOS。</li>
<li><strong>实时预览</strong>：Xcode 提供的 Canvas 允许开发者实时预览和调试 UI。</li>
<li><strong>高效开发</strong>：减少样板代码，提高开发效率。</li>
<li><strong>响应式编程</strong>：SwiftUI 内置支持响应式编程范式，简化数据与UI的绑定。</li>
</ul>
<h2 id="什么是视图-View-​">什么是视图(View)<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#what-is-view" title="什么是视图(View)的直接链接">​</a></h2>
<p>在 SwiftUI 中，<strong>视图(View)</strong> 是构建用户界面的基本单元。每一个视图都代表 UI 的一个部分，例如文本、按钮、图像等。视图可以嵌套和组合，以创建复杂的界面。</p>
<h3 id="常见的-SwiftUI-视图​">常见的 SwiftUI 视图<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E5%B8%B8%E8%A7%81%E7%9A%84-swiftui-%E8%A7%86%E5%9B%BE" title="常见的 SwiftUI 视图的直接链接">​</a></h3>
<ul>
<li><code>Text</code>：显示文本内容。</li>
<li><code>Image</code>：显示图片。</li>
<li><code>Button</code>：交互式按钮。</li>
<li><code>VStack</code> 和 <code>HStack</code>：垂直和水平堆叠视图。</li>
<li><code>List</code>：显示可滚动的列表。</li>
<li><code>ScrollView</code>：实现可滚动的内容视图。</li>
<li><code>Spacer</code>：在堆叠视图中添加弹性空间。</li>
<li><code>NavigationView</code>：实现导航功能。</li>
</ul>
<h3 id="示例：创建一个简单的文本视图​">示例：创建一个简单的文本视图<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%A4%BA%E4%BE%8B%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E6%9C%AC%E8%A7%86%E5%9B%BE" title="示例：创建一个简单的文本视图的直接链接">​</a></h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUIstruct ContentView: View &#123;    var body: some View &#123;        Text(&quot;Hello, SwiftUI!&quot;)    &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>在上述示例中，<code>Text</code> 视图用于显示一段文本。</p>
<h2 id="什么是修饰符-Modifiers-​">什么是修饰符(Modifiers)<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#what-is-modifiers" title="什么是修饰符(Modifiers)的直接链接">​</a></h2>
<p><strong>修饰符(Modifiers)</strong> 是 SwiftUI 中用于修改视图属性的方法。通过链式调用修饰符，开发者可以轻松地调整视图的外观和行为，例如颜色、字体、边距等。</p>
<h3 id="使用修饰符的示例​">使用修饰符的示例<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E4%BD%BF%E7%94%A8%E4%BF%AE%E9%A5%B0%E7%AC%A6%E7%9A%84%E7%A4%BA%E4%BE%8B" title="使用修饰符的示例的直接链接">​</a></h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello, SwiftUI!&quot;</span>)    .font(.title)    .foregroundColor(.blue)    .padding()</span><br></pre></td></tr></table></figure>
<p>在这个例子中，<code>Text</code> 视图被应用了三个修饰符：<code>font</code> 修改字体大小，<code>foregroundColor</code> 修改文本颜色，<code>padding</code> 添加内边距。</p>
<h2 id="什么是内置修饰符​">什么是内置修饰符<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#what-is-built-in-modifiers" title="什么是内置修饰符的直接链接">​</a></h2>
<p>SwiftUI 提供了丰富的<strong>内置修饰符</strong>，开发者可以直接使用这些修饰符来调整视图的各种属性。以下是一些常用的内置修饰符：</p>
<ul>
<li><code>font(_:)</code>：设置字体和字体大小。</li>
<li><code>foregroundColor(_:)</code>：设置前景色（如文本颜色）。</li>
<li><code>background(_:)</code>：设置视图的背景颜色或视图。</li>
<li><code>padding(_:)</code>：设置视图的内边距。</li>
<li><code>frame(width:height:)</code>：设置视图的宽度和高度。</li>
<li><code>cornerRadius(_:)</code>：设置视图的圆角半径。</li>
<li><code>shadow(color:radius:x:y:)</code>：添加阴影效果。</li>
<li><code>opacity(_:)</code>：设置视图的不透明度。</li>
<li><code>rotationEffect(_:)</code>：旋转视图。</li>
<li><code>scaleEffect(_:)</code>：缩放视图。</li>
</ul>
<h3 id="示例：使用多个内置修饰符​">示例：使用多个内置修饰符<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%A4%BA%E4%BE%8B%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA%E5%86%85%E7%BD%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6" title="示例：使用多个内置修饰符的直接链接">​</a></h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Welcome to SwiftUI&quot;</span>)    .font(.largeTitle)    .foregroundColor(.white)    .padding()    .background(<span class="type">Color</span>.blue)    .cornerRadius(<span class="number">10</span>)    .shadow(color: .gray, radius: <span class="number">5</span>, x: <span class="number">0</span>, y: <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>在这个例子中，<code>Text</code> 视图应用了多个内置修饰符，改变了字体、颜色、背景、圆角和阴影效果。</p>
<h2 id="如何自定义视图​">如何自定义视图<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#how-to-custom-view" title="如何自定义视图的直接链接">​</a></h2>
<p>除了使用内置视图和修饰符，SwiftUI 允许开发者创建<strong>自定义视图</strong>。通过组合多个视图和修饰符，可以创建可重用且模块化的 UI 组件。</p>
<h3 id="创建自定义视图的步骤​">创建自定义视图的步骤<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%86%E5%9B%BE%E7%9A%84%E6%AD%A5%E9%AA%A4" title="创建自定义视图的步骤的直接链接">​</a></h3>
<ol>
<li><strong>定义新的视图结构</strong>：创建一个遵循 <code>View</code> 协议的结构体。</li>
<li><strong>实现 <code>body</code> 属性</strong>：在 <code>body</code> 中定义视图的内容和布局。</li>
<li><strong>组合视图和修饰符</strong>：使用内置视图和修饰符来设计自定义视图。</li>
</ol>
<h3 id="示例：创建一个自定义按钮视图​">示例：创建一个自定义按钮视图<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%A4%BA%E4%BE%8B%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%89%E9%92%AE%E8%A7%86%E5%9B%BE" title="示例：创建一个自定义按钮视图的直接链接">​</a></h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUIstruct CustomButton: View &#123;    var title: String    var backgroundColor: Color    var body: some View &#123;        Text(title)            .font(.headline)            .foregroundColor(.white)            .padding()            .background(backgroundColor)            .cornerRadius(8)            .shadow(radius: 5)    &#125;&#125;struct ContentView: View &#123;    var body: some View &#123;        CustomButton(title: &quot;Click Me&quot;, backgroundColor: .green)    &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>在这个示例中，<code>CustomButton</code> 是一个自定义视图，通过组合 <code>Text</code> 视图和多个修饰符，创建了一个带有背景色、圆角和阴影效果的按钮。</p>
<h2 id="视图与组件化开发​">视图与组件化开发<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#view-and-component-development" title="视图与组件化开发的直接链接">​</a></h2>
<p><strong>组件化开发</strong> 是现代软件开发中的一种最佳实践，通过将 UI 分解为可重用的组件，提升代码的可维护性和可扩展性。在 SwiftUI 中，视图本身就是组件的基本形式，开发者可以通过创建自定义视图来实现组件化开发。</p>
<h3 id="组件化的优势​">组件化的优势<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%BB%84%E4%BB%B6%E5%8C%96%E7%9A%84%E4%BC%98%E5%8A%BF" title="组件化的优势的直接链接">​</a></h3>
<ul>
<li><strong>可重用性</strong>：相同的组件可以在不同的地方重复使用，减少代码冗余。</li>
<li><strong>可维护性</strong>：组件独立，便于管理和更新。</li>
<li><strong>可测试性</strong>：独立的组件更容易进行单元测试。</li>
</ul>
<h3 id="示例：创建多个自定义组件​">示例：创建多个自定义组件<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%A4%BA%E4%BE%8B%E5%88%9B%E5%BB%BA%E5%A4%9A%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6" title="示例：创建多个自定义组件的直接链接">​</a></h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HeaderView</span>: <span class="title class_ inherited__">View</span> &#123;    <span class="keyword">var</span> title: <span class="type">String</span>    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;        <span class="type">Text</span>(title)            .font(.largeTitle)            .padding()            .background(<span class="type">Color</span>.orange)            .foregroundColor(.white)    &#125;&#125;<span class="keyword">struct</span> <span class="title class_">FooterView</span>: <span class="title class_ inherited__">View</span> &#123;    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;        <span class="type">Text</span>(<span class="string">&quot;© 2025 Your Company&quot;</span>)            .font(.footnote)            .padding()            .background(<span class="type">Color</span>.gray.opacity(<span class="number">0.2</span>))    &#125;&#125;<span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;        <span class="type">VStack</span> &#123;            <span class="type">HeaderView</span>(title: <span class="string">&quot;Welcome to My App&quot;</span>)            <span class="type">Spacer</span>()            <span class="type">FooterView</span>()        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>在这个示例中，<code>HeaderView</code> 和 <code>FooterView</code> 是两个独立的自定义组件，通过组合它们构建了一个完整的界面。</p>
<h2 id="MVVM-架构简介​">MVVM 架构简介<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#mvvm-architecture-introduction" title="MVVM 架构简介的直接链接">​</a></h2>
<p><strong>MVVM（Model-View-ViewModel）</strong> 是一种软件架构模式，旨在将应用程序的业务逻辑与用户界面分离。MVVM 提供了一种清晰的方式来组织代码，使其更易于维护、测试和扩展。</p>
<h3 id="MVVM-的组成部分​">MVVM 的组成部分<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#mvvm-%E7%9A%84%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86" title="MVVM 的组成部分的直接链接">​</a></h3>
<ul>
<li><strong>Model（模型）</strong>：表示应用程序的数据和业务逻辑。通常与数据存储和网络请求相关。</li>
<li><strong>View（视图）</strong>：负责显示数据和处理用户交互。SwiftUI 中的视图如 <code>Text</code>、<code>Image</code> 等。</li>
<li><strong>ViewModel（视图模型）</strong>：充当 Model 和 View 之间的中介。它处理业务逻辑，将 Model 中的数据转换为 View 可以直接使用的格式，并响应用户交互。</li>
</ul>
<h3 id="MVVM-的优势​">MVVM 的优势<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#mvvm-%E7%9A%84%E4%BC%98%E5%8A%BF" title="MVVM 的优势的直接链接">​</a></h3>
<ul>
<li><strong>分离关注点</strong>：将 UI 与业务逻辑分离，提升代码的可维护性。</li>
<li><strong>可测试性</strong>：ViewModel 可以独立于 View 进行单元测试。</li>
<li><strong>可重用性</strong>：ViewModel 可以在多个 View 中复用。</li>
</ul>
<h2 id="SwiftUI-中的-MVVM-实现​">SwiftUI 中的 MVVM 实现<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#mvvm-implementation-in-swiftui" title="SwiftUI 中的 MVVM 实现的直接链接">​</a></h2>
<p>在 SwiftUI 中，MVVM 架构通过结合 SwiftUI 的声明式语法和数据绑定机制，实现了 Model、View 和 ViewModel 的分离与协作。</p>
<h3 id="关键概念​">关键概念<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5" title="关键概念的直接链接">​</a></h3>
<ul>
<li><strong>@State</strong>：用于在 View 中存储和管理局部状态。</li>
<li><strong>@ObservableObject</strong>：用于声明一个可观察的对象，通常在 ViewModel 中使用。</li>
<li><strong>@Published</strong>：用于在 ObservableObject 中标记可以被观察的属性。</li>
<li><strong>@StateObject</strong> 和 <strong>@ObservedObject</strong>：用于在 View 中引用 ViewModel。</li>
</ul>
<h3 id="示例：使用-MVVM-架构的简单计数器应用​">示例：使用 MVVM 架构的简单计数器应用<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#%E7%A4%BA%E4%BE%8B%E4%BD%BF%E7%94%A8-mvvm-%E6%9E%B6%E6%9E%84%E7%9A%84%E7%AE%80%E5%8D%95%E8%AE%A1%E6%95%B0%E5%99%A8%E5%BA%94%E7%94%A8" title="示例：使用 MVVM 架构的简单计数器应用的直接链接">​</a></h3>
<h4 id="Model​">Model<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#model" title="Model的直接链接">​</a></h4>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">CounterModel</span> &#123;    <span class="keyword">var</span> count: <span class="type">Int</span> <span class="operator">=</span> <span class="number">0</span>&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ViewModel​">ViewModel<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#viewmodel" title="ViewModel的直接链接">​</a></h4>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combineclass CounterViewModel: ObservableObject &#123;    @Published var counter: CounterModel    init(counter: CounterModel = CounterModel()) &#123;        self.counter = counter    &#125;    func increment() &#123;        counter.count += 1    &#125;    func decrement() &#123;        counter.count -= 1    &#125;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="View​">View<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#view" title="View的直接链接">​</a></h4>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUIstruct CounterView: View &#123;    @StateObject private var viewModel = CounterViewModel()    var body: some View &#123;        VStack(spacing: 20) &#123;            Text(&quot;Count: \(viewModel.counter.count)&quot;)                .font(.largeTitle)            HStack(spacing: 40) &#123;                Button(action: &#123;                    viewModel.decrement()                &#125;) &#123;                    Text(&quot;-&quot;)                        .font(.title)                        .frame(width: 60, height: 60)                        .background(Color.red)                        .foregroundColor(.white)                        .clipShape(Circle())                &#125;                Button(action: &#123;                    viewModel.increment()                &#125;) &#123;                    Text(&quot;+&quot;)                        .font(.title)                        .frame(width: 60, height: 60)                        .background(Color.green)                        .foregroundColor(.white)                        .clipShape(Circle())                &#125;            &#125;        &#125;        .padding()    &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>在这个示例中：</p>
<ul>
<li><strong>Model</strong>：<code>CounterModel</code> 包含一个 <code>count</code> 属性，表示当前计数值。</li>
<li><strong>ViewModel</strong>：<code>CounterViewModel</code> 作为 <code>ObservableObject</code>，管理 <code>CounterModel</code> 的实例，并提供 <code>increment</code> 和 <code>decrement</code> 方法来修改计数值。</li>
<li><strong>View</strong>：<code>CounterView</code> 使用 <code>@StateObject</code> 引用 <code>CounterViewModel</code>，并通过数据绑定 (<code>viewModel.counter.count</code>) 显示计数值，同时通过按钮调用 ViewModel 的方法来修改计数。</li>
</ul>
<h2 id="MVVM-架构关系图​">MVVM 架构关系图<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#mvvm-architecture-relationship-diagram" title="MVVM 架构关系图的直接链接">​</a></h2>
<p>以下图示展示了 MVVM 架构在 SwiftUI 中的关系：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graph LR    Model --&gt; ViewModel    ViewModel --&gt; View    View --&gt; ViewModel</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Model</strong>：提供数据和业务逻辑。</li>
<li><strong>ViewModel</strong>：持有 Model 的实例，处理业务逻辑，并通过 <code>@Published</code> 属性将数据暴露给 View。</li>
<li><strong>View</strong>：通过 <code>@StateObject</code> 或 <code>@ObservedObject</code> 引用 ViewModel，使用数据绑定显示数据，并通过用户交互调用 ViewModel 的方法。</li>
</ul>
<h2 id="基于SwiftUI的项目如何设置MVVM​">基于SwiftUI的项目如何设置MVVM<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#how-to-set-up-mvvm-in-swiftui-projects" title="基于SwiftUI的项目如何设置MVVM的直接链接">​</a></h2>
<p>在 SwiftUI 项目中应用 MVVM 架构，可以按照以下步骤进行设置：</p>
<h3 id="1-创建-Model​">1. 创建 Model<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#1-%E5%88%9B%E5%BB%BA-model" title="1. 创建 Model的直接链接">​</a></h3>
<p>首先，定义应用程序的数据结构和业务逻辑。例如，一个简单的用户模型：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span>: <span class="title class_ inherited__">Identifiable</span> &#123;    <span class="keyword">let</span> id: <span class="type">UUID</span>    <span class="keyword">let</span> name: <span class="type">String</span>    <span class="keyword">let</span> email: <span class="type">String</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-创建-ViewModel​">2. 创建 ViewModel<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#2-%E5%88%9B%E5%BB%BA-viewmodel" title="2. 创建 ViewModel的直接链接">​</a></h3>
<p>创建一个 <code>ObservableObject</code> 类来管理 Model 的数据和业务逻辑：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combineclass UserViewModel: ObservableObject &#123;    @Published var users: [User] = []    func fetchUsers() &#123;        <span class="comment">// 模拟网络请求或数据获取        users = [            User(id: UUID(), name: &quot;Alice&quot;, email: &quot;alice@example.com&quot;),            User(id: UUID(), name: &quot;Bob&quot;, email: &quot;bob@example.com&quot;)        ]    &#125;    func addUser(name: String, email: String) &#123;        let newUser = User(id: UUID(), name: name, email: email)        users.append(newUser)    &#125;    func removeUser(at offsets: IndexSet) &#123;        users.remove(atOffsets: offsets)    &#125;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-创建-View​">3. 创建 View<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#3-%E5%88%9B%E5%BB%BA-view" title="3. 创建 View的直接链接">​</a></h3>
<p>在 View 中引用 ViewModel 并使用数据绑定展示和操作数据：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUIstruct UserListView: View &#123;    @StateObject private var viewModel = UserViewModel()    var body: some View &#123;        NavigationView &#123;            List &#123;                ForEach(viewModel.users) &#123; user in                    VStack(alignment: .leading) &#123;                        Text(user.name)                            .font(.headline)                        Text(user.email)                            .font(.subheadline)                            .foregroundColor(.gray)                    &#125;                &#125;                .onDelete(perform: viewModel.removeUser)            &#125;            .navigationTitle(&quot;用户列表&quot;)            .navigationBarItems(trailing: Button(action: &#123;                viewModel.addUser(name: &quot;新用户&quot;, email: &quot;newuser@example.com&quot;)            &#125;) &#123;                Image(systemName: &quot;plus&quot;)            &#125;)            .onAppear &#123;                viewModel.fetchUsers()            &#125;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-组织项目结构​">4. 组织项目结构<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#4-%E7%BB%84%E7%BB%87%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84" title="4. 组织项目结构的直接链接">​</a></h3>
<p>为了更好地组织代码，建议按照 MVVM 的结构将项目分为不同的文件夹：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YourProject/├── Models/│   └── User.swift├── ViewModels/│   └── UserViewModel.swift├── Views/│   └── UserListView.swift└── YourProjectApp.swift</span><br></pre></td></tr></table></figure>
<h3 id="5-使用依赖注入（可选）​">5. 使用依赖注入（可选）<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#5-%E4%BD%BF%E7%94%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E5%8F%AF%E9%80%89" title="5. 使用依赖注入（可选）的直接链接">​</a></h3>
<p>为了提高代码的可测试性和可扩展性，可以使用依赖注入将 ViewModel 注入到 View 中。例如：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">UserListView</span>: <span class="title class_ inherited__">View</span> &#123;    <span class="meta">@ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">UserViewModel</span>    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;        <span class="comment">// 与之前相同    &#125;&#125;// 在入口处注入 ViewModelstruct YourProjectApp: App &#123;    var body: some Scene &#123;        WindowGroup &#123;            UserListView(viewModel: UserViewModel())        &#125;    &#125;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="6-添加更多功能​">6. 添加更多功能<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#6-%E6%B7%BB%E5%8A%A0%E6%9B%B4%E5%A4%9A%E5%8A%9F%E8%83%BD" title="6. 添加更多功能的直接链接">​</a></h3>
<p>随着项目的发展，可以在 ViewModel 中添加更多的方法和属性，处理更复杂的业务逻辑，同时保持 View 的简洁和专注于展示。</p>
<h2 id="SwiftUI-术语汇总​">SwiftUI 术语汇总<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#swiftui-terminology-summary" title="SwiftUI 术语汇总的直接链接">​</a></h2>
<p>为了更好地理解 SwiftUI，以下是一些常见的术语及其解释：</p>
<ul>
<li><strong>声明式编程（Declarative Programming）</strong>：一种编程范式，开发者描述 UI 应该是什么样子，系统负责管理其状态和更新。</li>
<li><strong>视图（View）</strong>：SwiftUI 中的基本构建块，用于构建用户界面。</li>
<li><strong>修饰符（Modifier）</strong>：用于修改视图属性的方法，采用链式调用方式。</li>
<li><strong>布局容器（Layout Containers）</strong>：用于组织和布局视图的容器，如 <code>VStack</code>、<code>HStack</code>、<code>ZStack</code>。</li>
<li><strong>状态（State）</strong>：视图的数据源，影响视图的显示和行为。</li>
<li><strong>绑定（Binding）</strong>：一种双向数据流机制，使视图与其数据源保持同步。</li>
<li><strong>环境（Environment）</strong>：提供全局数据和配置，视图可以从环境中读取或写入数据。</li>
<li><strong>预览（Preview）</strong>：Xcode 提供的实时预览功能，允许开发者在编写代码时即时查看 UI 的变化。</li>
<li><strong><code>ObservableObject</code></strong>：一种可以被多个视图观察的对象，当其中的 <code>@Published</code> 属性发生变化时，视图会自动更新。</li>
<li><strong><code>@State</code></strong>：用于在视图内部存储和管理局部状态。</li>
<li><strong><code>@ObservedObject</code></strong>：用于在视图中观察外部的 <code>ObservableObject</code>，视图会在对象变化时自动更新。</li>
<li><strong><code>@EnvironmentObject</code></strong>：用于在多个视图中共享一个 <code>ObservableObject</code>，无需手动传递。</li>
</ul>
<h2 id="总结​">总结<a target="_blank" rel="noopener" href="https://yuxuetr.com/blog/2025/01/06/swiftui-intro#summary" title="总结的直接链接">​</a></h2>
<p>SwiftUI 以其声明式语法和强大的功能，正在迅速改变 iOS 和其他 Apple 平台的应用开发方式。理解 SwiftUI 的核心概念，如视图(View)、修饰符(Modifiers)、内置修饰符、如何自定义视图和组件化开发，是掌握这一框架的关键。通过引入 MVVM 架构，开发者可以进一步提升代码的可维护性和可测试性，构建出高效、可扩展的应用。</p>
<p>本文介绍了 SwiftUI 的基本概念和术语，展示了如何创建和使用自定义视图，并深入探讨了 MVVM 架构在 SwiftUI 中的实现方式。掌握这些知识后，你将能够在 SwiftUI 项目中应用最佳实践，打造出优雅且高效的用户界面。</p>
<p>继续深入学习 SwiftUI 的高级功能，如动画、数据绑定和自定义控件，将进一步提升你的开发技能，帮助你打造出更具吸引力和互动性的应用。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/10/25/SwiftUI%E5%85%A8%E9%9D%A2%E6%8C%87%E5%8D%97-%E8%A7%86%E5%9B%BE-%E4%BF%AE%E9%A5%B0%E7%AC%A6-%E7%BB%84%E4%BB%B6%E4%B8%8EMVVM%E6%9E%B6%E6%9E%84/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/10/15/SwiftUI%E6%96%87%E6%A1%A3/"
                            aria-label=": SwiftUI文档"
                        >
                            SwiftUI文档
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-10-15T00:11:14+08:00">
	
		    2023 年 10 月 15 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/SwiftUI/">SwiftUI</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="SwiftUI简介">SwiftUI简介</h2>
<p><a href="#swiftui%E7%AE%80%E4%BB%8B"></a></p>
<p>SwiftUI是一种更为现代的编码方式，他可以为苹果任意平台声明用户界面。以更为快捷迅速的方式创建漂亮的动态应用程序！</p>
<p><img src="https://camo.githubusercontent.com/50a2f12c5e3282b365e3b2d61fb68268595f7d7cddb2a4cd5f96635465b50d72/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313461663861316435352f35366133303432312d393863352d343365302d626666642d3630353038363539316235342e706e67" alt=""></p>
<h2 id="只需描述你的布局">只需描述你的布局</h2>
<p><a href="#%E5%8F%AA%E9%9C%80%E6%8F%8F%E8%BF%B0%E4%BD%A0%E7%9A%84%E5%B8%83%E5%B1%80"></a></p>
<blockquote>
<p>为视图的任何状态声明内容和布局。SwiftUI知道该状态何时更改，并更新视图，以匹配其呈现的状态。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>(landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">   <span class="type">HStack</span> &#123;</span><br><span class="line">      <span class="type">Image</span>(landmark.thumbnail)</span><br><span class="line">      <span class="type">Text</span>(landmark.name)</span><br><span class="line">      <span class="type">Spacer</span>()</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> landmark.isFavorite &#123;</span><br><span class="line">         <span class="type">Image</span>(systemName: <span class="string">&quot;star.fill&quot;</span>)</span><br><span class="line">            .foregroundColor(.yellow)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/dee4c4f45faeaf064a3d75f5f27440b630ebc284815a1853e8bcbbb84464a06a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f636533613062393839302f63373266303838662d356265392d343661642d393234352d3163663862346337333561302e706e67" alt=""></p>
<h2 id="构建可重用组件">构建可重用组件</h2>
<p><a href="#%E6%9E%84%E5%BB%BA%E5%8F%AF%E9%87%8D%E7%94%A8%E7%BB%84%E4%BB%B6"></a></p>
<blockquote>
<p>将小的、单一职责的视图组合成更大、更复杂的界面。在为苹果任意平台设计的应用程序之间共享您的自定义视图。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">FeatureCard</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      landmark.featureImage</span><br><span class="line">         .resizable()</span><br><span class="line">         .aspectRatio(<span class="number">3</span><span class="operator">/</span><span class="number">2</span>, contentMode: .fit)</span><br><span class="line">         .overlay(<span class="type">TextOverlay</span>(landmark))</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/db8bb42a17bfee69c85380765cff44eb527695a3d8f4226e050412c8e8560ea7/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373433623135333030352f38316534646632642d616333302d343662382d616633302d3332643063386636393334652e706e67" alt=""></p>
<h2 id="简化动画">简化动画</h2>
<p><a href="#%E7%AE%80%E5%8C%96%E5%8A%A8%E7%94%BB"></a></p>
<blockquote>
<p>创建平滑动画就像添加一个方法调用一样简单。SwiftUI会在需要时自动计算并设置过渡动画。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">   <span class="type">Badge</span>()</span><br><span class="line">      .frame(width: <span class="number">300</span>, height: <span class="number">300</span>)</span><br><span class="line">      .animation(.easeInOut())</span><br><span class="line">   <span class="type">Text</span>(name)</span><br><span class="line">      .font(.title)</span><br><span class="line">      .animation(.easeInOut())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/80023f3ab89eb740084dfd37d15b0f3de507b16b0a1d366cdc72d786d58de98d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643565623365656563612f32353961653665362d663231362d343064382d613065362d6134623036396263343733612e706e67" alt=""></p>
<h2 id="在Xcode中实时预览">在Xcode中实时预览</h2>
<p><a href="#%E5%9C%A8xcode%E4%B8%AD%E5%AE%9E%E6%97%B6%E9%A2%84%E8%A7%88"></a></p>
<blockquote>
<p>在不运行应用程序的情况下设计、生成和测试应用程序的界面。使用交互式预览测试控件和布局。</p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/4a1a02a9323e98d568f2cd0b2db1c83597a545b034e8fbf89962f074a5ace9d2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f616436373263363465662f64326236663133362d666537362d346336392d393564642d6433623232633364393833362e706e67" alt=""></p>
<h3 id="应用程序设计和布局">应用程序设计和布局</h3>
<p><a href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%92%8C%E5%B8%83%E5%B1%80"></a></p>
<h2 id="组合复杂界面">组合复杂界面</h2>
<p><a href="#%E7%BB%84%E5%90%88%E5%A4%8D%E6%9D%82%E7%95%8C%E9%9D%A2"></a></p>
<p>地标的首页显示一个滚动的分类列表，在每个分类中水平滚动地标。在构建此主导航时，您将探索组合视图如何适应不同的设备大小和方向。</p>
<blockquote>
<p>学习时间：20分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/bbc4a40f38/ComposingComplexInterfaces.zip">下载地址：ComposingComplexInterfaces.zip</a></p>
</blockquote>
<h2 id="第一节-添加首页">第一节 添加首页</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%B7%BB%E5%8A%A0%E9%A6%96%E9%A1%B5"></a></p>
<p>既然你已经拥有了地标应用程序所需的所有视图，现在是时候给它们一个首页了——一个统一视图页面。主视图不仅包含所有其他视图，还提供导航和显示地标的方法。</p>
<p><img src="https://camo.githubusercontent.com/184615ada53392d20cfc9a87dca89fb1debd1aa03cb7e5a80e83c3ae9ea570c9/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f376535393332306432332f36663364613762622d343666612d343766362d393466622d6335333734613466333438372e706e67" alt=""></p>
<h2 id="步骤1">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>在名为<code>Home.swift</code>的新文件中创建名为<code>CategoryHome</code>的自定义视图。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Landmarks Content&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/54f5c957e91cf81977c40f1f885a23db7b8ad1c39919f455a0d8b8bc9f86fe3d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363633356333383935622f34373266646266312d643765622d343864662d393265352d3835656161666339313464652e706e67" alt=""></p>
<h2 id="步骤2">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>修改<code>scene delegate</code>，使其显示新的<code>CategoryHome</code>视图而不是地标列表。</p>
<p>主视图是地标应用程序的根，因此它需要一种方式来呈现所有其他视图。</p>
<blockquote>
<p>SceneDelegate.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SceneDelegate</span>: <span class="title class_ inherited__">UIResponder</span>, <span class="title class_ inherited__">UIWindowSceneDelegate</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> window: <span class="type">UIWindow</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">scene</span>(<span class="keyword">_</span> <span class="params">scene</span>: <span class="type">UIScene</span>, <span class="params">willConnectTo</span> <span class="params">session</span>: <span class="type">UISceneSession</span>, <span class="params">options</span> <span class="params">connectionOptions</span>: <span class="type">UIScene</span>.<span class="type">ConnectionOptions</span>) &#123;</span><br><span class="line">        <span class="comment">// Use this method to optionally configure and attach the UIWindow `window` to the provided UIWindowScene `scene`.</span></span><br><span class="line">        <span class="comment">// If using a storyboard, the `window` property will automatically be initialized and attached to the scene.</span></span><br><span class="line">        <span class="comment">// This delegate does not imply the connecting scene or session are new (see `application:configurationForConnectingSceneSession` instead).</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Use a UIHostingController as window root view controller</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> windowScene <span class="operator">=</span> scene <span class="keyword">as?</span> <span class="type">UIWindowScene</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> window <span class="operator">=</span> <span class="type">UIWindow</span>(windowScene: windowScene)</span><br><span class="line">            window.rootViewController <span class="operator">=</span> <span class="type">UIHostingController</span>(</span><br><span class="line">                rootView: <span class="type">CategoryHome</span>()</span><br><span class="line">                    .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">self</span>.window <span class="operator">=</span> window</span><br><span class="line">            window.makeKeyAndVisible()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>添加<code>NavigationView</code>以在地标中承载不同的视图。</p>
<p>您可以使用<code>NavigationView</code>以及<code>NavigationLink</code>实例和相关修饰符在应用程序中构建导航层级结构。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Landmarks Content&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/54f5c957e91cf81977c40f1f885a23db7b8ad1c39919f455a0d8b8bc9f86fe3d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363633356333383935622f34373266646266312d643765622d343864662d393265352d3835656161666339313464652e706e67" alt=""></p>
<h2 id="步骤4">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>将导航栏的标题设置为“Featured”。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Landmarks Content&quot;</span>)</span><br><span class="line">                .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/38292c3b58c1485c47ed763cb7c21032062389eed141c3556fb909779e4b6acd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333363626461306430662f33333064636463332d383334342d343038322d626561312d3230383065643838336331312e706e67" alt=""></p>
<h2 id="第二节-创建分类列表">第二节 创建分类列表</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9B%E5%BB%BA%E5%88%86%E7%B1%BB%E5%88%97%E8%A1%A8"></a></p>
<p>Landmarks应用程序将所有分类显示在垂直列中的单独行中，以便于浏览。通过组合垂直和水平堆栈，并向列表中添加滚动条，就可以完成此操作。</p>
<p><img src="https://camo.githubusercontent.com/7120019785703b47c78c069692aec1fcfe5a273eec32bcdd53210d87fb6ba90a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f656534353539633136342f33393836383833322d363861322d346431622d623532382d3935346337623063616237612e706e67" alt=""></p>
<h2 id="步骤1-2">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>使用<code>Dictionary</code>结构的<code>init（grouping:by:）</code>方法将地标分组到类别中，输入地标的category属性。</p>
<p>初始化项目文件给每个示例地标预设了类别。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Landmarks Content&quot;</span>)</span><br><span class="line">                .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-2">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<blockquote>
<p>使用列表在地标中显示分类。</p>
</blockquote>
<p><code>Landmark.Category</code>会匹配列表中每一项<code>name</code>，这些项在其他类别中必须是唯一的，因为它是枚举。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">Text</span>(key)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5eb1be4e6a5a6054754c674e55cb96a964eb5e4714371dafcd8e89bc27881bc7/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f613835663032383466332f34363066653135362d643264372d343166392d613632652d3438366362653333633430642e706e67" alt=""></p>
<h2 id="第三节-添加地标行">第三节 添加地标行</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E6%B7%BB%E5%8A%A0%E5%9C%B0%E6%A0%87%E8%A1%8C"></a></p>
<p>地标在水平滚动的行中显示每个类别。添加一个新的视图类型来表示行，然后在新视图中显示该类别的所有地标。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/add-rows-landmarks.gif" alt=""></p>
<h2 id="步骤1-3">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>定义用于保存行内容的新自定义视图。</p>
<p>这个视图需要存储地标的类别信息，以及地标本身。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="keyword">self</span>.categoryName)</span><br><span class="line">            .font(.headline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">3</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/069c759e8f0e65c0d2124cc0b667fc95e5c4e633e4c9787d2ce9a9c5a0c96636/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f616138396332313066362f39373033303036332d323462332d343436642d393765312d3062613339633662653638352e706e67" alt=""></p>
<h2 id="步骤2-3">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>更新<code>CategoryHome</code>的主体以将类别信息传递给新的行类型。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/bdb471f842daedd8a7647f492ee2f3fb8b486f551a25de7040e4ce8ce165ce89/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383339656466653062612f63353338646139342d626338642d343065312d383962302d3961646162656464303231372e706e67" alt=""></p>
<h2 id="步骤3-2">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>在<code>HStack</code>中显示该类别的地标。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span>(alignment: .top, spacing: <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">ForEach</span>(<span class="keyword">self</span>.items) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">Text</span>(landmark.name)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">3</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/a9cf0d35dc0309d88acd3589ab689a899d0bbcb5737608bd04700958e1a59487/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323062303265316264332f62373333313039622d646231622d346364622d616666332d6665373463616235316335362e706e67" alt=""></p>
<h2 id="步骤4-2">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<blockquote>
<p>通过指定一个<code>frame(width:height:)</code> 并在<code>scrollView</code>中包装<code>stack</code>，为行提供空间。</p>
</blockquote>
<p>使用长数据样本更新视图预览，以便确保可以滚动。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.categoryName)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .padding(.leading, <span class="number">15</span>)</span><br><span class="line">                .padding(.top, <span class="number">5</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">ScrollView</span>(.horizontal, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top, spacing: <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="keyword">self</span>.items) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                        <span class="type">Text</span>(landmark.name)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .frame(height: <span class="number">185</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">4</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/e8ce0ea8112e7c3538c644771ed4fa10378b87dd3c1f18b0e655de62cf6e6ef8/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333962653830646332652f38393332346134322d363966652d343431652d386433312d3138633736346163326630392e706e67" alt=""></p>
<h2 id="第四节-组成主页">第四节 组成主页</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E7%BB%84%E6%88%90%E4%B8%BB%E9%A1%B5"></a></p>
<p>地标应用程序的主页需要显示地标的简单信息，然后用户点击其中一个更多进入详情视图。</p>
<p>重新使用在<code>Creating and Combining Views</code>中的视图来创建更简单的视图预览，以显示地标的分类和特征。</p>
<p><img src="https://camo.githubusercontent.com/21440c60f467abd9344efabb42a4355c9aaeb6e8098b937a3aeee23b36617f84/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393633353563666336382f33333739633736382d646334652d346464382d393831622d3132363661656337626436302e706e67" alt=""></p>
<h2 id="步骤1-4">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>在<code>CategoryRow</code>旁边创建一个名为<code>CategoryItem</code>的新自定义视图，并用新视图替换<code>Text</code>视图。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.categoryName)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .padding(.leading, <span class="number">15</span>)</span><br><span class="line">                .padding(.top, <span class="number">5</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">ScrollView</span>(.horizontal, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top, spacing: <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="keyword">self</span>.items) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                        <span class="type">CategoryItem</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .frame(height: <span class="number">185</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryItem</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">155</span>, height: <span class="number">155</span>)</span><br><span class="line">                .cornerRadius(<span class="number">5</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">                .font(.caption)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding(.leading, <span class="number">15</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">4</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/2b64d2d3c0a6cb1df0563ac00675ac7fe79866129a6b72ad645bf27e0a40114e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396437366637373030632f36613362336335632d333465622d346637322d393363362d6136666634383831376535622e706e67" alt=""></p>
<h2 id="步骤2-4">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<blockquote>
<p>在<code>Home.swift</code>中，添加一个名为<code>FeaturedLandmarks</code>的简单视图，该视图仅显示标记为<code>isFeatured</code>的地标。</p>
</blockquote>
<p>在后面的教程中，您将把此视图转换为可交互的轮播视图。目前，它显示了一个裁剪和缩放后的预览图像。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/c27fa8ef7828faa6d7edbf28a2d0c0d69aff9c57cccecb7534739101ac917d36/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643037636165393339372f35363235656139652d366533362d343237302d396434342d3833303262373338623965352e706e67" alt=""></p>
<h2 id="步骤3-3">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>在两种地标预览中将<code>edge insets</code>设置为零，以便内容可以延伸到屏幕边缘。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/831721aa7e9c7e63bc5581baf34fc71750b0640cf5ca4858edb809a9a66d5c8e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386566623439346239622f35303266326431382d353737342d343339642d613363312d6238623235653635613737392e706e67" alt=""></p>
<h2 id="第五节-在分区之间添加导航">第五节 在分区之间添加导航</h2>
<p><a href="#%E7%AC%AC%E4%BA%94%E8%8A%82-%E5%9C%A8%E5%88%86%E5%8C%BA%E4%B9%8B%E9%97%B4%E6%B7%BB%E5%8A%A0%E5%AF%BC%E8%88%AA"></a></p>
<p>现在，在主页中可以看到所有不同分类的地标，用户需要一种方法来访问应用程序中的每个部分。使用<code>navigation</code>和<code>presentation Apis</code>可以从主页导航到地标详情页，收藏夹和用户主页。</p>
<p><img src="https://camo.githubusercontent.com/1f94b160bf9d8ebe7bffc2e41a8436d80be58391dab2416ccffb4e483581bc4a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626331313837333131302f32626231326135312d323733652d346663382d613131362d3736656664393039316432342e706e67" alt=""></p>
<h2 id="步骤1-5">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-4"></a></p>
<p>在<code>CategoryRow.swift</code>中，用<code>NavigationLink</code>包装现有的<code>CategoryItem</code>。</p>
<p>类别项本身是按钮的<code>label</code>，其目的地是显示地标详情视图。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.categoryName)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .padding(.leading, <span class="number">15</span>)</span><br><span class="line">                .padding(.top, <span class="number">5</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">ScrollView</span>(.horizontal, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top, spacing: <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="keyword">self</span>.items) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                        <span class="type">NavigationLink</span>(</span><br><span class="line">                            destination: <span class="type">LandmarkDetail</span>(</span><br><span class="line">                                landmark: landmark</span><br><span class="line">                            )</span><br><span class="line">                        ) &#123;</span><br><span class="line">                            <span class="type">CategoryItem</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .frame(height: <span class="number">185</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryItem</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">155</span>, height: <span class="number">155</span>)</span><br><span class="line">                .cornerRadius(<span class="number">5</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">                .font(.caption)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding(.leading, <span class="number">15</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">4</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/413ae130993f87716ab70d4d0574fe3561803a3f47e139045d361a81f18d456c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626638383932343062352f36643763346262372d343338312d343863332d616132372d3234613666383933626138622e706e67" alt=""></p>
<p><em><strong>注意</strong></em></p>
<blockquote>
<p>在<code>Xcode11 beta 6</code>中，如果在列表中嵌套一个<code>ScrollView</code>，并且该<code>ScrollView</code>包含一个<code>NavigationLink</code>，那么当用户点击<code>NavigationLink</code>时，这些<code>NavigationLink</code>不会导航到目标视图。</p>
</blockquote>
<h2 id="步骤2-5">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-4"></a></p>
<p>通过应用<code>renderingMode（:）</code>和<code>foregroundColor（:）</code>修饰符更改导航外观。</p>
<p>作为<code>NavigationLink</code>的<code>label</code>传递的文本使用环境的强调色进行渲染，而图像可能被作为<code>template images</code>进行渲染。您可以修改任一行为以最适合您的设计。</p>
<blockquote>
<p>CategoryRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categoryName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> items: [<span class="type">Landmark</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.categoryName)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .padding(.leading, <span class="number">15</span>)</span><br><span class="line">                .padding(.top, <span class="number">5</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">ScrollView</span>(.horizontal, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top, spacing: <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="keyword">self</span>.items) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                        <span class="type">NavigationLink</span>(</span><br><span class="line">                            destination: <span class="type">LandmarkDetail</span>(</span><br><span class="line">                                landmark: landmark</span><br><span class="line">                            )</span><br><span class="line">                        ) &#123;</span><br><span class="line">                            <span class="type">CategoryItem</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .frame(height: <span class="number">185</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryItem</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .renderingMode(.original)</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">155</span>, height: <span class="number">155</span>)</span><br><span class="line">                .cornerRadius(<span class="number">5</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">                .foregroundColor(.primary)</span><br><span class="line">                .font(.caption)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding(.leading, <span class="number">15</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryRow</span>(</span><br><span class="line">            categoryName: landmarkData[<span class="number">0</span>].category.rawValue,</span><br><span class="line">            items: <span class="type">Array</span>(landmarkData.prefix(<span class="number">4</span>))</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/40ad0aeb189cf55a35d268d0f4b94c0babc84183acc947084cf997dc37dc3a5a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396434333530393631332f64393931623434362d316436642d343164362d623662632d3935306637376133363534352e706e67" alt=""></p>
<h2 id="步骤3-4">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<blockquote>
<p>在<code>Home.swift</code>中，点击选项卡栏中的简介图标后，添加一个模态视图以显示用户简介页面。</p>
</blockquote>
<p>当<code>showProfile</code>状态变量设置为<code>true</code>时，SwiftUI显示用户简介占位符，当用户关闭模态时，将<code>showProfile</code>设置回<code>false</code>。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingProfile <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">            .sheet(isPresented: <span class="variable">$showingProfile</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/831721aa7e9c7e63bc5581baf34fc71750b0640cf5ca4858edb809a9a66d5c8e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386566623439346239622f35303266326431382d353737342d343339642d613363312d6238623235653635613737392e706e67" alt=""></p>
<h2 id="步骤4-3">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>在导航栏中添加一个按钮，在点击时将<code>showProfile</code>从<code>false</code>切换为<code>true</code>。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        .<span class="keyword">init</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingProfile <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> profileButton: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.showingProfile.toggle() &#125;) &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;person.crop.circle&quot;</span>)</span><br><span class="line">                .imageScale(.large)</span><br><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>))</span><br><span class="line">                .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing: profileButton)</span><br><span class="line">            .sheet(isPresented: <span class="variable">$showingProfile</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image(forSize: <span class="number">250</span>).resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/20e42fa057151b611d238df3d90aa348ae9bb00c5f7428fed435d8e6e846acb2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643335366365656333652f33346566363964332d356333382d346166392d613266632d6232373930393863653934312e706e67" alt=""></p>
<h2 id="步骤5">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>通过添加导航链接完成主页，该链接指向可过滤所有地标的列表。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingProfile <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> profileButton: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.showingProfile.toggle() &#125;) &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;person.crop.circle&quot;</span>)</span><br><span class="line">                .imageScale(.large)</span><br><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>))</span><br><span class="line">                .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkList</span>()) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;See All&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing: profileButton)</span><br><span class="line">            .sheet(isPresented: <span class="variable">$showingProfile</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/20e42fa057151b611d238df3d90aa348ae9bb00c5f7428fed435d8e6e846acb2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643335366365656333652f33346566363964332d356333382d346166392d613266632d6232373930393863653934312e706e67" alt=""></p>
<h2 id="步骤6">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>在<code>LandmarkList.swift</code>中，删除包装地标列表的<code>NavigationView</code>，并将其添加到预览中。</p>
<p>在应用程序的环境中，<code>LandmarkList</code>将始终显示在<code>Home.swift</code>中声明的导航视图中。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Favorites only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/b0e1c3a23091ea24ef4d8d54ada6adab9df6a85711ac1bb2a693acd7c7d76eed/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633562616130616431332f64353737316334622d333738372d343964332d623065312d3732373731396438353463332e706e67" alt=""></p>
<blockquote>
<p>SwiftUI纲要</p>
</blockquote>
<h2 id="创建和组织视图">创建和组织视图</h2>
<p><a href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E7%BB%84%E7%BB%87%E8%A7%86%E5%9B%BE"></a></p>
<blockquote>
<p>本教程将指导您构建一个iOS应用程序——<code>Landmarks(地标)</code>，用于发现和分享您喜欢的地方。首先，您将构建显示<code>Landmark</code>的详情页面。</p>
<p>为了布局视图，&quot;地标&quot;使用<code>stacks</code>来对<code>image、text</code>等组件进行组织和分层。要将地图添加到视图中，需要包含一个标准的<code>MapKit</code>组件。当您优化视图的设计时，Xcode提供实时反馈，这样当您修改代码时，就可以看到视图状态的改变。</p>
<p>下载项目文件开始构建此项目，并按照以下步骤操作：</p>
<p>学习时长：40分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/c2c7dffe44/CreatingAndCombiningViews.zip">下载示例：CreatingAndCombiningViews.zip</a></p>
</blockquote>
<h2 id="第一节-创建新项目并浏览画布">第一节 创建新项目并浏览画布</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE%E5%B9%B6%E6%B5%8F%E8%A7%88%E7%94%BB%E5%B8%83"></a></p>
<p>创建一个使用SwiftUI的新Xcode项目。浏览画布、预览和SwiftUI模板代码。</p>
<blockquote>
<p><strong>要在Xcode中预览画布上的视图并与之交互，请确保Mac运行的是macOS Catalina 10.15。</strong></p>
</blockquote>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/create-new-project.gif" alt=""></p>
<h2 id="步骤一">步骤一</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%80"></a></p>
<p>打开Xcode并在Xcode的启动窗口中单击<code>Create a new Xcode</code>项目，或者选择<code>File&gt;new&gt;project</code>。</p>
<p><img src="https://camo.githubusercontent.com/b896251a7bdc07ba857696a99dc6fe59bd89c8137cad7757cfc61f738c7e0b7e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383662333734366539622f65326236646630632d393035632d343533652d396436372d3137646463386536633632632e706e67" alt=""></p>
<h2 id="步骤二">步骤二</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C"></a></p>
<p>在模板选择器中，选择iOS平台，选择单视图应用程序模板，然后单击下一步。</p>
<p><img src="https://camo.githubusercontent.com/19b7163f0fce23e86f191a5d33a73f483bdfb3878bb8d03b039105b99a96282d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f306431393839386237652f30366538306666312d343766322d343638652d613331622d3165373732333234316432352e706e67" alt=""></p>
<h2 id="步骤三">步骤三</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89"></a></p>
<p>输入“Landmarks”作为产品名称，选中Use SwiftUI复选框，然后单击Next。选择一个路径来保存你的项目。</p>
<p><img src="https://camo.githubusercontent.com/5d1aaa88b7134b13f5b631ddfaca5371751fcd696a290fa7f4033ca10c6318aa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f646164623566636264312f33356231633834642d313236652d343732632d393833392d3934623563316362636139312e706e67" alt=""></p>
<h2 id="步骤四">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B"></a></p>
<p>在项目导航器中，单击以选择ContentView.swift。</p>
<p>默认情况下，SwiftUI视图文件声明两个结构。第一个结构实现了视图的必选协议，并描述了视图的内容和布局。第二个结构声明了该视图的预览。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/fa45c038604e470f340bc372a0be18df3fd2d59834b19100ff37f1892ce03b03/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f653063306239396461652f39623666363131622d313464662d343539322d613937372d3037383462653861373639352e706e67" alt=""></p>
<h2 id="步骤五">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94"></a></p>
<p>在画布中，单击<code>Resume</code>以显示预览。</p>
<blockquote>
<p>Tips:如果画布不可见，请选择<code>Editor &gt; Editor and Canvas</code>以显示它。</p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/5aca50837582794c53801557c660bfbff1dfcf7f63a32ef319ba404a38abae1c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663239623761393030382f65343364363039312d643238612d343433372d396231622d3062643566376664656533382e706e67" alt=""></p>
<h2 id="步骤六">步骤六</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AD"></a></p>
<p>在<code>body</code>属性中，将“Hello World”更改为自己的问候语。</p>
<p>当您在视图的<code>body</code>属性中更改代码时，预览将更新以反映您的更改。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello SwiftUI!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/44805c99d5837b9b3e39aefbd74ea383346bd97981c351ddc6b74ff2e9b01237/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393839373063306139622f65333334313835362d633766382d346539612d626133362d6336633731346536346263312e706e67" alt=""></p>
<h2 id="第二节-自定义文本视图">第二节 自定义文本视图</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%87%E6%9C%AC%E8%A7%86%E5%9B%BE"></a></p>
<p>您可以通过更改代码，或使用检查器查看可用的内容，并帮助您编写代码，来自定义视图的显示。</p>
<p>构建<code>Lanmarks</code>应用程序时，可以使用任意编辑器组合：源码编辑、画布或检查器。无论使用哪种工具，代码都会保持更新。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/customize-text-view.gif" alt=""></p>
<blockquote>
<p>接下来，您将使用检查器自定义文本视图。</p>
</blockquote>
<h2 id="步骤一-2">步骤一</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%80-1"></a></p>
<p>在预览中，按住<code>command</code>并单击问候语以打开结构化编辑弹出窗口，然后选择<code>Inspect</code>。</p>
<p>弹出窗口显示可自定义的不同属性，具体取决于所检查的视图类型。</p>
<p><img src="https://camo.githubusercontent.com/acbaddebaf9e02fd1f3e2f3b3af218dd010b855bff9c6ba4e3a47a513627a423/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f616563353330636561362f30616238393338352d376638352d346136382d616562312d3039313938313434316334312e706e67" alt=""></p>
<h2 id="步骤二-2">步骤二</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C-1"></a></p>
<p>使用检查器将文本更改为“Turtle Rock”，即您将在应用程序中显示的第一个地标的名称。</p>
<p><img src="https://camo.githubusercontent.com/d9ee74324dc0900cb1d7b27792990c0a5fe2b36ed66a8552040d3dfb92bb9db7/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f353132306265303465352f63376639613030632d383738382d346133322d623036612d6466376433663961373933632e706e67" alt=""></p>
<h2 id="步骤三-2">步骤三</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89-1"></a></p>
<p>将<code>font</code>更改为<code>Title</code>。</p>
<p>这会将系统字体应用于该文本，以便它正确适应用户系统偏好的字体大小和设置。</p>
<p><img src="https://camo.githubusercontent.com/9f18c4a616058131c5077547c4cf0f8f7b1f751e953938c806ff95f06c9438ff/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666234633137313966632f33646464633932322d366666382d343566322d383733662d6634303030623434343339332e706e67" alt=""></p>
<blockquote>
<p>要自定义SwiftUI视图，可以调用名为<code>修饰符(modifier)</code>的方法。修饰符会包装视图以更改其显示或其他属性。每个修饰符都返回一个新视图，因此通常采用垂直的链式调用多个修饰符。</p>
</blockquote>
<h2 id="步骤四-2">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B-1"></a></p>
<p>手动编辑代码添加<code>foregroundColor（.green）</code>修饰符；这会将文本的颜色更改为绿色。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">            .font(.title)</span><br><span class="line">            .foregroundColor(.green)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/97b308c4d6e5a26f949326cd1c00522d99a24940351288718961acd8f9aa4960/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386535333035373431652f38386637373732342d666565382d346437312d383166382d3437336530616433616264352e706e67" alt=""></p>
<blockquote>
<p>您的代码始终真实反应到视图上。因此当使用检查器更改或移除修饰符时，Xcode会立即更新视图以匹配代码。</p>
</blockquote>
<h2 id="步骤五-2">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94-1"></a></p>
<p>然后我们在代码编辑区，按住<code>command</code>并单击<code>Text</code>来打开检查器，然后从弹出窗口中选择<code>Inspect</code>。单击<code>Color</code>弹出菜单，然后选择<code>Inherited</code> , 将文本颜色再次更改为黑色。</p>
<p><img src="https://camo.githubusercontent.com/c6327d9f8d1dbb1700ba90424a6ed8a8a0271fa26ea928c91a742c5f5477d6be/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623433666439633531372f66303162373931302d633362302d346630652d386261612d3632366662393833376635612e706e67" alt=""></p>
<h2 id="步骤六-2">步骤六</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AD-1"></a></p>
<p>请注意，Xcode会自动更新代码以反映您的更改，并删除<code>foregroundColor（.green）</code>修饰符。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">            .font(.title)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/96956a9d68ddac2e1dc6eb288b7ab3b6fe704f1eb96d889b3b131640d3f0bcf4/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666562336666316666642f65323464393030352d333134392d346635382d383432392d3965646330383935366433362e706e67" alt=""></p>
<h2 id="第三节">第三节</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82"></a></p>
<h2 id="使用堆栈组合视图">使用堆栈组合视图</h2>
<p><a href="#%E4%BD%BF%E7%94%A8%E5%A0%86%E6%A0%88%E7%BB%84%E5%90%88%E8%A7%86%E5%9B%BE"></a></p>
<p>除了在上一节中创建的标题视图之外，还将添加文本视图，以包含有关地标的详细信息，例如公园的名称和所在的州。</p>
<p>创建SwiftUI视图时，可以在视图的<code>body</code>属性中描述其内容、布局和行为；但是，<code>body</code>属性只返回单个视图。您可以将多个视图组合并嵌入到<code>Stack</code>中，从而将视图水平、垂直或前后组合在一起。</p>
<p>在本节中，您将使用<code>VStack(垂直堆栈)</code>组合标题信息，使用<code>HStack(水平堆栈)</code>组合公园详情信息。</p>
<p><img src="https://camo.githubusercontent.com/3aeefe3292b56902b53bedabdd80192b5ee234ecf269f9107b09f74caa82e2f9/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346130303064326333342f35343661346433342d666566392d343537342d613430352d6431366563383363613766652e706e67" alt=""></p>
<blockquote>
<p>你可以使用Xcode的结构化编辑功能在容器视图中嵌入视图，也可以打开<code>Inspector</code> 或使用<code>help</code>进行其他更多有用的更改。</p>
</blockquote>
<h2 id="步骤一-3">步骤一</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%80-2"></a></p>
<p>按住<code>command</code>并单击<code>Text</code>视图，会看到初始值设定项的显示结构化编辑弹出窗口，然后选择<code>Embed in VStack</code>。</p>
<p><img src="https://camo.githubusercontent.com/cc4265b5a7b78aef59daf5b1853c9f1d8249d12fcca1923e7a5b4bd27c313a30/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336665383139363335382f36633934333065322d643062382d346161642d623131332d3465313263363938303135612e706e67" alt=""></p>
<blockquote>
<p>接下来，通过从<code>组件库</code>中拖动<code>Text</code>视图，将<code>Text</code>视图添加到<code>Stack</code>中。</p>
</blockquote>
<p>通过单击Xcode窗口右上角的加号按钮（＋）打开<code>组件库</code>，然后将<code>Text</code>视图拖到<code>Turtle Rock</code>文本视图下面的位置。</p>
<p><img src="https://camo.githubusercontent.com/4a1664a9507008e96d6e9f33f86c15160bc8af2e51a5e36472abef04746303e5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303033396239366439372f30626635663639322d366466312d343231352d393034392d6632346662333938373639652e706e67" alt=""></p>
<h2 id="步骤三-3">步骤三</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89-2"></a></p>
<p>将<code>Text</code>视图的默认文本替换为“Joshua Tree National Park”。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5d6997dedec53e4066531f7149f276b467926bae5d72db398c52dc78fa9d9f0f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663933373037383362622f30303262323930382d663832632d343866342d393634622d3833393831386631333864622e706e67" alt=""></p>
<blockquote>
<p>自定义位置文本的样式，以满足布局需求。</p>
</blockquote>
<h2 id="步骤四-3">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B-2"></a></p>
<p>将位置的<code>font</code>设置为<code>subheadline</code> 。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                .font(.subheadline)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/8d00ac729f176849ab669f4bb3b530b1b6ba1753b74e6e052635f0d6613e0636/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343462386236383931302f66353237663134322d363664662d343831642d383364662d3865666439366637616332652e706e67" alt=""></p>
<h2 id="步骤五-3">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94-2"></a></p>
<p>编辑<code>VStack</code>初始值设定项，以<code>leading</code>方式对齐视图。</p>
<p>默认情况下，<code>VStack</code>会将它们的内容按轴中心对齐，并提供上下文适当的间距。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                .font(.subheadline)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/35d3cab99a52b029abb9b190e70950cd52dc94aa49f3e2d59122c5ab565b199d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343162383435616533652f36373233376666372d306234322d346466662d386136362d3633343464313431326135352e706e67" alt=""></p>
<blockquote>
<p>接下来，您将在位置文本的右侧添加另一个文本视图，该视图用于展示公园所在的州。</p>
</blockquote>
<h2 id="步骤六-3">步骤六</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AD-2"></a></p>
<p>在画布中，按住<code>command</code>并单击<code>Joshua Tree National Park</code>，然后选择<code>Embed In HStack</code>。</p>
<p><img src="https://camo.githubusercontent.com/8caee3d1764973d6aa74464911639db3835510e1801389dfb428a9d083967c0f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f366233656139613838352f36353538333832372d343235612d343934332d626135662d6261663134636237663834622e706e67" alt=""></p>
<h2 id="步骤七">步骤七</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%83"></a></p>
<p>在地点文本后添加新的文本视图，将默认文本更改为公园所在的州，然后将其<code>font</code>设置为<code>subheadline</code> 。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/9bfc0dced1ef3a52ce3d041accc719f33799390abfb6cd709ea43b3270777fc0/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383262663137313031392f63323936656633632d333235622d346166342d393061642d3862346536663932666531302e706e67" alt=""></p>
<h2 id="步骤八">步骤八</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AB"></a></p>
<blockquote>
<p>若想使布局自动撑开并充满设备的宽，在<code>HStack</code>中添加<code>Spacer</code>来分隔<code>Joshua Tree National Park</code>和<code>California</code>两个文本视图。</p>
</blockquote>
<p><code>Spacer</code>将撑开<code>Stack</code>，以使其包含的视图充满其父视图的所有空间，而不是仅由其内容定义其大小。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/e806ad2124c7ae0896f94c64ecfa668c53e32539ef4e511deebb3dc7d2fcdff1/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643731306534363964352f64323865643832652d366230632d343738632d623139662d3030666664323262653831652e706e67" alt=""></p>
<h2 id="步骤九">步骤九</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B9%9D"></a></p>
<p>最后，使用<code>padding()</code>修饰符方法给整个地标信息区域加一个边距。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/6722a06a707c4babd354052944bc899cc907cbcd117c4b8ccf5e2f63bf1fb6b1/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f636539656364316434382f64656636386131392d666237362d346133322d396539312d6539643265393364343036372e706e67" alt=""></p>
<h2 id="第四节">第四节</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82"></a></p>
<p>创建自定义图像视图</p>
<p>在名称和地点视图都设置好的情况下，接下来要做的是为地标添加一个图像。</p>
<p>对自定义的图像使用遮罩、边框和阴影，和原来的方法相比，将使用很少的代码。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/custom-image-view.gif" alt=""></p>
<blockquote>
<p>首先将图片添加到项目的<code>Assets</code>中。</p>
</blockquote>
<h2 id="步骤一-4">步骤一</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%80-3"></a></p>
<p>在项目<code>Resources</code>文件夹的中找到<code>turtlerock.png</code>，将其拖到<code>Assets</code>中。Xcode为图像创建一个新的图像集。</p>
<p><img src="https://camo.githubusercontent.com/dfa87e40344b3fceb0c5ccded545c0c4d576332d0c5fad96ae69de5ec0647cea/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623539663862646134352f35666662663461382d346361642d343162652d623839342d3162323062363935646262352e706e67" alt=""></p>
<blockquote>
<p>接下来，您将为您的自定义图像视图创建一个新的SwiftUI视图。</p>
</blockquote>
<h2 id="步骤二-3">步骤二</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C-2"></a></p>
<p>选择<code>File &gt; New &gt; File</code>再次打开模板选择器。在<code>User Interface</code>中，单击选择<code>SwiftUI View</code>，然后单击<code>Next</code>。将文件命名为<code>CircleImage.swift</code>，然后单击<code>Create</code>。</p>
<p><img src="https://camo.githubusercontent.com/38f219688c78bf6c3f118949309132314feb802fec3adf0f05444fb2fc0c9772/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356165373664396566372f38326564626531612d646662362d346236332d623637322d6432356631646339633462302e706e67" alt=""></p>
<blockquote>
<p>现在您已准备好图像，以满足设计所需。</p>
</blockquote>
<h3 id="步骤三-4">步骤三</h3>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89-3"></a></p>
<p>使用<code>Image(:)</code>将<code>Text</code>视图替换为Turtle Rock的图像视图。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/fa383c03ffe8a6bcfa8a8c9b28d3711f86f6f6e0fe05b7503422c19d3151b360/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f653636643661303632392f38316562313064342d393739632d346164382d393539312d6131613239343834653464612e706e67" alt=""></p>
<h2 id="步骤四-4">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B-3"></a></p>
<p>添加<code>Image</code>的<code>.clipShape(Circle())</code>的修饰符，将图像剪裁为圆形。</p>
<p><code>Circle()</code>是一个可以用作遮罩的形状，或通过给<code>Circle()</code>设置<code>stroke</code>或<code>fill</code>来绘制视图。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d12972cd7ad4fa16646907177dc7e2cd8c306fa848d21147a6f34272e66cb953/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666366323666323732652f30643166663464612d653838632d346537392d383065612d3537366364633164646364372e706e67" alt=""></p>
<h2 id="步骤五-4">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94-3"></a></p>
<p>创建另一个带有灰色<code>stroke</code>的<code>Circle()</code>，使用<code>.overlay()</code>修饰符，将其覆盖添加到图像的边框中。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="type">Circle</span>().stroke(<span class="type">Color</span>.gray, lineWidth: <span class="number">4</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/7478ced9e68d1e568b055f1640cfefec6a0eeb02bc63dbd30d65aaeae716090c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373665376531343663622f62323063333934652d663330322d343638312d383163302d6336353561363162326337302e706e67" alt=""></p>
<h2 id="步骤六-4">步骤六</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AD-3"></a></p>
<p>接下来，添加半径为<code>10point</code>的阴影。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="type">Circle</span>().stroke(<span class="type">Color</span>.gray, lineWidth: <span class="number">4</span>))</span><br><span class="line">            .shadow(radius: <span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/4d29477149e15aa7473f5a604192733176f7ca99878d2391b53f5bccdee1db15/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313663636235646262342f61343930346164302d373864632d346635662d613366332d3165393761663331353734362e706e67" alt=""></p>
<h2 id="步骤七-2">步骤七</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%83-1"></a></p>
<p>将边框颜色修改为白色。</p>
<p>到此，我们就完成了图像视图。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>)</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="type">Circle</span>().stroke(<span class="type">Color</span>.white, lineWidth: <span class="number">4</span>))</span><br><span class="line">            .shadow(radius: <span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/89d64a999cb02f62d2946240944ab76e7de310b58d23dd69864bf049c7cb4af9/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f353463356536356234332f65646332636666312d646465342d343931372d623538642d6564346330353639303762622e706e67" alt=""></p>
<h2 id="第五节">第五节</h2>
<p><a href="#%E7%AC%AC%E4%BA%94%E8%8A%82"></a></p>
<h2 id="UIKit和SwiftUI配合使用">UIKit和SwiftUI配合使用</h2>
<p><a href="#uikit%E5%92%8Cswiftui%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"></a></p>
<p>现在可以创建地图视图了，您可以使用<code>MapKit</code>中的<code>MKMappView</code>类来绘制地图。</p>
<p>要在SwiftUI中使用UIView子类，可以将另一个视图包装在遵守UIViewRepresentable协议的SwiftUI视图中。SwiftUI包含了WatchKit和AppKit视图类似的协议。</p>
<p><img src="https://camo.githubusercontent.com/b3ae3c503c97109a3f27929c376bb5ef88ddd37f5ddf569f6b4d25236fec9a4d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313665326561303530312f62393735333932372d666234342d346637342d383736662d3331643931323663626231362e706e67" alt=""></p>
<blockquote>
<p>现在开始，您将创建一个新的自定义视图，该视图可以显示<code>MKMapView</code>。</p>
</blockquote>
<p>选择<code>File &gt; New &gt; File</code>，选择<code>iOS</code>平台，选择<code>SwiftUI View</code>模板，然后单击<code>Next</code>。将新文件命名为<code>MapView.swift</code>，然后单击“Create”。</p>
<p><img src="https://camo.githubusercontent.com/b2cbf45d4a436da332f40ab478e46f01f52f21ae1407b995a2fc07def74d1db5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303266346264623163372f62633066323063662d313039342d343139332d623832372d3435353737306266626132392e706e67" alt=""></p>
<h2 id="步骤二-4">步骤二</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C-3"></a></p>
<p>添加<code>import MapKit</code>，并让<code>MappView</code>结构遵守UIViewRepresentable协议。</p>
<p>不要担心Xcode显示的警告；您将在接下来的几个步骤中修复它。</p>
<blockquote>
<p>MapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MapKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">MapView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>UIViewRepresentable</code>协议有两个需要实现的方法：使用<code>UIView(context:)</code>方法创建<code>MKMapView</code>，使用<code>updateUIView(u:context:)</code>方法来配置视图并响应视图的任意变化。</p>
</blockquote>
<h2 id="步骤三-5">步骤三</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89-4"></a></p>
<p>用<code>makeUIView（context:）</code>方法替换body属性。</p>
<blockquote>
<p>MapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MapKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">MKMapView</span> &#123;</span><br><span class="line">        <span class="type">MKMapView</span>(frame: .zero)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">MapView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤四-5">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B-4"></a></p>
<p>创建一个<code>updateUIView（u:context:）</code>方法，将地图视图的区域设置为正确的坐标，以便将地图居中放置在<code>Turtle Rock</code>上。</p>
<blockquote>
<p>MapView.swift</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import SwiftUI</span><br><span class="line">import MapKit</span><br><span class="line"></span><br><span class="line">struct MapView: UIViewRepresentable &#123;</span><br><span class="line">    func makeUIView(context: Context) -&gt; MKMapView &#123;</span><br><span class="line">        MKMapView(frame: .zero)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func updateUIView(_ view: MKMapView, context: Context) &#123;</span><br><span class="line">        let coordinate = CLLocationCoordinate2D(</span><br><span class="line">            latitude: 34.011286, longitude: -116.166868)</span><br><span class="line">        let span = MKCoordinateSpan(latitudeDelta: 2.0, longitudeDelta: 2.0)</span><br><span class="line">        let region = MKCoordinateRegion(center: coordinate, span: span)</span><br><span class="line">        view.setRegion(region, animated: true)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct MapView_Preview: PreviewProvider &#123;</span><br><span class="line">    static var previews: some View &#123;</span><br><span class="line">        MapView()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当预览处于静态模式时，它们仅完全呈现<code>SwiftUI</code>视图。因为<code>MKMapView</code>是一个<code>UIView</code>子类，所以您需要切换到实时预览来查看地图。</p>
</blockquote>
<h2 id="步骤五-5">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94-4"></a></p>
<p>单击<code>Live Preview</code>按钮将预览切换到实时预览模式。您可能需要单击预览上方的<code>Try Again</code>或<code>Resume</code>按钮。</p>
<p>再过一会儿，你会看到一张<code>Joshua Tree National Park</code>的地图，那里是<code>Turtle Rock</code>的故乡。</p>
<p><img src="https://camo.githubusercontent.com/f721594834182445ac4af6508efaae5520c53febf3c75b5f8549aa1de1177e9c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343239336536353339662f37346238633831302d626537382d346133362d613032382d6634643132373466633736302e706e67" alt=""></p>
<h2 id="第六节">第六节</h2>
<p><a href="#%E7%AC%AC%E5%85%AD%E8%8A%82"></a></p>
<h2 id="组成详情视图">组成详情视图</h2>
<p><a href="#%E7%BB%84%E6%88%90%E8%AF%A6%E6%83%85%E8%A7%86%E5%9B%BE"></a></p>
<p>现在您已经拥有了所需的所有组件——名称和位置、圆形图像以及地图。</p>
<p>现在使用目前的工具，组合自定义视图，创建地标详情视图以达到最终设计吧。</p>
<p><img src="https://camo.githubusercontent.com/194cd52911cf2ed5d4e3cad7953c38a7375a16ebc26d3932c8e196642dab6096/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333365313530626235352f39373362613730322d383564622d343835322d383531662d3836613934636663613030322e706e67" alt=""></p>
<h2 id="步骤一-5">步骤一</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%80-4"></a></p>
<p>在项目导航器中，选择<code>ContentView.swift</code>文件。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                .font(.title)</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                    .font(.subheadline)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f8c51da637994597d28d41dc04507f0f93c251000f39564ef23e867b941493a3/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f366430303836356435342f62613132646666372d386164622d346565612d396535322d6239323237386639376134642e706e67" alt=""></p>
<h2 id="步骤二-5">步骤二</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C-4"></a></p>
<p>将刚才的三个文本的VStack嵌入到另一个VStack中。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f8c51da637994597d28d41dc04507f0f93c251000f39564ef23e867b941493a3/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f366430303836356435342f62613132646666372d386164622d346565612d396535322d6239323237386639376134642e706e67" alt=""></p>
<h2 id="步骤三-6">步骤三</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%89-5"></a></p>
<blockquote>
<p>将自定义<code>MapView</code>添加到<code>Stack</code>顶部。使用<code>frame(width:height:)</code>设置<code>MapView</code>的大小。</p>
</blockquote>
<p>仅指定<code>height(高度)</code>参数时，视图会自动调整其内容的宽度。在这种情况下，<code>MapView</code>将展开以填充可用空间。</p>
<h2 id="步骤四-6">步骤四</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B-5"></a></p>
<p>单击<code>Live Preview</code>按钮，以在预览中查看渲染的地图。</p>
<p>您可以在显示实时预览时继续编辑视图。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/bec25a515816f18045c64d1ef74843d963bb109bf840aea5ebe74f2dfdc1440b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f653536353333656265632f32626662663733302d666362662d343430352d613132312d6435666563393663313430332e706e67" alt=""></p>
<h2 id="步骤五-6">步骤五</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%BA%94-5"></a></p>
<p>将<code>CircleImage</code>视图添加到<code>Stack</code>中。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/7ca40186fd5e512a5fc8af8816f02a1504e386df895bbaf069430d47208c58f5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373261363131396562302f61373938633064382d653561632d346531392d383461382d3565336636623762663465322e706e67" alt=""></p>
<h2 id="步骤六-5">步骤六</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AD-4"></a></p>
<p>若要将<code>CircleImage</code>显示在<code>MapView</code>视图的上方，请使图像垂直偏移-130个点，并从视图底部填充-130个点。</p>
<p>这些调整通过向上移动图像为文本腾出空间。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5a711088e7a71112df3d58961351cc7f0e33438f2160a85e6e24e21898b83ff8/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623735306231356663652f37613135633138382d616334642d346163302d386161372d6163663536636431353737642e706e67" alt=""></p>
<h2 id="步骤七-3">步骤七</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E4%B8%83-2"></a></p>
<p>在<code>VStack</code>中底部添加一个<code>Spacer()</code>，将内容推到屏幕的顶部。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/71a7e5f83911ef9b430ae72e3560407b9976f3340bd52f8b5080ab4da1bf1d74/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666538313037343966622f33343663313732652d313335382d343966652d626238392d3331633030373736656561382e706e67" alt=""></p>
<h2 id="步骤八-2">步骤八</h2>
<p><a href="#%E6%AD%A5%E9%AA%A4%E5%85%AB-1"></a></p>
<p>最后，要允许地图内容扩展到屏幕的上边缘，请将<code>edgesIgnoringSafeArea（.top）</code>修饰符添加到地图视图中。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .edgesIgnoringSafeArea(.top)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ContentView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f348f6b5192adb6ce6417793d8aef7e43df24a97d6076575985141f77a9c2a87/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336231356434363864362f36363530306134662d303137392d343465362d616362302d6166393436383964396538652e706e67" alt=""></p>
<h3 id="绘图和动画">绘图和动画</h3>
<p><a href="#%E7%BB%98%E5%9B%BE%E5%92%8C%E5%8A%A8%E7%94%BB"></a></p>
<h2 id="绘制路径和形状">绘制路径和形状</h2>
<p><a href="#%E7%BB%98%E5%88%B6%E8%B7%AF%E5%BE%84%E5%92%8C%E5%BD%A2%E7%8A%B6"></a></p>
<p>用户每次访问列表中的地标时都会收到徽章。当然，要让用户收到徽章，您需要创建一个徽章。本教程将引导您通过组合路径和形状来创建徽章，然后将其与表示位置的另一个形状重叠。</p>
<p>如果要为不同类型的地标创建多个徽章，请尝试使用覆盖的符号、更改重复次数或更改不同角度和比例。</p>
<blockquote>
<p>学习时间：25分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/03f5d726da/DrawingPathsAndShapes.zip">下载地址：DrawingPathsAndShapes.zip</a></p>
</blockquote>
<h2 id="第一节-创建徽章视图">第一节 创建徽章视图</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E5%88%9B%E5%BB%BA%E5%BE%BD%E7%AB%A0%E8%A7%86%E5%9B%BE"></a></p>
<p>要创建徽章，首先要创建一个徽章视图，该视图使用<code>SwiftUI</code>中的矢量绘图<code>api</code>。</p>
<p><img src="https://camo.githubusercontent.com/774d2e73ebaff78b70c40ca9529b4861403a603308c8194925f26c99219a5c79/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633034643230303131322f31656161366365302d303239662d343637652d396431392d3038353266636461646233352e706e67" alt=""></p>
<h2 id="步骤1-6">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>选择<code>File &gt; New &gt; File</code>，然后从“iOS模板”工作表中选择<code>SwiftUI View</code>。单击<code>Next</code>继续，然后在“Save as”字段中输入<code>Badge</code>并单击“Create”。</p>
<p><img src="https://camo.githubusercontent.com/99555d98d1b740eee3060c51ebdeb1d66ccfbef1c27e68c781b2b4914aeefeae/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383436353835636132362f31356132366132382d653630652d343034342d623765372d3236643838646434653531302e706e67" alt=""></p>
<h2 id="步骤2-6">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>调整<code>Badge</code>视图以显示文本“Badge”，接下来我们开始定义徽章形状。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Badge&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/929d03baece74b8f321a9b5d3658d7e94c9672a1a1ddd1c2db4025a405459b5f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f306637373361633362632f34326663666164642d346636322d343833392d393635662d6633343238663863336431622e706e67" alt=""></p>
<h2 id="第二节-绘制徽章背景">第二节 绘制徽章背景</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E7%BB%98%E5%88%B6%E5%BE%BD%E7%AB%A0%E8%83%8C%E6%99%AF"></a></p>
<p>使用SwiftUI中的图形api绘制自定义徽章形状。</p>
<p><img src="https://camo.githubusercontent.com/152655c4d7925d1485ba71c999f8d9d69c540687d4b5d23baec49ae52e8b6c7c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356636333265333030352f31353832333462662d356139382d346436342d386663302d3764363835663431393435332e706e67" alt=""></p>
<h2 id="步骤1-7">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<blockquote>
<p>查看<code>HexagonParameters.swift</code>文件中的代码。</p>
</blockquote>
<p>六边形参数结构定义了绘制徽章六边形的详细信息。您不会修改此数据；相反，您将使用它指定用于绘制徽章的线条和曲线的控制点。</p>
<blockquote>
<p>HexagonParameters.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HexagonParameters</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Segment</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> useWidth: (<span class="type">CGFloat</span>, <span class="type">CGFloat</span>, <span class="type">CGFloat</span>)</span><br><span class="line">        <span class="keyword">let</span> xFactors: (<span class="type">CGFloat</span>, <span class="type">CGFloat</span>, <span class="type">CGFloat</span>)</span><br><span class="line">        <span class="keyword">let</span> useHeight: (<span class="type">CGFloat</span>, <span class="type">CGFloat</span>, <span class="type">CGFloat</span>)</span><br><span class="line">        <span class="keyword">let</span> yFactors: (<span class="type">CGFloat</span>, <span class="type">CGFloat</span>, <span class="type">CGFloat</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> adjustment: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.085</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> points <span class="operator">=</span> [</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">0.60</span>, <span class="number">0.40</span>, <span class="number">0.50</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">0.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.05</span>, <span class="number">0.05</span>, <span class="number">0.00</span>)</span><br><span class="line">        ),</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">0.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">0.05</span>, <span class="number">0.00</span>, <span class="number">0.00</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.20</span> <span class="operator">+</span> adjustment, <span class="number">0.30</span> <span class="operator">+</span> adjustment, <span class="number">0.25</span> <span class="operator">+</span> adjustment)</span><br><span class="line">        ),</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">0.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">0.00</span>, <span class="number">0.05</span>, <span class="number">0.00</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.70</span> <span class="operator">-</span> adjustment, <span class="number">0.80</span> <span class="operator">-</span> adjustment, <span class="number">0.75</span> <span class="operator">-</span> adjustment)</span><br><span class="line">        ),</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">0.40</span>, <span class="number">0.60</span>, <span class="number">0.50</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.95</span>, <span class="number">0.95</span>, <span class="number">1.00</span>)</span><br><span class="line">        ),</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">0.95</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.80</span> <span class="operator">-</span> adjustment, <span class="number">0.70</span> <span class="operator">-</span> adjustment, <span class="number">0.75</span> <span class="operator">-</span> adjustment)</span><br><span class="line">        ),</span><br><span class="line">        <span class="type">Segment</span>(</span><br><span class="line">            useWidth:  (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            xFactors:  (<span class="number">1.00</span>, <span class="number">0.95</span>, <span class="number">1.00</span>),</span><br><span class="line">            useHeight: (<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">1.00</span>),</span><br><span class="line">            yFactors:  (<span class="number">0.30</span> <span class="operator">+</span> adjustment, <span class="number">0.20</span> <span class="operator">+</span> adjustment, <span class="number">0.25</span> <span class="operator">+</span> adjustment)</span><br><span class="line">        )</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-7">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>在<code>Badge.swift</code>中，向<code>Badge</code>添加一个<code>Path shape</code>，并应用<code>fill（）</code>修饰符将该形状转换为视图。</p>
<p>您可以使用<code>paths</code>来组合线条、曲线和其他绘图，以形成更复杂的形状，如徽章的六边形背景。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        .fill(<span class="type">Color</span>.black)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-5">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>为<code>path</code>添加起点。</p>
<p><code>move（to:）</code>方法在形状的边界内移动绘图光标，就像一支虚构的笔悬停在该区域上，等待开始绘图一样。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">100.0</span></span><br><span class="line">            <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">            path.move(to: <span class="type">CGPoint</span>(x: width <span class="operator">*</span> <span class="number">0.95</span>, y: height <span class="operator">*</span> <span class="number">0.20</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        .fill(<span class="type">Color</span>.black)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-4">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>为形状数据的每个点绘制线，以创建一个大致的六边形。</p>
<p><code>addLine（to:）</code>方法接受一个点并绘制它。对<code>addLine（to:）</code>连续调用，会从上一点开始到新点画一条线。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">100.0</span></span><br><span class="line">            <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">            path.move(to: <span class="type">CGPoint</span>(x: width <span class="operator">*</span> <span class="number">0.95</span>, y: height <span class="operator">*</span> <span class="number">0.20</span>))</span><br><span class="line">            </span><br><span class="line">            <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                path.addLine(</span><br><span class="line">                    to: .<span class="keyword">init</span>(</span><br><span class="line">                        x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .fill(<span class="type">Color</span>.black)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/ed85c5f693b54a593cc345800d22c474866f66600c7a317f815b704ff64e5af3/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f653562343833633738622f33383931613534372d366466342d343731382d383362632d6335313766333166623438612e706e67" alt=""></p>
<blockquote>
<p>如果你的六边形看起来有点不寻常，不要担心；这符合预期。在接下来的几个步骤中，您将努力使六边形看起来更像本节开头显示的徽章形状。</p>
</blockquote>
<h2 id="步骤5-2">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>使用<code>addQuadCurve（to:control:）</code>方法为徽章的角绘制<code>Bézier</code>曲线。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">100.0</span></span><br><span class="line">            <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">            path.move(</span><br><span class="line">                to: <span class="type">CGPoint</span>(</span><br><span class="line">                    x: width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                    y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                path.addLine(</span><br><span class="line">                    to: .<span class="keyword">init</span>(</span><br><span class="line">                        x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                path.addQuadCurve(</span><br><span class="line">                    to: .<span class="keyword">init</span>(</span><br><span class="line">                        x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                    ),</span><br><span class="line">                    control: .<span class="keyword">init</span>(</span><br><span class="line">                        x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .fill(<span class="type">Color</span>.black)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/87cfebdd9ef83b5c88d360e56ef8075fdb707f0022f55cdb937b6e1b7d286209/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383238323862653436652f62633739393939392d336637632d343463312d623463332d3265333964613466373463312e706e67" alt=""></p>
<h2 id="步骤6-2">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<blockquote>
<p>将徽章<code>path</code>包装在<code>GeometryReader</code>中，以便徽章可以使用其包含视图的大小，该视图定义大小，而不是硬编码值（100）。</p>
</blockquote>
<p>当包含的视图不是正方形时，使用几何体的两个维度中的最小值以保证徽章的宽高比。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">                path.move(</span><br><span class="line">                    to: <span class="type">CGPoint</span>(</span><br><span class="line">                        x: width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                    path.addLine(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                    </span><br><span class="line">                    path.addQuadCurve(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                        ),</span><br><span class="line">                        control: .<span class="keyword">init</span>(</span><br><span class="line">                            x: width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="type">Color</span>.black)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/61a30b59da3216e824c6590b73438de6c4ab4edc0a04ecb6ad00b78ea23eaee2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313632643635333131352f66306264636565322d316633302d343264622d396635372d6661646532343463663064392e706e67" alt=""></p>
<h2 id="步骤7">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47"></a></p>
<p>使用<code>xScale</code>和<code>xOffset</code>调整变量使徽章在其几何体中居中。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">                <span class="keyword">let</span> xScale: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.832</span></span><br><span class="line">                <span class="keyword">let</span> xOffset <span class="operator">=</span> (width <span class="operator">*</span> (<span class="number">1.0</span> <span class="operator">-</span> xScale)) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">                width <span class="operator">*=</span> xScale</span><br><span class="line">                path.move(</span><br><span class="line">                    to: <span class="type">CGPoint</span>(</span><br><span class="line">                        x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                    path.addLine(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                    </span><br><span class="line">                    path.addQuadCurve(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                        ),</span><br><span class="line">                        control: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="type">Color</span>.black)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/37f8b437e325cf8c743d02b004c60c4b608e24fbfe2556fd9b899b94d4aa749a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333565653665356265612f39333734316261332d396662622d343633362d613336372d3630323262663839663463652e706e67" alt=""></p>
<h2 id="步骤8">步骤8</h2>
<p><a href="#%E6%AD%A5%E9%AA%A48"></a></p>
<p>将徽章的纯黑背景替换为与设计匹配的渐变色。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">                <span class="keyword">let</span> xScale: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.832</span></span><br><span class="line">                <span class="keyword">let</span> xOffset <span class="operator">=</span> (width <span class="operator">*</span> (<span class="number">1.0</span> <span class="operator">-</span> xScale)) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">                width <span class="operator">*=</span> xScale</span><br><span class="line">                path.move(</span><br><span class="line">                    to: <span class="type">CGPoint</span>(</span><br><span class="line">                        x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                    path.addLine(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                    </span><br><span class="line">                    path.addQuadCurve(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                        ),</span><br><span class="line">                        control: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="type">LinearGradient</span>(</span><br><span class="line">                gradient: .<span class="keyword">init</span>(colors: [<span class="keyword">Self</span>.gradientStart, <span class="keyword">Self</span>.gradientEnd]),</span><br><span class="line">                startPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0</span>),</span><br><span class="line">                endPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0.6</span>)</span><br><span class="line">            ))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientStart <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">221.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientEnd <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">172.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/1e524ce2966d5a60db50b14b4b30ae40adbd877f7e0456464b2d1dfa6ebc7f5a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346631383133633738392f63376362313063312d376536342d346362362d623536362d3065306533633566326331372e706e67" alt=""></p>
<h2 id="步骤9">步骤9</h2>
<p><a href="#%E6%AD%A5%E9%AA%A49"></a></p>
<p>对渐变填充应用<code>aspectRatio（u:contentMode:）</code>修饰符。</p>
<p>即使其父视图不是正方形的，可以通过它可以使视图保持1:1的宽高比，并保持其在视图中心的位置。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">                <span class="keyword">let</span> xScale: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.832</span></span><br><span class="line">                <span class="keyword">let</span> xOffset <span class="operator">=</span> (width <span class="operator">*</span> (<span class="number">1.0</span> <span class="operator">-</span> xScale)) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">                width <span class="operator">*=</span> xScale</span><br><span class="line">                path.move(</span><br><span class="line">                    to: <span class="type">CGPoint</span>(</span><br><span class="line">                        x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                    path.addLine(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                    </span><br><span class="line">                    path.addQuadCurve(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                        ),</span><br><span class="line">                        control: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="type">LinearGradient</span>(</span><br><span class="line">                gradient: .<span class="keyword">init</span>(colors: [<span class="keyword">Self</span>.gradientStart, <span class="keyword">Self</span>.gradientEnd]),</span><br><span class="line">                startPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0</span>),</span><br><span class="line">                endPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0.6</span>)</span><br><span class="line">            ))</span><br><span class="line">            .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientStart <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">221.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientEnd <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">172.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f7fec3cabd47e719e97ea257fc21fb68c72689ffffca4ff3ceeb769d8063483c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333535643136623766662f36623561346438332d373034352d343862312d623431642d6231323936623037303265652e706e67" alt=""></p>
<h2 id="第三节-画徽章符号">第三节 画徽章符号</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E7%94%BB%E5%BE%BD%E7%AB%A0%E7%AC%A6%E5%8F%B7"></a></p>
<p>地标徽章的中心有一个自定义徽章，该徽章基于地标应用程序图标中显示的山。</p>
<p>山体符号由两个形状组成：一个表示山顶的积雪，另一个表示沿引道的植被。您将使用两个由一个小间隙隔开的部分三角形来绘制它们。</p>
<p><img src="https://camo.githubusercontent.com/019468198dbe1e4663f786a97adedae4c70b9857a7bc2a3042250d9515d1480f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f353238376430396166642f34373364366363652d656164342d343438332d616438302d3364363934653733633435612e706e67" alt=""></p>
<h2 id="步骤1-8">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>在名为<code>BadgeBackground.swift</code>的新文件中，将徽章视图的主体放入新的徽章背景视图中，以便为其他视图准备徽章视图。</p>
<blockquote>
<p>BadgeBackground.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeBackground</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">var</span> width: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width</span><br><span class="line">                <span class="keyword">let</span> xScale: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.832</span></span><br><span class="line">                <span class="keyword">let</span> xOffset <span class="operator">=</span> (width <span class="operator">*</span> (<span class="number">1.0</span> <span class="operator">-</span> xScale)) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">                width <span class="operator">*=</span> xScale</span><br><span class="line">                path.move(</span><br><span class="line">                    to: <span class="type">CGPoint</span>(</span><br><span class="line">                        x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="number">0.95</span>,</span><br><span class="line">                        y: height <span class="operator">*</span> (<span class="number">0.20</span> <span class="operator">+</span> <span class="type">HexagonParameters</span>.adjustment)</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                <span class="type">HexagonParameters</span>.points.forEach &#123;</span><br><span class="line">                    path.addLine(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">0</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">0</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">0</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                    </span><br><span class="line">                    path.addQuadCurve(</span><br><span class="line">                        to: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">1</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">1</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">1</span></span><br><span class="line">                        ),</span><br><span class="line">                        control: .<span class="keyword">init</span>(</span><br><span class="line">                            x: xOffset <span class="operator">+</span> width <span class="operator">*</span> <span class="variable">$0</span>.useWidth.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.xFactors.<span class="number">2</span>,</span><br><span class="line">                            y: height <span class="operator">*</span> <span class="variable">$0</span>.useHeight.<span class="number">2</span> <span class="operator">*</span> <span class="variable">$0</span>.yFactors.<span class="number">2</span></span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="type">LinearGradient</span>(</span><br><span class="line">                gradient: .<span class="keyword">init</span>(colors: [<span class="keyword">Self</span>.gradientStart, <span class="keyword">Self</span>.gradientEnd]),</span><br><span class="line">                startPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0</span>),</span><br><span class="line">                endPoint: .<span class="keyword">init</span>(x: <span class="number">0.5</span>, y: <span class="number">0.6</span>)</span><br><span class="line">            ))</span><br><span class="line">            .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientStart <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">221.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> gradientEnd <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">239.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">172.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">120.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeBackground_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeBackground</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-8">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>将徽章背景放在徽章主体中以恢复徽章。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeBackground</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-6">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>为山形创建一个名为<code>BadgeSymbol</code>的新自定义视图，该山形在徽章设计中以旋转方式绘制。</p>
<blockquote>
<p>BadgeSymbol.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Badge Symbol&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeSymbol</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-5">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<blockquote>
<p>使用<code>Paths api</code>绘制符号的顶部。</p>
</blockquote>
<p><em><strong>实验</strong></em></p>
<p>尝试调整与spacing、topWidth和topHeight常量关联的系数，以查看它们如何影响整体形状。</p>
<blockquote>
<p>BadgeSymbol.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> width <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.75</span></span><br><span class="line">                <span class="keyword">let</span> spacing <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.030</span></span><br><span class="line">                <span class="keyword">let</span> middle <span class="operator">=</span> width <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">                <span class="keyword">let</span> topWidth <span class="operator">=</span> <span class="number">0.226</span> <span class="operator">*</span> width</span><br><span class="line">                <span class="keyword">let</span> topHeight <span class="operator">=</span> <span class="number">0.488</span> <span class="operator">*</span> height</span><br><span class="line">                </span><br><span class="line">                path.addLines([</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">-</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">+</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing)</span><br><span class="line">                ])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeSymbol</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d4fadb1b6926aa0b920704543e3f73a53eca3e540352a8451d47b41ea0f88306/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303864376334646534332f34653164623734382d653532622d343964662d386634652d3264636562356137303631662e706e67" alt=""></p>
<h2 id="步骤5-3">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>绘制符号的底部。</p>
<p>使用<code>move(to:)</code> 修饰符在同一路径中的多个形状之间插入间隙。</p>
<blockquote>
<p>BadgeSymbol.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> width <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.75</span></span><br><span class="line">                <span class="keyword">let</span> spacing <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.030</span></span><br><span class="line">                <span class="keyword">let</span> middle <span class="operator">=</span> width <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">                <span class="keyword">let</span> topWidth <span class="operator">=</span> <span class="number">0.226</span> <span class="operator">*</span> width</span><br><span class="line">                <span class="keyword">let</span> topHeight <span class="operator">=</span> <span class="number">0.488</span> <span class="operator">*</span> height</span><br><span class="line">                </span><br><span class="line">                path.addLines([</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">-</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">+</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing)</span><br><span class="line">                ])</span><br><span class="line">                </span><br><span class="line">                path.move(to: <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing <span class="operator">*</span> <span class="number">3</span>))</span><br><span class="line">                path.addLines([</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">-</span> topWidth, y: topHeight <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: spacing, y: height <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: width <span class="operator">-</span> spacing, y: height <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">+</span> topWidth, y: topHeight <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing <span class="operator">*</span> <span class="number">3</span>)</span><br><span class="line">                ])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeSymbol</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/2aeb7c2c54ec4a4df93333c94e73d44e38f3d49090df9e54659f949904bcf0fd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313836336566373939612f38343533353366342d386161302d343661362d613235662d6539333866626132363064632e706e67" alt=""></p>
<h2 id="步骤6-3">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-1"></a></p>
<p>用设计中的紫色填充符号。</p>
<blockquote>
<p>BadgeSymbol.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> symbolColor <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">79.0</span> <span class="operator">/</span> <span class="number">255</span>, green: <span class="number">79.0</span> <span class="operator">/</span> <span class="number">255</span>, blue: <span class="number">191.0</span> <span class="operator">/</span> <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">Path</span> &#123; path <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> width <span class="operator">=</span> <span class="built_in">min</span>(geometry.size.width, geometry.size.height)</span><br><span class="line">                <span class="keyword">let</span> height <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.75</span></span><br><span class="line">                <span class="keyword">let</span> spacing <span class="operator">=</span> width <span class="operator">*</span> <span class="number">0.030</span></span><br><span class="line">                <span class="keyword">let</span> middle <span class="operator">=</span> width <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">                <span class="keyword">let</span> topWidth <span class="operator">=</span> <span class="number">0.226</span> <span class="operator">*</span> width</span><br><span class="line">                <span class="keyword">let</span> topHeight <span class="operator">=</span> <span class="number">0.488</span> <span class="operator">*</span> height</span><br><span class="line">                </span><br><span class="line">                path.addLines([</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">-</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">+</span> topWidth, y: topHeight <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: spacing)</span><br><span class="line">                ])</span><br><span class="line">                </span><br><span class="line">                path.move(to: <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing <span class="operator">*</span> <span class="number">3</span>))</span><br><span class="line">                path.addLines([</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">-</span> topWidth, y: topHeight <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: spacing, y: height <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: width <span class="operator">-</span> spacing, y: height <span class="operator">-</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle <span class="operator">+</span> topWidth, y: topHeight <span class="operator">+</span> spacing),</span><br><span class="line">                    <span class="type">CGPoint</span>(x: middle, y: topHeight <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> spacing <span class="operator">*</span> <span class="number">3</span>)</span><br><span class="line">                ])</span><br><span class="line">            &#125;</span><br><span class="line">            .fill(<span class="keyword">Self</span>.symbolColor)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BadgeSymbol_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeSymbol</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/fc3faabc42bfcfce0d0a86b1b86971ce62182e10312cb36b6d8a05722fe77787/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393631363965323830662f33643161333332362d646566612d343762342d623135352d3961643734646639636464312e706e67" alt=""></p>
<h2 id="第四节-结合徽章前景和背景">第四节 结合徽章前景和背景</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E7%BB%93%E5%90%88%E5%BE%BD%E7%AB%A0%E5%89%8D%E6%99%AF%E5%92%8C%E8%83%8C%E6%99%AF"></a></p>
<p>徽章设计要求在徽章背景上旋转和重复多次山形。</p>
<p>定义一种新的<code>rotation</code>类型，并利用<code>ForEach</code>视图对山形的多个副本使用相同的调整。</p>
<p><img src="https://camo.githubusercontent.com/aefc19d3e0f719333604185d492ec381604058f783ada30cf5eefecc61564831/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336635623564396530312f34333233363733312d303631652d343636322d386632372d3036643731636138663030302e706e67" alt=""></p>
<h2 id="步骤1-9">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>创建新的<code>RotatedBadgeSymbol</code>视图以封装旋转符号。</p>
<p><em><strong>实验</strong></em></p>
<p>调整预览中的角度以测试旋转的效果。</p>
<blockquote>
<p>RotatedBadgeSymbol.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RotatedBadgeSymbol</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> angle: <span class="type">Angle</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">BadgeSymbol</span>()</span><br><span class="line">            .padding(<span class="operator">-</span><span class="number">60</span>)</span><br><span class="line">            .rotationEffect(angle, anchor: .bottom)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RotatedBadgeSymbol_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">RotatedBadgeSymbol</span>(angle: .<span class="keyword">init</span>(degrees: <span class="number">5</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/ad2e99a305cefccad8c1af9625fcd5a9ff17af394400b48eb5ce888f606d07c8/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f613730626135386564302f65303339656131662d343735662d343261662d623561312d3530363365623533353838302e706e67" alt=""></p>
<h2 id="步骤2-9">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>在<code>Badge.swift</code>中，将徽章的符号放置在<code>ZStack</code>中，将其放置在徽章背景上。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> badgeSymbols: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">RotatedBadgeSymbol</span>(angle: .<span class="keyword">init</span>(degrees: <span class="number">0</span>))</span><br><span class="line">            .opacity(<span class="number">0.5</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="type">BadgeBackground</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">self</span>.badgeSymbols</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/4c54668adce42a3f23ee929bbb920da390554088e0499f1118a56e3103976bee/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f636133386162363635662f61613838653861382d666339652d343332312d626666632d3134313936663561366233392e706e67" alt=""></p>
<blockquote>
<p>现在看来，徽章符号与预期的设计和背景的相对大小相比太大了。</p>
</blockquote>
<h2 id="步骤3-7">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>通过读取周围的几何图形并缩放符号，更正徽章符号的大小。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> badgeSymbols: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">RotatedBadgeSymbol</span>(angle: .<span class="keyword">init</span>(degrees: <span class="number">0</span>))</span><br><span class="line">            .opacity(<span class="number">0.5</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="type">BadgeBackground</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>.badgeSymbols</span><br><span class="line">                    .scaleEffect(<span class="number">1.0</span> <span class="operator">/</span> <span class="number">4.0</span>, anchor: .top)</span><br><span class="line">                    .position(x: geometry.size.width <span class="operator">/</span> <span class="number">2.0</span>, y: (<span class="number">3.0</span> <span class="operator">/</span> <span class="number">4.0</span>) <span class="operator">*</span> geometry.size.height)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/09976e95e2403dcece078fb1844cb1507b630bb76f19daecd72b08257b4b011b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393030343133613433662f35393537303331322d373337642d343062352d393437322d3030626431363163633066652e706e67" alt=""></p>
<h2 id="步骤4-6">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>使用<code>ForEach</code>创建旋转显示多个徽章符号的副本。</p>
<p>一个完整的360°旋转分成八个部分，通过重复山脉符号创建一个类似太阳的图案。</p>
<blockquote>
<p>Badge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> rotationCount <span class="operator">=</span> <span class="number">8</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> badgeSymbols: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>(<span class="number">0</span><span class="operator">..&lt;</span><span class="type">Badge</span>.rotationCount) &#123; i <span class="keyword">in</span></span><br><span class="line">            <span class="type">RotatedBadgeSymbol</span>(</span><br><span class="line">                angle: .degrees(<span class="type">Double</span>(i) <span class="operator">/</span> <span class="type">Double</span>(<span class="type">Badge</span>.rotationCount)) <span class="operator">*</span> <span class="number">360.0</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        .opacity(<span class="number">0.5</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="type">BadgeBackground</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>.badgeSymbols</span><br><span class="line">                    .scaleEffect(<span class="number">1.0</span> <span class="operator">/</span> <span class="number">4.0</span>, anchor: .top)</span><br><span class="line">                    .position(x: geometry.size.width <span class="operator">/</span> <span class="number">2.0</span>, y: (<span class="number">3.0</span> <span class="operator">/</span> <span class="number">4.0</span>) <span class="operator">*</span> geometry.size.height)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .scaledToFit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Badge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Badge</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/15ff62f5c4764fddd5e34e530ddd55baeb2c23d7db10f095d2de39e4ce090b1c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633266353134336336612f38656165633265312d306564652d343561332d386361382d6139376230323135653530392e706e67" alt=""></p>
<h3 id="框架集成">框架集成</h3>
<p><a href="#%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90"></a></p>
<h2 id="与UIKit协作">与UIKit协作</h2>
<p><a href="#%E4%B8%8Euikit%E5%8D%8F%E4%BD%9C"></a></p>
<p>SwiftUI与所有苹果平台上现有的UI框架无缝协作。例如，可以将UIKit视图和视图控制器放置在SwiftUI视图中，反之亦然。</p>
<p>本教程向您展示如何将主页的特色地标转换为包装UIPageViewController和UIPageControl实例。您将使用UIPageViewController来显示SwiftUI视图的轮播，并使用状态变量和绑定来协调整个用户界面中的数据更新。</p>
<blockquote>
<p>学习时间：25分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/189399d05e/InterfacingWithUIKit.zip">下载地址：InterfacingWithUIKit.zip</a></p>
</blockquote>
<h2 id="第一节">第一节</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82"></a></p>
<p>创建显示UIPageViewController的视图</p>
<p>要在SwiftUI中显示UIKit视图和视图控制器，可以创建遵守<code>UIViewRepresentable</code>和<code>UIViewControllerRepresentable</code>协议的类型，您的自定义类型创建并配置它们所表示的UIKit类型，而SwiftUI管理它们的生命周期，并在需要时更新它们。</p>
<p><img src="https://camo.githubusercontent.com/b490958db204499bec0d9227373b3866b89eacf7ce83dbde95acf21bb9f2fb88/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303665613065303265392f34343662303334372d356462382d343131332d383638632d3661346432626538333832652e706e67" alt=""></p>
<h2 id="步骤1-10">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>创建一个名为<code>PageViewController.swift</code>的新SwiftUI视图文件，并声明<code>PageViewController</code>类型遵守<code>UIViewControllerRepresentable</code>。</p>
<p>页面视图控制器存储<code>UIViewController</code>实例的数组。这些是在地标之间滚动的页面。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>接下来，添加<code>UIViewControllerRepresentable</code>协议的两个方法。</p>
</blockquote>
<h2 id="步骤2-10">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>添加<code>makeUIViewController（context:）</code>方法，该方法创建满足需求的<code>UIPageViewController</code>。</p>
<p>SwiftUI在准备好显示视图时调用此方法一次，然后管理视图控制器的生命周期。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-8">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>添加一个<code>updateUIViewController（_:context:）</code>方法，该方法调用<code>setViewControllers(_:direction:animated:)</code>以显示数组中的第一个视图控制器。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[<span class="number">0</span>]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建另一个SwiftUI视图以显示UIViewControllerRepresentable视图。</p>
</blockquote>
<h2 id="步骤4-7">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>创建一个名为<code>PageView.swift</code>的新SwiftUI视图文件，并更新<code>PageView</code>类型以将<code>PageViewController</code>声明为子视图。</p>
<p>注意，泛型初始值设定项接受一个视图数组，并将每个视图嵌套在<code>UIHostingController</code>中。<code>UIHostingController</code>是<code>UIViewController</code>子类，表示UIKit上下文中的SwiftUI视图。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageViewController</span>(controllers: viewControllers)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-4">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>更新<code>PageView_Preview</code>以传递所需的视图数组，此时预览开始工作。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageViewController</span>(controllers: viewControllers)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">            .aspectRatio(<span class="number">3</span><span class="operator">/</span><span class="number">2</span>, contentMode: .fit)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤6-4">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>在继续下一步之前，将页面视图预览固定到画布，所有操作变化都会发生在此视图上。</p>
<p><img src="https://camo.githubusercontent.com/d38e16df8e4d7240ecca90f3c33c0e8820f34d0ccf2fb0dea6f1edb9c8391101/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383537353364343366392f65646439346234362d366539632d343737312d383265642d3965366533326639623965632e706e67" alt=""></p>
<h2 id="第二节-创建视图控制器的数据源">第二节 创建视图控制器的数据源</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E6%BA%90"></a></p>
<p>在几个简单的步骤中，您已经完成了很多工作—<code>PageViewController</code>使用一个<code>UIPageViewController</code>在SwiftUI视图中显示内容。现在是时候让视图轮播滚动了。</p>
<p><img src="https://camo.githubusercontent.com/58608e8bf0060b71898229848d86fc96cb667132cc83a5d5e93b1747400c78ae/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346662643636376566382f37646366333263302d336230332d346235662d383336302d6264636339306664336632332e706e67" alt=""></p>
<blockquote>
<p>代表UIKit视图控制器的SwiftUI视图可以定义一个``类型，SwiftUI将其作为可表示视图上下文的一部分进行提供和管理。</p>
</blockquote>
<h2 id="步骤1-11">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>在<code>PageViewController</code>中声明嵌套的<code>Coordinator</code>类。</p>
<p>SwiftUI管理<code>UIViewControllerRepresentable</code>类型的<code>Coordinator</code>，并在调用上面创建的方法时将其作为上下文的一部分提供。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[<span class="number">0</span>]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤2-11">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>向<code>PageViewController</code>添加另一个方法以生成<code>Coordinator</code>。</p>
<p>SwiftUI在<code>makeUIViewController(context:)</code>之前调用此<code>makeCoordinator（）</code>方法，以便在配置视图控制器时可以访问<code>coordinator</code>对象。</p>
<blockquote>
<p>Tips 您可以使用这个<code>Coordinator</code>来实现常见的<code>Cocoa</code>模式，例如委托、数据源和通过<code>target-action</code>响应用户事件。</p>
</blockquote>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[<span class="number">0</span>]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤3-9">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>向<code>Coordinator</code>类型添加<code>UIPageViewControllerDataSource</code>一致性，并实现两个必需的方法。</p>
<p>这两个方法建立视图控制器之间的关系，以便您可以在它们之间来回滑动。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[<span class="number">0</span>]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIPageViewControllerDataSource</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerBefore</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.last</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerAfter</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">+</span> <span class="number">1</span> <span class="operator">==</span> parent.controllers.count &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.first</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">+</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤4-8">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>将<code>coordinator</code>添加为<code>UIPageViewController</code>的数据源。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line">        pageViewController.dataSource <span class="operator">=</span> context.coordinator</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[<span class="number">0</span>]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIPageViewControllerDataSource</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerBefore</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.last</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerAfter</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">+</span> <span class="number">1</span> <span class="operator">==</span> parent.controllers.count &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.first</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">+</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤5-5">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>打开实时预览并测试滑动交互。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_p42_swipe_interactions.gif" alt=""></p>
<h2 id="第三节-在SwiftUI视图状态下跟踪页面">第三节 在SwiftUI视图状态下跟踪页面</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%9C%A8swiftui%E8%A7%86%E5%9B%BE%E7%8A%B6%E6%80%81%E4%B8%8B%E8%B7%9F%E8%B8%AA%E9%A1%B5%E9%9D%A2"></a></p>
<p>要准备添加自定义<code>UIPageControl</code>，需要一种方法从<code>PageView</code>中跟踪当前页。</p>
<p>为此，您将在<code>PageView</code>中声明<code>@State</code>属性，并将对该属性的绑定传递到<code>PageViewController</code>视图。<code>PageViewController</code>更新绑定以匹配当前可见页。</p>
<p><img src="https://camo.githubusercontent.com/e92d63ed36a1d524de83d58689d504c2b2618167cffc2dd875938f3bc65159df/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313865323661616564652f62393733393638612d633030372d343061332d613332342d6431626336383731313134622e706e67" alt=""></p>
<h2 id="步骤1-12">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>首先添加一个<code>currentPage</code>绑定作为<code>PageViewController</code>的属性。</p>
<p>除了声明<code>@Binding</code>属性外，还要更新对<code>setViewControllers（u:direction:animated:）</code>的调用，传递<code>currentPage</code>绑定的值。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line">        pageViewController.dataSource <span class="operator">=</span> context.coordinator</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[currentPage]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIPageViewControllerDataSource</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerBefore</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.last</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerAfter</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">+</span> <span class="number">1</span> <span class="operator">==</span> parent.controllers.count &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.first</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">+</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤2-12">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>在<code>PageView</code>中声明<code>@State</code>变量，并在创建子<code>PageViewController</code>时向属性传递绑定。</p>
<p><strong>重要</strong></p>
<p>请记住使用<code>$</code>语法创建用状态来存储值的绑定。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> currentPage <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageViewController</span>(controllers: viewControllers, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">            .aspectRatio(<span class="number">3</span><span class="operator">/</span><span class="number">2</span>, contentMode: .fit)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤3-10">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>通过更改<code>PageViewController</code>的初始值，测试该值是否通过绑定流向<code>PageViewController</code>。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> currentPage <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageViewController</span>(controllers: viewControllers, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">            .aspectRatio(<span class="number">3</span><span class="operator">/</span><span class="number">2</span>, contentMode: .fit)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>实验</em>：向<code>PageView</code>添加一个按钮，使<code>PageViewController</code>跳转到第二个视图。</p>
</blockquote>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> currentPage <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageViewController</span>(controllers: viewControllers, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">            .aspectRatio(<span class="number">3</span><span class="operator">/</span><span class="number">2</span>, contentMode: .fit)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5209c189ff1a2699c690fb8575e8b907bf5fe16b9e2e98c50af4627556b2b21b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373430303064653136322f37633136356330632d326330312d343633322d626339322d6634356566333135663634332e706e67" alt=""></p>
<h2 id="步骤4-9">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>添加一个带有<code>currentPage</code>属性的文本视图，这样您就可以监视<code>@State</code>属性的值。</p>
<p>请注意，当您从一页刷到另一页时，值不会改变。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> currentPage <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">PageViewController</span>(controllers: viewControllers, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Current Page: <span class="subst">\(currentPage)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤5-6">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-2"></a></p>
<blockquote>
<p>在<code>PageViewController.swift</code>中，将协调器设置为<code>UIPageViewControllerDelegate</code>，并添加<code>pageViewController(_:didFinishAnimating:previousViewControllers:transitionCompleted completed: Bool)</code> 方法。</p>
</blockquote>
<p>由于SwiftUI在页面切换动画完成时调用此方法，因此可以找到当前视图控制器的索引并更新绑定。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line">        pageViewController.dataSource <span class="operator">=</span> context.coordinator</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[currentPage]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIPageViewControllerDataSource</span>, <span class="title class_ inherited__">UIPageViewControllerDelegate</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerBefore</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.last</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerAfter</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">+</span> <span class="number">1</span> <span class="operator">==</span> parent.controllers.count &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.first</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">+</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">didFinishAnimating</span> <span class="params">finished</span>: <span class="type">Bool</span>, <span class="params">previousViewControllers</span>: [<span class="type">UIViewController</span>], <span class="params">transitionCompleted</span> <span class="params">completed</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> completed,</span><br><span class="line">                <span class="keyword">let</span> visibleViewController <span class="operator">=</span> pageViewController.viewControllers<span class="operator">?</span>.first,</span><br><span class="line">                <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: visibleViewController)</span><br><span class="line">            &#123;</span><br><span class="line">                parent.currentPage <span class="operator">=</span> index</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="步骤6-5">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-1"></a></p>
<p>除了<code>dataSource</code>之外，还将<code>coordinator</code>指定为<code>UIPageViewController</code>的委托。</p>
<p>当在两个方向上连接绑定后，文本视图会在每次刷新后更新以显示正确的页码。</p>
<blockquote>
<p>PageViewController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageViewController</span>: <span class="title class_ inherited__">UIViewControllerRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> controllers: [<span class="type">UIViewController</span>]</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageViewController</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pageViewController <span class="operator">=</span> <span class="type">UIPageViewController</span>(</span><br><span class="line">            transitionStyle: .scroll,</span><br><span class="line">            navigationOrientation: .horizontal)</span><br><span class="line">        pageViewController.dataSource <span class="operator">=</span> context.coordinator</span><br><span class="line">        pageViewController.delegate <span class="operator">=</span> context.coordinator</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageViewController</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        pageViewController.setViewControllers(</span><br><span class="line">            [controllers[currentPage]], direction: .forward, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIPageViewControllerDataSource</span>, <span class="title class_ inherited__">UIPageViewControllerDelegate</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> parent: <span class="type">PageViewController</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">PageViewController</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.parent <span class="operator">=</span> pageViewController</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerBefore</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.last</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(</span><br><span class="line">            <span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>,</span><br><span class="line">            <span class="params">viewControllerAfter</span> <span class="params">viewController</span>: <span class="type">UIViewController</span>) -&gt; <span class="type">UIViewController</span>?</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: viewController) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> index <span class="operator">+</span> <span class="number">1</span> <span class="operator">==</span> parent.controllers.count &#123;</span><br><span class="line">                <span class="keyword">return</span> parent.controllers.first</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> parent.controllers[index <span class="operator">+</span> <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">pageViewController</span>(<span class="keyword">_</span> <span class="params">pageViewController</span>: <span class="type">UIPageViewController</span>, <span class="params">didFinishAnimating</span> <span class="params">finished</span>: <span class="type">Bool</span>, <span class="params">previousViewControllers</span>: [<span class="type">UIViewController</span>], <span class="params">transitionCompleted</span> <span class="params">completed</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> completed,</span><br><span class="line">                <span class="keyword">let</span> visibleViewController <span class="operator">=</span> pageViewController.viewControllers<span class="operator">?</span>.first,</span><br><span class="line">                <span class="keyword">let</span> index <span class="operator">=</span> parent.controllers.firstIndex(of: visibleViewController)</span><br><span class="line">            &#123;</span><br><span class="line">                parent.currentPage <span class="operator">=</span> index</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d5b9106f3812db2f0ec1daa8e138cccdc07062e87738cf859bc10dca88821760/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336432393630643539312f64323265646539662d316136622d346464372d623839652d3062363763393734316263332e706e67" alt=""></p>
<h2 id="第四节-添加自定义分页控件">第四节 添加自定义分页控件</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E9%A1%B5%E6%8E%A7%E4%BB%B6"></a></p>
<p>您已经准备好向视图中添加自定义<code>UIPageControl</code>，该控件包装在<code>SwiftUI</code>的<code>UIViewRepresentable</code>视图中。</p>
<p><img src="https://camo.githubusercontent.com/f33ce41b76a653d0786dee35b95351c06aee07e52f96da2ed4b11e6dd03d08de/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663632393031346637642f64613532303662612d383137642d346136362d623538622d3861363438303466383261342e706e67" alt=""></p>
<h2 id="步骤1-13">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>创建一个新的SwiftUI视图文件，名为<code>PageControl.swift</code>。更新<code>PageControl</code>类型以遵守<code>UIViewRepresentable</code>协议。</p>
<p><code>UIViewRepresentable</code>和<code>UIViewControllerRepresentable</code>类型具有相同的生命周期，其方法与其基础的UIKit类型相对应。</p>
<blockquote>
<p>PageControl.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageControl</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfPages: <span class="type">Int</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageControl</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> control <span class="operator">=</span> <span class="type">UIPageControl</span>()</span><br><span class="line">        control.numberOfPages <span class="operator">=</span> numberOfPages</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> control</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">UIPageControl</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        uiView.currentPage <span class="operator">=</span> currentPage</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/7464ce9d51ebc401e2d0aac2ce39d500dfb446199ff6c790fdb956a9ad014014/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633239636166623832652f30386636656331392d393565322d346662372d623735652d6164623437306466363234392e706e67" alt=""></p>
<h2 id="步骤2-13">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>将文本框替换为<code>PageControl</code>，从<code>VStack</code>切换到<code>ZStack</code>进行布局。</p>
<p>因为我们正在讲页数和绑定传递到当前页，所以<code>PageControl</code>已显示正确的值。</p>
<blockquote>
<p>PageView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView</span>&lt;<span class="type">Page</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> viewControllers: [<span class="type">UIHostingController</span>&lt;<span class="type">Page</span>&gt;]</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> currentPage <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">views</span>: [<span class="type">Page</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.viewControllers <span class="operator">=</span> views.map &#123; <span class="type">UIHostingController</span>(rootView: <span class="variable">$0</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span>(alignment: .bottomTrailing) &#123;</span><br><span class="line">            <span class="type">PageViewController</span>(controllers: viewControllers, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">            <span class="type">PageControl</span>(numberOfPages: viewControllers.count, currentPage: <span class="variable">$currentPage</span>)</span><br><span class="line">                .padding(.trailing)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PageView</span>(features.map &#123; <span class="type">FeatureCard</span>(landmark: <span class="variable">$0</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>下一步，让<code>PageControl</code>交互，这样用户可以点击一边或另一边时，页面可以随之滚动。</p>
</blockquote>
<h2 id="步骤3-11">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<p>在<code>PageControl</code>中创建嵌套的<code>Coordinator</code>类型，并添加<code>makeCoordinator（）</code>方法以创建并返回新的协调器。</p>
<p>由于<code>UIPageControl</code>是<code>UIControl</code>子类，故使用<code>target-action</code>模式而不是代理，所以此<code>Coordinator</code>实现<code>@objc</code>方法来更新 <code>current page</code>的绑定。</p>
<blockquote>
<p>PageControl.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageControl</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfPages: <span class="type">Int</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageControl</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> control <span class="operator">=</span> <span class="type">UIPageControl</span>()</span><br><span class="line">        control.numberOfPages <span class="operator">=</span> numberOfPages</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> control</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">UIPageControl</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        uiView.currentPage <span class="operator">=</span> currentPage</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> control: <span class="type">PageControl</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">control</span>: <span class="type">PageControl</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.control <span class="operator">=</span> control</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">@objc</span> <span class="keyword">func</span> <span class="title function_">updateCurrentPage</span>(<span class="params">sender</span>: <span class="type">UIPageControl</span>) &#123;</span><br><span class="line">            control.currentPage <span class="operator">=</span> sender.currentPage</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/499680b5bed8b1d8fe20a72857fc639a7c34c58b6e206f786702564aa0eb7b69/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623035623264353538382f33306162333238352d316336312d343961362d393133612d3537383263303033613731342e706e67" alt=""></p>
<h2 id="步骤4-10">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-3"></a></p>
<p>将<code>Coordinator</code>添加为<code>valueChanged</code>事件的目标，指定<code>updateCurrentPage（sender:）</code>方法作为要执行的操作。</p>
<blockquote>
<p>PageControl.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PageControl</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfPages: <span class="type">Int</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> currentPage: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="type">Coordinator</span>(<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIPageControl</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> control <span class="operator">=</span> <span class="type">UIPageControl</span>()</span><br><span class="line">        control.numberOfPages <span class="operator">=</span> numberOfPages</span><br><span class="line">        control.addTarget(</span><br><span class="line">            context.coordinator,</span><br><span class="line">            action: <span class="keyword">#selector</span>(<span class="type">Coordinator</span>.updateCurrentPage(sender:)),</span><br><span class="line">            for: .valueChanged)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> control</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">UIPageControl</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        uiView.currentPage <span class="operator">=</span> currentPage</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> control: <span class="type">PageControl</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">control</span>: <span class="type">PageControl</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.control <span class="operator">=</span> control</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">@objc</span> <span class="keyword">func</span> <span class="title function_">updateCurrentPage</span>(<span class="params">sender</span>: <span class="type">UIPageControl</span>) &#123;</span><br><span class="line">            control.currentPage <span class="operator">=</span> sender.currentPage</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/499680b5bed8b1d8fe20a72857fc639a7c34c58b6e206f786702564aa0eb7b69/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623035623264353538382f33306162333238352d316336312d343961362d393133612d3537383263303033613731342e706e67" alt=""></p>
<h2 id="步骤5-7">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-3"></a></p>
<p>现在尝试所有不同的交互，<code>PageView</code>展示了UIKit和SwiftUI视图以及控制器是如何协同工作的。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_p42_all_interactions.gif" alt=""></p>
<h3 id="绘图和动画-2">绘图和动画</h3>
<p><a href="#%E7%BB%98%E5%9B%BE%E5%92%8C%E5%8A%A8%E7%94%BB"></a></p>
<h2 id="视图动画和转场">视图动画和转场</h2>
<p><a href="#%E8%A7%86%E5%9B%BE%E5%8A%A8%E7%94%BB%E5%92%8C%E8%BD%AC%E5%9C%BA"></a></p>
<p>使用SwiftUI时，无论效果在哪里，都可以对视图或视图状态的更改单独设置动画。SwiftUI负责处理这些组合、重叠和可中断动画的所有复杂性。</p>
<p>在本教程中，您将设置一个视图的动画，该视图包含一个图形，用于跟踪用户在使用Landmarks应用程序时的行为数据。使用<code>animation(_:)</code>修改器，您将看到设置视图动画是多么容易。</p>
<blockquote>
<p>学习时间：25分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/6178892d17/AnimatingViewsAndTransitions.zip">下载地址：AnimatingViewsAndTransitions.zip</a></p>
</blockquote>
<h2 id="第一节-向各个视图添加动画">第一节 向各个视图添加动画</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E5%90%91%E5%90%84%E4%B8%AA%E8%A7%86%E5%9B%BE%E6%B7%BB%E5%8A%A0%E5%8A%A8%E7%94%BB"></a></p>
<p>在视图上使用<code>animation(_:)</code>修改器时，SwiftUI可以改变视图的任何<code>animatable(可动画)</code>属性。视图的颜色<code>color</code>、不透明度<code>opacity</code>、旋转<code>rotation</code>、大小<code>size</code>和其他属性都是可设置动画的。</p>
<p><img src="https://camo.githubusercontent.com/4d317f89cbe2df435bdf2ec9dcf6fba88a4a0e63b6a15e6b5c6aed225f19c72f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333362343064383539382f38376536316239342d306237302d343739632d616630622d6232326636356636366430342e706e67" alt=""></p>
<h2 id="步骤1-14">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>在<code>HikeView.swift</code>中，打开实时预览并尝试显示和隐藏图形。</p>
<p>请确保在本教程中使用实时预览，以便您可以尝试每个步骤的结果。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_p22_explore-no-animations.gif" alt=""></p>
<h2 id="步骤2-14">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>通过添加<code>animation(.easeInOut())</code>为按钮启用旋转动画。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .padding()</span><br><span class="line">                        .animation(.easeInOut())</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="步骤3-12">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>当图形可见时，添加一个让按钮变大的动画。</p>
<p><code>animation(_:)</code>修饰符将应用于其包装的视图中所有可动画的更改。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                        .animation(.easeInOut())</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="步骤4-11">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>将动画类型从<code>easeInOut（）</code>更改为<code>spring（）</code>。</p>
<p>SwiftUI包括预定义或自定义宽松的基本动画，以及弹簧和流体动画。可以调整动画的速度、在动画开始之前设置延迟或指定动画重复。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                        .animation(.spring())</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="步骤5-8">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>尝试通过在<code>scaleEffect</code>修改器的正上方添加另一个动画修改器来关闭旋转的动画。</p>
<p><em><strong>实验</strong></em></p>
<p>围绕SwiftUI尝试组合不同的动画效果，看看有什么不同的效果。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .animation(<span class="literal">nil</span>)</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                        .animation(.spring())</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="步骤6-6">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>在转到下一节之前，请删除两个动画（:）修改器。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="第二节-使状态的改变产生动画效果">第二节 使状态的改变产生动画效果</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E4%BD%BF%E7%8A%B6%E6%80%81%E7%9A%84%E6%94%B9%E5%8F%98%E4%BA%A7%E7%94%9F%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C"></a></p>
<p>既然您已经学习了如何将动画应用于各个视图，现在是时候在更改状态值的位置添加动画了。</p>
<p>在这里，您将对用户点击按钮并切换<code>showDetail</code>属性时发生的所有更改添加动画。</p>
<p><img src="https://camo.githubusercontent.com/d4134b5708c1d69b362a440bbd9b9dc86f10a28b1fe4e4a582ef3a10439a584c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336631323963663163392f37343633316630312d393438622d343030322d383034342d3165623063343531393465322e706e67" alt=""></p>
<h2 id="步骤1-15">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>用<code>withAnimation</code>函数包装<code>showDetail.toggle（）</code>的调用。</p>
<p>受<code>showDetail</code>属性影响的两个视图（<code>disclosure</code>按钮和<code>HikeDetail</code>视图）现在都具有动画过渡。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<blockquote>
<p>减慢动画的速度，以查看SwiftUI动画是如何中断的。</p>
</blockquote>
<h2 id="步骤2-15">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>将4秒长的基本动画传递给<code>withAnimation</code>函数。</p>
<p>可以传递相同类型的动画给给<code>animation（:）</code>修饰符的<code>withAnimation</code>函数。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation(.easeInOut(duration: <span class="number">4</span>)) &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-13">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>尝试在动画中打开和关闭图形视图。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_p22_slow-animation.gif" alt=""></p>
<h2 id="步骤4-12">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>在继续下一节之前，请从<code>withAnimation</code>函数调用中删除慢速动画。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第三节-自定义视图转场">第三节 自定义视图转场</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%86%E5%9B%BE%E8%BD%AC%E5%9C%BA"></a></p>
<p>默认情况下，视图通过淡入淡出在屏幕内外切换。您可以使用<code>transition（:）</code>修饰符自定义此转场。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/customize-view-transitions.gif" alt=""></p>
<h2 id="步骤1-16">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>向条件可见的<code>HikeView</code>添加一个<code>transition(_:)</code>修饰符。</p>
<p>现在，图形通过滑动进入和退出视线而出现和消失。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">                    .transition(.slide)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/41d0296155e0de9ae8880dc2a8cb8726e5becbc41e1220ee5fb5c7b0573c553f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663438633038343036392f65656233336165662d326664342d343139312d383966392d3739383034316635656632302e706e67" alt=""></p>
<h2 id="步骤2-16">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>将转场提取为<code>AnyTransition</code>的静态属性。</p>
<p>这将在展开自定义转场时保持代码的干净。对于自定义转换，您可以使用与SwiftUI相同的<code>.</code>语法。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyTransition</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> moveAndFade: <span class="type">AnyTransition</span> &#123;</span><br><span class="line">        <span class="type">AnyTransition</span>.slide</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">                    .transition(.moveAndFade)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-14">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>切换到使用<code>move(edge:)</code> 转场，以便图形从同一侧滑入和滑出。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyTransition</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> moveAndFade: <span class="type">AnyTransition</span> &#123;</span><br><span class="line">        <span class="type">AnyTransition</span>.move(edge: .trailing)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">                    .transition(.moveAndFade)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-13">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>使用<code>asymmetric(insertion:removal:)</code>（不对称）修饰符在视图出现和消失时提供不同的过渡。</p>
<blockquote>
<p>HikeView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyTransition</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> moveAndFade: <span class="type">AnyTransition</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> insertion <span class="operator">=</span> <span class="type">AnyTransition</span>.move(edge: .trailing)</span><br><span class="line">            .combined(with: .opacity)</span><br><span class="line">        <span class="keyword">let</span> removal <span class="operator">=</span> <span class="type">AnyTransition</span>.scale</span><br><span class="line">            .combined(with: .opacity)</span><br><span class="line">        <span class="keyword">return</span> .asymmetric(insertion: insertion, removal: removal)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> hike: <span class="type">Hike</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">HikeGraph</span>(data: hike.observations, path: \.elevation)</span><br><span class="line">                    .frame(width: <span class="number">50</span>, height: <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Text</span>(hike.name)</span><br><span class="line">                        .font(.headline)</span><br><span class="line">                    <span class="type">Text</span>(hike.distanceText)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    withAnimation &#123;</span><br><span class="line">                        <span class="keyword">self</span>.showDetail.toggle()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Image</span>(systemName: <span class="string">&quot;chevron.right.circle&quot;</span>)</span><br><span class="line">                        .imageScale(.large)</span><br><span class="line">                        .rotationEffect(.degrees(showDetail <span class="operator">?</span> <span class="number">90</span> : <span class="number">0</span>))</span><br><span class="line">                        .scaleEffect(showDetail <span class="operator">?</span> <span class="number">1.5</span> : <span class="number">1</span>)</span><br><span class="line">                        .padding()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">HikeDetail</span>(hike: hike)</span><br><span class="line">                    .transition(.moveAndFade)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第四节-为复杂效果撰写动画">第四节 为复杂效果撰写动画</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E4%B8%BA%E5%A4%8D%E6%9D%82%E6%95%88%E6%9E%9C%E6%92%B0%E5%86%99%E5%8A%A8%E7%94%BB"></a></p>
<p>单击栏下方的按钮时，图形将在三组不同的数据之间切换。在本节中，将使用组合动画为构成图形的胶囊提供动态、波动的转场动画。</p>
<p><img src="https://camo.githubusercontent.com/ea7f48d85067ec682b91b09b3d5670af26ad117a65f2bb78dece50eaced4ba99/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363232323031646265302f66306462643666652d653337332d343835662d393636622d3136343161383032663338302e706e67" alt=""></p>
<h2 id="步骤1-17">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<blockquote>
<p>将<code>showDetail</code>的默认值更改为true，并将<code>HikeView</code>预览锁定到画布。</p>
</blockquote>
<p>这使您在另一个文件中处理动画时依然可以在上下文中看到图表。</p>
<p><img src="https://camo.githubusercontent.com/cf94f22dc3bed82f642f4fd9f35f7a3ac0cd46625a55809cbe67112a51b33280/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633363366636646338312f38333866316334392d353838392d343137622d613539302d6662613564643464323662642e706e67" alt=""></p>
<h2 id="步骤2-17">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>在<code>GraphCapsule.swift</code>中，添加新的计算动画属性，并将其应用于胶囊形状。</p>
<blockquote>
<p>GraphCapsule.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GraphCapsule</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> index: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> range: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> overallRange: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> heightRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="built_in">max</span>(<span class="type">CGFloat</span>(magnitude(of: range) <span class="operator">/</span> magnitude(of: overallRange)), <span class="number">0.15</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offsetRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="type">CGFloat</span>((range.lowerBound <span class="operator">-</span> overallRange.lowerBound) <span class="operator">/</span> magnitude(of: overallRange))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> animation: <span class="type">Animation</span> &#123;</span><br><span class="line">        <span class="type">Animation</span>.default</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Capsule</span>()</span><br><span class="line">            .fill(<span class="type">Color</span>.gray)</span><br><span class="line">            .frame(height: height <span class="operator">*</span> heightRatio, alignment: .bottom)</span><br><span class="line">            .offset(x: <span class="number">0</span>, y: height <span class="operator">*</span> <span class="operator">-</span>offsetRatio)</span><br><span class="line">            .animation(animation)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5f732633cd0acac70f2f06525fd970ddd7a86d559e62e3b94aaca2d45ccf4cc6/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386333376331393866632f30316330383331362d623439652d346132382d386431342d6533306365323763646337372e706e67" alt=""></p>
<h2 id="步骤3-15">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<p>将动画切换为弹簧动画<code>spring</code>，减少阻尼部分<code>dampingFraction</code>以使条形可以跳跃。</p>
<blockquote>
<p>GraphCapsule.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GraphCapsule</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> index: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> range: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> overallRange: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> heightRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="built_in">max</span>(<span class="type">CGFloat</span>(magnitude(of: range) <span class="operator">/</span> magnitude(of: overallRange)), <span class="number">0.15</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offsetRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="type">CGFloat</span>((range.lowerBound <span class="operator">-</span> overallRange.lowerBound) <span class="operator">/</span> magnitude(of: overallRange))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> animation: <span class="type">Animation</span> &#123;</span><br><span class="line">        <span class="type">Animation</span>.spring(dampingFraction: <span class="number">0.5</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Capsule</span>()</span><br><span class="line">            .fill(<span class="type">Color</span>.gray)</span><br><span class="line">            .frame(height: height <span class="operator">*</span> heightRatio, alignment: .bottom)</span><br><span class="line">            .offset(x: <span class="number">0</span>, y: height <span class="operator">*</span> <span class="operator">-</span>offsetRatio)</span><br><span class="line">            .animation(animation)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-14">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-3"></a></p>
<p>稍微加快动画的速度，以缩短每个条形移动到新位置所需的时间。</p>
<blockquote>
<p>GraphCapsule.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GraphCapsule</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> index: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> range: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> overallRange: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> heightRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="built_in">max</span>(<span class="type">CGFloat</span>(magnitude(of: range) <span class="operator">/</span> magnitude(of: overallRange)), <span class="number">0.15</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offsetRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="type">CGFloat</span>((range.lowerBound <span class="operator">-</span> overallRange.lowerBound) <span class="operator">/</span> magnitude(of: overallRange))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> animation: <span class="type">Animation</span> &#123;</span><br><span class="line">        <span class="type">Animation</span>.spring(dampingFraction: <span class="number">0.5</span>)</span><br><span class="line">            .speed(<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Capsule</span>()</span><br><span class="line">            .fill(<span class="type">Color</span>.gray)</span><br><span class="line">            .frame(height: height <span class="operator">*</span> heightRatio, alignment: .bottom)</span><br><span class="line">            .offset(x: <span class="number">0</span>, y: height <span class="operator">*</span> <span class="operator">-</span>offsetRatio)</span><br><span class="line">            .animation(animation)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-9">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>根据胶囊在图形上的位置为每个动画添加延迟<code>delay</code>。</p>
<blockquote>
<p>GraphCapsule.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GraphCapsule</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> index: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> range: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> overallRange: <span class="type">Range</span>&lt;<span class="type">Double</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> heightRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="built_in">max</span>(<span class="type">CGFloat</span>(magnitude(of: range) <span class="operator">/</span> magnitude(of: overallRange)), <span class="number">0.15</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offsetRatio: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="type">CGFloat</span>((range.lowerBound <span class="operator">-</span> overallRange.lowerBound) <span class="operator">/</span> magnitude(of: overallRange))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> animation: <span class="type">Animation</span> &#123;</span><br><span class="line">        <span class="type">Animation</span>.spring(dampingFraction: <span class="number">0.5</span>)</span><br><span class="line">            .speed(<span class="number">2</span>)</span><br><span class="line">            .delay(<span class="number">0.03</span> <span class="operator">*</span> <span class="type">Double</span>(index))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Capsule</span>()</span><br><span class="line">            .fill(<span class="type">Color</span>.gray)</span><br><span class="line">            .frame(height: height <span class="operator">*</span> heightRatio, alignment: .bottom)</span><br><span class="line">            .offset(x: <span class="number">0</span>, y: height <span class="operator">*</span> <span class="operator">-</span>offsetRatio)</span><br><span class="line">            .animation(animation)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤6-7">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-1"></a></p>
<p>观察自定义动画在图形之间转换时如何提供波动效果。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_p22_explore-with-animations.gif" alt=""></p>
<h2 id="构建列表和导航">构建列表和导航</h2>
<p><a href="#%E6%9E%84%E5%BB%BA%E5%88%97%E8%A1%A8%E5%92%8C%E5%AF%BC%E8%88%AA"></a></p>
<p>设置了基本地标详情视图后，需要为用户提供查看地标所有列表和查看每个地标详情的方法。</p>
<p>您将创建显示所有地标信息的视图，并动态生成一个滚动列表，用户可以点击该列表查看地标的详情视图。要微调UI，您将使用Xcode的画布以不同的设备大小呈现多个预览。</p>
<p>下载项目文件以开始构建此项目，并执行以下步骤。</p>
<blockquote>
<p>学习时间：35分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/58bd04ddca/BuildingListsAndNavigation.zip">下载示例：BuildingListsAndNavigation.zip</a></p>
</blockquote>
<h2 id="第一节-了解示例数据。">第一节 了解示例数据。</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E4%BA%86%E8%A7%A3%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE"></a></p>
<p>在第一个教程中，我们将数据硬编码到所有自定义视图中。在这里，您将学习如何将数据传递到自定义视图中以动态显示。</p>
<p>首先<a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/58bd04ddca/BuildingListsAndNavigation.zip">下载示例项目</a>并熟悉示例数据。</p>
<p><img src="https://camo.githubusercontent.com/2dcdb436a4520060ac81a44c83c6e8d44acce0dc66b5516e771f5edc8f1eb0c9/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346434613235636432632f32663866396431352d333438652d346337662d623533642d6265333161356438633435372e706e67" alt=""></p>
<h2 id="步骤1-18">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>在项目导航器中，选择<code>Models&gt;Landmark.swift</code>。</p>
<p><code>Landmark.swift</code>声明了一个Landmark结构，该结构存储应用程序需要显示的所有<code>Landmark</code>信息，并从<code>landmarkData.json</code>导入一组<code>Landmark</code>数据。</p>
<blockquote>
<p>Landmark.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> CoreLocation</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Landmark</span>: <span class="title class_ inherited__">Hashable</span>, <span class="title class_ inherited__">Codable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> imageName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> coordinates: <span class="type">Coordinates</span></span><br><span class="line">    <span class="keyword">var</span> state: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> park: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> category: <span class="type">Category</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> locationCoordinate: <span class="type">CLLocationCoordinate2D</span> &#123;</span><br><span class="line">        <span class="type">CLLocationCoordinate2D</span>(</span><br><span class="line">            latitude: coordinates.latitude,</span><br><span class="line">            longitude: coordinates.longitude)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Category</span>: <span class="title class_ inherited__">String</span>, <span class="title class_ inherited__">CaseIterable</span>, <span class="title class_ inherited__">Codable</span>, <span class="title class_ inherited__">Hashable</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> featured <span class="operator">=</span> <span class="string">&quot;Featured&quot;</span></span><br><span class="line">        <span class="keyword">case</span> lakes <span class="operator">=</span> <span class="string">&quot;Lakes&quot;</span></span><br><span class="line">        <span class="keyword">case</span> rivers <span class="operator">=</span> <span class="string">&quot;Rivers&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Landmark</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">Image</span> &#123;</span><br><span class="line">        <span class="type">ImageStore</span>.shared.image(name: imageName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Coordinates</span>: <span class="title class_ inherited__">Hashable</span>, <span class="title class_ inherited__">Codable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> longitude: <span class="type">Double</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-18">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>在项目导航器中，选择<code>Resources&gt;landmarkData.json</code>。</p>
<p>您将在本教程的其余部分以及随后的所有内容中使用此示例数据。</p>
<blockquote>
<p>landmarkData.json</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Turtle Rock&quot;,</span><br><span class="line">        &quot;category&quot;: &quot;Featured&quot;,</span><br><span class="line">        &quot;city&quot;: &quot;Twentynine Palms&quot;,</span><br><span class="line">        &quot;state&quot;: &quot;California&quot;,</span><br><span class="line">        &quot;id&quot;: 1001,</span><br><span class="line">        &quot;park&quot;: &quot;Joshua Tree National Park&quot;,</span><br><span class="line">        &quot;coordinates&quot;: &#123;</span><br><span class="line">            &quot;longitude&quot;: -116.166868,</span><br><span class="line">            &quot;latitude&quot;: 34.011286</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;imageName&quot;: &quot;turtlerock&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;: &quot;Silver Salmon Creek&quot;,</span><br><span class="line">        &quot;category&quot;: &quot;Lakes&quot;,</span><br><span class="line">        &quot;city&quot;: &quot;Port Alsworth&quot;,</span><br><span class="line">        &quot;state&quot;: &quot;Alaska&quot;,</span><br><span class="line">        &quot;id&quot;: 1002,</span><br><span class="line">        &quot;park&quot;: &quot;Lake Clark National Park and Preserve&quot;,</span><br><span class="line">        &quot;coordinates&quot;: &#123;</span><br><span class="line">            &quot;longitude&quot;: -152.665167,</span><br><span class="line">            &quot;latitude&quot;: 59.980167</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;imageName&quot;: &quot;silversalmoncreek&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-16">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>请注意，我们将<code>ContentView</code>类型重命名为<code>LandmarkDetail</code>。</p>
<p>在本教程和以下每个教程中，您将创建多个视图类型。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f348f6b5192adb6ce6417793d8aef7e43df24a97d6076575985141f77a9c2a87/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336231356434363864362f36363530306134662d303137392d343465362d616362302d6166393436383964396538652e706e67" alt=""></p>
<h2 id="第二节-创建行视图">第二节 创建行视图</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9B%E5%BB%BA%E8%A1%8C%E8%A7%86%E5%9B%BE"></a></p>
<p>本节中构建的第一个视图是行视图，用于显示每个地标的详细信息。此行视图声明了一个属性即<code>landmark</code> ，其用于存储地标信息，以便行视图可以显示任何地标。稍后，您将把多个行视图合并成一个地标列表。</p>
<p><img src="https://camo.githubusercontent.com/7679f99fa7181e7bc78ece11727a61aa021c976167815cd1981ac6c382dd7c29/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383535333364323765662f36663163336461352d333463372d346332372d626137372d3237306564326132393237322e706e67" alt=""></p>
<h2 id="步骤1-19">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>创建一个新的SwiftUI视图，名为<code>LandmarkRow.swift</code>。</p>
<p><img src="https://camo.githubusercontent.com/ca612cb88a14a6cacd37822f86c9991f6f8364a9f53adc28f58e51f64d1d3261/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396164323335316237612f30613663303233322d366436312d346538622d396530342d3237636664613437626632622e706e67" alt=""></p>
<h2 id="步骤2-19">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>如果预览尚未显示，请通过选择<code>Editor &gt; Editor and Canvas</code>，来显示画布，然后单击“Resume”。</p>
<p><img src="https://camo.githubusercontent.com/540b4fa379403fc023c2e017e28eb71ad65fc6f5927a79fa852d90f86c982ec2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633761653862303631372f61633939663031352d333362302d346438332d626361322d6162383433383936623932662e706e67" alt=""></p>
<h2 id="步骤3-17">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>添加<code>landmark</code>作为<code>LandmarkRow</code>的存储属性。</p>
<p>添加<code>landmark</code>属性时，预览将停止工作，因为<code>LandmarkRow</code>类型在初始化期间需要<code>landmark</code>实例。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>想要修复预览，需要修改<code>PreviewProvider</code>。</p>
</blockquote>
<h2 id="步骤4-15">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>在<code>LandmarkRow_Previews</code>的<code>static previews</code>属性中，将<code>landmarkData</code>数组的第一个元素作为<code>LandmarkRow</code>参数添加到LandmarkRow初始值设定项中。</p>
<p>预览可以正常显示文本<code>Hello World</code>了。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/70344d7590245f3d18b90a323ac31f2a9eccd6355c8b3f59b2bf820c49c52fb8/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f316534326233323233612f32393262373461362d303137342d343737332d623834622d6238613637643566393164332e706e67" alt=""></p>
<blockquote>
<p>修复后，可以为行视图生成布局。</p>
</blockquote>
<h2 id="步骤5-10">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>将文本视图嵌入到<code>HStack</code>中。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/70344d7590245f3d18b90a323ac31f2a9eccd6355c8b3f59b2bf820c49c52fb8/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f316534326233323233612f32393262373461362d303137342d343737332d623834622d6238613637643566393164332e706e67" alt=""></p>
<h2 id="步骤6-8">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>修改文本视图以使用<code>landmark</code>的<code>name</code>属性。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/c34b69d9aa9b63d524698127d75b4399f497870d49fa6e7d40b840009b6a8890/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393834666538346334362f31616630626131302d333964362d343531332d396430382d3362616332336261636664642e706e67" alt=""></p>
<h2 id="步骤7-2">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47"></a></p>
<p>在<code>Text</code>视图之前添加<code>Image</code>视图来完成行视图。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/63dc967eb42e2bbc2e59f3b80dd2c047a3545c50946490624d6ea0d6e5878a3e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626635333364626138632f65396230646461362d643166332d343438632d626435342d3266316466313966336639302e706e67" alt=""></p>
<h2 id="第三节-自定义行预览">第三节 自定义行预览</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%8C%E9%A2%84%E8%A7%88"></a></p>
<p>Xcode的画布自动识别并显示当前编辑器中遵守<code>PreviewProvider</code>协议的任何类型。<code>PreviewProvider</code>返回一个或多个视图，并提供配置大小和设备的选项。</p>
<p>您可以自定义<code>PreviewProvider</code>返回的内容，以准确呈现对您最有帮助的预览。</p>
<p><img src="https://camo.githubusercontent.com/a6729288ec6370153c0302bfe5e85a501d9aa6759ded8aabbdaf3c07d1913e48/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383936633830353734642f64653433303166612d626639632d343561632d623766322d6262623939306363623431622e706e67" alt=""></p>
<h2 id="步骤1-20">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>在<code>LandmarkRow_Previews</code>中，将<code>landmark</code>参数更新为<code>landmarkData</code>数组中的第二个元素。</p>
<p>预览立即显示第二个示例地标，而不是第一个。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/63dc967eb42e2bbc2e59f3b80dd2c047a3545c50946490624d6ea0d6e5878a3e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626635333364626138632f65396230646461362d643166332d343438632d626435342d3266316466313966336639302e706e67" alt=""></p>
<h2 id="步骤2-20">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>使用<code>previewLayout(_:)</code> 设置一个与列表中的行近似的大小。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">            .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/6e9c3e19452d904a8edc75c3e99d0ebe5ffa01f16ce326db9f4b15d1b52971a5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623763346465376430652f64336364643533612d633363352d343135342d383466632d6362623661333133376165662e706e67" alt=""></p>
<blockquote>
<p>可以使用<code>Group</code>从<code>PreviewProvider</code>返回多个视图预览。</p>
</blockquote>
<h2 id="步骤3-18">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>将返回的行包装在一个<code>Group</code>中，然后再次添加第一行。</p>
<p><code>Group</code>是用于对视图内容进行分组的容器。Xcode将组的子视图呈现为画布中的单独预览。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">                .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">                .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/16e33f82002d7bbd654acf8ec4df30f4de33c7ff23681c31c5d5ee888b88da91/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373566396433663964302f63393062303738382d323265322d346132352d396137662d3464616163636439653762342e706e67" alt=""></p>
<h2 id="步骤4-16">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>要简化代码，请将<code>previewLayout（:）</code>调用移到<code>Group</code>的外部。</p>
<p>视图的子级视图继承视图的上下文设置，如预览配置。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">        &#125;</span><br><span class="line">        .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/16e33f82002d7bbd654acf8ec4df30f4de33c7ff23681c31c5d5ee888b88da91/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373566396433663964302f63393062303738382d323265322d346132352d396137662d3464616163636439653762342e706e67" alt=""></p>
<blockquote>
<p>Tips：在<code>PreviewProvider</code>中编写的代码只会改变Xcode在画布中显示的内容。</p>
</blockquote>
<h2 id="第四节-创建地标列表">第四节 创建地标列表</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%88%9B%E5%BB%BA%E5%9C%B0%E6%A0%87%E5%88%97%E8%A1%A8"></a></p>
<p>使用SwiftUI的<code>List</code>类型时，可以显示特定于平台的视图列表。列表的元素可以是静态的，比如您目前创建的堆栈的子视图，也可以是动态生成的。您甚至可以混合静态和动态生成的视图。</p>
<p><img src="https://camo.githubusercontent.com/0dd540c130b7003f3d576baef92b8e585ce0a6dccb8130811c9fdd4da9ab1aaa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343431363661633763332f63393162363534362d313233302d343361322d383836372d3266306534343565646239392e706e67" alt=""></p>
<h2 id="步骤1-21">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>创建一个新的<code>SwiftUI View</code>，名为<code>LandmarkList.swift</code>。</p>
<p><img src="https://camo.githubusercontent.com/9c7de4a1867143114d4a20a6885fde579d81297c027c98d2fc8f514fc1a2aaa6/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393931633532646234652f61666236646335392d636462382d346236342d396263652d3330663837636262656563342e706e67" alt=""></p>
<h2 id="步骤2-21">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>将默认<code>Text</code>视图替换为<code>List</code>，并提供前两个<code>Landmark</code>作为列表子级的<code>LandmarkRow</code>实例。</p>
<p>预览显示了两个地标，它们以适合iOS的列表样式呈现。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/46f318e8c55d715da76ebbc3daddc7294601ab2ecb0c5a626044afb4f83ec4e1/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303135643038393365302f63373333313836382d646235322d346664612d613635622d3131376333326538343864392e706e67" alt=""></p>
<h2 id="第五节-动态化列表">第五节 动态化列表</h2>
<p><a href="#%E7%AC%AC%E4%BA%94%E8%8A%82-%E5%8A%A8%E6%80%81%E5%8C%96%E5%88%97%E8%A1%A8"></a></p>
<p>您可以直接从集合中生成行，而不是单独的指定列表中的元素。</p>
<p>通过传递数据集合并为集合中的每个元素提供视图的闭包，可以创建显示集合元素的列表。列表使用提供的闭包将集合中的每个元素转换为子视图。</p>
<p><img src="https://camo.githubusercontent.com/e6aaef5ffb941d324829926768025373fa43369737579d6dbd0a6bafac1362d0/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363862636164373735392f33663266383037312d393765312d343831652d393261322d6566623138626530316563372e706e67" alt=""></p>
<h2 id="步骤1-22">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-4"></a></p>
<p>删除两个静态<code>LandmarkRow</code>，并将<code>landmarkData</code> 传递给<code>Lisst</code>初始值设定项。</p>
<p><code>List</code>使用<code>identifiable</code>数据。您可以通过以下两种方式之一生产<code>identifiable</code>数据：1、使用<code>key path</code>属性标识每个元素；2、使数据遵守<code>Identifiable</code>协议。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(landmarkData, id: \.id) &#123; landmark <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-22">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-4"></a></p>
<p>通过从闭包返回<code>LandmarkRow</code>来动态生成列表。</p>
<p>这将为<code>landmarkData</code>数组中的每个元素创建一个<code>LandmarkRow</code>。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(landmarkData, id: \.id) &#123; landmark <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/9a26e88d14bcac52fe6b908b862daf000771cb6e9beede294236167f9d9779eb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643437646332623739352f61653339343032322d633731302d346338362d393232362d3765306361323235633238372e706e67" alt=""></p>
<blockquote>
<p>接下来，您将通过使<code>Landmark</code>遵守<code>Identifiable</code>来简化代码。</p>
</blockquote>
<h2 id="步骤3-19">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<p>切换到<code>Landmark.swift</code>并声明<code>Identifiable</code>协议。</p>
<p>由于<code>Landmark</code>类型已经具有<code>Identifiable</code>所需的id属性，因此没有其他工作要做。</p>
<blockquote>
<p>Landmark.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> CoreLocation</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Landmark</span>: <span class="title class_ inherited__">Hashable</span>, <span class="title class_ inherited__">Codable</span>, <span class="title class_ inherited__">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> imageName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> coordinates: <span class="type">Coordinates</span></span><br><span class="line">    <span class="keyword">var</span> state: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> park: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> category: <span class="type">Category</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> locationCoordinate: <span class="type">CLLocationCoordinate2D</span> &#123;</span><br><span class="line">        <span class="type">CLLocationCoordinate2D</span>(</span><br><span class="line">            latitude: coordinates.latitude,</span><br><span class="line">            longitude: coordinates.longitude)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Category</span>: <span class="title class_ inherited__">String</span>, <span class="title class_ inherited__">CaseIterable</span>, <span class="title class_ inherited__">Codable</span>, <span class="title class_ inherited__">Hashable</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> featured <span class="operator">=</span> <span class="string">&quot;Featured&quot;</span></span><br><span class="line">        <span class="keyword">case</span> lakes <span class="operator">=</span> <span class="string">&quot;Lakes&quot;</span></span><br><span class="line">        <span class="keyword">case</span> rivers <span class="operator">=</span> <span class="string">&quot;Rivers&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Landmark</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">Image</span> &#123;</span><br><span class="line">        <span class="type">ImageStore</span>.shared.image(name: imageName)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Coordinates</span>: <span class="title class_ inherited__">Hashable</span>, <span class="title class_ inherited__">Codable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> longitude: <span class="type">Double</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/9a26e88d14bcac52fe6b908b862daf000771cb6e9beede294236167f9d9779eb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643437646332623739352f61653339343032322d633731302d346338362d393232362d3765306361323235633238372e706e67" alt=""></p>
<h2 id="步骤4-17">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>切换回<code>LandmarkList.swift</code>并删除id参数。</p>
<p>从现在起，您将能够直接使用<code>Landmark</code>的集合。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/9a26e88d14bcac52fe6b908b862daf000771cb6e9beede294236167f9d9779eb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643437646332623739352f61653339343032322d633731302d346338362d393232362d3765306361323235633238372e706e67" alt=""></p>
<h2 id="第六节-在列表和详情之间设置导航">第六节 在列表和详情之间设置导航</h2>
<p><a href="#%E7%AC%AC%E5%85%AD%E8%8A%82-%E5%9C%A8%E5%88%97%E8%A1%A8%E5%92%8C%E8%AF%A6%E6%83%85%E4%B9%8B%E9%97%B4%E8%AE%BE%E7%BD%AE%E5%AF%BC%E8%88%AA"></a></p>
<p>列表呈现正确，但您还不能轻触每个<code>LandmarkRow</code>来查看该地标的详情页面。</p>
<p>通过把<code>List</code>嵌入到<code>NavigationView</code>中使其具有导航功能，然后在<code>NavigationLink</code>中嵌入每一行<code>LandmarkRow</code>，并设置要跳转的目标视图。</p>
<p><img src="https://camo.githubusercontent.com/40ec756f989e837d2bbc7215fa39be8b457a86f9da26b8895897c63b536c0153/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343866653961623061332f63366632316466392d316436642d343264342d623231622d3061323538386634636439372e706e67" alt=""></p>
<h2 id="步骤1-23">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-5"></a></p>
<p>在<code>NavigationView</code>中嵌入动态生成的<code>LandmarkList</code>。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/10c5e824736a30cb2416082248046234500d1766f24939144b8492f62cc88ddf/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303738613132653533362f66636231336362362d613865332d346339352d613266642d6138343439396131666132622e706e67" alt=""></p>
<h2 id="步骤2-23">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-5"></a></p>
<p>在显示列表时，调用<code>navigationBarTitle（:）</code>修饰符方法设置导航栏的标题。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/2e223378a25970e2f510031191eca5c174091923bd9eb329f844898fbb28b114/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356238616236386239392f36386333343630362d306434312d343361392d623233612d6262666665393131373764382e706e67" alt=""></p>
<h2 id="步骤3-20">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-4"></a></p>
<p>在<code>List</code>的闭包中，将返回的<code>Row</code>包装在<code>NavigationLink</code> 中，指定<code>LandmarkDetail</code>视图作为跳转目标。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>()) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/4f1f502fd64b5098da356d410e304df576a21e7491864733eecb0ebc989d4bf6/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f636336613763613332362f38383336633637612d646230332d343064362d613834612d3364333830393934306638312e706e67" alt=""></p>
<h2 id="步骤4-18">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-3"></a></p>
<p>通过切换到实时预览模式，您可以在预览中直接尝试导航功能。单击<code>Live Preview</code>按钮并点击地标行访问详情页。</p>
<p><img src="https://camo.githubusercontent.com/87d58aa06de09967e4d72ca003b8368afeebe31cfb7bb802aba7359cbbbae098/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356533393736373734642f64393065313465662d666366652d346566342d396266382d6430353062633961343261342e706e67" alt=""></p>
<h2 id="第7节-将数据传递到子视图">第7节 将数据传递到子视图</h2>
<p><a href="#%E7%AC%AC7%E8%8A%82-%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E5%88%B0%E5%AD%90%E8%A7%86%E5%9B%BE"></a></p>
<p><code>LandmarkDetail</code>视图仍然使用硬编码方式来显示地标。与<code>LandmarkRow</code>一样，<code>LandmarkDetail</code>类型及其包含的视图需要使用<code>landmark</code>属性作为其数据源。</p>
<p>从子视图开始，您将转换<code>CircleImage</code>、<code>MapView</code>和<code>LandmarkDetail</code>以显示传入的数据，而不是对每行进行硬编码。</p>
<p><img src="https://camo.githubusercontent.com/d385ac27178d00ad935d9201c395114d5a6a577609f9b3720c3c4f3e2a3ba40f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633333383030313062662f63623439373332662d636233652d346537372d613265362d3834663766373631383530322e706e67" alt=""></p>
<h2 id="步骤1-24">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-6"></a></p>
<p>在<code>CircleImage.swift</code>中，将存储属性<code>image</code>添加到<code>CircleImage</code>。</p>
<p>这是使用SwiftUI构建视图时的常见模式。您的自定义视图通常会包装一系列修饰符。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">Image</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        image</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">            .overlay(<span class="type">Circle</span>().stroke(<span class="type">Color</span>.white, lineWidth: <span class="number">4</span>))</span><br><span class="line">            .shadow(radius: <span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-24">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-6"></a></p>
<p>更新<code>CircleImage_Preview</code> 以传递名为<code>Turtle Rock</code>的<code>Image</code>。</p>
<blockquote>
<p>CircleImage.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> image: <span class="type">Image</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        image</span><br><span class="line">            .clipShape(<span class="type">Circle</span>())</span><br><span class="line">            .overlay(<span class="type">Circle</span>().stroke(<span class="type">Color</span>.white, lineWidth: <span class="number">4</span>))</span><br><span class="line">            .shadow(radius: <span class="number">10</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CircleImage_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>(image: <span class="type">Image</span>(<span class="string">&quot;turtlerock&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>步骤3</p>
<p>在<code>MapView.swift</code>中，向<code>MapView</code>添加一个<code>coordinate</code>属性，并将代码转换为使用该属性，而不是硬编码纬度和经度。</p>
<blockquote>
<p>MapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MapKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> coordinate: <span class="type">CLLocationCoordinate2D</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">MKMapView</span> &#123;</span><br><span class="line">        <span class="type">MKMapView</span>(frame: .zero)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">view</span>: <span class="type">MKMapView</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> span <span class="operator">=</span> <span class="type">MKCoordinateSpan</span>(latitudeDelta: <span class="number">0.02</span>, longitudeDelta: <span class="number">0.02</span>)</span><br><span class="line">        <span class="keyword">let</span> region <span class="operator">=</span> <span class="type">MKCoordinateRegion</span>(center: coordinate, span: span)</span><br><span class="line">        view.setRegion(region, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">MapView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-19">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-4"></a></p>
<p>更新<code>MapView_Preview</code>以传递数据数组中第一个地标元素的坐标。</p>
<blockquote>
<p>MapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MapKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> coordinate: <span class="type">CLLocationCoordinate2D</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">MKMapView</span> &#123;</span><br><span class="line">        <span class="type">MKMapView</span>(frame: .zero)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">view</span>: <span class="type">MKMapView</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> span <span class="operator">=</span> <span class="type">MKCoordinateSpan</span>(latitudeDelta: <span class="number">0.02</span>, longitudeDelta: <span class="number">0.02</span>)</span><br><span class="line">        <span class="keyword">let</span> region <span class="operator">=</span> <span class="type">MKCoordinateRegion</span>(center: coordinate, span: span)</span><br><span class="line">        view.setRegion(region, animated: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MapView_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">MapView</span>(coordinate: landmarkData[<span class="number">0</span>].locationCoordinate)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-11">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>在<code>LandmarkDetail.swift</code>中，将<code>Landmark</code>属性添加到<code>LandmarkDetail</code>类中。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>步骤6</p>
<p>更新<code>LandmarkDetail_Preview</code>以使用<code>landmarkData</code>数组中的第一个地标元素。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>()</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Turtle Rock&quot;</span>)</span><br><span class="line">                    .font(.title)</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Joshua Tree National Park&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;California&quot;</span>)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤7-3">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47-1"></a></p>
<p>将所需的数据下传给自定义类型。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>(coordinate: landmark.locationCoordinate)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>(image: landmark.image)</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(landmark.name)</span><br><span class="line">                    .font(.title)</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.park)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(landmark.state)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤8-2">步骤8</h2>
<p><a href="#%E6%AD%A5%E9%AA%A48"></a></p>
<p>最后，调用<code>navigationBarTitle(_:displayMode:)</code>修饰符，在显示详情视图时为导航栏提供标题。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>(coordinate: landmark.locationCoordinate)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>(image: landmark.image)</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(landmark.name)</span><br><span class="line">                    .font(.title)</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.park)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(landmark.state)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(landmark.name), displayMode: .inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤9-2">步骤9</h2>
<p><a href="#%E6%AD%A5%E9%AA%A49"></a></p>
<p>在<code>SceneDelegate.swift</code>中，将应用程序的根视图切换为<code>LandmarkList</code>。</p>
<p>当在模拟器中独立运行(不是预览模式)时，您的应用程序将从<code>SceneDelegate</code>中定义的根视图开始。</p>
<blockquote>
<p>SceneDelegate.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SceneDelegate</span>: <span class="title class_ inherited__">UIResponder</span>, <span class="title class_ inherited__">UIWindowSceneDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> window: <span class="type">UIWindow</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">scene</span>(<span class="keyword">_</span> <span class="params">scene</span>: <span class="type">UIScene</span>, <span class="params">willConnectTo</span> <span class="params">session</span>: <span class="type">UISceneSession</span>, <span class="params">options</span> <span class="params">connectionOptions</span>: <span class="type">UIScene</span>.<span class="type">ConnectionOptions</span>) &#123;</span><br><span class="line">        <span class="comment">// Use this method to optionally configure and attach the UIWindow `window` to the provided UIWindowScene `scene`.</span></span><br><span class="line">        <span class="comment">// If using a storyboard, the `window` property will automatically be initialized and attached to the scene.</span></span><br><span class="line">        <span class="comment">// This delegate does not imply the connecting scene or session are new (see `application:configurationForConnectingSceneSession` instead).</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Use a UIHostingController as window root view controller</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> windowScene <span class="operator">=</span> scene <span class="keyword">as?</span> <span class="type">UIWindowScene</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> window <span class="operator">=</span> <span class="type">UIWindow</span>(windowScene: windowScene)</span><br><span class="line">            window.rootViewController <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: <span class="type">LandmarkList</span>())</span><br><span class="line">            <span class="keyword">self</span>.window <span class="operator">=</span> window</span><br><span class="line">            window.makeKeyAndVisible()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/942e2a6d97e59f6a46f5bf7872fe5724b6bd3ab79c6d8de821609fb1423b17fe/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f326662653635353663342f62666331343637622d653761392d346136312d383035312d3530623935353039633361622e706e67" alt=""></p>
<h2 id="步骤10">步骤10</h2>
<p><a href="#%E6%AD%A5%E9%AA%A410"></a></p>
<p>在<code>LandmarkList.swift</code>中，将当前<code>Landmark</code>传递到目标详情页。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/942e2a6d97e59f6a46f5bf7872fe5724b6bd3ab79c6d8de821609fb1423b17fe/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f326662653635353663342f62666331343637622d653761392d346136312d383035312d3530623935353039633361622e706e67" alt=""></p>
<h2 id="步骤11">步骤11</h2>
<p><a href="#%E6%AD%A5%E9%AA%A411"></a></p>
<p>切换到实时预览以查看从列表导航到详情视图时，是否显示正确的地标。</p>
<p><img src="https://camo.githubusercontent.com/87d58aa06de09967e4d72ca003b8368afeebe31cfb7bb802aba7359cbbbae098/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356533393736373734642f64393065313465662d666366652d346566342d396266382d6430353062633961343261342e706e67" alt=""></p>
<h2 id="第8节-动态生成预览">第8节 动态生成预览</h2>
<p><a href="#%E7%AC%AC8%E8%8A%82-%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E9%A2%84%E8%A7%88"></a></p>
<p>接下来，将向<code>LandmarkList_Previews</code>添加代码，以呈现不同设备大小的列表视图预览。默认情况下，预览以激活状态设备的大小呈现。可以通过调用<code>previewDevice（:）</code>修饰符方法来更改预览设备。</p>
<p><img src="https://camo.githubusercontent.com/603502b096d1dbf3d709b47fe0f9d131ecbc1a96e086420d2d25f63e44d55b9e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626639376636663634642f34373565346163332d623630352d343330392d613239342d6539643265666136663161622e706e67" alt=""></p>
<h2 id="步骤1-25">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-7"></a></p>
<p>首先，将当前列表预览更改为<code>iPhone SE</code>大小的渲染器。</p>
<p>您可以提供<code>Xcode</code>的<code>scheme</code>菜单中显示的任何设备的名称。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">            .previewDevice(<span class="type">PreviewDevice</span>(rawValue: <span class="string">&quot;iPhone SE&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/2203984b932e49e6398b65e894436f578a66b000318f3603b910210a0ec188da/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666166613963356530652f38396335393062612d613265302d343662632d626163612d3238643039303631373832652e706e67" alt=""></p>
<h2 id="步骤2-25">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-7"></a></p>
<p>在<code>LandmarkList_Previews</code>中，使用设备名称数组作为数据，将<code>LandmarkList</code>嵌入<code>ForEach</code>实例中。</p>
<p>ForEach对集合的操作方式与list相同，这意味着您可以在任何可以使用子视图的地方使用它，例如在<code>stacks</code>、<code>list</code>、<code>group</code>等中。当数据元素是简单的值类型（如您在这里使用的字符串）时，可以使用.self作为<code>identifier</code>的<code>key path</code>。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>([<span class="string">&quot;iPhone SE&quot;</span>, <span class="string">&quot;iPhone XS Max&quot;</span>], id: \.<span class="keyword">self</span>) &#123; deviceName <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .previewDevice(<span class="type">PreviewDevice</span>(rawValue: deviceName))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/211152e25bc0bf47a4004a9e14db37a62988641dbc90c805391d7be151fbd173/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393039336136303638362f64366638326161302d663330382d346364632d623934322d6165396134613866613166392e706e67" alt=""></p>
<h2 id="步骤3-21">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-5"></a></p>
<p>使用<code>previewDisplayName(_:)</code>修饰符将设备名称添加为预览的标签。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>([<span class="string">&quot;iPhone SE&quot;</span>, <span class="string">&quot;iPhone XS Max&quot;</span>], id: \.<span class="keyword">self</span>) &#123; deviceName <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .previewDevice(<span class="type">PreviewDevice</span>(rawValue: deviceName))</span><br><span class="line">                .previewDisplayName(deviceName)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/72d9728f29857da99cbbc6d65a54ea98688bea2d7ead6617132e113f755ce77d/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363434663134663036342f34313930623234332d616636322d343337622d613365312d3930346435333232346630362e706e67" alt=""></p>
<h2 id="步骤4-20">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-5"></a></p>
<p>您可以尝试使用不同的设备来比较视图的渲染，所有这些都来自画布。</p>
<p><img src="https://camo.githubusercontent.com/e276e569fa4b0488ec9d0f2135055373e8f316cb83bb73d2394cf0c9b7af0963/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386533376136303038342f64616634323962622d336237372d343138662d616431332d6161346239646137316137632e706e67" alt=""></p>
<h3 id="框架集成-2">框架集成</h3>
<p><a href="#%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90"></a></p>
<h2 id="创建watchOS应用程序">创建watchOS应用程序</h2>
<p><a href="#%E5%88%9B%E5%BB%BAwatchos%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"></a></p>
<p>本教程为您提供了一个机会，让您可以应用您已经了解的有关SwiftUI的大部分内容，并且只需很少的努力将<code>Landmarks</code>应用程序迁移到<code>watchOS</code>。</p>
<p>在复制为iOS应用程序创建的共享数据和视图之前，您将首先向项目中添加<code>watchOS target</code>。所有资源就绪后，您将自定义SwiftUI视图，以便在<code>watchOS</code>上显示详情视图和列表视图。</p>
<blockquote>
<p>学习时间：25分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/2165a283e4/CreatingAwatchOSApp.zip">下载地址：CreatingAwatchOSApp.zip</a></p>
</blockquote>
<h2 id="第一节-添加watchOS-Target">第一节 添加watchOS Target</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%B7%BB%E5%8A%A0watchos-target"></a></p>
<p>要创建watchOS应用程序，请首先将watchOS Target添加到项目中。Xcode将watchOS应用程序的文件夹和文件，以及构建和运行该应用程序所需的方案添加到项目中。</p>
<p><img src="https://camo.githubusercontent.com/94e5cb4d1b6bf9cee0366f72b27112dfbfee7b131f979b7a5c3c25a0f546eba5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363332313031353864612f65306461346164642d363265622d343737652d613363622d3134626666653362383361612e706e67" alt=""></p>
<h2 id="步骤1-26">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>选择<code>File &gt; New &gt; Target</code>。当工作模板表出现时，选择<code>watchOS</code>选项卡，选择<code>Watch App for iOS</code>应用程序模板，然后单击<code>Next</code>。</p>
<p>此模板将新的watchOS应用程序添加到您的项目中，并与iOS应用程序配对。</p>
<p><img src="https://camo.githubusercontent.com/3f1925f86b2fade7e5cdd1a610932de6d20c4e4ab5eb287b08d9814f8171f18b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f376334633065333137312f64363831333232342d323866362d343031382d383736302d3163623662623936623062332e706e67" alt=""></p>
<h2 id="步骤2-26">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>在表单中，输入<code>WatchLandmarks</code>作为产品名称。将语言设置为<code>Swift</code>，将用户界面设置为<code>SwiftUI</code>。选中<code>Include Notification Scene</code>复选框，然后单击“Finish”。</p>
<p><img src="https://camo.githubusercontent.com/ae35f464476b2d66628838d67b41534e4270d03640001178b51b630cfe730604/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f306534313063643932332f64613733363431312d346335322d346162662d616535312d3965366464643232366639332e706e67" alt=""></p>
<h2 id="步骤3-22">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<blockquote>
<p>如果Xcode提示，请单击“Activate”。</p>
</blockquote>
<p>这将选择<code>WatchLandmarks</code>方案，以便您可以构建和运行watchOS应用程序。</p>
<p><img src="https://camo.githubusercontent.com/e27ae1c3f18e4b9666755eb3a325dc9fb977dccd9a40cf680f486112b0400deb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363334663533666536622f35316663376633362d363264612d346461622d386435342d6330366434653738633437372e706e67" alt=""></p>
<h2 id="步骤4-21">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>在<code>WatchLandmarks</code>扩展的“General”选项卡中，选中<code>Supports Running Without iOS App Installation(支持在不安装iOS应用程序的情况下运行)</code>复选框。</p>
<blockquote>
<p>尽可能创建一个独立的watchOS应用程序。独立的watchOS应用不需要iOS配套应用。</p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/e95d6ca42c552ac8f94552ac39cf826eea201631c2c2f2aa53b9c536cf798c31/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623439343564306165372f39346632616132382d336365622d343932382d613663662d6435366338626138613464612e706e67" alt=""></p>
<h2 id="第二节-在目标之间共享文件">第二节 在目标之间共享文件</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%9C%A8%E7%9B%AE%E6%A0%87%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6"></a></p>
<p>设置了watchOS目标后，需要共享iOS目标中的一些资源。您将重用<code>Landmark</code>应用程序的数据模型、一些资源文件以及两个平台都可以显示而无需修改的任何视图。</p>
<p><img src="https://camo.githubusercontent.com/1edc28a6d546e1ed24f7e6702f2a723a10290c3e5c38b7bbdaf19d803db63bdd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396532653061356561352f66643762633837662d613235652d346561622d383837662d6462366462636362323065382e706e67" alt=""></p>
<h2 id="步骤1-27">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>在项目导航器中，单击命令以选择以下文件：LandmarkRow.swift、Landmark.swift、UserData.swift、Data.swift、Profile.swift、Hike.swift和CircleImage.swift。</p>
<p>Landmark.swift、UserData.swift、Data.swift、Profile.swift和Hike.swift定义了应用程序的数据模型。您不会使用模型的所有方面，但需要所有文件才能成功编译应用程序。LandmarkRow.swift和CircleImage.swift都是应用程序可以在watchOS上显示的视图，无需任何更改。</p>
<p><img src="https://camo.githubusercontent.com/ea545188f8eb75b30f9ef0d042a89331accc069e6ceb29d20c9ee060c44b6bdb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323531366535363133642f39353732313666652d616632622d343965632d616430652d6639653731643638323162652e706e67" alt=""></p>
<h2 id="步骤2-27">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>在“文件检查器”中，选中“Target Membership”部分中的“WatchLandmarks Extension”复选框。</p>
<p><img src="https://camo.githubusercontent.com/98daa11ce8e23aae78655dbcbb344fab78364e24b96bc2d079bf4076c96d8a38/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666538373435363936342f32353861333461652d613536352d343364342d613261392d3436356636653562393939392e706e67" alt=""></p>
<blockquote>
<p>这使您在上一步中选择的文件可用于watchOS应用程序。</p>
</blockquote>
<h2 id="步骤3-23">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>在项目导航器中，选择Landmark组中的Assets.xclassets文件，并将其添加到<code>File</code>检查器的<code>Target Membership</code>部分中的<code>WatchLandmarks</code> Target中。</p>
<p>这与您在上一步中选择的<code>Target</code>不同。<code>WatchLandmarks Extension</code> Target包含你的应用程序的代码，而<code>WatchLandmarks Target</code>管理脚本、图标和相关资源。</p>
<p><img src="https://camo.githubusercontent.com/0b9dbaa9d025d35d817a7c05ca880f6feb9eefb10678aaa655125a215cad0593/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343239303166333030652f66643362663461652d343539622d343638652d623631312d6561636235613433353862322e706e67" alt=""></p>
<h2 id="步骤4-22">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>在项目导航器中，选择<code>Resources</code>文件夹中的所有文件，然后在<code>File</code>检查器的<code>Target Membership</code>中将它们添加到<code>WatchLandmarks Extension</code> target中。</p>
<p><img src="https://camo.githubusercontent.com/ec10e16d166dfdf5a2c40538ba019261705f7c623dd8860d6cf9bf388666cc05/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f643662376136323537342f38313462303931662d313832392d346639612d396439652d3365663137613038616635362e706e67" alt=""></p>
<h2 id="第三节-创建详情视图">第三节 创建详情视图</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%88%9B%E5%BB%BA%E8%AF%A6%E6%83%85%E8%A7%86%E5%9B%BE"></a></p>
<p>现在iOS目标资源已经准备好用于watch应用程序，您需要创建一个watch的视图来显示地标详情。为了测试详情视图，您将为最大和最小的手表尺寸创建自定义预览，并对圆形视图进行一些更改，以便所有内容都适合手表界面。</p>
<p><img src="https://camo.githubusercontent.com/a0426ec1422661dea3b047ab629887a05f43745897c6f338c4067f054e40cad2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393838393463356262642f63346534646538382d626138652d343962392d396136652d3030656439626335376633622e706e67" alt=""></p>
<h2 id="步骤1-28">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>在项目导航器中，单击<code>WatchLandmarks Extension</code>文件夹旁边的三角形以显示其内容，然后添加名为<code>WatchLandmarkDetail</code>的新SwiftUI视图。</p>
<p><img src="https://camo.githubusercontent.com/8b29e4d0ecfe281efce56192f299c9b98ae900700b71deb605ce17c58c39686c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f666566643362356538372f37376436306238312d623132622d343232302d616565302d3939383339643931363837362e706e67" alt=""></p>
<h2 id="步骤2-28">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>将<code>userData、landmark、landmarkIndex</code>属性添加到<code>WatchLandmarkDetail</code>结构中。</p>
<p>这些属性与您在Handling User Input时添加到<code>LandmarkDetail</code>结构中的属性相同。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchLandmarkDetail</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在上一步中添加属性后，Xcode中将出现参数丢失错误。要修复错误，您需要执行以下两项操作之一：为属性提供默认值，或传递参数设置视图的属性。</p>
</blockquote>
<h2 id="步骤3-24">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>在预览中，创建用户数据的实例，并使用它将<code>landmark</code>对象传递给<code>WatchLandmarkView</code>结构的初始值。还需要将用户数据设置为视图的环境对象。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>])</span><br><span class="line">            .environmentObject(userData)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/52c7d41a324a48a3eb1df51ec58a274b897760eb9a34e23e53390b29c03ff4ba/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f316637333639333863382f61386131383764652d356539622d343239312d623936632d3663636162626233346638392e706e67" alt=""></p>
<h2 id="步骤4-23">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>在<code>WatchLandmarkDetail.swift</code>中，从<code>body（）</code>方法返回<code>CircleImage</code>视图。</p>
<p>在这里，您可以重用iOS项目中的CircleImage视图。因为您创建了一个可调整大小的图像，所以调用<code>.scaledToFill（）</code>将调整圆的大小，使其自动适配显示。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">            .scaledToFill()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>])</span><br><span class="line">            .environmentObject(userData)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-12">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>为最大（44毫米）和最小（38毫米）的表盘创建预览。</p>
<p>通过对最大和最小的手表表面进行测试，你可以看到你的应用程序在屏幕上的缩放效果。一如既往，您应该在所有支持的设备大小上测试用户界面。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">            .scaledToFill()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/11cbfa48139c2ad01549d97b5a9cef1482ce2f8e52edd920e278dad0c7ee3f8e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373432643533393730322f32626266363065642d363139372d346636342d383535352d3061383465323561313766622e706e67" alt=""></p>
<blockquote>
<p>圆形图像将调整大小以适配显示的高度。不幸的是，这也限制了圆的宽度。要解决裁减问题，您需要将图像嵌入<code>VStack</code>中，并进行一些额外的布局更改，以便圆形图像适合任何手表的宽度。</p>
</blockquote>
<h2 id="步骤6-9">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>将圆图像嵌入到<code>VStack</code>中。在图像下方显示地标名称及其信息。</p>
<p>如您所见，该信息不太适合在表盘屏幕上显示，但您可以通过将VStack放在滚动视图中来解决这个问题。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                .scaledToFill()</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .lineLimit(<span class="number">0</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Toggle</span>(isOn:</span><br><span class="line">            <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Divider</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                .font(.caption)</span><br><span class="line">                .bold()</span><br><span class="line">                .lineLimit(<span class="number">0</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                .font(.caption)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/2c3962044d2e8fb9d52feabbda3f0efa434ad2dcdccb3522561c45264d3c2e0a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663831373162393463612f62633039313630392d363564362d343436332d383436342d6433613566336632613035312e706e67" alt=""></p>
<h2 id="步骤7-4">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47"></a></p>
<p>在滚动视图中包装<code>VStack</code>。</p>
<p>这会打开视图滚动，但会产生另一个问题：圆形图像现在会扩展到原大小，并且会调整其他UI元素的大小以匹配图像大小。您需要调整圆图像的大小，以便屏幕上只显示圆和地标名称。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Toggle</span>(isOn:</span><br><span class="line">                <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/6bba9cde52680e0519f897f766fbbc853ab2e9b7a2672272b69464f0886d3759/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f353636613563623838342f39643437616339662d323061392d346466652d393332642d3532636461346266393932342e706e67" alt=""></p>
<h2 id="步骤8-3">步骤8</h2>
<p><a href="#%E6%AD%A5%E9%AA%A48"></a></p>
<p>将<code>scaleToFill（）</code>更改为<code>scaleToFit（）</code>。</p>
<p>这将缩放圆图像以匹配显示器的宽度。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Toggle</span>(isOn:</span><br><span class="line">                <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/e6834923fb4a19e1e1f84d6b508b58c798d0184d8e46f8f5841f8d8a6c775b73/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323761386531653230612f61333830633264632d343361342d346265362d386639322d3339303463353931356536662e706e67" alt=""></p>
<h2 id="步骤9-3">步骤9</h2>
<p><a href="#%E6%AD%A5%E9%AA%A49"></a></p>
<p>添加<code>padding</code>，使地标名称在圆图像下方可见。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Toggle</span>(isOn:</span><br><span class="line">                <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="number">16</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/0b02ca1bf5ca5290d18b14f1bada438174e7f0f2402042aa4dfed889e7a76e59/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393436633830326330302f35633633636462372d663166362d343863642d386662362d6332613162653432383335652e706e67" alt=""></p>
<h2 id="步骤10-2">步骤10</h2>
<p><a href="#%E6%AD%A5%E9%AA%A410"></a></p>
<p>在<code>后退</code>按钮上添加标题。</p>
<p>这会将后退按钮的文本设置为“地标”。但是，在添加“地标列表”视图之前，您不会看到“后退”按钮。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Toggle</span>(isOn:</span><br><span class="line">                <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="number">16</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="string">&quot;Landmarks&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/0b02ca1bf5ca5290d18b14f1bada438174e7f0f2402042aa4dfed889e7a76e59/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393436633830326330302f35633633636462372d663166362d343863642d386662362d6332613162653432383335652e706e67" alt=""></p>
<h2 id="第四节-添加watchOS地图视图">第四节 添加watchOS地图视图</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E6%B7%BB%E5%8A%A0watchos%E5%9C%B0%E5%9B%BE%E8%A7%86%E5%9B%BE"></a></p>
<p>现在您已经创建了基本详情视图，现在是时候添加一个地图来显示地标的位置了。与<code>CircleImage</code>不同，你不能重用iOS应用程序的<code>MapView</code>。相反，您需要创建一个<code>WKInterfaceObjectRepresentable</code>结构来包装<code>WatchKit</code>的地图视图。</p>
<p><img src="https://camo.githubusercontent.com/53b2572627149ce7fb0b40d2c07f7bd257519607b195f956ae26ef8abc4d7a19/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313738306665356134352f37623630306664352d386637302d346365362d626532652d6434666338313530326139382e706e67" alt=""></p>
<h2 id="步骤1-29">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>向<code>WatchKit extension</code>添加名为<code>WatchMapView</code>的自定义视图。</p>
<blockquote>
<p>WatchMapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchMapView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/52c7d41a324a48a3eb1df51ec58a274b897760eb9a34e23e53390b29c03ff4ba/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f316637333639333863382f61386131383764652d356539622d343239312d623936632d3663636162626233346638392e706e67" alt=""></p>
<h2 id="步骤2-29">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<blockquote>
<p>在<code>WatchMapView</code>结构中，将View更改为<code>WKInterfaceObjectRepresentable</code>。</p>
</blockquote>
<p>要查看区别，请在步骤1和2所示的代码之间来回滚动。</p>
<blockquote>
<p>WatchMapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView</span>: <span class="title class_ inherited__">WKInterfaceObjectRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchMapView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Xcode显示编译错误，因为WatchMapView尚未实现<code>WKInterfaceObjectRepresentable</code>协议属性。</p>
</blockquote>
<h2 id="步骤3-25">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<p>删除<code>body（）</code>方法并将其替换为<code>landmark</code>属性。</p>
<p>无论何时创建地图视图，都需要传递此属性的值。例如，可以将<code>landmark</code>的实例传递给预览。</p>
<blockquote>
<p>WatchMapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView</span>: <span class="title class_ inherited__">WKInterfaceObjectRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchMapView</span>(landmark: <span class="type">UserData</span>().landmarks[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-24">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-3"></a></p>
<p>实现<code>WKInterfaceObjectRepresentable</code>的<code>makeWKInterfaceObject(context:)</code> 方法。</p>
<p>此方法用来创建<code>WatchMapView</code>显示的<code>WatchKit</code>地图。</p>
<blockquote>
<p>WatchMapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView</span>: <span class="title class_ inherited__">WKInterfaceObjectRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeWKInterfaceObject</span>(<span class="params">context</span>: <span class="type">WKInterfaceObjectRepresentableContext</span>&lt;<span class="type">WatchMapView</span>&gt;) -&gt; <span class="type">WKInterfaceMap</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">WKInterfaceMap</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchMapView</span>(landmark: <span class="type">UserData</span>().landmarks[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-13">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>通过实现<code>WKInterfaceObjectRepresentable</code>的<code>updateWKInterfaceObject（_:，context:）</code>方法，根据地标的坐标设置地图的区域。</p>
<p>现在，编译成功了。</p>
<blockquote>
<p>WatchMapView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView</span>: <span class="title class_ inherited__">WKInterfaceObjectRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeWKInterfaceObject</span>(<span class="params">context</span>: <span class="type">WKInterfaceObjectRepresentableContext</span>&lt;<span class="type">WatchMapView</span>&gt;) -&gt; <span class="type">WKInterfaceMap</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">WKInterfaceMap</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateWKInterfaceObject</span>(<span class="keyword">_</span> <span class="params">map</span>: <span class="type">WKInterfaceMap</span>, <span class="params">context</span>: <span class="type">WKInterfaceObjectRepresentableContext</span>&lt;<span class="type">WatchMapView</span>&gt;) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> span <span class="operator">=</span> <span class="type">MKCoordinateSpan</span>(latitudeDelta: <span class="number">0.02</span>,</span><br><span class="line">            longitudeDelta: <span class="number">0.02</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> region <span class="operator">=</span> <span class="type">MKCoordinateRegion</span>(</span><br><span class="line">            center: landmark.locationCoordinate,</span><br><span class="line">            span: span)</span><br><span class="line">        </span><br><span class="line">        map.setRegion(region)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchMapView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">WatchMapView</span>(landmark: <span class="type">UserData</span>().landmarks[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5551ad7b71c54a37f15c63d1056aac1c7f0c5e8e1519cc2f166a73a61fa53bdb/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356330373736623463622f39396533356233612d306333652d343063312d613739332d6261656261626230323734642e706e67" alt=""></p>
<h2 id="步骤6-10">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-1"></a></p>
<p>选择<code>WatchLandmarkView.swift</code>文件并将地图视图添加到<code>VStack</code>的底部。</p>
<p>代码添加了一个分隔符，后跟地图视图。<code>.scaledToFit（）</code>和<code>.padding（）</code>修饰符将地图以合适的大小适配屏幕。</p>
<blockquote>
<p>WatchLandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: <span class="keyword">self</span>.landmark.image.resizable())</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.name)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Toggle</span>(isOn:</span><br><span class="line">                <span class="variable">$userData</span>.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorite&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.park)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .lineLimit(<span class="number">0</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Text</span>(<span class="keyword">self</span>.landmark.state)</span><br><span class="line">                    .font(.caption)</span><br><span class="line">                </span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">WatchMapView</span>(landmark: <span class="keyword">self</span>.landmark)</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">                    .padding()</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="number">16</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="string">&quot;Landmarks&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WatchLandmarkDetail_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">0</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 4 - 44mm&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">WatchLandmarkDetail</span>(landmark: userData.landmarks[<span class="number">1</span>]).environmentObject(userData)</span><br><span class="line">                .previewDevice(<span class="string">&quot;Apple Watch Series 2 - 38mm&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/b1c95ec69bb97575ea43a15c8c0740e0f9643f936edcfb9eb0d05f2a95e269fd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663336383661313061612f63303138653933642d636538342d343762622d623730632d3436336530343834336131342e706e67" alt=""></p>
<h2 id="第五节-创建跨平台列表视图">第五节 创建跨平台列表视图</h2>
<p><a href="#%E7%AC%AC%E4%BA%94%E8%8A%82-%E5%88%9B%E5%BB%BA%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE"></a></p>
<p>对于地标列表，您可以重用iOS应用程序中的行<code>Row</code>，但每个平台都需要呈现自己的详情视图。为了支持这一点，您将把LandmarkList视图转换为泛型列表类型，在这里实例化代码定义了详情视图。</p>
<h2 id="步骤1-在工具栏中，选择Landmarks-scheme。">步骤1 在工具栏中，选择<code>Landmarks scheme</code>。</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-%E5%9C%A8%E5%B7%A5%E5%85%B7%E6%A0%8F%E4%B8%AD%E9%80%89%E6%8B%A9landmarks-scheme"></a></p>
<p>Xcode现在编译并运行应用程序的iOS版本。在将列表移动到watchOS应用程序之前，您要确保对<code>LandmarkList</code>视图的任何修改在iOS应用程序中仍然有效。</p>
<p><img src="https://camo.githubusercontent.com/fa82bdc504625c6f764d35ff385f348b7bbca93a267ab913261dfa8611a4be51/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f383264316230653466632f38313034303539622d396138612d346434662d616362382d6561376664386537376462372e706e67" alt=""></p>
<h2 id="步骤2-30">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-4"></a></p>
<p>选择<code>LandmarkList.swift</code>并更改类型声明，使其成为泛型类型。</p>
<blockquote>
<p>LandmarksList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>&lt;<span class="type">DetailView</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">private</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show Favorites Only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(</span><br><span class="line">                    destination: <span class="type">LandmarkDetail</span>(landmark: landmark).environmentObject(<span class="keyword">self</span>.userData)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarksList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>([<span class="string">&quot;iPhone SE&quot;</span>, <span class="string">&quot;iPhone XS Max&quot;</span>].identified(by: \.<span class="keyword">self</span>)) &#123; deviceName <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .previewDevice(<span class="type">PreviewDevice</span>(rawValue: deviceName))</span><br><span class="line">                .previewDisplayName(deviceName)</span><br><span class="line">        &#125;</span><br><span class="line">        .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在创建<code>LandmarkList</code>结构的实例时，添加泛型声明会导致<code>Generic parameter could not be inferred(无法推断泛型参数)</code>错误。以下步骤会修复这些错误。</p>
</blockquote>
<h2 id="步骤3-26">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-4"></a></p>
<p>为创建局部视图的闭包添加属性。</p>
<blockquote>
<p>LandmarksList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>&lt;<span class="type">DetailView</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">private</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> detailViewProducer: (<span class="type">Landmark</span>) -&gt; <span class="type">DetailView</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show Favorites Only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(</span><br><span class="line">                    destination: <span class="type">LandmarkDetail</span>(landmark: landmark).environmentObject(<span class="keyword">self</span>.userData)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarksList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>([<span class="string">&quot;iPhone SE&quot;</span>, <span class="string">&quot;iPhone XS Max&quot;</span>].identified(by: \.<span class="keyword">self</span>)) &#123; deviceName <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .previewDevice(<span class="type">PreviewDevice</span>(rawValue: deviceName))</span><br><span class="line">                .previewDisplayName(deviceName)</span><br><span class="line">        &#125;</span><br><span class="line">        .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-25">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-4"></a></p>
<p>使用<code>detailViewProducer</code>属性为地标创建详情视图。</p>
<blockquote>
<p>LandmarksList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>&lt;<span class="type">DetailView</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">private</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> detailViewProducer: (<span class="type">Landmark</span>) -&gt; <span class="type">DetailView</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show Favorites Only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(</span><br><span class="line">                    destination: <span class="keyword">self</span>.detailViewProducer(landmark).environmentObject(<span class="keyword">self</span>.userData)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarksList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ForEach</span>([<span class="string">&quot;iPhone SE&quot;</span>, <span class="string">&quot;iPhone XS Max&quot;</span>].identified(by: \.<span class="keyword">self</span>)) &#123; deviceName <span class="keyword">in</span></span><br><span class="line">            <span class="type">LandmarkList</span>()</span><br><span class="line">                .previewDevice(<span class="type">PreviewDevice</span>(rawValue: deviceName))</span><br><span class="line">                .previewDisplayName(deviceName)</span><br><span class="line">        &#125;</span><br><span class="line">        .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建<code>LandmarkList</code>实例时，还需要提供一个闭包，用于创建<code>landmark</code>的详情视图。</p>
</blockquote>
<h2 id="步骤5-14">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-2"></a></p>
<p>选择Home.swift。在<code>CategoryHome</code>结构的<code>body（）</code>方法中，添加闭包以创建<code>LandmarkDetail</code>视图。</p>
<p>Xcode根据闭包的返回值推断<code>LandmarkList</code>结构的泛型类型。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingProfile <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> profileButton: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.showingProfile.toggle() &#125;) &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;person.crop.circle&quot;</span>)</span><br><span class="line">                .imageScale(.large)</span><br><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>))</span><br><span class="line">                .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="type">CGFloat</span>(<span class="number">200</span>))</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkList</span> &#123; <span class="type">LandmarkDetail</span>(landmark: <span class="variable">$0</span>) &#125;) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;See All&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing: profileButton)</span><br><span class="line">            .sheet(isPresented: <span class="variable">$showingProfile</span>) &#123;</span><br><span class="line">                <span class="type">ProfileHost</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// swiftlint:disable type_name</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤6-11">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-2"></a></p>
<p>在LandmarkList.swift中，向预览添加类似的代码。</p>
<p>在这里，您需要使用条件判断，根据Xcode编译的当前<code>scheme</code>定义详情视图。现在地标应用程序可以按照预期在iOS上构建和运行了。</p>
<blockquote>
<p>LandmarksList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>&lt;<span class="type">DetailView</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">private</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> detailViewProducer: (<span class="type">Landmark</span>) -&gt; <span class="type">DetailView</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show Favorites Only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(</span><br><span class="line">                    destination: <span class="keyword">self</span>.detailViewProducer(landmark).environmentObject(<span class="keyword">self</span>.userData)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> os(watchOS)</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">PreviewDetailView</span> <span class="operator">=</span> <span class="type">WatchLandmarkDetail</span></span><br><span class="line"><span class="keyword">#else</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">PreviewDetailView</span> <span class="operator">=</span> <span class="type">LandmarkDetail</span></span><br><span class="line"><span class="keyword">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span> &#123; <span class="type">PreviewDetailView</span>(landmark: <span class="variable">$0</span>) &#125;</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/155253a23fe7a02f9e435374ece449f3d092a622da3841dd7353dc1135ba1b25/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f656164323837616138322f66396236376132322d313936632d343064372d386630302d3132323033643730626535302e706e67" alt=""></p>
<h2 id="第六节-添加地标列表">第六节 添加地标列表</h2>
<p><a href="#%E7%AC%AC%E5%85%AD%E8%8A%82-%E6%B7%BB%E5%8A%A0%E5%9C%B0%E6%A0%87%E5%88%97%E8%A1%A8"></a></p>
<p>现在您已经更新了LandmarksList视图，以便它在两个平台上都能工作，您可以将其添加到watchOS应用程序中。</p>
<p><img src="https://camo.githubusercontent.com/b36132b3627950a40351115d6c1c9f2d198d1e46e8d2fdd493a44c0299ac446a/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393964396135313461382f63633463373830662d383065382d343139362d393632332d6634653731663636666165302e706e67" alt=""></p>
<h2 id="步骤1-30">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-4"></a></p>
<p>在文件检查器中，将<code>LandmarksList.swift</code>添加到<code>WatchLandmarks Extension</code>Target。</p>
<p>现在可以在watchOS应用程序的代码中使用LandmarkList视图。</p>
<p><img src="https://camo.githubusercontent.com/d6270016341abca60586d0bcd80f66db55284bb4841e76f6f1f4885612d473dd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623666656465613266642f35333239623336652d326261302d343633662d623038342d3933386465666665643934322e706e67" alt=""></p>
<h2 id="步骤2-31">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-5"></a></p>
<p>在工具栏中，将<code>scheme</code>更改为<code>WatchLandmarks</code>。</p>
<p><img src="https://camo.githubusercontent.com/8e530ec5f9e0f7ffb6dbe22b95af0564eb1ca8cff023b8da7b3bdd2595f7bd28/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f373561623437356338612f39336539613464372d343039622d343233362d383336632d6566353765383161626532352e706e67" alt=""></p>
<h2 id="步骤3-27">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-5"></a></p>
<p>打开<code>LandmarkList.swift</code>，继续预览。</p>
<p>预览现在显示watchOS列表视图。</p>
<blockquote>
<p>LandmarksList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>&lt;<span class="type">DetailView</span>: <span class="type">View</span>&gt;: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">private</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> detailViewProducer: (<span class="type">Landmark</span>) -&gt; <span class="type">DetailView</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Show Favorites Only&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(</span><br><span class="line">                    destination: <span class="keyword">self</span>.detailViewProducer(landmark).environmentObject(<span class="keyword">self</span>.userData)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">#if</span> os(watchOS)</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">PreviewDetailView</span> <span class="operator">=</span> <span class="type">WatchLandmarkDetail</span></span><br><span class="line"><span class="keyword">#else</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">PreviewDetailView</span> <span class="operator">=</span> <span class="type">LandmarkDetail</span></span><br><span class="line"><span class="keyword">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span> &#123; <span class="type">PreviewDetailView</span>(landmark: <span class="variable">$0</span>) &#125;</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>watchOS应用程序的根视图是ContentView，它显示默认文本<code>Hello World！</code>。</p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/a30f9cebda3c540a1e1fe0292baf157da40c156769c84d0739fcab1e930c17ba/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346230666337396331342f65663032396237332d656637622d343939352d393566352d3862646339613030653636612e706e67" alt=""></p>
<h2 id="步骤4-26">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-5"></a></p>
<p>修改ContentView，使其显示列表视图。</p>
<blockquote>
<p>ContentView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span> &#123; <span class="type">WatchLandmarkDetail</span>(landmark: <span class="variable">$0</span>) &#125;</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span> &#123; <span class="type">WatchLandmarkDetail</span>(landmark: <span class="variable">$0</span>) &#125;</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/a30f9cebda3c540a1e1fe0292baf157da40c156769c84d0739fcab1e930c17ba/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346230666337396331342f65663032396237332d656637622d343939352d393566352d3862646339613030653636612e706e67" alt=""></p>
<h2 id="步骤5-15">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-3"></a></p>
<p>在模拟器中编译运行watchOS应用程序。</p>
<p>通过滚动列表中的地标来测试watchOS应用程序的行为，点击以查看地标的详细信息，并将其标记为收藏夹。单击<code>back</code>按钮返回列表，然后打开<code>Favorite</code>开关，这样您只能看到收藏的地标。</p>
<p><img src="https://camo.githubusercontent.com/dbca4e8fc36442494ed03ed86a398c0097cd6bf49c6b6b142c23852c6e387189/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626461336236636435662f30633332306434632d386131352d346261312d393138322d3264383231333239343366362e706e67" alt=""></p>
<h2 id="第7节-创建自定义通知界面">第7节 创建自定义通知界面</h2>
<p><a href="#%E7%AC%AC7%E8%8A%82-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%9A%E7%9F%A5%E7%95%8C%E9%9D%A2"></a></p>
<p>你的watchOS版地标应用程序几乎完成了。在这最后一部分中，您将创建一个通知界面，每当您离最喜欢的某一位置很近时，会收到地标信息的通知信息。</p>
<p><img src="https://camo.githubusercontent.com/c72963e1dff238ad5c763a4eeb9497a4e3405611aee70cabf5a39196b4cf9a81/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333739646434353933332f36366236343234342d633164662d343963372d383936362d6639333234396435656136302e706e67" alt=""></p>
<blockquote>
<p>注意：本节仅介绍如何在收到通知后显示通知。它不描述如何设置或发送通知。</p>
</blockquote>
<h2 id="步骤1-31">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-5"></a></p>
<p>打开<code>NotificationView.swift</code>并创建一个显示有关地标、标题和消息的信息的视图。</p>
<p>因为任何通知值都可以为nil，所以预览将显示通知视图的两个版本。第一个仅在未提供数据时显示默认值，第二个显示您提供的标题、消息和位置。</p>
<blockquote>
<p>NotificationView.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">NotificationView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> title: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">let</span> message: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">let</span> landmark: <span class="type">Landmark</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">title</span>: <span class="type">String</span>? <span class="operator">=</span> <span class="literal">nil</span>,</span><br><span class="line">         <span class="params">message</span>: <span class="type">String</span>? <span class="operator">=</span> <span class="literal">nil</span>,</span><br><span class="line">         <span class="params">landmark</span>: <span class="type">Landmark</span>? <span class="operator">=</span> <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.title <span class="operator">=</span> title</span><br><span class="line">        <span class="keyword">self</span>.message <span class="operator">=</span> message</span><br><span class="line">        <span class="keyword">self</span>.landmark <span class="operator">=</span> landmark</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> landmark <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">                <span class="type">CircleImage</span>(image: landmark<span class="operator">!</span>.image.resizable())</span><br><span class="line">                    .scaledToFit()</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(title <span class="operator">??</span> <span class="string">&quot;Unknown Landmark&quot;</span>)</span><br><span class="line">                .font(.headline)</span><br><span class="line">                .lineLimit(<span class="number">0</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Divider</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(message <span class="operator">??</span> <span class="string">&quot;You are within 5 miles of one of your favorite landmarks.&quot;</span>)</span><br><span class="line">                .font(.caption)</span><br><span class="line">                .lineLimit(<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">NotificationView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">NotificationView</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">NotificationView</span>(title: <span class="string">&quot;Turtle Rock&quot;</span>,</span><br><span class="line">                             message: <span class="string">&quot;You are within 5 miles of Turtle Rock.&quot;</span>,</span><br><span class="line">                             landmark: <span class="type">UserData</span>().landmarks[<span class="number">0</span>])</span><br><span class="line">        &#125;</span><br><span class="line">        .previewLayout(.sizeThatFits)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/0fae9f5a08302a4a49c869bf638a2acfad4094d98c421317e921f5b2daac8d8b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323137366330646438622f66393033653434392d376161632d343135362d623838352d6535306132616464616636622e706e67" alt=""></p>
<h2 id="步骤2-32">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-6"></a></p>
<p>打开<code>NotificationController</code>并添加<code>landmark</code>、<code>title</code>和<code>message</code>属性。</p>
<p>这些数据存储了有关通知传入信息。</p>
<blockquote>
<p>NotificationController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationController</span>: <span class="title class_ inherited__">WKUserNotificationHostingController</span>&lt;<span class="title class_ inherited__">NotificationView</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> message: <span class="type">String</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">NotificationView</span> &#123;</span><br><span class="line">        <span class="type">NotificationView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">willActivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is about to be visible to user</span></span><br><span class="line">        <span class="keyword">super</span>.willActivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didDeactivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is no longer visible</span></span><br><span class="line">        <span class="keyword">super</span>.didDeactivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didReceive</span>(<span class="keyword">_</span> <span class="params">notification</span>: <span class="type">UNNotification</span>) &#123;</span><br><span class="line">        <span class="comment">// This method is called when a notification needs to be presented.</span></span><br><span class="line">        <span class="comment">// Implement it if you use a dynamic notification interface.</span></span><br><span class="line">        <span class="comment">// Populate your dynamic notification interface as quickly as possible.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-28">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-6"></a></p>
<p>更新<code>body（）</code>方法以使用这些属性。</p>
<p>此方法实例化您先前创建的通知视图。</p>
<blockquote>
<p>NotificationController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationController</span>: <span class="title class_ inherited__">WKUserNotificationHostingController</span>&lt;<span class="title class_ inherited__">NotificationView</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> message: <span class="type">String</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">NotificationView</span> &#123;</span><br><span class="line">        <span class="type">NotificationView</span>(title: title,</span><br><span class="line">            message: message,</span><br><span class="line">            landmark: landmark)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">willActivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is about to be visible to user</span></span><br><span class="line">        <span class="keyword">super</span>.willActivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didDeactivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is no longer visible</span></span><br><span class="line">        <span class="keyword">super</span>.didDeactivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didReceive</span>(<span class="keyword">_</span> <span class="params">notification</span>: <span class="type">UNNotification</span>) &#123;</span><br><span class="line">        <span class="comment">// This method is called when a notification needs to be presented.</span></span><br><span class="line">        <span class="comment">// Implement it if you use a dynamic notification interface.</span></span><br><span class="line">        <span class="comment">// Populate your dynamic notification interface as quickly as possible.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-27">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-6"></a></p>
<p>定义<code>LandmarkIndexKey</code>。</p>
<p>使用此键可从通知中提取地标索引。</p>
<blockquote>
<p>NotificationController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationController</span>: <span class="title class_ inherited__">WKUserNotificationHostingController</span>&lt;<span class="title class_ inherited__">NotificationView</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> message: <span class="type">String</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> landmarkIndexKey <span class="operator">=</span> <span class="string">&quot;landmarkIndex&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">NotificationView</span> &#123;</span><br><span class="line">        <span class="type">NotificationView</span>(title: title,</span><br><span class="line">            message: message,</span><br><span class="line">            landmark: landmark)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">willActivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is about to be visible to user</span></span><br><span class="line">        <span class="keyword">super</span>.willActivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didDeactivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is no longer visible</span></span><br><span class="line">        <span class="keyword">super</span>.didDeactivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didReceive</span>(<span class="keyword">_</span> <span class="params">notification</span>: <span class="type">UNNotification</span>) &#123;</span><br><span class="line">        <span class="comment">// This method is called when a notification needs to be presented.</span></span><br><span class="line">        <span class="comment">// Implement it if you use a dynamic notification interface.</span></span><br><span class="line">        <span class="comment">// Populate your dynamic notification interface as quickly as possible.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-16">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-4"></a></p>
<p>更新<code>didReceive（:）</code>方法以解析通知中的数据。</p>
<p>此方法更新控制器的属性。调用此方法后，系统将使控制器的body属性无效，该属性将更新导航视图。然后系统在<code>Apple Watch</code>上显示通知。</p>
<blockquote>
<p>NotificationController.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationController</span>: <span class="title class_ inherited__">WKUserNotificationHostingController</span>&lt;<span class="title class_ inherited__">NotificationView</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span>?</span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> message: <span class="type">String</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> landmarkIndexKey <span class="operator">=</span> <span class="string">&quot;landmarkIndex&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">NotificationView</span> &#123;</span><br><span class="line">        <span class="type">NotificationView</span>(title: title,</span><br><span class="line">            message: message,</span><br><span class="line">            landmark: landmark)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">willActivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is about to be visible to user</span></span><br><span class="line">        <span class="keyword">super</span>.willActivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didDeactivate</span>() &#123;</span><br><span class="line">        <span class="comment">// This method is called when watch view controller is no longer visible</span></span><br><span class="line">        <span class="keyword">super</span>.didDeactivate()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">didReceive</span>(<span class="keyword">_</span> <span class="params">notification</span>: <span class="type">UNNotification</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> userData <span class="operator">=</span> <span class="type">UserData</span>()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> notificationData <span class="operator">=</span></span><br><span class="line">            notification.request.content.userInfo <span class="keyword">as?</span> [<span class="type">String</span>: <span class="keyword">Any</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> aps <span class="operator">=</span> notificationData<span class="operator">?</span>[<span class="string">&quot;aps&quot;</span>] <span class="keyword">as?</span> [<span class="type">String</span>: <span class="keyword">Any</span>]</span><br><span class="line">        <span class="keyword">let</span> alert <span class="operator">=</span> aps<span class="operator">?</span>[<span class="string">&quot;alert&quot;</span>] <span class="keyword">as?</span> [<span class="type">String</span>: <span class="keyword">Any</span>]</span><br><span class="line">        </span><br><span class="line">        title <span class="operator">=</span> alert<span class="operator">?</span>[<span class="string">&quot;title&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span></span><br><span class="line">        message <span class="operator">=</span> alert<span class="operator">?</span>[<span class="string">&quot;body&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> index <span class="operator">=</span> notificationData<span class="operator">?</span>[landmarkIndexKey] <span class="keyword">as?</span> <span class="type">Int</span> &#123;</span><br><span class="line">            landmark <span class="operator">=</span> userData.landmarks[index]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当Apple Watch收到通知时，它会创建与通知类别关联的通知控制器。若要设置通知控制器的类别，必须打开并编辑应用程序的情节提要。</p>
</blockquote>
<h2 id="步骤6-12">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46-3"></a></p>
<p>在项目导航栏中，选择“Watch Landmarks”文件夹并打开界面<code>storyboard</code>。选择指向静态通知界面控制器的箭头。</p>
<p><img src="https://camo.githubusercontent.com/2ff42dd6b1639719775536c9667f1725a8f4048c54082b63676c0130fd0bd79b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396533653661653038342f37643030303236652d623164642d343830392d616635612d6436623234306566623432322e706e67" alt=""></p>
<h2 id="步骤7-5">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47-1"></a></p>
<p>在属性检查器中，将<code>Notification Category</code>的名称设置为<code>LandmarkNear</code>。</p>
<p><img src="https://camo.githubusercontent.com/4203bf25cc18a8afbde6c395f5065fffd03d54a53b2fb15d42212ece46d61a6f/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f616562353239626132342f39323838386434652d643332382d346364612d396364662d3037326364626164366265612e706e67" alt=""></p>
<blockquote>
<p>配置测试负载来使用LandmarkNear类别，并传递通知控制器期望的数据。</p>
</blockquote>
<h2 id="步骤8-4">步骤8</h2>
<p><a href="#%E6%AD%A5%E9%AA%A48-1"></a></p>
<p>选择<code>PushNotificationPayload.apns</code>文件，并更新title、body、category和landmarkIndex属性。请务必将类别设置为<code>LandmarkNear</code>。您还可以删除本教程中未使用的任何键，如<code>subtitle</code>、<code>WatchKit Simulator Actions</code>和<code>customKey</code>。</p>
<blockquote>
<p>PushNotificationPayload.apns</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;aps&quot;: &#123;</span><br><span class="line">        &quot;alert&quot;: &#123;</span><br><span class="line">            &quot;body&quot;: &quot;You are within 5 miles of Silver Salmon Creek.&quot;</span><br><span class="line">            &quot;title&quot;: &quot;Silver Salmon Creek&quot;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;category&quot;: &quot;LandmarkNear&quot;,</span><br><span class="line">        &quot;thread-id&quot;: &quot;5280&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    &quot;landmarkIndex&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>负载文件模拟远程通知中从服务器发送的数据。</p>
<h2 id="步骤9-4">步骤9</h2>
<p><a href="#%E6%AD%A5%E9%AA%A49-1"></a></p>
<p>选择“Landmarks-Watch (Notification)” scheme，并编译和运行您的应用程序。</p>
<p>第一次运行通知Scheme时，系统将请求发送通知的权限。选择<code>Allow(允许)</code>。模拟器随后显示一个可滚动的通知，其中包括：一个用于将地标应用程序标记为发送者的框、通知视图和通知操作的按钮。</p>
<p><img src="https://camo.githubusercontent.com/5e9bdcb61dafdcfe82a539a6318f43adf0ff0990568ddc411344e5b05f26f930/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f656263643133633637652f61396131333262642d616463652d343939382d393164622d6630633263313464643163332e706e67" alt=""></p>
<h3 id="应用程序设计和布局-2">应用程序设计和布局</h3>
<p><a href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%92%8C%E5%B8%83%E5%B1%80"></a></p>
<h2 id="使用UI控件">使用UI控件</h2>
<p><a href="#%E4%BD%BF%E7%94%A8ui%E6%8E%A7%E4%BB%B6"></a></p>
<p>在地标应用程序中，用户可以创建一个个人资料页来表达他们的个性。为了让用户能够更改他们的个人简介，您将添加一个编辑模式，并设计一个偏好设置页面。</p>
<p>您将使用各种用于数据输入的通用用户界面控件，并在用户保存更改时更新地标数据模型。</p>
<blockquote>
<p>学习时间：25分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/9b7e314dba/WorkingWithUIControls.zip">下载地址：WorkingWithUIControls.zip</a></p>
</blockquote>
<h2 id="第一节-显示用户简介">第一节 显示用户简介</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7%E7%AE%80%E4%BB%8B"></a></p>
<p><code>Landmarks</code>应用程序在本地存储一些详情配置和偏好设置。在用户编辑其详情之前，它们将显示在没有任何编辑控件的摘要视图中。</p>
<p><img src="https://camo.githubusercontent.com/c6e0255cc6cf7621c378c8e10b76a20f5471d4904d56a158291073a788ff4ac0/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626664393235336532642f36393961356631322d636638612d343936342d383666642d6463303065313331653333302e706e67" alt=""></p>
<h2 id="步骤1-32">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>要开始，请在<code>Landmarks</code>目录下创建一个名为<code>Profile</code>的新目录，然后将名为<code>ProfileHost</code>的视图添加到该目录中。</p>
<p><code>ProfileHost</code>视图将同时承载用户信息的静态摘要视图和编辑模式。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Profile for: <span class="subst">\(draftProfile.username)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/dc751f03ab8bf316b49e867e58b74d1def84ba36dd929506cde9559755e064bd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663034323966613466302f37643238353632392d353833372d343838332d383464332d3336613831636138646662322e706e67" alt=""></p>
<h2 id="步骤2-33">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>将<code>Home.swift</code>中的静态文本替换为上一步中创建的<code>ProfileHost</code>。</p>
<p>现在，主屏幕上的<code>profile</code>按钮将以模态方式展现用户简介。</p>
<blockquote>
<p>Home.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> categories: [<span class="type">String</span>: [<span class="type">Landmark</span>]] &#123;</span><br><span class="line">        <span class="type">Dictionary</span>(</span><br><span class="line">            grouping: landmarkData,</span><br><span class="line">            by: &#123; <span class="variable">$0</span>.category.rawValue &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> featured: [<span class="type">Landmark</span>] &#123;</span><br><span class="line">        landmarkData.filter &#123; <span class="variable">$0</span>.isFeatured &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showingProfile <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> profileButton: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.showingProfile.toggle() &#125;) &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;person.crop.circle&quot;</span>)</span><br><span class="line">                .imageScale(.large)</span><br><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">&quot;User Profile&quot;</span>))</span><br><span class="line">                .padding()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">FeaturedLandmarks</span>(landmarks: featured)</span><br><span class="line">                    .scaledToFill()</span><br><span class="line">                    .frame(height: <span class="number">200</span>)</span><br><span class="line">                    .clipped()</span><br><span class="line">                    .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">ForEach</span>(categories.keys.sorted(), id: \.<span class="keyword">self</span>) &#123; key <span class="keyword">in</span></span><br><span class="line">                    <span class="type">CategoryRow</span>(categoryName: key, items: <span class="keyword">self</span>.categories[key]<span class="operator">!</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .listRowInsets(<span class="type">EdgeInsets</span>())</span><br><span class="line">                </span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkList</span>()) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;See All&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Featured&quot;</span>))</span><br><span class="line">            .navigationBarItems(trailing: profileButton)</span><br><span class="line">            .sheet(isPresented: <span class="variable">$showingProfile</span>) &#123;</span><br><span class="line">                <span class="type">ProfileHost</span>()</span><br><span class="line">                    .environmentObject(<span class="keyword">self</span>.userData)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeaturedLandmarks</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmarks: [<span class="type">Landmark</span>]</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        landmarks[<span class="number">0</span>].image.resizable()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CategoryHome_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">CategoryHome</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/7d80dac1796c14d563b5ce1f5cdf150d623238ddcc3d3354d1a011ffd5e5943e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f303434356634646233312f32366365353664312d303137362d343238632d396632332d3565623939353232346638322e706e67" alt=""></p>
<h2 id="步骤3-29">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>创建一个名为<code>ProfileSummary</code>的新视图，该视图接受一个<code>Profile</code>实例并显示一些基本的用户信息。</p>
<p><code>ProfileSummary</code>持有一个<code>Profile</code>，比个人简介持有它好，因为父视图<code>ProfileHost</code>管理此视图的<code>State</code>。</p>
<blockquote>
<p>ProfileSummary.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> goalFormat: <span class="type">DateFormatter</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateStyle <span class="operator">=</span> .long</span><br><span class="line">        formatter.timeStyle <span class="operator">=</span> .none</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(profile.username)</span><br><span class="line">                .bold()</span><br><span class="line">                .font(.title)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Notifications: <span class="subst">\(<span class="keyword">self</span>.profile.prefersNotifications <span class="operator">?</span> <span class="string">&quot;On&quot;</span>: <span class="string">&quot;Off&quot;</span> )</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Seasonal Photos: <span class="subst">\(<span class="keyword">self</span>.profile.seasonalPhoto.rawValue)</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Goal Date: <span class="subst">\(<span class="keyword">self</span>.profile.goalDate, formatter: <span class="keyword">Self</span>.goalFormat)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileSummary</span>(profile: <span class="type">Profile</span>.default)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/35202ca2396b10ec362f296622b16f36b22316be660c75233236e35f0d4cd954/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f333432613635343461652f39633838366562392d616363642d343363312d396161652d3930356336646335366233622e706e67" alt=""></p>
<h2 id="步骤4-28">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>更新<code>ProfileHost</code>以显示新的摘要视图。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">ProfileSummary</span>(profile: draftProfile)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/f0622abcb1d191737b5d9182be9cdf5567354f360fe14c3f6417c092f78355fd/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f326666376439333961622f35383030653861362d343130392d346533302d623663372d3834306665383337363232302e706e67" alt=""></p>
<h2 id="步骤5-17">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>创建一个名为<code>HikeBadge</code> 的新视图，该视图由<a target="_blank" rel="noopener" href="https://github.com/ly918/SwiftUI-Chinese-Documents/wiki/01-Drawing-Paths-and-Shapes">绘制路径和形状</a>中制作的徽章以及徒步旅行的一些数据文本组成。</p>
<p>徽章只是一个图形，因此<code>HikeBadge</code>中的文本和<code>accessibility(label:)</code> 修饰符使徽章的含义对其他用户更清晰。</p>
<p><em><strong>注意：</strong></em></p>
<p>两次调用<code>frame(width:height:)</code>修饰符，使徽章以其设计时的尺寸300×300点进行缩放渲染。</p>
<blockquote>
<p>HikeBadge.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeBadge</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .center) &#123;</span><br><span class="line">            <span class="type">Badge</span>()</span><br><span class="line">                .frame(width: <span class="number">300</span>, height: <span class="number">300</span>)</span><br><span class="line">                .scaleEffect(<span class="number">1.0</span> <span class="operator">/</span> <span class="number">3.0</span>)</span><br><span class="line">                .frame(width: <span class="number">100</span>, height: <span class="number">100</span>)</span><br><span class="line">            <span class="type">Text</span>(name)</span><br><span class="line">                .font(.caption)</span><br><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">&quot;Badge for <span class="subst">\(name)</span>.&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HikeBadge_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HikeBadge</span>(name: <span class="string">&quot;Preview Testing&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/111ef1c72951f8fac61e410a18cbee9dca47ead17575da16f0974afb465b38d4/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323262316564663131332f32656438626262352d393438302d343539302d386238302d3337353430386666316466302e706e67" alt=""></p>
<h2 id="步骤6-13">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>更新<code>ProfileSummary</code>以添加不同颜色的徽章以及获得徽章的原因文字。</p>
<blockquote>
<p>ProfileSummary.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> goalFormat: <span class="type">DateFormatter</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateStyle <span class="operator">=</span> .long</span><br><span class="line">        formatter.timeStyle <span class="operator">=</span> .none</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(profile.username)</span><br><span class="line">                .bold()</span><br><span class="line">                .font(.title)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Notifications: <span class="subst">\(<span class="keyword">self</span>.profile.prefersNotifications <span class="operator">?</span> <span class="string">&quot;On&quot;</span>: <span class="string">&quot;Off&quot;</span> )</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Seasonal Photos: <span class="subst">\(<span class="keyword">self</span>.profile.seasonalPhoto.rawValue)</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Goal Date: <span class="subst">\(<span class="keyword">self</span>.profile.goalDate, formatter: <span class="keyword">Self</span>.goalFormat)</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Completed Badges&quot;</span>)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                <span class="type">ScrollView</span> &#123;</span><br><span class="line">                    <span class="type">HStack</span> &#123;</span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;First Hike&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;Earth Day&quot;</span>)</span><br><span class="line">                            .hueRotation(<span class="type">Angle</span>(degrees: <span class="number">90</span>))</span><br><span class="line">                        </span><br><span class="line">                        </span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;Tenth Hike&quot;</span>)</span><br><span class="line">                            .grayscale(<span class="number">0.5</span>)</span><br><span class="line">                            .hueRotation(<span class="type">Angle</span>(degrees: <span class="number">45</span>))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .frame(height: <span class="number">140</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileSummary</span>(profile: <span class="type">Profile</span>.default)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/6e1242822670a46d172d861abdf601e520c6f3a36c3c338fa2c3da6a0cc835a5/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f376363396662663531312f38626135623366372d393436642d343637652d386665322d6637303062646161346463352e706e67" alt=""></p>
<h2 id="步骤7-6">步骤7</h2>
<p><a href="#%E6%AD%A5%E9%AA%A47"></a></p>
<p>通过引入<a target="_blank" rel="noopener" href="https://github.com/ly918/SwiftUI-Chinese-Documents/wiki/02-Animating-Views-and-Transitions">视图动画与转场</a>的<code>HikeView</code>来完成<code>ProfileSummary</code>。</p>
<blockquote>
<p>ProfileSummary.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> goalFormat: <span class="type">DateFormatter</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateStyle <span class="operator">=</span> .long</span><br><span class="line">        formatter.timeStyle <span class="operator">=</span> .none</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(profile.username)</span><br><span class="line">                .bold()</span><br><span class="line">                .font(.title)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Notifications: <span class="subst">\(<span class="keyword">self</span>.profile.prefersNotifications <span class="operator">?</span> <span class="string">&quot;On&quot;</span>: <span class="string">&quot;Off&quot;</span> )</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Seasonal Photos: <span class="subst">\(<span class="keyword">self</span>.profile.seasonalPhoto.rawValue)</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Goal Date: <span class="subst">\(<span class="keyword">self</span>.profile.goalDate, formatter: <span class="keyword">Self</span>.goalFormat)</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Completed Badges&quot;</span>)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                <span class="type">ScrollView</span> &#123;</span><br><span class="line">                    <span class="type">HStack</span> &#123;</span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;First Hike&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;Earth Day&quot;</span>)</span><br><span class="line">                            .hueRotation(<span class="type">Angle</span>(degrees: <span class="number">90</span>))</span><br><span class="line">                        </span><br><span class="line">                        </span><br><span class="line">                        <span class="type">HikeBadge</span>(name: <span class="string">&quot;Tenth Hike&quot;</span>)</span><br><span class="line">                            .grayscale(<span class="number">0.5</span>)</span><br><span class="line">                            .hueRotation(<span class="type">Angle</span>(degrees: <span class="number">45</span>))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .frame(height: <span class="number">140</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Recent Hikes&quot;</span>)</span><br><span class="line">                    .font(.headline)</span><br><span class="line">            </span><br><span class="line">                <span class="type">HikeView</span>(hike: hikeData[<span class="number">0</span>])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileSummary_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileSummary</span>(profile: <span class="type">Profile</span>.default)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/be5f3e3a6ac062ed689f93e9ac2f2b624e1ba24a06b4de7da1fc47bd61a5a8fa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f326332343930656132622f64356239376331662d353064382d346339362d616364622d3038646338366662646633632e706e67" alt=""></p>
<h2 id="第二节-添加编辑模式">第二节 添加编辑模式</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E6%B7%BB%E5%8A%A0%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F"></a></p>
<p>用户需要在查看或编辑其简介详情之间切换。您将添加一个编辑模式，通过向现有的<code>ProfileHost</code>添加一个<code>EditButton</code>，然后创建一个带有控件的视图，用于编辑单个数据。</p>
<p><img src="https://camo.githubusercontent.com/d6ab975fb258a886c7c0895e93383a0eafb7910d3d550d8b19e92145998182d2/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633864333432643434622f38306437343066392d363633652d346436332d623036352d3964653139336566366362332e706e67" alt=""></p>
<h2 id="步骤1-33">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>添加一个<code>Environment</code>属性，并设置<code>\.editMode</code>。</p>
<p>可以使用此属性读取和写入当前编辑范围。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">ProfileSummary</span>(profile: draftProfile)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/6dea1a87c22691c7a43a0a50e0be144f2bcdc8e27b3732191cb4b9fe4dbdc897/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f623065663766383639302f33613533396366322d323561392d346530662d383562352d3964386539306664313165372e706e67" alt=""></p>
<h2 id="步骤2-34">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>创建一个编辑按钮，用于打开和关闭环境的编辑模式。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ProfileSummary</span>(profile: draftProfile)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/931200989845ec40b8559d1573d5fdc574eae47f5495278a32cbafc2c9e07c15/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343266646661333261382f39346262613361382d663230362d343564642d396165652d6361643134303361343236312e706e67" alt=""></p>
<h2 id="步骤3-30">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>更新<code>UserData</code>类以包含用户简介的实例，该实例在用户关闭简介视图后仍然存在。</p>
<blockquote>
<p>UserData.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserData</span>: <span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> landmarks <span class="operator">=</span> landmarkData</span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> profile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤4-29">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>从<code>Environment</code>中读取<code>Profile</code>数据，将数据的控制权传递给<code>ProfileHost</code> 。</p>
<p>为了避免在确认编辑之前更新全局应用程序状态（例如当用户输入其名称时），编辑视图将对其自身的副本进行操作。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ProfileSummary</span>(profile: draftProfile)</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/931200989845ec40b8559d1573d5fdc574eae47f5495278a32cbafc2c9e07c15/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343266646661333261382f39346262613361382d663230362d343564642d396165652d6361643134303361343236312e706e67" alt=""></p>
<h2 id="步骤5-18">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-1"></a></p>
<p>添加条件视图，显示静态简介视图或编辑模式视图。</p>
<p><em>注意</em></p>
<p>目前，编辑模式只是一个静态文本字段。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .inactive &#123;</span><br><span class="line">                <span class="type">ProfileSummary</span>(profile: userData.profile)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Profile Editor&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/931200989845ec40b8559d1573d5fdc574eae47f5495278a32cbafc2c9e07c15/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343266646661333261382f39346262613361382d663230362d343564642d396165652d6361643134303361343236312e706e67" alt=""></p>
<h2 id="第三节-定义用户简介编辑器">第三节 定义用户简介编辑器</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%AE%9A%E4%B9%89%E7%94%A8%E6%88%B7%E7%AE%80%E4%BB%8B%E7%BC%96%E8%BE%91%E5%99%A8"></a></p>
<p>用户简介编辑器主要由不同的控件组成，这些控件更改用户简介中的各个详情信息。配置文件中的某些项目（如徽章）不可由用户编辑，因此它们不会显示在编辑器中。</p>
<p>为了与信息摘要保持一致，您将在编辑器中按相同的顺序添加概要文件详情信息。</p>
<p><img src="https://camo.githubusercontent.com/0cac9efdd06c38a735f0c38cd6d8b3624e86f908deb65ee01044a87728e4200b/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f396335613437613962322f37333730366661322d616566392d343633622d393966382d3133373835333731336161352e706e67" alt=""></p>
<h2 id="步骤1-34">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>创建一个名为<code>ProfileEditor</code>的新视图，并包含对用户简介副本的绑定。</p>
<p>视图中的第一个控件是一个<code>TextField</code>，它控制并更新一个字符串的绑定，是用户选择的显示名称。当创建<code>TextField</code>时，您需要提供标签和字符串的绑定。</p>
<blockquote>
<p>ProfileEditor.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Username&quot;</span>).bold()</span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                <span class="type">TextField</span>(<span class="string">&quot;Username&quot;</span>, text: <span class="variable">$profile</span>.username)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileEditor</span>(profile: .constant(.default))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/e0b433f59437ef51e48017738bf4c32f4e2d5a0a8fe7fb42a3988e4aa31db299/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f353164333566386637372f35353630646134622d353263622d346566332d396135612d6562663165656536323362312e706e67" alt=""></p>
<h2 id="步骤2-35">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>更新<code>ProfileHost</code>中的条件内容，使其包含<code>Profile Editor</code>，并传递简介信息的绑定。</p>
<p>现在，单击“Edit”时将显示“简介编辑视图”。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .inactive &#123;</span><br><span class="line">                <span class="type">ProfileSummary</span>(profile: userData.profile)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">ProfileEditor</span>(profile: <span class="variable">$draftProfile</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/931200989845ec40b8559d1573d5fdc574eae47f5495278a32cbafc2c9e07c15/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343266646661333261382f39346262613361382d663230362d343564642d396165652d6361643134303361343236312e706e67" alt=""></p>
<h2 id="步骤3-31">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>添加是否接收地标相关事件通知的开关。</p>
<p><code>Toggles</code>是只有打开或关闭的控件，因此它们非常适合布尔值<code>Boolean</code>，如“yes”或“no”的设置。</p>
<blockquote>
<p>ProfileEditor.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Username&quot;</span>).bold()</span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                <span class="type">TextField</span>(<span class="string">&quot;Username&quot;</span>, text: <span class="variable">$profile</span>.username)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$profile</span>.prefersNotifications) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Enable Notifications&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileEditor</span>(profile: .constant(.default))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/0fad353c21b0b7997add4d2553a0f3453b2b09808dea3dd9c79f1552020a79a0/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663831373539336236662f36383235303337312d633531332d346534632d386430642d6134663535323433346238372e706e67" alt=""></p>
<h2 id="步骤4-30">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-2"></a></p>
<p>将<code>Picker</code>控件及其标签放置在<code>VStack</code>中，使地标照片具有可选择的季节。</p>
<blockquote>
<p>ProfileEditor.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Username&quot;</span>).bold()</span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                <span class="type">TextField</span>(<span class="string">&quot;Username&quot;</span>, text: <span class="variable">$profile</span>.username)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$profile</span>.prefersNotifications) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Enable Notifications&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Seasonal Photo&quot;</span>).bold()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Picker</span>(<span class="string">&quot;Seasonal Photo&quot;</span>, selection: <span class="variable">$profile</span>.seasonalPhoto) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="type">Profile</span>.<span class="type">Season</span>.allCases, id: \.<span class="keyword">self</span>) &#123; season <span class="keyword">in</span></span><br><span class="line">                        <span class="type">Text</span>(season.rawValue).tag(season)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .pickerStyle(<span class="type">SegmentedPickerStyle</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(.top)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileEditor</span>(profile: .constant(.default))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/5f7fb44f5decb629bc6fe906c174209684246778e3d78e8017fcea558bbdcea0/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346466326462643037662f38616232653066362d343932662d346634372d616463382d3330386561333761656439342e706e67" alt=""></p>
<h2 id="步骤5-19">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45-2"></a></p>
<p>最后，在季节选择器下面添加一个<code>DatePicker</code>，修改到达地标的日期。</p>
<blockquote>
<p>ProfileEditor.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> profile: <span class="type">Profile</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> dateRange: <span class="type">ClosedRange</span>&lt;<span class="type">Date</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> min <span class="operator">=</span> <span class="type">Calendar</span>.current.date(byAdding: .year, value: <span class="operator">-</span><span class="number">1</span>, to: profile.goalDate)<span class="operator">!</span></span><br><span class="line">        <span class="keyword">let</span> max <span class="operator">=</span> <span class="type">Calendar</span>.current.date(byAdding: .year, value: <span class="number">1</span>, to: profile.goalDate)<span class="operator">!</span></span><br><span class="line">        <span class="keyword">return</span> min<span class="operator">...</span>max</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span> &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Username&quot;</span>).bold()</span><br><span class="line">                <span class="type">Divider</span>()</span><br><span class="line">                <span class="type">TextField</span>(<span class="string">&quot;Username&quot;</span>, text: <span class="variable">$profile</span>.username)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Toggle</span>(isOn: <span class="variable">$profile</span>.prefersNotifications) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Enable Notifications&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Seasonal Photo&quot;</span>).bold()</span><br><span class="line">                </span><br><span class="line">                <span class="type">Picker</span>(<span class="string">&quot;Seasonal Photo&quot;</span>, selection: <span class="variable">$profile</span>.seasonalPhoto) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(<span class="type">Profile</span>.<span class="type">Season</span>.allCases, id: \.<span class="keyword">self</span>) &#123; season <span class="keyword">in</span></span><br><span class="line">                        <span class="type">Text</span>(season.rawValue).tag(season)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .pickerStyle(<span class="type">SegmentedPickerStyle</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(.top)</span><br><span class="line">            </span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;Goal Date&quot;</span>).bold()</span><br><span class="line">                <span class="type">DatePicker</span>(</span><br><span class="line">                    <span class="string">&quot;Goal Date&quot;</span>,</span><br><span class="line">                    selection: <span class="variable">$profile</span>.goalDate,</span><br><span class="line">                    in: dateRange,</span><br><span class="line">                    displayedComponents: .date)</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(.top)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileEditor_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileEditor</span>(profile: .constant(.default))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/53f34a34ae2f171abbf31a50e92687bffe0bcb94780ddbb3149d1409f9cfc9ce/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323236356630663038642f38656639306461352d313135392d346339332d393836392d6535643038623336613864392e706e67" alt=""></p>
<h2 id="第四节-延迟编辑传递">第四节 延迟编辑传递</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%BB%B6%E8%BF%9F%E7%BC%96%E8%BE%91%E4%BC%A0%E9%80%92"></a></p>
<p>要使其编辑，直到用户退出编辑模式后才生效，在编辑过程中使用其<code>Profile</code>的草稿副本，然后仅当用户确认编辑时才将草稿副本分配给真实副本。</p>
<p><img src="https://camo.githubusercontent.com/ba8bb301954e5d24b756a85cd53bb19c0d2b7d34bd309f80cecb607c120931df/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f336233616333366261322f30393433616661362d646434662d343938662d386461342d3837393031636362356531352e706e67" alt=""></p>
<h2 id="步骤1-35">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>向<code>ProfileHost</code>添加取消按钮。</p>
<p>与<code>EditButton</code>提供的<code>Done</code>按钮不同，<code>Cancel</code>按钮不会将编辑应用于其闭包中的真实<code>Profile</code>数据。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .active &#123;</span><br><span class="line">                    <span class="type">Button</span>(<span class="string">&quot;Cancel&quot;</span>) &#123;</span><br><span class="line">                        <span class="keyword">self</span>.draftProfile <span class="operator">=</span> <span class="keyword">self</span>.userData.profile</span><br><span class="line">                        <span class="keyword">self</span>.mode<span class="operator">?</span>.animation().wrappedValue <span class="operator">=</span> .inactive</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .inactive &#123;</span><br><span class="line">                <span class="type">ProfileSummary</span>(profile: userData.profile)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">ProfileEditor</span>(profile: <span class="variable">$draftProfile</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/9cf7616ad8ad548a13328cdc59bc8e4150d63d4dc75b3ada23ea9d3707b25455/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f313663393663323531342f33323165303362622d373233372d346231302d616637362d3930633936313566653637322e706e67" alt=""></p>
<h2 id="步骤2-36">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>应用<code>onAppear（perform:）</code>和<code>onDisappear（perform:）</code>修饰符，将正确的用户简介数据填充给编辑器，并在用户点击<code>Done</code>按钮时更新简介数据。</p>
<p>否则，在下次激活编辑模式时显示旧值。</p>
<blockquote>
<p>ProfileHost.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> mode</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> draftProfile <span class="operator">=</span> <span class="type">Profile</span>.default</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">20</span>) &#123;</span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .active &#123;</span><br><span class="line">                    <span class="type">Button</span>(<span class="string">&quot;Cancel&quot;</span>) &#123;</span><br><span class="line">                        <span class="keyword">self</span>.draftProfile <span class="operator">=</span> <span class="keyword">self</span>.userData.profile</span><br><span class="line">                        <span class="keyword">self</span>.mode<span class="operator">?</span>.animation().wrappedValue <span class="operator">=</span> .inactive</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="type">EditButton</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.mode<span class="operator">?</span>.wrappedValue <span class="operator">==</span> .inactive &#123;</span><br><span class="line">                <span class="type">ProfileSummary</span>(profile: userData.profile)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">ProfileEditor</span>(profile: <span class="variable">$draftProfile</span>)</span><br><span class="line">                    .onAppear &#123;</span><br><span class="line">                        <span class="keyword">self</span>.draftProfile <span class="operator">=</span> <span class="keyword">self</span>.userData.profile</span><br><span class="line">                    &#125;</span><br><span class="line">                    .onDisappear &#123;</span><br><span class="line">                        <span class="keyword">self</span>.userData.profile <span class="operator">=</span> <span class="keyword">self</span>.draftProfile</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ProfileHost_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ProfileHost</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="处理用户输入">处理用户输入</h2>
<p><a href="#%E5%A4%84%E7%90%86%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5"></a></p>
<p>在<code>Landmarks</code>应用程序中，用户可以标记他们最喜欢的位置，并筛选列表来仅仅显示他们最喜欢的位置。要创建此功能，首先要向列表中添加一个开关，以便用户只关注他们的收藏夹，然后添加一个星形按钮，用户点击该按钮可将地标标记到收藏夹。</p>
<blockquote>
<p>学习时间：20分钟</p>
<p><a target="_blank" rel="noopener" href="https://docs-assets.developer.apple.com/published/771290d0bd/HandlingUserInput.zip">下载示例：HandlingUserInput.zip</a></p>
</blockquote>
<h2 id="第一节-标记用户最喜欢的地标">第一节 标记用户最喜欢的地标</h2>
<p><a href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%A0%87%E8%AE%B0%E7%94%A8%E6%88%B7%E6%9C%80%E5%96%9C%E6%AC%A2%E7%9A%84%E5%9C%B0%E6%A0%87"></a></p>
<p>从优化列表开始，让用户一目了然地看到他们的最爱。为每个显示最喜欢的地标行添加一个星。</p>
<p><img src="https://camo.githubusercontent.com/4aa651ebee6d81f607e9bee34a34506164ffc48c8f17ea132c641f4e5c8ecf78/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f616261313761363135392f31626639656633392d616563312d343439612d626266362d3461353161643134626261652e706e67" alt=""></p>
<h2 id="步骤1-36">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41"></a></p>
<p>打开Xcode项目，然后在项目导航器中选择<code>LandmarkRow.swift</code>。</p>
<p><img src="https://camo.githubusercontent.com/b5ee6c4f665c8054ed2808428326c4d6662057bee79047e2cc67af6e6c155a0e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f346464646463666363652f38613830303966382d333938382d343239342d613364362d6434303666656361343162392e706e67" alt=""></p>
<h2 id="步骤2-37">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42"></a></p>
<p>在<code>Spacer()</code>之后，在<code>if</code>语句中添加一个星星<code>Image</code>，用来测试当前地标是否被收藏。</p>
<p>在<code>SwiftUI</code>语句块中，使用<code>if</code>语句有条件地包含视图。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> landmark.isFavorite &#123;</span><br><span class="line">                <span class="type">Image</span>(systemName: <span class="string">&quot;star.fill&quot;</span>)</span><br><span class="line">                    .imageScale(.medium)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">        &#125;</span><br><span class="line">        .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/fbfdfba69de187370146be22b42b87895b2f65aaada5b3166b57e77ad5588d96/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f356533626437306461662f62353138333261382d313439632d343264642d613731632d6532373866623432386561352e706e67" alt=""></p>
<h2 id="步骤3-32">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43"></a></p>
<p>由于系统图像是基于矢量的，因此可以使用<code>foregroundColor(_:)</code>修改器更改其颜色。</p>
<p>当地标的<code>isFavorite</code>属性为<code>true</code>时，星星就出现了。您将在本教程后面看到如何修改该属性。</p>
<blockquote>
<p>LandmarkRow.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            landmark.image</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">50</span>, height: <span class="number">50</span>)</span><br><span class="line">            <span class="type">Text</span>(landmark.name)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> landmark.isFavorite &#123;</span><br><span class="line">                <span class="type">Image</span>(systemName: <span class="string">&quot;star.fill&quot;</span>)</span><br><span class="line">                    .imageScale(.medium)</span><br><span class="line">                    .foregroundColor(.yellow)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkRow_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            <span class="type">LandmarkRow</span>(landmark: landmarkData[<span class="number">1</span>])</span><br><span class="line">        &#125;</span><br><span class="line">        .previewLayout(.fixed(width: <span class="number">300</span>, height: <span class="number">70</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/cc381bdda5a2ed09d939fc572dce85556290d5a4de0734734e0ec42e180bf500/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f323936663738343265362f35623964346433322d653165372d343336302d386439302d3735303736373561633137312e706e67" alt=""></p>
<h2 id="第二节-筛选列表视图">第二节 筛选列表视图</h2>
<p><a href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E7%AD%9B%E9%80%89%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE"></a></p>
<p>您可以自定义列表视图，使其显示所有地标，或仅显示用户的收藏夹。为此，需要向<code>LandmarkList</code>类型添加<code>@State</code>。</p>
<p><code>@State</code>是一个值或一组值，可以随时间变化，并影响视图的行为、内容或布局。使用带有<code>@State</code>的属性将其添加到视图中。</p>
<p><img src="https://camo.githubusercontent.com/993c19c2ccd5c1576da45a2874e7e720ccfafac224f1bc41460a6ef299062cac/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f613536633730363461392f36303065356234632d643763372d343464632d386330612d3634326639316231353131372e706e67" alt=""></p>
<h2 id="步骤1-37">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-1"></a></p>
<p>在项目导航器中选择<code>LandmarkList.swift</code>。将名为<code>showFavoritesOnly</code>的<code>@State</code>属性添加到<code>LandmarkList</code>，其初始值设置为<code>false</code>。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                    <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d9e7a2f4df6532c16478858c7ac5fb747e2b7cce72b4870b005aa83cf10b84fa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386633363332623561362f37323338653637622d343130352d343063342d396237372d3066666633373535363934622e706e67" alt=""></p>
<h2 id="步骤2-38">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-1"></a></p>
<p>单击“Resume”按钮刷新画布。</p>
<p>当您对视图的结构进行更改（如添加或修改属性）时，需要手动刷新画布。</p>
<p><img src="https://camo.githubusercontent.com/5aca50837582794c53801557c660bfbff1dfcf7f63a32ef319ba404a38abae1c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f663239623761393030382f65343364363039312d643238612d343433372d396231622d3062643566376664656533382e706e67" alt=""></p>
<h2 id="步骤3-33">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-1"></a></p>
<p>通过检查<code>showFavoritesOnly</code>属性和每个<code>landmark.isFavorite</code>值筛选地标列表。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                    <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                        <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/d9e7a2f4df6532c16478858c7ac5fb747e2b7cce72b4870b005aa83cf10b84fa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f386633363332623561362f37323338653637622d343130352d343063342d396237372d3066666633373535363934622e706e67" alt=""></p>
<h2 id="第三节-添加控件以切换状态">第三节 添加控件以切换状态</h2>
<p><a href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E6%B7%BB%E5%8A%A0%E6%8E%A7%E4%BB%B6%E4%BB%A5%E5%88%87%E6%8D%A2%E7%8A%B6%E6%80%81"></a></p>
<p>要让用户控制列表的筛选器，需要添加一个控件，该控件可以单独更改<code>showFavoritesOnly</code>的值。通过绑定<code>toggle</code>控件来完成此操作。</p>
<p>绑定是对可变状态的引用。当用户从关闭切换到打开，然后再次关闭时，控件使用绑定相应地更新视图的状态。</p>
<p><img src="https://camo.githubusercontent.com/a67258caf2144ecc7ee1f4c04114a2eca407d5565529eda103eff177a46308c7/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f613630666538303030302f34646662386564632d663334362d346532612d623939382d3637373731356330663133662e706e67" alt=""></p>
<h2 id="步骤1-38">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-2"></a></p>
<p>将行嵌套到<code>ForEach</code>中。</p>
<p>若要在列表中组合静态视图和动态视图，或组合两个或多个不同的动态视图组，请使用<code>ForEach</code>类型，而不是将数据集合传递给列表。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">ForEach</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                        <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/7620af575a013a7b2bd317f7e6763ac3e07576f079451bd0fa53706d2965258e/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393530313063356662382f35656135353237642d363630612d343461612d386437312d3265373364333064346564322e706e67" alt=""></p>
<h2 id="步骤2-39">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-2"></a></p>
<p>添加一个<code>Toggle</code>视图作为列表视图的第一个子视图，给<code>showFavoritesOnly</code>做一个绑定。</p>
<p>您可以使用<code>$</code>来访问状态变量或其绑定的属性。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: <span class="variable">$showFavoritesOnly</span>) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorites only&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">ForEach</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                        <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/503097b42856f626d1afe9730df92456533c60be7d7776259a1bb245c308af61/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f626136656331626361632f66623362363937662d616464342d346337332d383064662d3133376161323333386132622e706e67" alt=""></p>
<h2 id="步骤3-34">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-2"></a></p>
<p>使用实时预览并通过点击切换来尝试此新功能。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_proj_1_3_live_preview.gif" alt=""></p>
<h2 id="第四节-使用Observable-Object进行存储">第四节 使用Observable Object进行存储</h2>
<p><a href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E4%BD%BF%E7%94%A8observable-object%E8%BF%9B%E8%A1%8C%E5%AD%98%E5%82%A8"></a></p>
<p>为了让用户控制哪些特定的地标是最喜欢的，您首先要将地标数据存储在一个<code>Observable Object</code>中。</p>
<p><code>Observable Object</code>的自定义对象，可以从<code>SwiftUI</code>环境中的存储绑定到视图。<code>SwiftUI</code>监视可观察对象的任何可能影响视图的更改，并在更改后显示正确的视图。</p>
<p><img src="https://camo.githubusercontent.com/dce7da47901d2fab4ff422853ee6508ce178e39b5bd3a16888b1416566b994cf/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f343563373038333235352f38313337623930652d353763352d346364352d623937312d6162306435313966663939622e706e67" alt=""></p>
<h2 id="步骤1-39">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-3"></a></p>
<p>创建一个名为<code>UserData.Swift</code>的新<code>Swift</code>文件。</p>
<blockquote>
<p>UserData.swift</p>
</blockquote>
<h2 id="步骤2-40">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-3"></a></p>
<p>从组合框架中声明遵守<code>ObservableObject</code>协议的新模型类型。</p>
<p><code>SwiftUI</code>订阅您的<code>ObservableObject</code>，并在数据更改时更新任何需要刷新的视图。</p>
<blockquote>
<p>UserData.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserData</span>: <span class="title class_ inherited__">ObservableObject</span>  &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-35">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-3"></a></p>
<p>添加<code>showFavoritesOnly</code>和地标的存储属性及其初始值。</p>
<blockquote>
<p>UserData.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserData</span>: <span class="title class_ inherited__">ObservableObject</span>  &#123;</span><br><span class="line">    <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> landmarks <span class="operator">=</span> landmarkData</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>ObservableObject</code>需要发布对其数据的任何更改，以便其订阅者可以获取更改。</p>
</blockquote>
<h2 id="步骤4-31">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44"></a></p>
<p>将<code>@Published</code>属性添加到模型中的每个属性</p>
<blockquote>
<p>UserData.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">UserData</span>: <span class="title class_ inherited__">ObservableObject</span>  &#123;</span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> showFavoritesOnly <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> landmarks <span class="operator">=</span> landmarkData</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第五节-在视图中采用你的模型对象">第五节 在视图中采用你的模型对象</h2>
<p><a href="#%E7%AC%AC%E4%BA%94%E8%8A%82-%E5%9C%A8%E8%A7%86%E5%9B%BE%E4%B8%AD%E9%87%87%E7%94%A8%E4%BD%A0%E7%9A%84%E6%A8%A1%E5%9E%8B%E5%AF%B9%E8%B1%A1"></a></p>
<p>现在您已经创建了<code>UserData</code>对象，您需要更新视图以将其作为应用程序的数据存储。</p>
<p><img src="https://camo.githubusercontent.com/a5272502caa72f1589db85e4029efde08c1ecfa7373d6cb0103b975e7bb40daa/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f326336313065353134302f35356439366639322d323762352d346137382d393533632d6465333263343264376563342e706e67" alt=""></p>
<h2 id="步骤1-40">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-4"></a></p>
<p>在<code>LandmarkList.swift</code>中，用<code>@EnvironmentObject</code>属性替换<code>showFavoritesOnly</code>声明，并向预览添加<code>environmentObject（:）</code>修饰符。</p>
<p>只要<code>environmentObject（:）</code>修饰符已应用于父对象，此<code>userData</code>属性就会自动获取其值。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: <span class="variable">$showFavoritesOnly</span>) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorites only&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">ForEach</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                        <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-41">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-4"></a></p>
<p>通过访问<code>userData</code>上的相同属性来替换<code>showFavoritesOnly</code>的使用。</p>
<p>与<code>@State</code>属性一样，您可以使用<code>$</code>访问到<code>userData</code>对象成员的绑定。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorites only&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">ForEach</span>(landmarkData) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                        <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/b0e1c3a23091ea24ef4d8d54ada6adab9df6a85711ac1bb2a693acd7c7d76eed/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633562616130616431332f64353737316334622d333738372d343964332d623065312d3732373731396438353463332e706e67" alt=""></p>
<h2 id="步骤3-36">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-4"></a></p>
<p>创建<code>ForEach</code>实例时使用<code>userData.landmarks</code>作为数据。</p>
<blockquote>
<p>LandmarkList.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span> &#123;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: <span class="variable">$userData</span>.showFavoritesOnly) &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;Favorites only&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">ForEach</span>(userData.landmarks) &#123; landmark <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="operator">!</span><span class="keyword">self</span>.userData.showFavoritesOnly <span class="operator">||</span> landmark.isFavorite &#123;</span><br><span class="line">                        <span class="type">NavigationLink</span>(destination: <span class="type">LandmarkDetail</span>(landmark: landmark)) &#123;</span><br><span class="line">                            <span class="type">LandmarkRow</span>(landmark: landmark)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">&quot;Landmarks&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkList_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkList</span>()</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://camo.githubusercontent.com/b0e1c3a23091ea24ef4d8d54ada6adab9df6a85711ac1bb2a693acd7c7d76eed/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f633562616130616431332f64353737316334622d333738372d343964332d623065312d3732373731396438353463332e706e67" alt=""></p>
<h2 id="步骤4-32">步骤4</h2>
<p><a href="#%E6%AD%A5%E9%AA%A44-1"></a></p>
<p>在<code>SceneDelegate.swift</code>中，将<code>environmentObject（:）</code>修饰符添加到<code>LandmarkList</code>。</p>
<p>如果您在模拟器或设备上构建并运行地标，而不是使用预览，则此更新将确保地标列表在环境中有一个<code>UserData</code>对象。</p>
<blockquote>
<p>SceneDelegate.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SceneDelegate</span>: <span class="title class_ inherited__">UIResponder</span>, <span class="title class_ inherited__">UIWindowSceneDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> window: <span class="type">UIWindow</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">scene</span>(<span class="keyword">_</span> <span class="params">scene</span>: <span class="type">UIScene</span>, <span class="params">willConnectTo</span> <span class="params">session</span>: <span class="type">UISceneSession</span>, <span class="params">options</span> <span class="params">connectionOptions</span>: <span class="type">UIScene</span>.<span class="type">ConnectionOptions</span>) &#123;</span><br><span class="line">        <span class="comment">// Use this method to optionally configure and attach the UIWindow `window` to the provided UIWindowScene `scene`.</span></span><br><span class="line">        <span class="comment">// If using a storyboard, the `window` property will automatically be initialized and attached to the scene.</span></span><br><span class="line">        <span class="comment">// This delegate does not imply the connecting scene or session are new (see `application:configurationForConnectingSceneSession` instead).</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Use a UIHostingController as window root view controller</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> windowScene <span class="operator">=</span> scene <span class="keyword">as?</span> <span class="type">UIWindowScene</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> window <span class="operator">=</span> <span class="type">UIWindow</span>(windowScene: windowScene)</span><br><span class="line">            window.rootViewController <span class="operator">=</span> <span class="type">UIHostingController</span>(</span><br><span class="line">                rootView: <span class="type">LandmarkList</span>()</span><br><span class="line">                    .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">self</span>.window <span class="operator">=</span> window</span><br><span class="line">            window.makeKeyAndVisible()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤5-20">步骤5</h2>
<p><a href="#%E6%AD%A5%E9%AA%A45"></a></p>
<p>更新<code>LandmarkDetail</code>视图以在环境中使用<code>UserData</code>对象。</p>
<p>在访问或更新地标的收藏状态时，您将使用地标索引，以便始终访问该数据的正确版本。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>(landmark: landmark)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>(image: landmark.image)</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(landmark.name)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.park)</span><br><span class="line">                        .font(caption)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(landmark.state)</span><br><span class="line">                        .font(.caption)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(landmark.name), displayMode: .inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤6-14">步骤6</h2>
<p><a href="#%E6%AD%A5%E9%AA%A46"></a></p>
<p>切换回<code>LandmarkList.swift</code>并打开实时预览，以验证一切正常工作。</p>
<p><img src="https://camo.githubusercontent.com/211674563804b74ec03a0cc1d1b8f7240d5525d10802894e37aeac6f0612d6a6/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f363630353938333533362f63363063373334652d656232652d343639622d626465332d6364373062633739383562372e706e67" alt=""></p>
<h2 id="第六节-为每个地标创建收藏夹按钮">第六节 为每个地标创建收藏夹按钮</h2>
<p><a href="#%E7%AC%AC%E5%85%AD%E8%8A%82-%E4%B8%BA%E6%AF%8F%E4%B8%AA%E5%9C%B0%E6%A0%87%E5%88%9B%E5%BB%BA%E6%94%B6%E8%97%8F%E5%A4%B9%E6%8C%89%E9%92%AE"></a></p>
<p>地标应用程序现在可以在过滤和未经过滤的地标视图之间切换，但最喜欢的地标列表仍然是硬编码的。要允许用户添加和删除收藏，需要将收藏按钮添加到地标详情视图。</p>
<p><img src="https://camo.githubusercontent.com/2cb4907f49bdd9a91007cc4866569b2beac4d7e8d097cb42f4098447675c891c/68747470733a2f2f646f63732d6173736574732e646576656c6f7065722e6170706c652e636f6d2f7075626c69736865642f393737303763643363332f31313436653264392d363332352d343931302d393263642d3137393162626365646136302e706e67" alt=""></p>
<h2 id="步骤1-41">步骤1</h2>
<p><a href="#%E6%AD%A5%E9%AA%A41-5"></a></p>
<p>在<code>LandmarkDetail.swift</code>中，将地标的名称嵌入<code>HStack</code>。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>(landmark: landmark)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>(image: landmark.image)</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">HStack</span> &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.name)</span><br><span class="line">                        .font(.title)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.park)</span><br><span class="line">                        .font(caption)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(landmark.state)</span><br><span class="line">                        .font(.caption)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(landmark.name), displayMode: .inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤2-42">步骤2</h2>
<p><a href="#%E6%AD%A5%E9%AA%A42-5"></a></p>
<p>在地标名称旁边创建一个新按钮。使用<code>if-else</code>条件语句提供不同的图像，以指示地标是否收藏。</p>
<p>在按钮的<code>action</code>闭包中，代码使用带有<code>userData</code>对象的<code>landmarkIndex</code>来更新地标。</p>
<blockquote>
<p>LandmarkDetail.swift</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> userData: <span class="type">UserData</span></span><br><span class="line">    <span class="keyword">var</span> landmark: <span class="type">Landmark</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> landmarkIndex: <span class="type">Int</span> &#123;</span><br><span class="line">        userData.landmarks.firstIndex(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> landmark.id &#125;)<span class="operator">!</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">MapView</span>(landmark: landmark)</span><br><span class="line">                .frame(height: <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>(image: landmark.image)</span><br><span class="line">                .offset(y: <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line">                .padding(.bottom, <span class="operator">-</span><span class="number">130</span>)</span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">HStack</span> &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.name)</span><br><span class="line">                        .font(.title)</span><br><span class="line"></span><br><span class="line">                    <span class="type">Button</span>(action: &#123;</span><br><span class="line">                        <span class="keyword">self</span>.userData.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite.toggle()</span><br><span class="line">                    &#125;) &#123;</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">self</span>.userData.landmarks[<span class="keyword">self</span>.landmarkIndex].isFavorite &#123;</span><br><span class="line">                            <span class="type">Image</span>(systemName: <span class="string">&quot;star.fill&quot;</span>)</span><br><span class="line">                                .foregroundColor(<span class="type">Color</span>.yellow)</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="type">Image</span>(systemName: <span class="string">&quot;star&quot;</span>)</span><br><span class="line">                                .foregroundColor(<span class="type">Color</span>.gray)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(landmark.park)</span><br><span class="line">                        .font(caption)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(landmark.state)</span><br><span class="line">                        .font(.caption)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(landmark.name), displayMode: .inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LandmarkDetail_Preview</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">LandmarkDetail</span>(landmark: landmarkData[<span class="number">0</span>])</span><br><span class="line">            .environmentObject(<span class="type">UserData</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="步骤3-37">步骤3</h2>
<p><a href="#%E6%AD%A5%E9%AA%A43-5"></a></p>
<p>切换回<code>LandmarkList.swift</code>，并打开实时预览。</p>
<p>当您从列表导航到详情信息并点击按钮时，这些更改将在您返回列表时保持不变。因为两个视图都在访问环境中的同一个模型对象，所以两个视图保持一致性。</p>
<p><img src="https://github.com/ly918/SwiftUI-Chinese-Documents/raw/master/Resource/_proj_1_3_complete.gif" alt=""></p>
<blockquote>
<p>User Interface</p>
</blockquote>
<h2 id="视图和控件">视图和控件</h2>
<p><a href="#%E8%A7%86%E5%9B%BE%E5%92%8C%E6%8E%A7%E4%BB%B6"></a></p>
<p>在屏幕上显示内容并处理用户交互。</p>
<h2 id="概述">概述</h2>
<p><a href="#%E6%A6%82%E8%BF%B0"></a></p>
<p>视图和控件是应用程序用户界面的可视化构建区块。使用它们在屏幕上显示应用程序的内容。视图可以描述文本、图像、形状、自定义绘图以及所有这些内容的组合。控件允许用户使用一致的API与其相应的平台和上下文进行交互。</p>
<p>使用指定其视觉关系和层次结构的容器合并视图。使用名为修饰符<code>modifiers</code>的方法自定义内置视图和为应用程序创建的视图的显示、行为和交互。</p>
<p>将修饰符<code>modifiers</code>应用于视图和控件：</p>
<ul>
<li>控制视图的大小、位置和外观属性。</li>
<li>响应轻触、手势和其他用户交互。</li>
<li>支持拖拽操作。</li>
<li>自定义动画和转场。</li>
<li>设置样式首选项和其他环境数据。</li>
</ul>
<p>有关如何使用视图和控件的其他信息，请参见人机界面指南。</p>
<h2 id="话题">话题</h2>
<p><a href="#%E8%AF%9D%E9%A2%98"></a></p>
<h3 id="摘要">摘要</h3>
<p><a href="#%E6%91%98%E8%A6%81"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ly918/SwiftUI-Chinese-Documents/wiki/D1-View"><code>protocol View</code></a></p>
<p>视图:用来描述SwiftUI的视图类型。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ly918/SwiftUI-Chinese-Documents/wiki/01-Creating-And-Combining-Views">Creating and Combining Views</a></p>
<p>创建并组合视图：本教程将指导您构建地标，这是一个iOS应用程序，用于发现和共享您喜欢的地方。您将首先构建显示地标的详情视图。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ly918/SwiftUI-Chinese-Documents/wiki/02-Working-with-UI-Controls">Working with UI Controls</a></p>
<p>使用UI控件：在地标应用程序中，用户可以创建个人简介来表达他们的个性。为了让用户能够更改他们的个人简介，您将添加一个编辑模式并设计首选项页面。</p>
<h3 id="文本-Text">文本 Text</h3>
<p><a href="#%E6%96%87%E6%9C%AC-text"></a></p>
<p><code>struct Text</code></p>
<p>文本：显示一行或多行只读文本的视图。</p>
<p><code>struct TextField</code></p>
<p>文本输入框：显示可编辑文本的控件。</p>
<p><code>struct SecureField</code></p>
<p>密文输入框：用户安全输入私密文本的控件。</p>
<p><code>struct Font</code></p>
<p>字体：依赖于环境的字体。</p>
<h3 id="图像-Images">图像 Images</h3>
<p><a href="#%E5%9B%BE%E5%83%8F-images"></a></p>
<p><code>struct Image</code></p>
<p>图像：显示依赖于环境的图像视图。</p>
<h3 id="按钮-Buttons">按钮 Buttons</h3>
<p><a href="#%E6%8C%89%E9%92%AE-buttons"></a></p>
<p><code>struct Button</code></p>
<p>按钮：触控时执行操作的控件。</p>
<p><code>struct NavigationLink</code></p>
<p>导航链接：按下时触发导航显示的按钮。</p>
<p><code>struct MenuButton</code></p>
<p>菜单按钮：当按下时显示包含选项列表的菜单的按钮。</p>
<p><code>struct EditButton</code></p>
<p>编辑按钮：切换当前编辑范围的编辑模式的按钮。</p>
<p><code>struct PasteButton</code></p>
<p>粘贴按钮：触发从粘贴板读取数据的系统按钮。</p>
<h3 id="值选择器-Value-Selectors">值选择器 Value Selectors</h3>
<p><a href="#%E5%80%BC%E9%80%89%E6%8B%A9%E5%99%A8-value-selectors"></a></p>
<p><code>struct Toggle</code></p>
<p>开关：在打开和关闭状态之间切换的控件。</p>
<p><code>struct Picker</code></p>
<p>选择器：从一组互斥值中进行选择的控件。</p>
<p><code>struct DatePicker</code></p>
<p>日期选择器：用于选择绝对日期的控件。</p>
<p><code>struct Slider</code></p>
<p>滑块：从有界线性值范围中选择值的控件。</p>
<p><code>struct Stepper</code></p>
<p>步进器：用于执行递增和递减操作的控件。</p>
<h3 id="支持类型-Supporting-Types">支持类型 Supporting Types</h3>
<p><a href="#%E6%94%AF%E6%8C%81%E7%B1%BB%E5%9E%8B-supporting-types"></a></p>
<p><code>struct ViewBuilder</code></p>
<p>视图构建器：从闭包构造视图的自定义参数属性。</p>
<p><code>protocol ViewModifier</code></p>
<p>视图修饰器：应用于视图或其他视图的修饰器，生成原始值的不同版本。</p>
<blockquote>
<p>protocol</p>
</blockquote>
<h2 id="View">View</h2>
<p><a href="#view"></a></p>
<p>一个表示SwiftUI视图的类型。</p>
<p>代码释义</p>
<h2 id="声明">声明</h2>
<p><a href="#%E5%A3%B0%E6%98%8E"></a></p>
<blockquote>
<p>protocol View</p>
</blockquote>
<h2 id="概述-2">概述</h2>
<p><a href="#%E6%A6%82%E8%BF%B0"></a></p>
<p>通过声明遵守<code>View protocol</code>的类型来创建自定义视图。实现所需的<code>body</code>计算属性，以提供自定义视图的内容和行为。</p>
<h2 id="主题">主题</h2>
<p><a href="#%E4%B8%BB%E9%A2%98"></a></p>
<h3 id="1-Implementing-a-Custom-View-实现自定义视图">1 - Implementing a Custom View - 实现自定义视图</h3>
<p><a href="#1---implementing-a-custom-view---%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%86%E5%9B%BE"></a></p>
<h4 id="1-1-视图的内容和行为。必需的，默认实现。">1.1 视图的内容和行为。必需的，默认实现。</h4>
<p><a href="#11-%E8%A7%86%E5%9B%BE%E7%9A%84%E5%86%85%E5%AE%B9%E5%92%8C%E8%A1%8C%E4%B8%BA%E5%BF%85%E9%9C%80%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0"></a></p>
<blockquote>
<p>demo</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="comment">/// 1 - Implementing a Custom View - 实现自定义视图</span></span><br><span class="line">    <span class="comment">/// 视图的内容和行为。</span></span><br><span class="line">    <span class="comment">/// 必需的。默认实现。</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">            .background(<span class="type">Color</span>.yellow)</span><br><span class="line">            .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-Sizing-a-Views-制定视图的大小">2 - Sizing a Views - 制定视图的大小</h3>
<p><a href="#2---sizing-a-views---%E5%88%B6%E5%AE%9A%E8%A7%86%E5%9B%BE%E7%9A%84%E5%A4%A7%E5%B0%8F"></a></p>
<h4 id="2-1-将视图定位在具有指定大小的不可见框架中">2.1 将视图定位在具有指定大小的不可见框架中</h4>
<p><a href="#21-%E5%B0%86%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%BD%8D%E5%9C%A8%E5%85%B7%E6%9C%89%E6%8C%87%E5%AE%9A%E5%A4%A7%E5%B0%8F%E7%9A%84%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%A1%86%E6%9E%B6%E4%B8%AD"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">frame</span>(<span class="params">width</span>: <span class="type">CGFloat</span>?, <span class="params">height</span>: <span class="type">CGFloat</span>?, <span class="params">alignment</span>: <span class="type">Alignment</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-将视图定位在具有指定宽度和高度的不可见框架中。">2.2 将视图定位在具有指定宽度和高度的不可见框架中。</h4>
<p><a href="#22-%E5%B0%86%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%BD%8D%E5%9C%A8%E5%85%B7%E6%9C%89%E6%8C%87%E5%AE%9A%E5%AE%BD%E5%BA%A6%E5%92%8C%E9%AB%98%E5%BA%A6%E7%9A%84%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%A1%86%E6%9E%B6%E4%B8%AD"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">frame</span>(<span class="params">minWidth</span>: <span class="type">CGFloat</span>?, <span class="params">idealWidth</span>: <span class="type">CGFloat</span>?, <span class="params">maxWidth</span>: <span class="type">CGFloat</span>?, <span class="params">minHeight</span>: <span class="type">CGFloat</span>?, <span class="params">idealHeight</span>: <span class="type">CGFloat</span>?, <span class="params">maxHeight</span>: <span class="type">CGFloat</span>?, <span class="params">alignment</span>: <span class="type">Alignment</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="2-3-将视图修复为理想大小。">2.3 将视图修复为理想大小。</h4>
<p><a href="#23-%E5%B0%86%E8%A7%86%E5%9B%BE%E4%BF%AE%E5%A4%8D%E4%B8%BA%E7%90%86%E6%83%B3%E5%A4%A7%E5%B0%8F"></a></p>
<h4 id="2-4-将视图修复为理想大小，可指定垂直或水平方向的修复。">2.4 将视图修复为理想大小，可指定垂直或水平方向的修复。</h4>
<p><a href="#24-%E5%B0%86%E8%A7%86%E5%9B%BE%E4%BF%AE%E5%A4%8D%E4%B8%BA%E7%90%86%E6%83%B3%E5%A4%A7%E5%B0%8F%E5%8F%AF%E6%8C%87%E5%AE%9A%E5%9E%82%E7%9B%B4%E6%88%96%E6%B0%B4%E5%B9%B3%E6%96%B9%E5%90%91%E7%9A%84%E4%BF%AE%E5%A4%8D"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fixedSize</span>(<span class="params">horizontal</span>: <span class="type">Bool</span>, <span class="params">vertical</span>: <span class="type">Bool</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="2-5-设置父布局应将空间分配给子布局的优先级，默认为0。">2.5 设置父布局应将空间分配给子布局的优先级，默认为0。</h4>
<p><a href="#25-%E8%AE%BE%E7%BD%AE%E7%88%B6%E5%B8%83%E5%B1%80%E5%BA%94%E5%B0%86%E7%A9%BA%E9%97%B4%E5%88%86%E9%85%8D%E7%BB%99%E5%AD%90%E5%B8%83%E5%B1%80%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7%E9%BB%98%E8%AE%A4%E4%B8%BA0"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">layoutPriority</span>(<span class="type">Double</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>demo</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SizingInViews</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="comment">/// 2 - Sizing a Views - 制定视图大小</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="comment">/// 2.1 将视图定位在具有指定大小的不可见框架中。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .frame(width: <span class="number">200</span>, height: <span class="number">50</span>, alignment: .topLeading)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 2.2 将视图定位在具有指定宽度和高度的不可见框架中。</span></span><br><span class="line">           <span class="type">Text</span>(<span class="string">&quot;Hello, World 2Hello, World 2Hello, World 2Hello, World 2Hello, World 2Hello, World 2Hello&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .frame(minWidth: <span class="number">10</span>, idealWidth: <span class="number">60</span>, maxWidth: <span class="number">300</span>, minHeight: <span class="number">10</span>, idealHeight: <span class="number">60</span>, maxHeight: <span class="number">300</span>, alignment: .topTrailing)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 2.3 将视图固定在其理想大小。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World3&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .fixedSize()</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 2.4 将视图修复为理想大小，可指定垂直或水平方向的修复。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World4Hello, World4HelloHello, World4Hello, World4HelloHello&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .fixedSize(horizontal: <span class="literal">true</span>, vertical: <span class="literal">false</span>)</span><br><span class="line">                .frame(width: <span class="number">200</span>, height: <span class="number">200</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 2.5 指定布局优先级 默认为0</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World5&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .layoutPriority(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-Positioning-a-View-定位视图">3 - Positioning a View - 定位视图</h3>
<p><a href="#3---positioning-a-view---%E5%AE%9A%E4%BD%8D%E8%A7%86%E5%9B%BE"></a></p>
<h4 id="3-1-将视图的中心固定在其父坐标空间的指定点上。">3.1 将视图的中心固定在其父坐标空间的指定点上。</h4>
<p><a href="#31-%E5%B0%86%E8%A7%86%E5%9B%BE%E7%9A%84%E4%B8%AD%E5%BF%83%E5%9B%BA%E5%AE%9A%E5%9C%A8%E5%85%B6%E7%88%B6%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E7%9A%84%E6%8C%87%E5%AE%9A%E7%82%B9%E4%B8%8A"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">position</span>(<span class="type">CGPoint</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="3-2-将视图的中心固定在其父坐标空间中指定的坐标上。">3.2 将视图的中心固定在其父坐标空间中指定的坐标上。</h4>
<p><a href="#32-%E5%B0%86%E8%A7%86%E5%9B%BE%E7%9A%84%E4%B8%AD%E5%BF%83%E5%9B%BA%E5%AE%9A%E5%9C%A8%E5%85%B6%E7%88%B6%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E4%B8%AD%E6%8C%87%E5%AE%9A%E7%9A%84%E5%9D%90%E6%A0%87%E4%B8%8A"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">position</span>(<span class="params">x</span>: <span class="type">CGFloat</span>, <span class="params">y</span>: <span class="type">CGFloat</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="3-3-通过给定Size中的width和height偏移视图。">3.3 通过给定<code>Size</code>中的<code>width</code>和<code>height</code>偏移视图。</h4>
<p><a href="#33-%E9%80%9A%E8%BF%87%E7%BB%99%E5%AE%9Asize%E4%B8%AD%E7%9A%84width%E5%92%8Cheight%E5%81%8F%E7%A7%BB%E8%A7%86%E5%9B%BE"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">offset</span>(<span class="type">CGSize</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="3-4-通过指定的x和y值偏移视图。">3.4 通过指定的<code>x</code>和<code>y</code>值偏移视图。</h4>
<p><a href="#34-%E9%80%9A%E8%BF%87%E6%8C%87%E5%AE%9A%E7%9A%84x%E5%92%8Cy%E5%80%BC%E5%81%8F%E7%A7%BB%E8%A7%86%E5%9B%BE"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">offset</span>(<span class="params">x</span>: <span class="type">CGFloat</span>, <span class="params">y</span>: <span class="type">CGFloat</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="3-5-将视图延展到指定边缘的安全区域之外。">3.5 将视图延展到指定边缘的安全区域之外。</h4>
<p><a href="#35-%E5%B0%86%E8%A7%86%E5%9B%BE%E5%BB%B6%E5%B1%95%E5%88%B0%E6%8C%87%E5%AE%9A%E8%BE%B9%E7%BC%98%E7%9A%84%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F%E4%B9%8B%E5%A4%96"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">edgesIgnoringSafeArea</span>(<span class="type">Edge</span>.<span class="type">Set</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="3-6-将名称分配给此视图的坐标空间，此视图的后代可以将其引用。">3.6 将名称分配给此视图的坐标空间，此视图的后代可以将其引用。</h4>
<p><a href="#36-%E5%B0%86%E5%90%8D%E7%A7%B0%E5%88%86%E9%85%8D%E7%BB%99%E6%AD%A4%E8%A7%86%E5%9B%BE%E7%9A%84%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E6%AD%A4%E8%A7%86%E5%9B%BE%E7%9A%84%E5%90%8E%E4%BB%A3%E5%8F%AF%E4%BB%A5%E5%B0%86%E5%85%B6%E5%BC%95%E7%94%A8"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">coordinateSpace</span>&lt;<span class="type">T</span>&gt;(<span class="params">name</span>: <span class="type">T</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>demo</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PositioningAViews</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="comment">/// 3  - Positioning a View - 定位视图</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">/// 3.1 将视图的中心固定在其父坐标空间的指定点上。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.red)</span><br><span class="line">                .position(<span class="type">CGPoint</span>(x: <span class="number">100</span>, y: <span class="number">0</span>))</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 3.2 将视图的中心固定在其父坐标空间中指定的坐标上。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World2&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.green)</span><br><span class="line">                .position(x: <span class="number">100</span>, y: <span class="number">30</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 3.3 通过给定`Size`中的`width`和`height`偏移视图。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World3&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.red)</span><br><span class="line">                .position(x: <span class="number">100</span>, y: <span class="number">60</span>)</span><br><span class="line">                .offset(<span class="type">CGSize</span>(width: <span class="number">30</span>, height: <span class="number">0</span>))</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/// 3.4 通过指定的`x`和`y`值偏移视图。</span></span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Hello, World4&quot;</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.green)</span><br><span class="line">                .position(x: <span class="number">100</span>, y: <span class="number">90</span>)</span><br><span class="line">                .offset(x: <span class="operator">-</span><span class="number">30</span>, y: <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">        .edgesIgnoringSafeArea(.top)<span class="comment">/// 3.5 将视图延展到指定边缘的安全区域之外。</span></span><br><span class="line">        .coordinateSpace(name: <span class="string">&quot;test&quot;</span>)<span class="comment">/// 3.6 将名称分配给此视图的坐标空间，此视图的后代可以将其引用。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-Aligning-Views-设置视图的对其方式">4 - Aligning Views - 设置视图的对其方式</h3>
<p><a href="#4---aligning-views---%E8%AE%BE%E7%BD%AE%E8%A7%86%E5%9B%BE%E7%9A%84%E5%AF%B9%E5%85%B6%E6%96%B9%E5%BC%8F"></a></p>
<h4 id="4-1-设置视图的水平对齐方式。">4.1 设置视图的水平对齐方式。</h4>
<p><a href="#41-%E8%AE%BE%E7%BD%AE%E8%A7%86%E5%9B%BE%E7%9A%84%E6%B0%B4%E5%B9%B3%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">alignmentGuide</span>(<span class="type">HorizontalAlignment</span>, <span class="params">computeValue</span>: (<span class="type">ViewDimensions</span>) -&gt; <span class="type">CGFloat</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="4-2-设置视图的垂直">4.2 设置视图的垂直</h4>
<p><a href="#42-%E8%AE%BE%E7%BD%AE%E8%A7%86%E5%9B%BE%E7%9A%84%E5%9E%82%E7%9B%B4"></a></p>
<p>对齐方式。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">alignmentGuide</span>(<span class="type">VerticalAlignment</span>, <span class="params">computeValue</span>: (<span class="type">ViewDimensions</span>) -&gt; <span class="type">CGFloat</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="4-3-视图在其自身的坐标空间中的大小和对齐方式的规则。">4.3 视图在其自身的坐标空间中的大小和对齐方式的规则。</h4>
<p><a href="#43-%E8%A7%86%E5%9B%BE%E5%9C%A8%E5%85%B6%E8%87%AA%E8%BA%AB%E7%9A%84%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E4%B8%AD%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%92%8C%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F%E7%9A%84%E8%A7%84%E5%88%99"></a></p>
<h4 id="4-4-用于标识对齐规则的类型。">4.4 用于标识对齐规则的类型。</h4>
<p><a href="#44-%E7%94%A8%E4%BA%8E%E6%A0%87%E8%AF%86%E5%AF%B9%E9%BD%90%E8%A7%84%E5%88%99%E7%9A%84%E7%B1%BB%E5%9E%8B"></a></p>
<h3 id="5-Adjusting-the-Padding-of-a-View-调整视图边距">5 - Adjusting the Padding of a View - 调整视图边距</h3>
<p><a href="#5---adjusting-the-padding-of-a-view---%E8%B0%83%E6%95%B4%E8%A7%86%E5%9B%BE%E8%BE%B9%E8%B7%9D"></a></p>
<h4 id="5-1-将视图沿所有边缘内嵌填充指定的大小。">5.1 将视图沿所有边缘内嵌填充指定的大小。</h4>
<p><a href="#51-%E5%B0%86%E8%A7%86%E5%9B%BE%E6%B2%BF%E6%89%80%E6%9C%89%E8%BE%B9%E7%BC%98%E5%86%85%E5%B5%8C%E5%A1%AB%E5%85%85%E6%8C%87%E5%AE%9A%E7%9A%84%E5%A4%A7%E5%B0%8F"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">padding</span>(<span class="type">CGFloat</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="5-2-使用指定的EdgeInsets内嵌填充视图。">5.2 使用指定的<code>EdgeInsets</code>内嵌填充视图。</h4>
<p><a href="#52-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84edgeinsets%E5%86%85%E5%B5%8C%E5%A1%AB%E5%85%85%E8%A7%86%E5%9B%BE"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">padding</span>(<span class="type">EdgeInsets</span>) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="5-3-使用指定的Edge集合内嵌填充指定大小。">5.3 使用指定的<code>Edge</code>集合内嵌填充指定大小。</h4>
<p><a href="#53-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84edge%E9%9B%86%E5%90%88%E5%86%85%E5%B5%8C%E5%A1%AB%E5%85%85%E6%8C%87%E5%AE%9A%E5%A4%A7%E5%B0%8F"></a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">padding</span>(<span class="type">Edge</span>.<span class="type">Set</span>, <span class="type">CGFloat</span>?) -&gt; <span class="type">View</span></span><br></pre></td></tr></table></figure>
<h4 id="5-4-定义了矩形各边的内嵌距离的结构体。">5.4 定义了矩形各边的内嵌距离的结构体。</h4>
<p><a href="#54-%E5%AE%9A%E4%B9%89%E4%BA%86%E7%9F%A9%E5%BD%A2%E5%90%84%E8%BE%B9%E7%9A%84%E5%86%85%E5%B5%8C%E8%B7%9D%E7%A6%BB%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93"></a></p>
<blockquote>
<p>demo</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AdjustingPaddingView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="comment">/// 5 - Adjusting the Padding of a View - 调整视图边距</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="comment">/*@START_MENU_TOKEN@*/</span><span class="string">&quot;Hello, World!&quot;</span><span class="comment">/*@END_MENU_TOKEN@*/</span>)</span><br><span class="line">                .background(<span class="type">Color</span>.yellow)</span><br><span class="line">                .border(<span class="type">Color</span>.red, width: <span class="number">2</span>)</span><br><span class="line">                .position(x: <span class="number">100</span>, y: <span class="number">30</span>)</span><br><span class="line">                .padding()</span><br><span class="line">                </span><br><span class="line">        &#125;</span><br><span class="line">        .background(<span class="type">Color</span>.gray)</span><br><span class="line"><span class="comment">//        .padding()///  默认边距</span></span><br><span class="line"><span class="comment">//        .padding(30) /// 5.1 将视图沿所有边缘内嵌填充指定的大小。</span></span><br><span class="line"><span class="comment">//        .padding(EdgeInsets(top: 20, leading: 10, bottom: 60, trailing: 50)) /// 5.2 使用指定的`EdgeInsets`内嵌填充视图。</span></span><br><span class="line">        .padding([.leading,.trailing], <span class="number">20</span>) <span class="comment">/// 5.3 使用指定的`Edge`集合内嵌填充指定大小。</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/10/15/SwiftUI%E6%96%87%E6%A1%A3/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/08/29/%E6%95%B0%E5%AD%A6/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86%EF%BC%88%E5%BA%94%E7%94%A8%E7%AF%87%EF%BC%89/"
                            aria-label=": 一文搞懂贝叶斯定理（应用篇）"
                        >
                            一文搞懂贝叶斯定理（应用篇）
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-08-29T16:26:57+08:00">
	
		    2023 年 8 月 29 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E5%9F%BA%E7%A1%80/">基础</a>, <a class="category-link" href="../../categories/%E5%9F%BA%E7%A1%80/%E6%95%B0%E5%AD%A6/">数学</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>在统计学里，长期以来，有频率学派和贝叶斯学派两大学派，他们互相鄙视对方，就像华山派的气宗与剑宗之争。</p>
<p>这两大学派最根本的观点在于看待世界的方式不同：</p>
<ul>
<li>频率学派认为世界是客观的，必须通过大量独立采样来获得统计均值，不能先给出一个主观的先验概率（假设）；</li>
<li>贝叶斯学派则认为概率是一种信念度，可以有非常主观的先验概率，然后，通过一次次采样结果修正先验概率，使之逼近客观事实。</li>
</ul>
<p>这两大学派哪个才是正确的？其实都对，只是看待世界的角度不同。但是在现实世界中，除了抛硬币、掷骰子、玩老虎机等少数符合理想数学模型的场景，频率学派才能发挥作用。大多数需要我们估算概率的现实场景，只能用贝叶斯理论来指导实践。</p>
<p>举个例子，假设我住在市区，希望赶上飞机的概率不低于90%，那么我应该提前多久出发呢？我必须试验至少100次，看看样本空间，才能获得一个比较准确的统计均值。然而这是不现实的，因为我一年可能就坐几次飞机。我只能拍脑袋先估一个提前30分钟就够了，结果第三次就没赶上，这说明我必须修正我的先验概率，后续改为提前45分钟，才能提升赶上飞机的概率。</p>
<p>我们再以《狼来了》的故事为例，当小孩第一次喊狼来了，村民听到后可以根据先验概率，比如P(小孩是诚实的)=90%判断赶紧去帮忙，结果发现被骗了，于是大家根据“被骗了”这一证据把后验概率P(小孩是诚实的)调整为60%，第二次又被骗了，于是再次把后验概率调整为20%，等到第三次听见小孩求救时，大家根据P(小孩是诚实的)=20%判断，他大概率还是在说谎，于是没有人去帮忙了。</p>
<p>有的同学会问，你说的这些，都是定性分析，没有定量计算啊！</p>
<p>要把贝叶斯定理用到定量计算，必须得借助计算机。</p>
<p>以吴军老师在中文分词领域举的一个例子来说，对于一个句子：南京市长江大桥，可以有两种划分：</p>
<ul>
<li>南京市 / 长江大桥</li>
<li>南京市长 / 江大桥</li>
</ul>
<p>到底哪一种更合理？我们可以计算条件概率：</p>
<ul>
<li>P(长江大桥|南京市) = 出现“南京市”时，出现“长江大桥”的概率；</li>
<li>P(江大桥|南京市长) = 出现“南京市长”时，出现“江大桥”的概率。</li>
</ul>
<p>提前准备好大量的中文语料，计算出任意两个词的条件概率，我们就可以得出哪种分词更合理。</p>
<p>在互联网领域，凡是遇到“当出现xyz时应该推荐什么”这样的条件概率时，也总是能应用贝叶斯理论。</p>
<p>例如，我们在搜索引擎中输入<code>elon</code>这个单词后，搜索框自动给出了联想补全：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-29-bayes-use/elon.png" alt="elon"></p>
<p>怎么实现这个功能？把用户最近搜索的所有可能的单词列出来，然后计算条件概率：</p>
<ul>
<li>P(mask|elon)=0.5</li>
<li>P(jerk|elon)=0.1</li>
<li>P(university|elon)=0.2</li>
<li>…</li>
</ul>
<p>把它们排个序，选出条件概率最大的几个，就是搜索建议。</p>
<p>诸如反垃圾邮件、电商推荐系统等，都是贝叶斯理论在机器学习中的应用。由于需要大量的计算，贝叶斯理论也只有在计算机时代才能广泛应用。</p>
<h3 id="关于信念">关于信念</h3>
<p>我们再回顾一下贝叶斯定理：</p>
<p>稍微改一下，变为：</p>
<p>P(H)是先验概率，P(H|E)是后验概率，P(E|H)/P(E)被称为调整因子，先验概率乘以调整因子就得到后验概率。</p>
<p>我们发现，如果P(H)=0，则P(H|E)=0；如果P(H)=1，则P(E|H)=P(E)，P(H|E)=1。</p>
<p>也就是说，如果先验概率为0%或100%，那么，无论出现任何证据E，都无法改变后验概率P(H|E)。这对我们看待世界的认知有重大指导意义，因为贝叶斯概率的本质是信念，通过一次次事件，我们可能加强某种信念，也可能减弱某种信念，但如果信念保持100%或0%，则可以做到对外界输入完全“免疫”。</p>
<p>举个例子，十年前许多人都认为比特币是庞氏骗局，如果100%坚定地持有这种信念，那么他将无视用户越来越多、价格上涨、交易量扩大、机构入市等诸多证据，至今仍然会坚信比特币是骗局而错过无数次机会。（注：此处示例不构成任何投资建议）</p>
<p>对于新生事物，每个人都可以有非常主观的先验概率，但只要我们不把先验概率定死为0或100%，就有机会改变自己的信念，从而更有可能接近客观事实，这也是贝叶斯定理的精髓：</p>
<blockquote>
<p>你相信什么并不重要，重要的是你别完全相信它。</p>
</blockquote>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/08/29/%E6%95%B0%E5%AD%A6/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86%EF%BC%88%E5%BA%94%E7%94%A8%E7%AF%87%EF%BC%89/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/08/27/%E6%95%B0%E5%AD%A6/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86%EF%BC%88%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%89/"
                            aria-label=": 一文搞懂贝叶斯定理（原理篇）"
                        >
                            一文搞懂贝叶斯定理（原理篇）
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-08-27T16:26:10+08:00">
	
		    2023 年 8 月 27 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E5%9F%BA%E7%A1%80/">基础</a>, <a class="category-link" href="../../categories/%E5%9F%BA%E7%A1%80/%E6%95%B0%E5%AD%A6/">数学</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>托马斯·贝叶斯（Thomas Bayes）是18世纪的英国数学家，也是一位虔诚的牧师。据说他为了反驳对上帝的质疑而推导出贝叶斯定理。贝叶斯定理是一个由结果倒推原因的概率算法，在贝叶斯提出这个条件概率公式后，很长一段时间，大家并没有觉得它有什么作用，并一直受到主流统计学派的排斥。直到计算机诞生后，人们发现，贝叶斯定理可以广泛应用在数据分析、模式识别、统计决策，以及最火的人工智能中，结果，贝叶斯定理是如此有用，以至于不仅应用在计算机上，还广泛应用在经济学、心理学、博弈论等各种领域，可以说，掌握并应用贝叶斯定理，是每个人必备的技能。</p>
<p>这里推荐两个视频，深入浅出地解释了贝叶斯定理：</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Pu675cHJ7bg">Bayes’ Theorem 贝叶斯定理</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=HZGCoVF3YvM">Bayes theorem, the geometry of changing beliefs</a></p>
<p>如果你不想花太多时间看视频，可以继续阅读，我把视频内容编译成文字，以便快速学习贝叶斯定理。</p>
<p>为了搞明白贝叶斯定理究竟要解决什么问题，我们先看一个现实生活的例子：</p>
<p>已知有一种疾病，发病率是0.1%。针对这种疾病的测试非常准确：</p>
<ul>
<li>如果有病，则准确率是99%（即有1%未检出阳性）；</li>
<li>如果没有病，则误报率是2%（即有2%误报为阳性）。</li>
</ul>
<p>现在，如果一个人测试显示阳性，请问他患病的概率是多少？</p>
<p>如果我们从大街上随便找一个人，那么他患病的概率就是0.1%，因为这个概率是基于历史统计数据的先验概率。</p>
<p>现在，他做了一次测试，结果为阳性，我们要计算他患病的概率，就是计算条件概率，即：在测试为阳性这一条件下，患病的概率是多少。</p>
<p>从直觉上这个人患病的概率大于0.1%，但也肯定小于99%。究竟是多少，怎么计算，我们先放一放。</p>
<p>为了理解条件概率，我们换一个更简单的例子：掷两次骰子，一共可能出现的结果有6x6=36种：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/sample-all.png" alt="sample space"></p>
<p>这就是所谓的样本空间，每个样本的概率均为1/36，这个很好理解。</p>
<p>如果我们定义事件A为：至少有一个骰子是2，那么事件A的样本空间如下图红色部分所示：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/sample-a.png" alt="Event A"></p>
<p>事件A一共有11种情况，我们计算事件A的概率P(A)：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/pa.png" alt="P(A)"></p>
<p>我们再定义事件B：两个骰子之和为7，那么事件B的样本空间如下图绿色部分所示：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/sample-b.png" alt="Event B"></p>
<p>事件B一共有6种情况，我们计算事件B的概率P(B)：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/pb.png" alt="P(B)"></p>
<p>接下来我们用P(A∩B)表示A和B同时发生的概率，A∩B就是A和B的交集，如下图蓝色部分所示：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/sample-p-a-and-b.png" alt="P(A∩B)"></p>
<p>显然A∩B只有两种情况，因此，计算P(A∩B)：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/p-a-and-b.png" alt="P(A∩B)"></p>
<p>接下来我们就可以讨论条件概率了。我们用P(A|B)表示在B发生的条件下，A发生的概率。由于B已经发生，所以，样本空间就是B的样本数量6，而要发生A则只能是A、B同时发生，即A∩B，有两种情况。</p>
<p>因此，计算P(A|B)如下：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/p-a-b.png" alt="P(A|B)"></p>
<p>同理，我们用P(B|A)表示在A发生的条件下，B发生的概率。此时，分子仍然是A∩B的样本数量，但分母变成A的样本数量：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/p-b-a.png" alt="P(B|A)"></p>
<p>可见，条件概率P(A|B)和P(B|A)是不同的。</p>
<p>我们再回到A、B同时发生的概率，观察P(A∩B)可以改写为：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/p-a-and-b-2.png" alt="P(B|A)xP(A)"></p>
<p>同理，P(A∩B)还可以改写为：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/p-a-and-b-3.png" alt="P(A|B)xP(B)"></p>
<p>因此，根据上述两个等式，我们推导出下面的等式：</p>
<p>把左边的<code>P(A∩B)</code>去掉，我们得到等式：</p>
<p>最后，整理一下等式，我们推导出贝叶斯定理如下：</p>
<p>这就是著名的贝叶斯定理，它表示，当出现B时，如何计算A的概率。</p>
<p>很多时候，我们把<code>A</code>改写为<code>H</code>，把<code>B</code>改写为<code>E</code>：</p>
<p>H表示Hypothesis（假设），E表示Evidence（证据），贝叶斯定理的意义就在于，给定一个先验概率P(H)，在出现了证据E的情况下，计算后验概率P(H|E)。</p>
<h3 id="计算">计算</h3>
<p>有了贝叶斯定理，我们就可以回到开头的问题：</p>
<p>已知有一种疾病，发病率是0.1%。针对这种疾病的测试非常准确：</p>
<ul>
<li>如果有病，则准确率是99%（即有1%未检出阳性）；</li>
<li>如果没有病，则误报率是2%（即有2%误报为阳性）。</li>
</ul>
<p>现在，如果一个人测试显示阳性，请问他患病的概率是多少？</p>
<p>用H表示患病，E表示测试为阳性，那么，我们要计算在测试为阳性的条件下，一个人患病的概率，就是计算P(H|E)。根据贝叶斯定理，计算如下：</p>
<p>P(H)表示患病的概率，根据发病率可知，P(H)=0.1%；</p>
<p>P(E|H)表示在患病的情况下，测试为阳性的概率，根据“如果有病，则准确率是99%”可知，P(E|H)=99%；</p>
<p>P(E)表示测试为阳性的概率。这个概率就稍微复杂点，因为它是指对所有人（包含病人和健康人）进行测试，结果阳性的概率。</p>
<p>我们可以把检测人数放大，例如放大到10万人，对10万人进行检测，根据发病率可知：</p>
<ul>
<li>有100人是病人，另外99900是健康人；</li>
<li>对100个病人进行测试，有99人显示阳性，另有1人未检出（阴性）；</li>
<li>对99900个健康人进行测试，有2%=1998人显示阳性（误报），另有98%=97902人为阴性。</li>
</ul>
<p>下图显示了检测为阳性的结果的分布：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">           ┌───────┐</span><br><span class="line">           │100000 │</span><br><span class="line">           └───────┘</span><br><span class="line">               │</span><br><span class="line">       ┌───────┴───────┐</span><br><span class="line">       ▼               ▼</span><br><span class="line">   ┌───────┐       ┌───────┐</span><br><span class="line">   │  100  │       │ 99900 │</span><br><span class="line">   └───────┘       └───────┘</span><br><span class="line">       │               │</span><br><span class="line">   ┌───┴───┐       ┌───┴───┐</span><br><span class="line">   ▼       ▼       ▼       ▼</span><br><span class="line">┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐</span><br><span class="line">│ 99  │ │  1  │ │1998 │ │97902│</span><br><span class="line">└─────┘ └─────┘ └─────┘ └─────┘</span><br><span class="line">   │               │</span><br><span class="line">   ▼               ▼</span><br><span class="line">   +               +</span><br></pre></td></tr></table></figure>
<p>所以，对于10万人的样本空间来说，事件E=显示阳性的概率为(99+1998)/100000=2.097%。</p>
<p>带入贝叶斯定理，计算P(H|E)：</p>
<p>计算结果为患病的概率为4.721%，这个概率远小于99%，且与大多数人的直觉不同，原因在于庞大的健康人群导致的误报数量远多于病人，当出现“检测阳性”的证据时，患病的概率从先验概率0.1%提升到4.721%，还远不足以确诊。</p>
<h3 id="贝叶斯定理的另一种表示">贝叶斯定理的另一种表示</h3>
<p>在上述计算中，我们发现计算P(E)是比较困难的，很多时候，甚至无法知道P(E)。此时，我们需要贝叶斯定理的另一种表示形式。</p>
<p>我们用P(H)表示H发生的概率，用H表示H不发生，P(H)表示H不发生的概率。显然P(H)=1-P(H)。</p>
<p>下图红色部分表示H，红色部分以外则表示H：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/ph.png" alt="P(H)"></p>
<p>事件E用绿色表示：</p>
<p><img src="https://liaoxuefeng.com/blogs/all/2023-08-27-bayes-explain/pe.png" alt="P(E)"></p>
<p>可见，P(E)可以分为两部分，一部分是E和H的交集，另一部分是E和H的交集：</p>
<p>根据上文的公式P(A∩B)=P(A|B)xP(B)，代入可得：</p>
<p>把P(E)替换掉，我们得到贝叶斯定理的另一种写法：</p>
<p>用这个公式来计算，我们就不必计算P(E)了。再次回到开头的问题：</p>
<p>已知有一种疾病，发病率是0.1%。针对这种疾病的测试非常准确：</p>
<ul>
<li>如果有病，则准确率是99%（即有1%未检出阳性）；</li>
<li>如果没有病，则误报率是2%（即有2%误报为阳性）。</li>
</ul>
<p>现在，如果一个人测试显示阳性，请问他患病的概率是多少？</p>
<ul>
<li>P(E|H)表示患病时检测阳性的概率=99%；</li>
<li>P(H)表示患病的概率=0.1%；</li>
<li>P(E|H)表示没有患病但检测阳性的概率=2%；</li>
<li>P(H)表示没有患病的概率=1-P(H)=99.9%。</li>
</ul>
<p>代入公式，计算：</p>
<p>检测为阳性这一证据使得患病的概率从0.1%提升到4.721%。假设这个人又做了一次检测，结果仍然是阳性，那么他患病的概率是多少？</p>
<p>我们仍然使用贝叶斯定理计算，只不过现在先验概率P(H)不再是0.1%，而是4.721%，P(E|H)和P(E|H)仍保持不变，计算新的P(H|E)：</p>
<p>结果为71%，两次检测为阳性的结果使得先验概率从0.1%提升到4.721%再提升到71%，继续第三次检测如果为阳性则概率将提升至99.18%。</p>
<p>可见，贝叶斯定理的核心思想就是不断根据新的证据，将先验概率调整为后验概率，使之更接近客观事实。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/08/27/%E6%95%B0%E5%AD%A6/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86%EF%BC%88%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%89/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/04/14/Algorithms/Astar%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BF%9D%E5%A7%86%E7%BA%A7%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB/"
                            aria-label=": Astar搜索算法简介及保姆级代码解读"
                        >
                            Astar搜索算法简介及保姆级代码解读
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-04-14T15:43:00+08:00">
	
		    2023 年 4 月 14 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%AE%97%E6%B3%95/">算法</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h4 id="A-搜索算法简介及保姆级代码解读">A*搜索算法简介及保姆级代码解读</h4>
<ul>
<li><a href="#1_A_1">1. A*算法简单介绍</a></li>
<li>
<ul>
<li><a href="#11_A_12">1.1 A*算法理论基础</a></li>
<li>
<ul>
<li><a href="#111__31">1.1.1 节点计算</a></li>
<li><a href="#112__60">1.1.2 由计算得出的小结论</a></li>
</ul>
</li>
<li><a href="#12__70">1.2 算法逻辑结构</a></li>
</ul>
</li>
<li><a href="#2__80">2. 代码解析</a></li>
<li>
<ul>
<li><a href="#21__81">2.1 引入地图</a></li>
<li><a href="#22__159">2.2 预处理</a></li>
<li><a href="#23_parent_286">2.3 定义父节点`parent`</a></li>
<li><a href="#24__296">2.4 主循环</a></li>
<li>
<ul>
<li><a href="#241_359">2.4.1</a></li>
<li><a href="#242_364">2.4.2</a></li>
<li><a href="#243_380">2.4.3</a></li>
<li><a href="#244_383">2.4.4</a></li>
<li><a href="#245_396">2.4.5</a></li>
</ul>
</li>
<li><a href="#25__414">2.5 画图</a></li>
</ul>
</li>
<li><a href="#3__427">3. 结果</a></li>
</ul>
<h2 id="1-A-算法简单介绍">1. A*算法简单介绍</h2>
<p>A*算法是一种路径规划算法，和传统的Dijkstra算法有所不同，该算法<strong>有选择</strong>地进行节点搜索，因此比Dijkstra算法更快、搜索的点更少。<br>
阅读本文，不需要掌握Dijkstra算法的知识，请放心食用。<br>
注意：<strong>本文只介绍二维A*算法及相关示例</strong>。</p>
<p><strong>PS</strong>：本文代码编写参考B站up主<br>
<code>小黎的Ally</code>的<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Jt4y1z7Ry?from=search&amp;seid=14748520462847442393&amp;spm_id_from=333.337.0.0">路径规划与轨迹跟踪系列算法学习_第4讲_A*算法</a>，讲解详细，本文代码部分是将其代码进行了些许改动并加以解释，在此对up主的辛苦表达感谢！！</p>
<p><strong>PPS</strong>：本文所使用的把地图栅格化的函数来自于博客<br>
<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42667352/article/details/98523370">Matlab中将一幅图片做成栅格地图</a>，本文进行了些许改动，再次一并感谢博主的辛苦！</p>
<h3 id="1-1-A-算法理论基础">1.1 A*算法理论基础</h3>
<p>A*算法首先将要搜索的区域划分为若干栅格（grid），并有选择地标识出障碍物（Obstacle）与空白区域。一般地，<strong>栅格划分越细密，搜索点数越多，搜索过程越慢，计算量也越大；栅格划分越稀疏，搜索点数越少，相应地搜索精确性就越低</strong>。<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/e5a5e9d6d0f36afb2bf3f1cd9ef378ac.png#pic_center" alt="地图栅格"></p>
<p>如上图，引入地图信息后画出栅格，该图片采用 100 × 100 100 \times 100 100×100的栅格划分，图中黑色区域为障碍物区域。图中绿点为起始点，红点为终点。</p>
<p>对每个节点，在计算时同时考虑两项<strong>代价</strong>指标：<strong>当前节点与起始点的距离</strong>，以及<strong>当前节点与目标点的距离</strong>：<br>
f = g + h f = g + h f=g+h其中 f f f为总代价， g g g为当前节点距离起始点的距离， h h h为当前节点距离目标点的距离。<br>
而在计算距离时，又可以采用两种方式：<br>
<strong>欧氏距离</strong>：<br>
L = ( x 1 − x 2 ) 2 + ( y 1 − y 2 ) 2 L = \sqrt{\left( x_1 - x_2 \right) ^2 + \left( y_1 - y_2 \right) ^2} L=(x1​−x2​)2+(y1​−y2​)2 ​<strong>曼哈顿距离</strong>：<br>
L = ∣ x 1 − x 2 ∣ + ∣ y 1 − y 2 ∣ L = \lvert x_1 - x_2 \rvert + \lvert y_1 - y_2 \rvert L=∣x1​−x2​∣+∣y1​−y2​∣为了计算方便，本文计算 h h h时采用<strong>曼哈顿距离</strong>，这也是A*算法中的一贯做法。<br>
为了方便计数，在计算每一个节点时，在栅格左上角写 f f f值，左下角写 g g g值，右下角写 h h h值。</p>
<h4 id="1-1-1-节点计算">1.1.1 节点计算</h4>
<p>这里举一个例子。<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/86fca2663892fb458c7cdef9e81facdf.jpeg#pic_center" alt="节点计算例1"><br>
如图所示，A点为起始点，M点为终点。对于A点来说，对其周边的8个节点进行寻找，A点本身为<strong>父节点</strong>，周边8个点为<strong>子节点</strong>。</p>
<p>假设：</p>
<ul>
<li>格子边长为10，这样水平和竖直位移一格为10，而对角位移一格为14；</li>
<li>从父节点到子节点可以水平、竖直、对角线位移计算 g g g值，而从子节点到目标点只能使用水平、竖直位移计算曼哈顿距离 h h h值。</li>
</ul>
<p>对于点B：从A到B只需右移一格，因此B的 g = 10 g=10 g=10；从B到M需要先右移四格，再上移三格，因此B的 h = 40 + 30 = 70 h = 40+30=70 h=40+30=70。这样B的 f = g + h = 10 + 70 = 80 f=g+h=10+70=80 f=g+h=10+70=80。将三者都记在B格中。<br>
对于点C：从A到C只需向右上方平移一格，因此C的 g = 14 g=14 g=14；从C到M需要先右移四格，再上移两格，因此C的 h = 40 + 20 = 60 h=40+20=60 h=40+20=60，继而C的 f = g + h = 74 f=g+h=74 f=g+h=74。<br>
同理可以计算出D的 g = 14 , h = 80 , f = 94 g=14, h=80,f=94 g=14,h=80,f=94，以及其他几个子节点的值。</p>
<p>将这8个子节点进行对比，可以发现，C点的 f f f值最小，因此选取C点为下一步搜寻的父节点， A C ‾ \overline{AC} AC即为路径迈出的第一步。<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/61d8dbfe6ffe8e4eb0d95eb32b2a6032.jpeg#pic_center" alt="节点计算例2"><br>
如图所示，现在将C作为新的父节点。</p>
<p>对于J点：<br>
从C到J只需右移一格，因此J的 g = 10 + g C = 10 + 14 = 24 g=10+g_C =10+14=24 g=10+gC​=10+14=24。需要注意的是，<strong>J点的 g g g值是从C到J的 g g g加上从A到C的 g g g，即当前子节点的 g g g值是从起点到该点的所有 g g g累和</strong>。<br>
从J到M需要先右移三格，再上移两格，因此J的 h = 30 + 20 = 50 h = 30+20=50 h=30+20=50。这样J的 f = g + h = 24 + 50 = 74 f=g+h=24+50=74 f=g+h=24+50=74。将三者都记在J格中。</p>
<p>对于I点：<br>
从C到I只需向右上方平移一格，同样地，<strong>I点的 g g g值是从C到I的 g g g加上从A到C的 g g g，即当前子节点的 g g g值是从起点到该点的所有 g g g累和</strong>，因此I的 g = 14 + g C = 14 + 14 = 28 g=14+g_C =14+14=28 g=14+gC​=14+14=28。<br>
从I到M需要先右移三格，再上移一格，因此I的 h = 30 + 10 = 40 h = 30+10=40 h=30+10=40。这样I的 f = g + h = 28 + 40 = 68 f=g+h=28+40=68 f=g+h=28+40=68。将三者都记在I格中。<br>
同样计算出其他点的值。<br>
可以看出，I点的 f f f值最小，因此选择I点作为路径上的下一个点，此时路径变为 A C I ‾ \overline{ACI} ACI。</p>
<p>如此一步步进行迭代，最后找到最优轨迹。</p>
<h4 id="1-1-2-由计算得出的小结论">1.1.2 由计算得出的小结论</h4>
<ul>
<li>每个节点中需要存储至少3个值： g , h , f g,h,f g,h,f。</li>
<li>当子节点迭代到目标点本身时， h = 0 h=0 h=0，即当前节点到目标点的距离为0.</li>
<li>在算法实施时， g g g的计算可以取10或14，即从父节点到子节点可以水平/竖直位移，也可以沿对角线位移；而 h h h的计算只能取10的倍数，即从当前子节点到目标点只能水平/竖直位移。前者可以采用<strong>欧氏距离</strong>，后者只能采用<strong>曼哈顿距离</strong>。</li>
<li><strong>当某个子节点被选中后，就作为下一次搜索的父节点；并且为了避免节点的重复计算和筛选，在下一次搜索时，需要将上一步选中的节点从“可搜索”列表中删除</strong>。如上图中，当C为父节点时，选中I作为下一次的父节点；那么当第二步I为父节点时，由于C已经在已选轨迹上了，所以I的子节点实际上并不包括C，只计算7个子节点即可。</li>
<li>鉴于上一点，可以预想，算法的具体实施过程中，<strong>需要有两个数组保存“待计算子节点”和“已被选中的节点”。当“待计算子节点”中某个点符合 f f f最小时，就将其加入“已选中的节点”，并在“待计算子节点”中删除该点，防止后续重复计算</strong>。</li>
<li>当算法结束时，<strong>保存在“已选中的节点”中的所有点，按照顺序即为找出的路径</strong>。</li>
<li>算法结束时，<strong>最后一个点的 f f f值，即为从起点到终点所用的距离</strong>。</li>
<li>算法的停止条件：1)当“待计算子节点”中没有点时，即已经没有点可供寻找了；2)当当前父节点恰为目标节点时，即 h = 0 h=0 h=0。</li>
</ul>
<h3 id="1-2-算法逻辑结构">1.2 算法逻辑结构</h3>
<p>A*算法的逻辑结构如下：<br>
1）初始化。导入地图信息，设置障碍物区域，设置起点<code>start</code>、终点<code>target</code>、栅格数量 m × n m \times n m×n等。<br>
2）数据预处理。建立“待计算子节点”的数组<code>openlist</code>，“已选中的节点”的数组<code>closelist</code>，保存路径的数组<code>closelist_path</code>。除此之外，还需建立一个当前子节点集合<code>children</code>，用来保存当前父节点周围8个子节点的坐标，以及父节点本身<code>parent</code>；还有保存代价值 g , h , f g, h,f g,h,f的数组<code>openlist_cost</code>和<code>closelist_cost</code>。<br>
3）对子节点们<code>children</code>中的每个节点<code>child</code>：<br>
若该子节点不在“待计算子节点”节点<code>openlist</code>中，则追加进去；<br>
若在，则计算出该<code>child</code>的 g g g值，该 g g g值是从起点到父节点<code>parent</code>的距离加上父节点到该子节点的距离。若该 g g g值小于之前<code>openlist_cost</code>中的 g g g最小值，那么就将<code>openlist_cost</code>中的最小 g g g值更新；<br>
4）由于该代价最小点已经加入了轨迹，因此将该点加入<code>clost_list</code>和<code>closelist_path</code>，并从<code>openlist</code>中剔除；<br>
5）更新<code>openlist</code>中的最小代价值，并以其为父节点开始新一轮搜索。</p>
<h2 id="2-代码解析">2. 代码解析</h2>
<h3 id="2-1-引入地图">2.1 引入地图</h3>
<p>代码块：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">%% 画地图</span><br><span class="line"></span><br><span class="line">% 栅格地图的行数、列数定义</span><br><span class="line">m = 150;</span><br><span class="line">n = 150;</span><br><span class="line">% 地图m行n列</span><br><span class="line"></span><br><span class="line">start = [10, 20];        % 起始节点</span><br><span class="line">target = [130, 80];       % 终止节点</span><br><span class="line"></span><br><span class="line">obs = TrunToGridMap(m, n);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">% 画格子</span><br><span class="line">for i = 0 : 5 : m</span><br><span class="line">    plot([0, n], [i, i], &#x27;k&#x27;, &#x27;handlevisibility&#x27;, &#x27;off&#x27;);</span><br><span class="line">    hold on;</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">for j = 0 : 5 : n</span><br><span class="line">    plot([j, j], [0, m], &#x27;k&#x27;, &#x27;handlevisibility&#x27;, &#x27;off&#x27;);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">axis equal;</span><br><span class="line">xlim([0, n]);</span><br><span class="line">ylim([0, m]);</span><br><span class="line"></span><br><span class="line">% 绘制障碍物、起止点颜色块</span><br><span class="line">scatter(start(1), start(2), 700, &#x27;pg&#x27;, &#x27;filled&#x27;);</span><br><span class="line">scatter(target(1), target(2), 700, &#x27;pr&#x27;, &#x27;filled&#x27;);</span><br><span class="line"></span><br><span class="line">for i = 1 : size(obs, 1) - 1</span><br><span class="line">    temp = obs(i, :);</span><br><span class="line">    fill([temp(1)-1, temp(1), temp(1), temp(1)-1],...</span><br><span class="line">        [temp(2)-1, temp(2)-1, temp(2), temp(2)], &#x27;k&#x27;, &#x27;handlevisibility&#x27;, &#x27;off&#x27;);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">temp = obs(size(obs, 1), :);</span><br><span class="line">fill([temp(1)-1, temp(1), temp(1), temp(1)-1],...</span><br><span class="line">    [temp(2)-1, temp(2)-1, temp(2), temp(2)], &#x27;k&#x27;);</span><br></pre></td></tr></table></figure>
<p>绘制一个 150 × 150 150 \times 150 150×150的地图，起点设置为 ( 10 , 20 ) (10,20) (10,20)，终点设置为 ( 130 , 80 ) (130,80) (130,80)。<br>
障碍物的坐标通过函数<code>TrunToGridMap(m, n)</code>获得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function obs = TrunToGridMap(a, b)</span><br><span class="line">    I=imread(&#x27;此处放地图图片的文件名&#x27;);   %读入图片</span><br><span class="line">    I = rgb2gray(I);     %将图片转为灰度图</span><br><span class="line">    I = imrotate(I, -90);</span><br><span class="line"></span><br><span class="line">    l=1;    %网格边长</span><br><span class="line">    B = imresize(I,[a/l b/l]);</span><br><span class="line">    J=floor(B/255); </span><br><span class="line"></span><br><span class="line">    axes(&#x27;GridLineStyle&#x27;, &#x27;-&#x27;);</span><br><span class="line">    axis equal;</span><br><span class="line"></span><br><span class="line">    hold on</span><br><span class="line">    grid on</span><br><span class="line">    axis([0,a,0,b]);</span><br><span class="line">    set(gca,&#x27;xtick&#x27;,0:10:a,&#x27;ytick&#x27;,0:10:b);</span><br><span class="line"></span><br><span class="line">    obs = [];</span><br><span class="line"></span><br><span class="line">    %障碍物填充为黑色</span><br><span class="line">    for i=1:a/l-1</span><br><span class="line">        for j=1:b/l-1</span><br><span class="line">            if(J(i,j)==0)</span><br><span class="line">                obs(end+1, :) = [i, j];</span><br><span class="line">            end</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>该函数读取一个图片文件，将其转化为灰度图像，并将灰度图中黑色色块所在的坐标返回为障碍物坐标。</p>
<h3 id="2-2-预处理">2.2 预处理</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">%% 预处理</span><br><span class="line"></span><br><span class="line">% 初始化closelist</span><br><span class="line">closelist = start;</span><br><span class="line">closelist_path = &#123;start, start&#125;;      % 路径，从自身到自身</span><br><span class="line">closelist_cost = 0;</span><br><span class="line">children = child_nodes_cal(start, m, n, obs, closelist);</span><br><span class="line"></span><br><span class="line">% 初始化openlist</span><br><span class="line">openlist = children;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i = 1 : size(openlist, 1)   % i为第i个节点</span><br><span class="line">    openlist_path&#123;i, 1&#125; = openlist(i, :);   % openlist_path的第i行第1列为第i个节点child</span><br><span class="line">    openlist_path&#123;i, 2&#125; = [start; openlist(i, :)]; % openlist_path的第i行第2列为一个列向量，分别是起始节点和当前child</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">for i = 1 : size(openlist, 1)</span><br><span class="line">    g = norm(start - openlist(i, 1:2));</span><br><span class="line">    h = abs(target(1) - openlist(i, 1)) + abs(target(2) - openlist(i, 2));</span><br><span class="line">    f = g + h;</span><br><span class="line">    openlist_cost(i, :) = [g, h, f];</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>这一部分主要做了以下几步：</p>
<ul>
<li>把起点<code>start</code>设为轨迹的第一个点：<code>closelist = start</code>；</li>
<li>路径初始化，即从起点到起点：<code>closelist_path = &#123;start, start&#125;</code>；</li>
<li>代价首先置为0：<code>closelist_cost = 0</code>；</li>
<li>利用<code>child_nodes_cal</code>函数计算当前父节点（即起点）周围的子节点们；</li>
<li>这些子节点们<code>children</code>即为待计算的子节点，也就是<code>openlist</code>；</li>
<li>随后进入一个循环，对每一个子节点i，<code>openlist_path</code>中第i行第1个元素储存第i个节点<code>child</code>，第2个元素为一个<strong>列向量</strong>，分别是第i个<code>child</code>的起点和它本身；</li>
<li>第二个循环则是计算代价的循环，对每一个子节点i，计算 g g g（这里使用<strong>范数</strong><code>norm</code>）， h h h（曼哈顿距离）和 f f f；之后，在代价数组<code>openlist_cost</code>中储存这三个代价值，因此<code>openlist_cost</code>第i行的元素为一个<strong>行向量</strong>；</li>
</ul>
<p>其中用到的子节点计算函数如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">function child_nodes = child_nodes_cal(parent_node, m, n, obs, closelist)</span><br><span class="line">    child_nodes = [];</span><br><span class="line">    field = [1, 1;</span><br><span class="line">        n, 1;</span><br><span class="line">        n, m;</span><br><span class="line">        1, m];</span><br><span class="line">    </span><br><span class="line">    % 左上子节点</span><br><span class="line">    child_node = [parent_node(1) - 1, parent_node(2) + 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        % [in, on] = inpolygon, 返回 in，以指明 xq 和 yq 所指定的查询点是在 xv 和 </span><br><span class="line">        % yv 定义的多边形区% 域的边缘内部还是在边缘上,in为内部，on为边缘上</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 上子节点</span><br><span class="line">    child_node = [parent_node(1), parent_node(2) + 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 右上子节点</span><br><span class="line">    child_node = [parent_node(1) + 1, parent_node(2) + 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    % 左子节点</span><br><span class="line">    child_node = [parent_node(1) - 1, parent_node(2)];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    %右子节点</span><br><span class="line">    child_node = [parent_node(1) + 1, parent_node(2)];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    %左下子节点</span><br><span class="line">    child_node = [parent_node(1) - 1, parent_node(2) - 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 下子节点</span><br><span class="line">    child_node = [parent_node(1), parent_node(2) - 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 右下子节点</span><br><span class="line">    child_node = [parent_node(1) + 1, parent_node(2) - 1];</span><br><span class="line">    if inpolygon(child_node(1), child_node(2), field(:, 1), field(:, 2))</span><br><span class="line">        if ~ismember(child_node, obs, &#x27;rows&#x27;)</span><br><span class="line">            child_nodes = [child_nodes; child_node];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    %% 排除已经存在于closelist的节点</span><br><span class="line">    delete_idx = [];</span><br><span class="line">    for i = 1 : size(child_nodes, 1)</span><br><span class="line">        if ismember(child_nodes(i, :), closelist, &#x27;rows&#x27;)</span><br><span class="line">            delete_idx(end+1, :) = i;</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    child_nodes(delete_idx, :) = [];</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="2-3-定义父节点parent">2.3 定义父节点<code>parent</code></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%% 定义父节点</span><br><span class="line">% 从openlist开始搜索移动代价最小的节点</span><br><span class="line">[~, min_idx] = min(openlist_cost(:, 3));    % 看f值最小，min_idx为f最小的那一行</span><br><span class="line">parent = openlist(min_idx, :);% 以min_idx该行的子节点child_node为新的父节点</span><br></pre></td></tr></table></figure>
<p>这一步搜索<code>openlist_cost</code>代价数组中 f f f最小的元素，记下其索引<code>min_idx</code>；<br>
随后该索引对应的<code>openlist</code>中的元素即为“ f f f值最小的待计算子节点”，作为下一步计算的父节点<code>parent</code>。</p>
<h3 id="2-4-主循环">2.4 主循环</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">%% 进入循环</span><br><span class="line">flag = 1;</span><br><span class="line">while flag</span><br><span class="line">    % 找出父节点的忽略closelist的子节点</span><br><span class="line">    children = child_nodes_cal(parent ,m, n, obs, closelist);</span><br><span class="line">    </span><br><span class="line">    % 判断这些子节点是否在openlist中，若在，则更新；没在，则追加到openlist中</span><br><span class="line">    for i = 1 : size(children, 1)</span><br><span class="line">        child = children(i, :);</span><br><span class="line">        [in_flag, openlist_idx] = ismember(child, openlist, &#x27;rows&#x27;);</span><br><span class="line">        % in_flag表示该child_node是否在openlist中</span><br><span class="line">        % openlist_idx表示该child_node在openlist中的行数</span><br><span class="line">        </span><br><span class="line">        g = openlist_cost(min_idx, 1) + norm(parent - child);</span><br><span class="line">        % 原来的g加上新的g</span><br><span class="line">        h = abs(child(1) - target(1)) + abs(child(2) - target(2));</span><br><span class="line">        f = g + h;</span><br><span class="line">        </span><br><span class="line">        if in_flag  % 若在，则比较更新g, f</span><br><span class="line">            if g &lt; openlist_cost(openlist_idx, 1)   </span><br><span class="line">                % openlist_cost(openlist_idx,1)指的是openlist_cost中idx这一行（即child_node所在的一行）的第一个坐标，即g</span><br><span class="line">                openlist_cost(openlist_idx, 1) = g;</span><br><span class="line">                openlist_cost(openlist_idx, 3) = f;</span><br><span class="line">                openlist_path&#123;openlist_idx, 2&#125; = [openlist_path&#123;min_idx, 2&#125;; child];</span><br><span class="line">                % openlist_path的第i行第2列为一个列向量，分别是起始节点和当前child，此处定义新的起始节点为openlist_path(min_idx,2)， 而openlist_path(min_idx,2)指第min_idx行所对应的 child在openlist_path中对应的路径，相当于把新的child附加到了路径上，延长了路径</span><br><span class="line">            end</span><br><span class="line">        else</span><br><span class="line">            openlist(end+1, :) = child;</span><br><span class="line">            openlist_cost(end+1, :) = [g, h, f];</span><br><span class="line">            openlist_path&#123;end+1, 1&#125; = child;</span><br><span class="line">            openlist_path&#123;end, 2&#125; = [openlist_path&#123;min_idx, 2&#125;; child];</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 从openlist移除代价最小的节点到closelist</span><br><span class="line">    closelist(end+1, :) = openlist(min_idx, :);</span><br><span class="line">    closelist_cost(end+1, :) = openlist_cost(min_idx, 3);</span><br><span class="line">    closelist_path(end+1, :) = openlist_path(min_idx, :);</span><br><span class="line">    </span><br><span class="line">    % 同样地，openlist中少了该节点</span><br><span class="line">    openlist(min_idx, :) = [];</span><br><span class="line">    openlist_cost(min_idx, :) = [];</span><br><span class="line">    openlist_path(min_idx, :) = [];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    % 重新搜索：从openlist搜索移动代价最小的节点，作为新的父节点</span><br><span class="line">    [~, min_idx] = min(openlist_cost(:, 3));</span><br><span class="line">    parent = openlist(min_idx, :);</span><br><span class="line">    </span><br><span class="line">    % 判断是否搜索到终点</span><br><span class="line">    if parent == target</span><br><span class="line">        closelist(end+1, :) = openlist(min_idx, :);</span><br><span class="line">        closelist_cost(end+1, 1) = openlist_cost(min_idx, 1);</span><br><span class="line">        closelist_path(end+1, :) = openlist_path(min_idx, :);</span><br><span class="line">        flag = 0;</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="2-4-1">2.4.1</h4>
<p>对这一部分循环来说，首先利用<code>child_nodes_cal</code>函数得出当前父节点<code>parent</code>周围的子节点们<code>children</code>；<br>
对每一个子节点<code>child</code>，判断其是否在“待计算子节点”<code>openlist</code>列表中——<code>in_flag</code>=1表示在列表中，同时<code>openlist_idx</code>为该子节点在<code>openlist</code>中的索引号。<br>
判断完成后，首先计算该子节点的 g , h , f g,h,f g,h,f值，注意： g g g值为父节点<code>parent</code>的 g g g加上该<code>child</code>子节点的 g g g值。</p>
<h4 id="2-4-2">2.4.2</h4>
<p>计算 g , h , f g,h,f g,h,f之后，再来看子节点在<code>openlist</code>中的情况。<strong>由于循环中查看了<code>parent</code>周围所有子节点的情况，所以一定会存在某个子节点的 g g g比其他子节点的 g g g都小</strong>。如果找到了这样的子节点，那么就更新该子节点在<code>openlist_cost</code>中对应位置的 g , h , f g,h,f g,h,f值。</p>
<p>同时，还要将该子节点加入到路径<code>openlist_path</code>中，即这一句代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openlist_path&#123;openlist_idx, 2&#125; = [openlist_path&#123;min_idx, 2&#125;; child];</span><br></pre></td></tr></table></figure>
<p>这行代码的含义是：<br>
<code>openlist_idx</code>表示当前子节点<code>child</code>在<code>openlist</code>中的索引，<code>min_idx</code>表示之前所有子节点中代价最小的子节点的索引。之前在<strong>预处理</strong>一节中提到，<code>openlist_path</code>的第i行第2列为一个列向量，分别是父节点和当前child，相当于第2列储存了路径。</p>
<p>而<code>min_idx</code>表示“代价最小的节点”，也就是父节点<code>parent</code>。因此这里<code>openlist_path&#123;min_idx, 2&#125;</code>表示父节点的路径。而<code>[openlist_path&#123;min_idx, 2&#125;; child]</code>则是把新的<code>child</code>附加到这一个列向量上，相当于把新的<code>child</code>附加到路径尾端，把向量长度延长了一个<code>child</code>，延长了路径。</p>
<p>这样，<strong><code>[openlist_path&#123;min_idx, 2&#125;; child]</code>构成了一个“父节点路径-当前child”的新路径</strong>。</p>
<p>把这个新路径赋值给<code>openlist_idx</code>索引所对应的<code>openlist_path</code>上，即为该<code>openlist_idx</code>索引对应的子节点的路径。</p>
<h4 id="2-4-3">2.4.3</h4>
<p>另一方面，如果该<code>child</code>不在<code>openlist</code>中，那么就把该<code>child</code>添加到“待计算子节点”列表中，其 g , h , f g,h,f g,h,f值添加到<code>openlist_cost</code>代价列表中，其路径<code>[openlist_path&#123;min_idx, 2&#125;; child]</code>添加到路径<code>openlist_path</code>中。</p>
<h4 id="2-4-4">2.4.4</h4>
<p>由于移动代价最小的节点已经是路径上的一点了，所以为了避免重复计算，应当把她从“待计算子节点”列表中删除，加入“已计算节点”中，即</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">closelist(end+1, :) = openlist(min_idx, :);</span><br><span class="line">closelist_cost(end+1, :) = openlist_cost(min_idx, 3);</span><br><span class="line">closelist_path(end+1, :) = openlist_path(min_idx, :);</span><br><span class="line">% openlist中少了该节点</span><br><span class="line">openlist(min_idx, :) = [];</span><br><span class="line">openlist_cost(min_idx, :) = [];</span><br><span class="line">openlist_path(min_idx, :) = [];</span><br></pre></td></tr></table></figure>
<p>仔细观察不难发现，<code>min_idx</code>对应的正是这一步的<code>parent</code>节点，直到这里，我们才把它加入到“已计算节点”列表中，在之前它一直呆在<code>openlist</code>中。</p>
<h4 id="2-4-5">2.4.5</h4>
<p>父节点加入到了“已计算节点”中了，那么下一步就没有父节点了，所以需要找出新的父节点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> [~, min_idx] = min(openlist_cost(:, 3));</span><br><span class="line">parent = openlist(min_idx, :);</span><br></pre></td></tr></table></figure>
<p>同时还需要判断一下，是否已经进行到了程序结束：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">% 判断是否搜索到终点</span><br><span class="line">if parent == target</span><br><span class="line">    closelist(end+1, :) = openlist(min_idx, :);</span><br><span class="line">    closelist_cost(end+1, 1) = openlist_cost(min_idx, 1);</span><br><span class="line">    closelist_path(end+1, :) = openlist_path(min_idx, :);</span><br><span class="line">    flag = 0;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>需要注意，即使当当前父节点已经是目标点了，也不要忘了把这个父节点加入到“已计算节点”中，相当于把目标点添加入路径中，形成路径上最后一个点。</p>
<h3 id="2-5-画图">2.5 画图</h3>
<p>这一步就是将结果绘制出来了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">path_opt = closelist_path&#123;end, 2&#125;;</span><br><span class="line">% closelist_path中第二列存放路径，所以path_opt存放的是路径的(x,y)值</span><br><span class="line">path_opt(:, 1) = path_opt(:, 1) - 0.5;</span><br><span class="line">path_opt(:, 2) = path_opt(:, 2) - 0.5;</span><br><span class="line">plot(path_opt(:, 1), path_opt(:, 2), &#x27;m&#x27;, &#x27;linewidth&#x27;, 1.5);</span><br><span class="line"></span><br><span class="line">title([&#x27;Total length of path: &#x27; num2str(closelist_cost(end, 1))]);</span><br><span class="line">legend(&#x27;Start node&#x27;, &#x27;Target node&#x27;, &#x27;Obstacle&#x27;, &#x27;Path&#x27;, &#x27;location&#x27;, &#x27;northwest&#x27;);</span><br><span class="line">set(gca, &#x27;fontsize&#x27;, 35, &#x27;fontname&#x27;, &#x27;times new roman&#x27;);</span><br></pre></td></tr></table></figure>
<h2 id="3-结果">3. 结果</h2>
<p>这里导入稻妻地图作为路径规划的示例，该地图多为岛屿，路径复杂，障碍物分散且数量多，十分适合作为示例使用。<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/fcf59433821c1051a8f8714547d79018.png#pic_center" alt="稻妻地图"><br>
将其灰度化得到<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/124b144e99366faa9e582a913fc277e3.jpeg#pic_center" alt="灰度稻妻"><br>
把地图划分为 m × n = 150 × 150 m \times n = 150 \times 150 m×n=150×150的栅格，并设置起点为 ( 10 , 20 ) (10,20) (10,20)，终点为 ( 130 , 80 ) (130,80) (130,80)：<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/50113f38beb35b89434c28535c12ba1b.png#pic_center" alt="稻妻地图栅格"><br>
图中绿色为起点，红色为终点。</p>
<p>路径规划结果：<br>
<img src="https://i-blog.csdnimg.cn/blog_migrate/8a875e6b8ffc0c48064351488be0d262.png#pic_center" alt="稻妻路径规划"><br>
可以看出，A* 算法可以找到期望路径。</p>
<p>文件所有代码在笔者的资源<a target="_blank" rel="noopener" href="https://download.csdn.net/download/weixin_58399148/43085850">二维A*算法路径规划matlab代码</a>中可以下载得到。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/04/14/Algorithms/Astar%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BF%9D%E5%A7%86%E7%BA%A7%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2023/04/12/Algorithms/Dijkstra%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/"
                            aria-label=": Dijkstra简单介绍"
                        >
                            Dijkstra简单介绍
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2023-04-12T22:53:09+08:00">
	
		    2023 年 4 月 12 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%AE%97%E6%B3%95/">算法</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>不是有个叫迪杰斯特拉(Dijkstra)的算法吗？名字难记不说，加权图的最短路径问题在实际开发中也很少需要自己实现，所以总是很快就忘了。。。</p>
<h2 id="迪杰斯特拉算法是什么"><a href="#%E8%BF%AA%E6%9D%B0%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95%E6%98%AF%E4%BB%80%E4%B9%88"></a>迪杰斯特拉算法是什么</h2>
<p>迪杰斯特拉算法是一种用于求解图的最短路径的算法。很多人可能只是听过这个名字。虽然它的原理简单易懂，但初次接触可能有些难以理解，不过只要逐步分析就会发现它其实是一个相当直观的算法。<br>
对于没有权重的迷宫搜索等问题，可以用广度优先搜索(BFS)解决，但如果每条边都有权重，就需要计算所有可能的路径。假设每个顶点只经过一次，且有E条边，那么时间复杂度会是O(E!)，计算量会爆炸式增长。<br>
这样计算起来就很不现实。</p>
<p>而迪杰斯特拉算法正是高效解决这类问题的算法。</p>
<p>需要注意的是，各边的成本必须是非负值（大于等于0）。如果包含负数，则需要使用贝尔曼-福特(Bellman-Ford)等算法。</p>
<h2 id="步骤"><a href="#%E6%AD%A5%E9%AA%A4"></a>步骤</h2>
<p>迪杰斯特拉算法的步骤非常简单：</p>
<ol>
<li>将起点的最短距离设为0</li>
<li>从未访问的点中选择已知最短距离且距离最小的顶点移动</li>
<li>设置该顶点连接的其他顶点的最短距离。如果可以更新更短的距离，则更新。</li>
<li>重复以上步骤，直到所有顶点的最短距离都确定</li>
</ol>
<p>光这么说可能有点抽象，下面我们通过一个具体例子来说明。</p>
<h2 id="示例"><a href="#%E7%A4%BA%E4%BE%8B"></a>示例</h2>
<p>虽然方法很原始，但这是最能表达清楚的方式…<br>
我们来看下面这张图的最短路径：<br>
<a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F90f90a2f-8991-1bc5-adb4-fb4b053a901f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b9d055575e737f8a2c459474e25322c7"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F90f90a2f-8991-1bc5-adb4-fb4b053a901f.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b9d055575e737f8a2c459474e25322c7" alt="image.png"></a></p>
<p>绿色表示最短路径已确定并已访问的顶点，红色是起点顶点。每个顶点上的数字表示当前的最短路径：<br>
<a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2Fae1ddc01-e867-8894-7aee-3940269cfe2e.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0b8d3bd32321d163185bac4e6ecf4db7"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2Fae1ddc01-e867-8894-7aee-3940269cfe2e.gif?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0b8d3bd32321d163185bac4e6ecf4db7" alt="dijkstra algo.gif"></a></p>
<p>可以看到，算法从起点开始，每次移动到当前最短路径的顶点，并计算相邻顶点的最短路径。</p>
<h2 id="实现"><a href="#%E5%AE%9E%E7%8E%B0"></a>实现</h2>
<p>接下来我们来实现这个算法。<br>
按照上述步骤直接实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params">nodes</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> start = nodes[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">// 记录已访问的顶点</span></span><br><span class="line">    <span class="keyword">const</span> visited = <span class="keyword">new</span> <span class="title class_">Set</span>()</span><br><span class="line">    <span class="keyword">const</span> routesFromStart = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">     <span class="comment">// 记录从起点出发的距离</span></span><br><span class="line"></span><br><span class="line">    routesFromStart.<span class="title function_">set</span>(start, &#123;<span class="attr">distance</span>: <span class="number">0</span>&#125;)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> n <span class="keyword">of</span> nodes) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n != start) &#123;</span><br><span class="line">            <span class="comment">// 除起点外所有顶点初始化为无穷大</span></span><br><span class="line">            routesFromStart.<span class="title function_">set</span>(n, &#123;<span class="attr">distance</span>: <span class="title class_">Number</span>.<span class="property">MAX_VALUE</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> current = start</span><br><span class="line">    <span class="keyword">let</span> routes = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">    <span class="keyword">while</span>(current != <span class="literal">null</span>) &#123;</span><br><span class="line">        visited.<span class="title function_">add</span>(current)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> edge <span class="keyword">of</span> current.<span class="property">edges</span>) &#123;</span><br><span class="line">             <span class="comment">// 计算相邻顶点的最短距离，如果更小则更新</span></span><br><span class="line">            <span class="keyword">if</span>(edge.<span class="property">cost</span> + routesFromStart.<span class="title function_">get</span>(current).<span class="property">distance</span> &lt; routesFromStart.<span class="title function_">get</span>(edge.<span class="property">to</span>).<span class="property">distance</span>) &#123;</span><br><span class="line">                routesFromStart.<span class="title function_">set</span>(edge.<span class="property">to</span>, &#123;<span class="attr">distance</span>: edge.<span class="property">cost</span> + routesFromStart.<span class="title function_">get</span>(current).<span class="property">distance</span>&#125;)</span><br><span class="line">                routes.<span class="title function_">set</span>(current, edge.<span class="property">to</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> cheapestNodeDistance = <span class="title class_">Number</span>.<span class="property">MAX_VALUE</span></span><br><span class="line">        current = <span class="literal">null</span></span><br><span class="line">        <span class="comment">// 从已计算最短距离的未访问顶点中选择最小的顶点</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> city <span class="keyword">of</span> routesFromStart.<span class="title function_">keys</span>()) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!visited.<span class="title function_">has</span>(city) &amp;&amp; cheapestNodeDistance &gt; routesFromStart.<span class="title function_">get</span>(city).<span class="property">distance</span>)&#123;</span><br><span class="line">                cheapestNodeDistance = routesFromStart.<span class="title function_">get</span>(city).<span class="property">distance</span></span><br><span class="line">                current = city</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> routesFromStart.<span class="title function_">get</span>(nodes[nodes.<span class="property">length</span> - <span class="number">1</span>]).<span class="property">distance</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>假设顶点数为V，这段代码在最坏情况下需要遍历所有边，并在内部循环中选择最小顶点，因此时间复杂度是O(V² + E)。空间复杂度需要记录每个顶点，所以是O(V)。</p>
<h2 id="关于使用优先队列的实现"><a href="#%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E7%9A%84%E5%AE%9E%E7%8E%B0"></a>关于使用优先队列的实现</h2>
<p>细心的读者可能已经发现，这段代码中选取最小顶点的逻辑可以优化，这就是优先队列(Priority Queue)。<br>
优先队列的插入和取出操作需要O(logN)的时间复杂度，但比线性搜索最小顶点更快。</p>
<p>JavaScript没有内置优先队列，以下是Python实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">nodes</span>):</span><br><span class="line">    start_node = nodes[<span class="number">0</span>]</span><br><span class="line">    routes_from_start = &#123;n: math.inf <span class="keyword">for</span> n <span class="keyword">in</span> nodes&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 起点距离设为0</span></span><br><span class="line">    routes_from_start[start_node] = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    minHeap = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 添加起点</span></span><br><span class="line">    heappush(minHeap, (<span class="number">0</span>, start_node))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 直到堆为空</span></span><br><span class="line">    <span class="keyword">while</span> minHeap:</span><br><span class="line">        (cost, current_node) = heappop(minHeap)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查priority key是否重复</span></span><br><span class="line">        <span class="keyword">if</span> cost &gt; routes_from_start[current_node]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> node <span class="keyword">in</span> current_node.routes:</span><br><span class="line">            price_info = current_node.routes[node]</span><br><span class="line">            <span class="keyword">if</span> routes_from_start[node] &gt; price_info + routes_from_start[current_node]:</span><br><span class="line">                routes_from_start[node] = price_info + routes_from_start[current_node]</span><br><span class="line">                <span class="comment"># 记录更新最短距离的节点</span></span><br><span class="line">                heappush(minHeap, (price_info + routes_from_start[current_node], node))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> routes_from_start[nodes[-<span class="number">1</span>]]</span><br></pre></td></tr></table></figure>
<p>优先队列的说明我们以后再讨论。<br>
优化后的算法时间复杂度为O(V + ElogE)，比最初的实现更高效。</p>
<h2 id="记录路径"><a href="#%E8%AE%B0%E5%BD%95%E8%B7%AF%E5%BE%84"></a>记录路径</h2>
<p>现在我们已经能求出最短成本，但这是&quot;最短路径&quot;问题，我们自然还想知道具体路径。<br>
改进上面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">nodes</span>):</span><br><span class="line">    start_node = nodes[<span class="number">0</span>]</span><br><span class="line">    routes_from_start = &#123;n: math.inf <span class="keyword">for</span> n <span class="keyword">in</span> nodes&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 起点距离设为0</span></span><br><span class="line">    routes_from_start[start_node] = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    minHeap = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 添加起点</span></span><br><span class="line">    heappush(minHeap, (<span class="number">0</span>, start_node))</span><br><span class="line">    path = collections.defaultdict(Node)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 直到堆为空</span></span><br><span class="line">    <span class="keyword">while</span> minHeap:</span><br><span class="line">        (cost, current_node) = heappop(minHeap)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查priority key是否重复</span></span><br><span class="line">        <span class="keyword">if</span> cost &gt; routes_from_start[current_node]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> node <span class="keyword">in</span> current_node.routes:</span><br><span class="line">            price_info = current_node.routes[node]</span><br><span class="line">            <span class="keyword">if</span> routes_from_start[node] &gt; price_info + routes_from_start[current_node]:</span><br><span class="line">                routes_from_start[node] = price_info + routes_from_start[current_node]</span><br><span class="line">                <span class="comment"># 记录更新最短距离的节点</span></span><br><span class="line">                path[node.<span class="built_in">id</span>] = current_node.<span class="built_in">id</span></span><br><span class="line">                heappush(minHeap, (price_info + routes_from_start[current_node], node))</span><br><span class="line"></span><br><span class="line">    current_node = nodes[-<span class="number">1</span>].<span class="built_in">id</span></span><br><span class="line">    path_array = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 从终点回溯记录的最短路径节点</span></span><br><span class="line">    <span class="keyword">while</span> current_node:</span><br><span class="line">        path_array.append(current_node)</span><br><span class="line">        <span class="keyword">if</span> current_node <span class="keyword">not</span> <span class="keyword">in</span> path:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        current_node = path[current_node]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> routes_from_start[nodes[-<span class="number">1</span>]], path_array[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>迪杰斯特拉算法会记录更新最短距离的节点，最后回溯即可。时间复杂度会增加最短路径节点数的计算量。</p>
<h2 id="为什么这样能求出最短路径"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%99%E6%A0%B7%E8%83%BD%E6%B1%82%E5%87%BA%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84"></a>为什么这样能求出最短路径</h2>
<p>看到这里，很多人可能会想：算法本身很简单，实现也不难，但为什么能保证求出最短距离呢？我们简单验证一下：</p>
<p><a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F8623f00e-2046-445a-f386-6341b4bef518.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4286b7e1195710b30d6ffb7ab22967c7"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F8623f00e-2046-445a-f386-6341b4bef518.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=4286b7e1195710b30d6ffb7ab22967c7" alt="image.png"></a></p>
<p>假设集合L中的顶点到起点S的最短距离已确定，那么从L连接到的最小顶点也应该是S的最短距离。</p>
<p><a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F8eb04095-91e7-85e6-93f1-93cd7f927fa0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b64897102d0f8dec7ed56385248d0a06"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F8eb04095-91e7-85e6-93f1-93cd7f927fa0.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=b64897102d0f8dec7ed56385248d0a06" alt="image.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2Fa10dcc01-c558-6f52-3b6f-906cb3433456.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=57a5fb3ec3b55e91b33e0184905063aa"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2Fa10dcc01-c558-6f52-3b6f-906cb3433456.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=57a5fb3ec3b55e91b33e0184905063aa" alt="image.png"></a></p>
<p>在集合T中选取最小顶点i，则d[i] = min(T)。对于任意顶点k，最短距离d[k] ≥ d[i]是确定的，因为d[i]是最小值且各边权重非负。<br>
通过归纳法可以证明这一点。</p>
<p>其实这就是一个递推公式：</p>
<p>d[i] = min(k ⊂ T) + i到L中相邻顶点的最短距离</p>
<p>说到递推公式就想到动态规划(DP)。关于DP可以参考这篇文章：<br>
<a target="_blank" rel="noopener" href="https://qiita.com/drken/items/a5e6fe22863b7992efdb">https://qiita.com/drken/items/a5e6fe22863b7992efdb</a></p>
<p>用DP来看值的更新过程：<br>
<a target="_blank" rel="noopener" href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F800c0d89-06f7-335a-5195-2f47d85cc22c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=76478692796218d17f0ab00d2f2651b4"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F134294%2F800c0d89-06f7-335a-5195-2f47d85cc22c.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=76478692796218d17f0ab00d2f2651b4" alt="image.png"></a></p>
<p>纵轴表示迭代次数，横轴表示顶点。原来迪杰斯特拉算法是DP的一种啊。</p>
<h2 id="总结"><a href="#%E6%80%BB%E7%BB%93"></a>总结</h2>
<p>通过以上分析，迪杰斯特拉算法一旦理解后其实相当简单。以后在算法问题中遇到类似问题时，希望能快速联想到这个算法。<br>
*顺便说一句，我也想写一篇关于DP的文章</p>
<p>讲解视频可以在这里观看：<br>
<a target="_blank" rel="noopener" href="https://youtu.be/jz8b0q5R1Ss">https://youtu.be/jz8b0q5R1Ss</a></p>
<h2 id="参考"><a href="#%E5%8F%82%E8%80%83"></a>参考</h2>
<p><a target="_blank" rel="noopener" href="http://www.lab2.kuis.kyoto-u.ac.jp/~shuichi/algintro/alg-6s.pdf">http://www.lab2.kuis.kyoto-u.ac.jp/~shuichi/algintro/alg-6s.pdf</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=X1AsMlJdiok">https://www.youtube.com/watch?v=X1AsMlJdiok</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2023/04/12/Algorithms/Dijkstra%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">第 1 頁 共 1 頁</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>分享一些技術教程,命令備忘(cheat-sheet)等</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</br>資深技術顧問</br>數據科學家</br>Hit廣島觀光大使</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macau
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/27/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"
                            aria-label=": R语言-环境安装"
                        >
                            <h3 class="media-heading">R语言-环境安装</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月27日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/28/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E5%9F%BA%E7%A1%80/"
                            aria-label=": R语言-基础"
                        >
                            <h3 class="media-heading">R语言-基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/01/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE/"
                            aria-label=": R语言-读取数据"
                        >
                            <h3 class="media-heading">R语言-读取数据</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/02/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BB%98%E5%9B%BE/"
                            aria-label=": R语言-绘图"
                        >
                            <h3 class="media-heading">R语言-绘图</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月2日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/03/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"
                            aria-label=": R语言-线性回归"
                        >
                            <h3 class="media-heading">R语言-线性回归</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月3日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/22/Algorithms/1.%E7%AE%97%E6%B3%95%E5%9C%A8%E8%AE%A1%E7%AE%97%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8/"
                            aria-label=": 1. 算法在计算中的作用"
                        >
                            <h3 class="media-heading">1. 算法在计算中的作用</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月22日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/23/Algorithms/2.%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/"
                            aria-label=": 2. 算法基础"
                        >
                            <h3 class="media-heading">2. 算法基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月23日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/24/Algorithms/3.%E5%87%BD%E6%95%B0%E7%9A%84%E5%A2%9E%E9%95%BF/"
                            aria-label=": 3. 函数的增长"
                        >
                            <h3 class="media-heading">3. 函数的增长</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月24日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/25/Algorithms/4.%E5%88%86%E6%B2%BB%E7%AD%96%E7%95%A5/"
                            aria-label=": 4. 分治策略"
                        >
                            <h3 class="media-heading">4. 分治策略</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月25日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/26/Algorithms/5.%E6%A6%82%E7%8E%87%E5%88%86%E6%9E%90%E5%92%8C%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95/"
                            aria-label=": 5. 概率分析和随机算法"
                        >
                            <h3 class="media-heading">5. 概率分析和随机算法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月26日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 198 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
