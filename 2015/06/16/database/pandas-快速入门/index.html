
<!DOCTYPE html>
<html lang="zh-tw">
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">

    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    
      <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/locale/zh-tw.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script>
      window.algoliaConfig = {
        appId: 'AWFC86Q51O',
        apiKey: 'c9d952906eb1b154d75cf863e75c1ede',
        indexName: 'MyBlog'
      };
      var algoliaIndex = algoliasearch(
        algoliaConfig.appId,
        algoliaConfig.apiKey
      ).initIndex(algoliaConfig.indexName);
    </script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>pandas 快速入门 - Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kein Chan","sameAs":["https://github.com/chankein/","https://www.linkedin.com/profile/","mailto:kein.chan85@gmail.com"],"image":"profile.jpg"},"articleBody":"pandas 快速入门#\n这是 pandas 的一个简短介绍，主要面向新用户。你可以在实用代码片段中查看更复杂的示例。\n通常，我们按如下方式导入\n123In [1]: import numpy as npIn [2]: import pandas as pd\npandas 中的基本数据结构#\nPandas 提供了两种用于处理数据的类\n\n\nSeries：一个一维的带标签数组，可容纳任何类型的数据\n例如整数、字符串、Python 对象等。\n\n\nDataFrame：一个二维数据结构，像二维数组或带有行和列的表格一样容纳数据。\n\n\n对象创建#\n请参阅数据结构简介部分。\n通过传入值列表创建Series，让 pandas 创建默认的RangeIndex。\n1234567891011In [3]: s = pd.Series([1, 3, 5, np.nan, 6, 8])In [4]: sOut[4]: 0    1.01    3.02    5.03    NaN4    6.05    8.0dtype: float64\n通过传入 NumPy 数组，使用date_range()创建带有日期时间索引和标签列的DataFrame\n12345678910111213141516171819In [5]: dates = pd.date_range(&quot;20130101&quot;, periods=6)In [6]: datesOut[6]: DatetimeIndex([&#x27;2013-01-01&#x27;, &#x27;2013-01-02&#x27;, &#x27;2013-01-03&#x27;, &#x27;2013-01-04&#x27;,               &#x27;2013-01-05&#x27;, &#x27;2013-01-06&#x27;],              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)In [7]: df = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list(&quot;ABCD&quot;))In [8]: dfOut[8]:                    A         B         C         D2013-01-01  0.469112 -0.282863 -1.509059 -1.1356322013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-03 -0.861849 -2.104569 -0.494929  1.0718042013-01-04  0.721555 -0.706771 -1.039575  0.2718602013-01-05 -0.424972  0.567020  0.276232 -1.0874012013-01-06 -0.673690  0.113648 -1.478427  0.524988\n通过传入一个对象字典创建DataFrame，其中键是列标签，值是列值。\n12345678910111213141516171819In [9]: df2 = pd.DataFrame(   ...:     &#123;   ...:         &quot;A&quot;: 1.0,   ...:         &quot;B&quot;: pd.Timestamp(&quot;20130102&quot;),   ...:         &quot;C&quot;: pd.Series(1, index=list(range(4)), dtype=&quot;float32&quot;),   ...:         &quot;D&quot;: np.array([3] * 4, dtype=&quot;int32&quot;),   ...:         &quot;E&quot;: pd.Categorical([&quot;test&quot;, &quot;train&quot;, &quot;test&quot;, &quot;train&quot;]),   ...:         &quot;F&quot;: &quot;foo&quot;,   ...:     &#125;   ...: )   ...: In [10]: df2Out[10]:      A          B    C  D      E    F0  1.0 2013-01-02  1.0  3   test  foo1  1.0 2013-01-02  1.0  3  train  foo2  1.0 2013-01-02  1.0  3   test  foo3  1.0 2013-01-02  1.0  3  train  foo\n生成的DataFrame的列具有不同的dtypes\n123456789In [11]: df2.dtypesOut[11]: A          float64B    datetime64[s]C          float32D            int32E         categoryF           objectdtype: object\n如果你使用 IPython，列名（以及公共属性）的 Tab 自动补全功能会自动启用。以下是部分将自动补全的属性：\n12345678910111213In [12]: df2.&lt;TAB&gt;  # noqa: E225, E999df2.A                  df2.booldf2.abs                df2.boxplotdf2.add                df2.Cdf2.add_prefix         df2.clipdf2.add_suffix         df2.columnsdf2.align              df2.copydf2.all                df2.countdf2.any                df2.combinedf2.append             df2.Ddf2.apply              df2.describedf2.applymap           df2.diffdf2.B                  df2.duplicated\n如你所见，列 A、B、C 和 D 会自动 Tab 补全。E 和 F 也在其中；其余属性为简洁起见已被截断。\n查看数据#\n请参阅基本核心功能部分。\n使用DataFrame.head()和DataFrame.tail()分别查看框架的顶部和底部行。\n123456789101112131415In [13]: df.head()Out[13]:                    A         B         C         D2013-01-01  0.469112 -0.282863 -1.509059 -1.1356322013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-03 -0.861849 -2.104569 -0.494929  1.0718042013-01-04  0.721555 -0.706771 -1.039575  0.2718602013-01-05 -0.424972  0.567020  0.276232 -1.087401In [14]: df.tail(3)Out[14]:                    A         B         C         D2013-01-04  0.721555 -0.706771 -1.039575  0.2718602013-01-05 -0.424972  0.567020  0.276232 -1.0874012013-01-06 -0.673690  0.113648 -1.478427  0.524988\n显示DataFrame.index或DataFrame.columns\n12345678In [15]: df.indexOut[15]: DatetimeIndex([&#x27;2013-01-01&#x27;, &#x27;2013-01-02&#x27;, &#x27;2013-01-03&#x27;, &#x27;2013-01-04&#x27;,               &#x27;2013-01-05&#x27;, &#x27;2013-01-06&#x27;],              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)In [16]: df.columnsOut[16]: Index([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;], dtype=&#x27;object&#x27;)\n使用DataFrame.to_numpy()返回底层数据的 NumPy 表示，不包含索引或列标签。\n12345678In [17]: df.to_numpy()Out[17]: array([[ 0.4691, -0.2829, -1.5091, -1.1356],       [ 1.2121, -0.1732,  0.1192, -1.0442],       [-0.8618, -2.1046, -0.4949,  1.0718],       [ 0.7216, -0.7068, -1.0396,  0.2719],       [-0.425 ,  0.567 ,  0.2762, -1.0874],       [-0.6737,  0.1136, -1.4784,  0.525 ]])\n注意\nNumPy 数组的整个数组只有一个 dtype，而 pandas DataFrames 的每列有一个 dtype。当你调用DataFrame.to_numpy()时，pandas 会找到能够容纳 DataFrame 中 所有 dtypes 的 NumPy dtype。如果共同的数据类型是 object，则DataFrame.to_numpy()将需要复制数据。\n1234567891011121314151617In [18]: df2.dtypesOut[18]: A          float64B    datetime64[s]C          float32D            int32E         categoryF           objectdtype: objectIn [19]: df2.to_numpy()Out[19]: array([[1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;test&#x27;, &#x27;foo&#x27;],       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;train&#x27;, &#x27;foo&#x27;],       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;test&#x27;, &#x27;foo&#x27;],       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;train&#x27;, &#x27;foo&#x27;]],      dtype=object)\ndescribe()显示数据的快速统计摘要\n1234567891011In [20]: df.describe()Out[20]:               A         B         C         Dcount  6.000000  6.000000  6.000000  6.000000mean   0.073711 -0.431125 -0.687758 -0.233103std    0.843157  0.922818  0.779887  0.973118min   -0.861849 -2.104569 -1.509059 -1.13563225%   -0.611510 -0.600794 -1.368714 -1.07661050%    0.022070 -0.228039 -0.767252 -0.38618875%    0.658444  0.041933 -0.034326  0.461706max    1.212112  0.567020  0.276232  1.071804\n转置数据\n1234567In [21]: df.TOut[21]:    2013-01-01  2013-01-02  2013-01-03  2013-01-04  2013-01-05  2013-01-06A    0.469112    1.212112   -0.861849    0.721555   -0.424972   -0.673690B   -0.282863   -0.173215   -2.104569   -0.706771    0.567020    0.113648C   -1.509059    0.119209   -0.494929   -1.039575    0.276232   -1.478427D   -1.135632   -1.044236    1.071804    0.271860   -1.087401    0.524988\nDataFrame.sort_index()按轴排序\n123456789In [22]: df.sort_index(axis=1, ascending=False)Out[22]:                    D         C         B         A2013-01-01 -1.135632 -1.509059 -0.282863  0.4691122013-01-02 -1.044236  0.119209 -0.173215  1.2121122013-01-03  1.071804 -0.494929 -2.104569 -0.8618492013-01-04  0.271860 -1.039575 -0.706771  0.7215552013-01-05 -1.087401  0.276232  0.567020 -0.4249722013-01-06  0.524988 -1.478427  0.113648 -0.673690\nDataFrame.sort_values()按值排序\n123456789In [23]: df.sort_values(by=&quot;B&quot;)Out[23]:                    A         B         C         D2013-01-03 -0.861849 -2.104569 -0.494929  1.0718042013-01-04  0.721555 -0.706771 -1.039575  0.2718602013-01-01  0.469112 -0.282863 -1.509059 -1.1356322013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-06 -0.673690  0.113648 -1.478427  0.5249882013-01-05 -0.424972  0.567020  0.276232 -1.087401\n选择#\n请参阅索引文档索引与选择数据和MultiIndex / 高级索引。\nGetitem ([])#\n对于DataFrame，传入单个标签会选择一列并生成一个Series，等同于 df.A\n123456789In [24]: df[&quot;A&quot;]Out[24]: 2013-01-01    0.4691122013-01-02    1.2121122013-01-03   -0.8618492013-01-04    0.7215552013-01-05   -0.4249722013-01-06   -0.673690Freq: D, Name: A, dtype: float64\n对于DataFrame，传入切片 : 会选择匹配的行。\n12345678910111213In [25]: df[0:3]Out[25]:                    A         B         C         D2013-01-01  0.469112 -0.282863 -1.509059 -1.1356322013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-03 -0.861849 -2.104569 -0.494929  1.071804In [26]: df[&quot;20130102&quot;:&quot;20130104&quot;]Out[26]:                    A         B         C         D2013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-03 -0.861849 -2.104569 -0.494929  1.0718042013-01-04  0.721555 -0.706771 -1.039575  0.271860\n按标签选择#\n更多信息请参阅按标签选择，使用DataFrame.loc()或DataFrame.at()。\n选择与标签匹配的行\n1234567In [27]: df.loc[dates[0]]Out[27]: A    0.469112B   -0.282863C   -1.509059D   -1.135632Name: 2013-01-01 00:00:00, dtype: float64\n选择所有行 (:) 和选定的列标签\n123456789In [28]: df.loc[:, [&quot;A&quot;, &quot;B&quot;]]Out[28]:                    A         B2013-01-01  0.469112 -0.2828632013-01-02  1.212112 -0.1732152013-01-03 -0.861849 -2.1045692013-01-04  0.721555 -0.7067712013-01-05 -0.424972  0.5670202013-01-06 -0.673690  0.113648\n对于标签切片，两个端点都包含在内\n123456In [29]: df.loc[&quot;20130102&quot;:&quot;20130104&quot;, [&quot;A&quot;, &quot;B&quot;]]Out[29]:                    A         B2013-01-02  1.212112 -0.1732152013-01-03 -0.861849 -2.1045692013-01-04  0.721555 -0.706771\n选择单个行和列标签会返回一个标量\n12In [30]: df.loc[dates[0], &quot;A&quot;]Out[30]: 0.4691122999071863\n为了快速访问标量（等同于之前的方法）\n12In [31]: df.at[dates[0], &quot;A&quot;]Out[31]: 0.4691122999071863\n按位置选择#\n更多信息请参阅按位置选择，使用DataFrame.iloc()或DataFrame.iat()。\n通过传入整数的位置进行选择\n1234567In [32]: df.iloc[3]Out[32]: A    0.721555B   -0.706771C   -1.039575D    0.271860Name: 2013-01-04 00:00:00, dtype: float64\n整数切片行为类似于 NumPy/Python\n12345In [33]: df.iloc[3:5, 0:2]Out[33]:                    A         B2013-01-04  0.721555 -0.7067712013-01-05 -0.424972  0.567020\n整数位置列表\n123456In [34]: df.iloc[[1, 2, 4], [0, 2]]Out[34]:                    A         C2013-01-02  1.212112  0.1192092013-01-03 -0.861849 -0.4949292013-01-05 -0.424972  0.276232\n显式切片行\n12345In [35]: df.iloc[1:3, :]Out[35]:                    A         B         C         D2013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-03 -0.861849 -2.104569 -0.494929  1.071804\n显式切片列\n123456789In [36]: df.iloc[:, 1:3]Out[36]:                    B         C2013-01-01 -0.282863 -1.5090592013-01-02 -0.173215  0.1192092013-01-03 -2.104569 -0.4949292013-01-04 -0.706771 -1.0395752013-01-05  0.567020  0.2762322013-01-06  0.113648 -1.478427\n显式获取值\n12In [37]: df.iloc[1, 1]Out[37]: -0.17321464905330858\n为了快速访问标量（等同于之前的方法）\n12In [38]: df.iat[1, 1]Out[38]: -0.17321464905330858\n布尔索引#\n选择 df.A 大于 0 的行。\n123456In [39]: df[df[&quot;A&quot;] &gt; 0]Out[39]:                    A         B         C         D2013-01-01  0.469112 -0.282863 -1.509059 -1.1356322013-01-02  1.212112 -0.173215  0.119209 -1.0442362013-01-04  0.721555 -0.706771 -1.039575  0.271860\n从满足布尔条件的DataFrame中选择值\n123456789In [40]: df[df &gt; 0]Out[40]:                    A         B         C         D2013-01-01  0.469112       NaN       NaN       NaN2013-01-02  1.212112       NaN  0.119209       NaN2013-01-03       NaN       NaN       NaN  1.0718042013-01-04  0.721555       NaN       NaN  0.2718602013-01-05       NaN  0.567020  0.276232       NaN2013-01-06       NaN  0.113648       NaN  0.524988\n使用isin()方法进行过滤\n12345678910111213141516171819In [41]: df2 = df.copy()In [42]: df2[&quot;E&quot;] = [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;three&quot;]In [43]: df2Out[43]:                    A         B         C         D      E2013-01-01  0.469112 -0.282863 -1.509059 -1.135632    one2013-01-02  1.212112 -0.173215  0.119209 -1.044236    one2013-01-03 -0.861849 -2.104569 -0.494929  1.071804    two2013-01-04  0.721555 -0.706771 -1.039575  0.271860  three2013-01-05 -0.424972  0.567020  0.276232 -1.087401   four2013-01-06 -0.673690  0.113648 -1.478427  0.524988  threeIn [44]: df2[df2[&quot;E&quot;].isin([&quot;two&quot;, &quot;four&quot;])]Out[44]:                    A         B         C         D     E2013-01-03 -0.861849 -2.104569 -0.494929  1.071804   two2013-01-05 -0.424972  0.567020  0.276232 -1.087401  four\n设置#\n设置新列会自动按索引对齐数据\n12345678910111213In [45]: s1 = pd.Series([1, 2, 3, 4, 5, 6], index=pd.date_range(&quot;20130102&quot;, periods=6))In [46]: s1Out[46]: 2013-01-02    12013-01-03    22013-01-04    32013-01-05    42013-01-06    52013-01-07    6Freq: D, dtype: int64In [47]: df[&quot;F&quot;] = s1\n按标签设置值\n1In [48]: df.at[dates[0], &quot;A&quot;] = 0\n按位置设置值\n1In [49]: df.iat[0, 1] = 0\n通过分配 NumPy 数组进行设置\n1In [50]: df.loc[:, &quot;D&quot;] = np.array([5] * len(df))\n先前的设置操作的结果\n123456789In [51]: dfOut[51]:                    A         B         C    D    F2013-01-01  0.000000  0.000000 -1.509059  5.0  NaN2013-01-02  1.212112 -0.173215  0.119209  5.0  1.02013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.02013-01-04  0.721555 -0.706771 -1.039575  5.0  3.02013-01-05 -0.424972  0.567020  0.276232  5.0  4.02013-01-06 -0.673690  0.113648 -1.478427  5.0  5.0\n带设置的 where 操作\n12345678910111213In [52]: df2 = df.copy()In [53]: df2[df2 &gt; 0] = -df2In [54]: df2Out[54]:                    A         B         C    D    F2013-01-01  0.000000  0.000000 -1.509059 -5.0  NaN2013-01-02 -1.212112 -0.173215 -0.119209 -5.0 -1.02013-01-03 -0.861849 -2.104569 -0.494929 -5.0 -2.02013-01-04 -0.721555 -0.706771 -1.039575 -5.0 -3.02013-01-05 -0.424972 -0.567020 -0.276232 -5.0 -4.02013-01-06 -0.673690 -0.113648 -1.478427 -5.0 -5.0\n缺失数据#\n对于 NumPy 数据类型，np.nan 表示缺失数据。默认情况下，它不包含在计算中。请参阅缺失数据部分。\n重新索引允许你更改/添加/删除指定轴上的索引。这会返回数据的副本。\n1234567891011In [55]: df1 = df.reindex(index=dates[0:4], columns=list(df.columns) + [&quot;E&quot;])In [56]: df1.loc[dates[0] : dates[1], &quot;E&quot;] = 1In [57]: df1Out[57]:                    A         B         C    D    F    E2013-01-01  0.000000  0.000000 -1.509059  5.0  NaN  1.02013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.02013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.0  NaN2013-01-04  0.721555 -0.706771 -1.039575  5.0  3.0  NaN\nDataFrame.dropna()删除任何包含缺失数据的行\n1234In [58]: df1.dropna(how=&quot;any&quot;)Out[58]:                    A         B         C    D    F    E2013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.0\nDataFrame.fillna()填充缺失数据\n1234567In [59]: df1.fillna(value=5)Out[59]:                    A         B         C    D    F    E2013-01-01  0.000000  0.000000 -1.509059  5.0  5.0  1.02013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.02013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.0  5.02013-01-04  0.721555 -0.706771 -1.039575  5.0  3.0  5.0\nisna()获取值为 nan 的布尔掩码\n1234567In [60]: pd.isna(df1)Out[60]:                 A      B      C      D      F      E2013-01-01  False  False  False  False   True  False2013-01-02  False  False  False  False  False  False2013-01-03  False  False  False  False  False   True2013-01-04  False  False  False  False  False   True\n操作#\n请参阅二元运算基本部分。\n统计#\n操作通常排除缺失数据。\n计算每列的平均值\n12345678In [61]: df.mean()Out[61]: A   -0.004474B   -0.383981C   -0.687758D    5.000000F    3.000000dtype: float64\n计算每行的平均值\n123456789In [62]: df.mean(axis=1)Out[62]: 2013-01-01    0.8727352013-01-02    1.4316212013-01-03    0.7077312013-01-04    1.3950422013-01-05    1.8836562013-01-06    1.592306Freq: D, dtype: float64\n与具有不同索引或列的另一个Series或DataFrame进行操作时，结果将与索引或列标签的并集对齐。此外，pandas 会沿指定维度自动广播，并将未对齐的标签填充为np.nan。\n123456789101112131415161718192021In [63]: s = pd.Series([1, 3, 5, np.nan, 6, 8], index=dates).shift(2)In [64]: sOut[64]: 2013-01-01    NaN2013-01-02    NaN2013-01-03    1.02013-01-04    3.02013-01-05    5.02013-01-06    NaNFreq: D, dtype: float64In [65]: df.sub(s, axis=&quot;index&quot;)Out[65]:                    A         B         C    D    F2013-01-01       NaN       NaN       NaN  NaN  NaN2013-01-02       NaN       NaN       NaN  NaN  NaN2013-01-03 -1.861849 -3.104569 -1.494929  4.0  1.02013-01-04 -2.278445 -3.706771 -4.039575  2.0  0.02013-01-05 -5.424972 -4.432980 -4.723768  0.0 -1.02013-01-06       NaN       NaN       NaN  NaN  NaN\n用户定义函数#\nDataFrame.agg()和DataFrame.transform()分别应用一个用户定义函数，该函数会减少或广播其结果。\n123456789101112131415161718In [66]: df.agg(lambda x: np.mean(x) * 5.6)Out[66]: A    -0.025054B    -2.150294C    -3.851445D    28.000000F    16.800000dtype: float64In [67]: df.transform(lambda x: x * 101.2)Out[67]:                      A           B           C      D      F2013-01-01    0.000000    0.000000 -152.716721  506.0    NaN2013-01-02  122.665737  -17.529322   12.063922  506.0  101.22013-01-03  -87.219115 -212.982405  -50.086843  506.0  202.42013-01-04   73.021382  -71.525239 -105.204988  506.0  303.62013-01-05  -43.007200   57.382459   27.954680  506.0  404.82013-01-06  -68.177398   11.501219 -149.616767  506.0  506.0\n值计数#\n更多信息请参阅直方图和离散化。\n1234567891011121314151617181920212223In [68]: s = pd.Series(np.random.randint(0, 7, size=10))In [69]: sOut[69]: 0    41    22    13    24    65    46    47    68    49    4dtype: int64In [70]: s.value_counts()Out[70]: 4    52    26    21    1Name: count, dtype: int64\n字符串方法#\nSeries在 str 属性中配备了一组字符串处理方法，可以轻松地对数组的每个元素进行操作，如下面的代码片段所示。更多信息请参阅矢量化字符串方法。\n1234567891011121314In [71]: s = pd.Series([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;Aaba&quot;, &quot;Baca&quot;, np.nan, &quot;CABA&quot;, &quot;dog&quot;, &quot;cat&quot;])In [72]: s.str.lower()Out[72]: 0       a1       b2       c3    aaba4    baca5     NaN6    caba7     dog8     catdtype: object\n合并#\n拼接#\npandas 提供了各种功能，可以轻松地将 Series 和 DataFrame 对象与各种集合逻辑（用于索引）和关系代数功能（用于连接/合并类型操作）结合在一起。\n请参阅合并部分。\n使用concat()按行拼接 pandas 对象\n1234567891011121314151617181920212223242526272829303132In [73]: df = pd.DataFrame(np.random.randn(10, 4))In [74]: dfOut[74]:           0         1         2         30 -0.548702  1.467327 -1.015962 -0.4830751  1.637550 -1.217659 -0.291519 -1.7455052 -0.263952  0.991460 -0.919069  0.2660463 -0.709661  1.669052  1.037882 -1.7057754 -0.919854 -0.042379  1.247642 -0.0099205  0.290213  0.495767  0.362949  1.5481066 -1.131345 -0.089329  0.337863 -0.9458677 -0.932132  1.956030  0.017587 -0.0166928 -0.575247  0.254161 -1.143704  0.2158979  1.193555 -0.077118 -0.408530 -0.862495# break it into piecesIn [75]: pieces = [df[:3], df[3:7], df[7:]]In [76]: pd.concat(pieces)Out[76]:           0         1         2         30 -0.548702  1.467327 -1.015962 -0.4830751  1.637550 -1.217659 -0.291519 -1.7455052 -0.263952  0.991460 -0.919069  0.2660463 -0.709661  1.669052  1.037882 -1.7057754 -0.919854 -0.042379  1.247642 -0.0099205  0.290213  0.495767  0.362949  1.5481066 -1.131345 -0.089329  0.337863 -0.9458677 -0.932132  1.956030  0.017587 -0.0166928 -0.575247  0.254161 -1.143704  0.2158979  1.193555 -0.077118 -0.408530 -0.862495\n连接#\nmerge()支持沿着特定列进行 SQL 风格的连接。请参阅数据库风格连接部分。\n1234567891011121314151617181920212223In [77]: left = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;foo&quot;], &quot;lval&quot;: [1, 2]&#125;)In [78]: right = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;foo&quot;], &quot;rval&quot;: [4, 5]&#125;)In [79]: leftOut[79]:    key  lval0  foo     11  foo     2In [80]: rightOut[80]:    key  rval0  foo     41  foo     5In [81]: pd.merge(left, right, on=&quot;key&quot;)Out[81]:    key  lval  rval0  foo     1     41  foo     1     52  foo     2     43  foo     2     5\nmerge() 基于唯一键进行合并\n123456789101112131415161718192021In [82]: left = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;bar&quot;], &quot;lval&quot;: [1, 2]&#125;)In [83]: right = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;bar&quot;], &quot;rval&quot;: [4, 5]&#125;)In [84]: leftOut[84]:    key  lval0  foo     11  bar     2In [85]: rightOut[85]:    key  rval0  foo     41  bar     5In [86]: pd.merge(left, right, on=&quot;key&quot;)Out[86]:    key  lval  rval0  foo     1     41  bar     2     5\n分组#\n“分组”指的是一个或多个以下步骤的过程\n\n\n根据某些条件将数据分拆成组\n\n\n对每个组独立地应用一个函数\n\n\n将结果组合成一个数据结构\n\n\n请参阅分组部分。\n123456789101112131415161718192021In [87]: df = pd.DataFrame(   ....:     &#123;   ....:         &quot;A&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;foo&quot;],   ....:         &quot;B&quot;: [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;two&quot;, &quot;two&quot;, &quot;one&quot;, &quot;three&quot;],   ....:         &quot;C&quot;: np.random.randn(8),   ....:         &quot;D&quot;: np.random.randn(8),   ....:     &#125;   ....: )   ....: In [88]: dfOut[88]:      A      B         C         D0  foo    one  1.346061 -1.5775851  bar    one  1.511763  0.3968232  foo    two  1.627081 -0.1053813  bar  three -0.990582 -0.5325324  foo    two -0.441652  1.4537495  bar    two  1.211526  1.2088436  foo    one  0.268520 -0.0809527  foo  three  0.024580 -0.264610\n按列标签分组，选择列标签，然后将DataFrameGroupBy.sum()函数应用于结果组\n123456In [89]: df.groupby(&quot;A&quot;)[[&quot;C&quot;, &quot;D&quot;]].sum()Out[89]:             C         DA                      bar  1.732707  1.073134foo  2.824590 -0.574779\n按多列标签分组会形成MultiIndex。\n12345678910In [90]: df.groupby([&quot;A&quot;, &quot;B&quot;]).sum()Out[90]:                   C         DA   B                        bar one    1.511763  0.396823    three -0.990582 -0.532532    two    1.211526  1.208843foo one    1.614581 -1.658537    three  0.024580 -0.264610    two    1.185429  1.348368\n重塑#\n请参阅层次化索引和重塑部分。\n堆叠#\n1234567891011121314151617181920In [91]: arrays = [   ....:    [&quot;bar&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;baz&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;qux&quot;, &quot;qux&quot;],   ....:    [&quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;],   ....: ]   ....: In [92]: index = pd.MultiIndex.from_arrays(arrays, names=[&quot;first&quot;, &quot;second&quot;])In [93]: df = pd.DataFrame(np.random.randn(8, 2), index=index, columns=[&quot;A&quot;, &quot;B&quot;])In [94]: df2 = df[:4]In [95]: df2Out[95]:                      A         Bfirst second                    bar   one    -0.727965 -0.589346      two     0.339969 -0.693205baz   one    -0.339355  0.593616      two     0.884345  1.591431\nstack()方法“压缩”了 DataFrame 列中的一个层\n1234567891011121314In [96]: stacked = df2.stack(future_stack=True)In [97]: stackedOut[97]: first  second   bar    one     A   -0.727965               B   -0.589346       two     A    0.339969               B   -0.693205baz    one     A   -0.339355               B    0.593616       two     A    0.884345               B    1.591431dtype: float64\n对于一个“堆叠”的 DataFrame 或 Series（其 index 为 MultiIndex），stack() 的逆操作是 unstack()，它默认会解除堆叠最底层\n1234567891011121314151617181920212223242526In [98]: stacked.unstack()Out[98]:                      A         Bfirst second                    bar   one    -0.727965 -0.589346      two     0.339969 -0.693205baz   one    -0.339355  0.593616      two     0.884345  1.591431In [99]: stacked.unstack(1)Out[99]: second        one       twofirst                      bar   A -0.727965  0.339969      B -0.589346 -0.693205baz   A -0.339355  0.884345      B  0.593616  1.591431In [100]: stacked.unstack(0)Out[100]: first          bar       bazsecond                      one    A -0.727965 -0.339355       B -0.589346  0.593616two    A  0.339969  0.884345       B -0.693205  1.591431\n透视表#\n请参阅透视表部分。\n1234567891011121314151617181920212223242526In [101]: df = pd.DataFrame(   .....:     &#123;   .....:         &quot;A&quot;: [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;] * 3,   .....:         &quot;B&quot;: [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;] * 4,   .....:         &quot;C&quot;: [&quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;, &quot;bar&quot;] * 2,   .....:         &quot;D&quot;: np.random.randn(12),   .....:         &quot;E&quot;: np.random.randn(12),   .....:     &#125;   .....: )   .....: In [102]: dfOut[102]:         A  B    C         D         E0     one  A  foo -1.202872  0.0476091     one  B  foo -1.814470 -0.1364732     two  C  foo  1.018601 -0.5617573   three  A  bar -0.595447 -1.6230334     one  B  bar  1.395433  0.0293995     one  C  bar -0.392670 -0.5421086     two  A  foo  0.007207  0.2826967   three  B  foo  1.928123 -0.0873028     one  C  foo -0.055224 -1.5751709     one  A  bar  2.395985  1.77120810    two  B  bar  1.552825  0.81648211  three  C  bar  0.166599  1.100230\npivot_table()通过指定values、index和columns来透视DataFrame\n12345678910111213In [103]: pd.pivot_table(df, values=&quot;D&quot;, index=[&quot;A&quot;, &quot;B&quot;], columns=[&quot;C&quot;])Out[103]: C             bar       fooA     B                    one   A  2.395985 -1.202872      B  1.395433 -1.814470      C -0.392670 -0.055224three A -0.595447       NaN      B       NaN  1.928123      C  0.166599       NaNtwo   A       NaN  0.007207      B  1.552825       NaN      C       NaN  1.018601\n时间序列#\npandas 具有简单、强大且高效的功能，用于在频率转换期间执行重采样操作（例如，将秒级数据转换为 5 分钟级数据）。这在金融应用中非常常见，但不仅限于此。请参阅时间序列部分。\n12345678In [104]: rng = pd.date_range(&quot;1/1/2012&quot;, periods=100, freq=&quot;s&quot;)In [105]: ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng)In [106]: ts.resample(&quot;5Min&quot;).sum()Out[106]: 2012-01-01    24182Freq: 5min, dtype: int64\nSeries.tz_localize()将时间序列本地化到某个时区\n1234567891011121314151617181920212223In [107]: rng = pd.date_range(&quot;3/6/2012 00:00&quot;, periods=5, freq=&quot;D&quot;)In [108]: ts = pd.Series(np.random.randn(len(rng)), rng)In [109]: tsOut[109]: 2012-03-06    1.8577042012-03-07   -1.1935452012-03-08    0.6775102012-03-09   -0.1539312012-03-10    0.520091Freq: D, dtype: float64In [110]: ts_utc = ts.tz_localize(&quot;UTC&quot;)In [111]: ts_utcOut[111]: 2012-03-06 00:00:00+00:00    1.8577042012-03-07 00:00:00+00:00   -1.1935452012-03-08 00:00:00+00:00    0.6775102012-03-09 00:00:00+00:00   -0.1539312012-03-10 00:00:00+00:00    0.520091Freq: D, dtype: float64\nSeries.tz_convert()将时区感知的时间序列转换为另一个时区\n12345678In [112]: ts_utc.tz_convert(&quot;US/Eastern&quot;)Out[112]: 2012-03-05 19:00:00-05:00    1.8577042012-03-06 19:00:00-05:00   -1.1935452012-03-07 19:00:00-05:00    0.6775102012-03-08 19:00:00-05:00   -0.1539312012-03-09 19:00:00-05:00    0.520091Freq: D, dtype: float64\n向时间序列添加非固定时长（BusinessDay）\n1234567891011In [113]: rngOut[113]: DatetimeIndex([&#x27;2012-03-06&#x27;, &#x27;2012-03-07&#x27;, &#x27;2012-03-08&#x27;, &#x27;2012-03-09&#x27;,               &#x27;2012-03-10&#x27;],              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)In [114]: rng + pd.offsets.BusinessDay(5)Out[114]: DatetimeIndex([&#x27;2012-03-13&#x27;, &#x27;2012-03-14&#x27;, &#x27;2012-03-15&#x27;, &#x27;2012-03-16&#x27;,               &#x27;2012-03-16&#x27;],              dtype=&#x27;datetime64[ns]&#x27;, freq=None)\n分类数据#\npandas 可以在DataFrame中包含分类数据。有关完整文档，请参阅分类简介和API 文档。\n1234In [115]: df = pd.DataFrame(   .....:     &#123;&quot;id&quot;: [1, 2, 3, 4, 5, 6], &quot;raw_grade&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;a&quot;, &quot;a&quot;, &quot;e&quot;]&#125;   .....: )   .....: \n将原始等级转换为分类数据类型\n123456789101112In [116]: df[&quot;grade&quot;] = df[&quot;raw_grade&quot;].astype(&quot;category&quot;)In [117]: df[&quot;grade&quot;]Out[117]: 0    a1    b2    b3    a4    a5    eName: grade, dtype: categoryCategories (3, object): [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;e&#x27;]\n将类别重命名为更有意义的名称\n123In [118]: new_categories = [&quot;very good&quot;, &quot;good&quot;, &quot;very bad&quot;]In [119]: df[&quot;grade&quot;] = df[&quot;grade&quot;].cat.rename_categories(new_categories)\n重新排序类别并同时添加缺失的类别（Series.cat()下的方法默认返回一个新的Series）\n123456789101112131415In [120]: df[&quot;grade&quot;] = df[&quot;grade&quot;].cat.set_categories(   .....:     [&quot;very bad&quot;, &quot;bad&quot;, &quot;medium&quot;, &quot;good&quot;, &quot;very good&quot;]   .....: )   .....: In [121]: df[&quot;grade&quot;]Out[121]: 0    very good1         good2         good3    very good4    very good5     very badName: grade, dtype: categoryCategories (5, object): [&#x27;very bad&#x27;, &#x27;bad&#x27;, &#x27;medium&#x27;, &#x27;good&#x27;, &#x27;very good&#x27;]\n排序是按类别顺序，而不是字典顺序\n123456789In [122]: df.sort_values(by=&quot;grade&quot;)Out[122]:    id raw_grade      grade5   6         e   very bad1   2         b       good2   3         b       good0   1         a  very good3   4         a  very good4   5         a  very good\n使用 observed=False 按分类列分组也会显示空类别\n123456789In [123]: df.groupby(&quot;grade&quot;, observed=False).size()Out[123]: gradevery bad     1bad          0medium       0good         2very good    3dtype: int64\n绘图#\n请参阅绘图文档。\n我们使用标准约定来引用 matplotlib API\n123In [124]: import matplotlib.pyplot as pltIn [125]: plt.close(&quot;all&quot;)\nplt.close 方法用于关闭图形窗口\n12345In [126]: ts = pd.Series(np.random.randn(1000), index=pd.date_range(&quot;1/1/2000&quot;, periods=1000))In [127]: ts = ts.cumsum()In [128]: ts.plot();\n\nplot()绘制所有列\n123456789101112In [129]: df = pd.DataFrame(   .....:     np.random.randn(1000, 4), index=ts.index, columns=[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]   .....: )   .....: In [130]: df = df.cumsum()In [131]: plt.figure();In [132]: df.plot();In [133]: plt.legend(loc=&#x27;best&#x27;);\n\n导入和导出数据#\n请参阅IO 工具部分。\nCSV#\n写入 CSV 文件：使用DataFrame.to_csv()\n123In [134]: df = pd.DataFrame(np.random.randint(0, 5, (10, 5)))In [135]: df.to_csv(&quot;foo.csv&quot;)\n从 CSV 文件读取：使用read_csv()\n12345678910111213In [136]: pd.read_csv(&quot;foo.csv&quot;)Out[136]:    Unnamed: 0  0  1  2  3  40           0  4  3  1  1  21           1  1  0  2  3  22           2  1  4  2  1  23           3  0  4  0  2  24           4  4  2  2  3  45           5  4  0  4  3  16           6  2  1  2  0  37           7  4  0  4  4  48           8  4  4  1  0  19           9  0  4  3  0  3\nParquet#\n写入 Parquet 文件\n1In [137]: df.to_parquet(&quot;foo.parquet&quot;)\n使用read_parquet()从 Parquet 文件读取\n12345678910111213In [138]: pd.read_parquet(&quot;foo.parquet&quot;)Out[138]:    0  1  2  3  40  4  3  1  1  21  1  0  2  3  22  1  4  2  1  23  0  4  0  2  24  4  2  2  3  45  4  0  4  3  16  2  1  2  0  37  4  0  4  4  48  4  4  1  0  19  0  4  3  0  3\nExcel#\n读写Excel。\n使用DataFrame.to_excel()写入 Excel 文件\n1In [139]: df.to_excel(&quot;foo.xlsx&quot;, sheet_name=&quot;Sheet1&quot;)\n使用read_excel()从 Excel 文件读取\n12345678910111213In [140]: pd.read_excel(&quot;foo.xlsx&quot;, &quot;Sheet1&quot;, index_col=None, na_values=[&quot;NA&quot;])Out[140]:    Unnamed: 0  0  1  2  3  40           0  4  3  1  1  21           1  1  0  2  3  22           2  1  4  2  1  23           3  0  4  0  2  24           4  4  2  2  3  45           5  4  0  4  3  16           6  2  1  2  0  37           7  4  0  4  4  48           8  4  4  1  0  19           9  0  4  3  0  3\n常见陷阱#\n如果您尝试对Series或DataFrame执行布尔操作，可能会看到类似以下的异常：\n123456789101112131415161718In [141]: if pd.Series([False, True, False]):   .....:      print(&quot;I was true&quot;)   .....: ---------------------------------------------------------------------------ValueError                                Traceback (most recent call last)&lt;ipython-input-141-b27eb9c1dfc0&gt; in ?()----&gt; 1 if pd.Series([False, True, False]):      2      print(&quot;I was true&quot;)~/work/pandas/pandas/pandas/core/generic.py in ?(self)   1575     @final   1576     def __nonzero__(self) -&gt; NoReturn:-&gt; 1577         raise ValueError(   1578             f&quot;The truth value of a &#123;type(self).__name__&#125; is ambiguous. &quot;   1579             &quot;Use a.empty, a.bool(), a.item(), a.any() or a.all().&quot;   1580         )ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().\n请参阅比较和常见陷阱以获取解释和解决方法。\n","dateCreated":"2015-06-16T11:35:31+08:00","dateModified":"2025-06-16T14:08:17+08:00","datePublished":"2015-06-16T11:35:31+08:00","description":"","headline":"pandas 快速入门","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"},"publisher":{"@type":"Organization","name":"Kein Chan","sameAs":["https://github.com/chankein/","https://www.linkedin.com/profile/","mailto:kein.chan85@gmail.com"],"image":"profile.jpg","logo":{"@type":"ImageObject","url":"profile.jpg"}},"url":"https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/","keywords":"pandas"}</script>
    <meta name="description" content="pandas 快速入门# 这是 pandas 的一个简短介绍，主要面向新用户。你可以在实用代码片段中查看更复杂的示例。 通常，我们按如下方式导入 123In [1]: import numpy as npIn [2]: import pandas as pd pandas 中的基本数据结构# Pandas 提供了两种用于处理数据的类   Series：一个一维的带标签数组，可容纳任何类型的数据 例">
<meta property="og:type" content="blog">
<meta property="og:title" content="pandas 快速入门">
<meta property="og:url" content="https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:description" content="pandas 快速入门# 这是 pandas 的一个简短介绍，主要面向新用户。你可以在实用代码片段中查看更复杂的示例。 通常，我们按如下方式导入 123In [1]: import numpy as npIn [2]: import pandas as pd pandas 中的基本数据结构# Pandas 提供了两种用于处理数据的类   Series：一个一维的带标签数组，可容纳任何类型的数据 例">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://pandas.ac.cn/docs/_images/series_plot_basic.png">
<meta property="og:image" content="https://pandas.ac.cn/docs/_images/frame_plot_basic.png">
<meta property="article:published_time" content="2015-06-16T03:35:31.000Z">
<meta property="article:modified_time" content="2025-06-16T06:08:17.148Z">
<meta property="article:author" content="Kein Chan">
<meta property="article:tag" content="pandas">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pandas.ac.cn/docs/_images/series_plot_basic.png">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../../../../../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../../../../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../../../../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../../../../../#about"
            >
        
        
            <img class="header-picture" src="../../../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../../../../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../../../../../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>分享一些技術教程,命令備忘(cheat-sheet)等</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            pandas 快速入门
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2015-06-16T11:35:31+08:00">
	
		    2015 年 6 月 16 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../../../../categories/database/">database</a>, <a class="category-link" href="../../../../../categories/database/pandas/">pandas</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="pandas-快速入门">pandas 快速入门<a href="#minutes-to-pandas" title="Link to this heading">#</a></h2>
<p>这是 pandas 的一个简短介绍，主要面向新用户。你可以在<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/cookbook.html#cookbook">实用代码片段</a>中查看更复杂的示例。</p>
<p>通常，我们按如下方式导入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [1]: import numpy as np</span><br><span class="line"></span><br><span class="line">In [2]: import pandas as pd</span><br></pre></td></tr></table></figure>
<h2 id="pandas-中的基本数据结构">pandas 中的基本数据结构<a href="#basic-data-structures-in-pandas" title="Link to this heading">#</a></h2>
<p>Pandas 提供了两种用于处理数据的类</p>
<ol>
<li>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>：一个一维的带标签数组，可容纳任何类型的数据</p>
<p>例如整数、字符串、Python 对象等。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>：一个二维数据结构，像二维数组或带有行和列的表格一样容纳数据。</p>
</li>
</ol>
<h2 id="对象创建">对象创建<a href="#object-creation" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/dsintro.html#dsintro">数据结构简介</a>部分。</p>
<p>通过传入值列表创建<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>，让 pandas 创建默认的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.RangeIndex.html#pandas.RangeIndex" title="pandas.RangeIndex"><code>RangeIndex</code></a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [3]: s = pd.Series([1, 3, 5, np.nan, 6, 8])</span><br><span class="line"></span><br><span class="line">In [4]: s</span><br><span class="line">Out[4]: </span><br><span class="line">0    1.0</span><br><span class="line">1    3.0</span><br><span class="line">2    5.0</span><br><span class="line">3    NaN</span><br><span class="line">4    6.0</span><br><span class="line">5    8.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>通过传入 NumPy 数组，使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.date_range.html#pandas.date_range" title="pandas.date_range"><code>date_range()</code></a>创建带有日期时间索引和标签列的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In [5]: dates = pd.date_range(&quot;20130101&quot;, periods=6)</span><br><span class="line"></span><br><span class="line">In [6]: dates</span><br><span class="line">Out[6]: </span><br><span class="line">DatetimeIndex([&#x27;2013-01-01&#x27;, &#x27;2013-01-02&#x27;, &#x27;2013-01-03&#x27;, &#x27;2013-01-04&#x27;,</span><br><span class="line">               &#x27;2013-01-05&#x27;, &#x27;2013-01-06&#x27;],</span><br><span class="line">              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)</span><br><span class="line"></span><br><span class="line">In [7]: df = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list(&quot;ABCD&quot;))</span><br><span class="line"></span><br><span class="line">In [8]: df</span><br><span class="line">Out[8]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401</span><br><span class="line">2013-01-06 -0.673690  0.113648 -1.478427  0.524988</span><br></pre></td></tr></table></figure>
<p>通过传入一个对象字典创建<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>，其中键是列标签，值是列值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In [9]: df2 = pd.DataFrame(</span><br><span class="line">   ...:     &#123;</span><br><span class="line">   ...:         &quot;A&quot;: 1.0,</span><br><span class="line">   ...:         &quot;B&quot;: pd.Timestamp(&quot;20130102&quot;),</span><br><span class="line">   ...:         &quot;C&quot;: pd.Series(1, index=list(range(4)), dtype=&quot;float32&quot;),</span><br><span class="line">   ...:         &quot;D&quot;: np.array([3] * 4, dtype=&quot;int32&quot;),</span><br><span class="line">   ...:         &quot;E&quot;: pd.Categorical([&quot;test&quot;, &quot;train&quot;, &quot;test&quot;, &quot;train&quot;]),</span><br><span class="line">   ...:         &quot;F&quot;: &quot;foo&quot;,</span><br><span class="line">   ...:     &#125;</span><br><span class="line">   ...: )</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [10]: df2</span><br><span class="line">Out[10]: </span><br><span class="line">     A          B    C  D      E    F</span><br><span class="line">0  1.0 2013-01-02  1.0  3   test  foo</span><br><span class="line">1  1.0 2013-01-02  1.0  3  train  foo</span><br><span class="line">2  1.0 2013-01-02  1.0  3   test  foo</span><br><span class="line">3  1.0 2013-01-02  1.0  3  train  foo</span><br></pre></td></tr></table></figure>
<p>生成的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>的列具有不同的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/basics.html#basics-dtypes">dtypes</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [11]: df2.dtypes</span><br><span class="line">Out[11]: </span><br><span class="line">A          float64</span><br><span class="line">B    datetime64[s]</span><br><span class="line">C          float32</span><br><span class="line">D            int32</span><br><span class="line">E         category</span><br><span class="line">F           object</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>如果你使用 IPython，列名（以及公共属性）的 Tab 自动补全功能会自动启用。以下是部分将自动补全的属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [12]: df2.&lt;TAB&gt;  # noqa: E225, E999</span><br><span class="line">df2.A                  df2.bool</span><br><span class="line">df2.abs                df2.boxplot</span><br><span class="line">df2.add                df2.C</span><br><span class="line">df2.add_prefix         df2.clip</span><br><span class="line">df2.add_suffix         df2.columns</span><br><span class="line">df2.align              df2.copy</span><br><span class="line">df2.all                df2.count</span><br><span class="line">df2.any                df2.combine</span><br><span class="line">df2.append             df2.D</span><br><span class="line">df2.apply              df2.describe</span><br><span class="line">df2.applymap           df2.diff</span><br><span class="line">df2.B                  df2.duplicated</span><br></pre></td></tr></table></figure>
<p>如你所见，列 <code>A</code>、<code>B</code>、<code>C</code> 和 <code>D</code> 会自动 Tab 补全。<code>E</code> 和 <code>F</code> 也在其中；其余属性为简洁起见已被截断。</p>
<h2 id="查看数据">查看数据<a href="#viewing-data" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/basics.html#basics">基本核心功能</a>部分。</p>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head" title="pandas.DataFrame.head"><code>DataFrame.head()</code></a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail" title="pandas.DataFrame.tail"><code>DataFrame.tail()</code></a>分别查看框架的顶部和底部行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [13]: df.head()</span><br><span class="line">Out[13]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401</span><br><span class="line"></span><br><span class="line">In [14]: df.tail(3)</span><br><span class="line">Out[14]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401</span><br><span class="line">2013-01-06 -0.673690  0.113648 -1.478427  0.524988</span><br></pre></td></tr></table></figure>
<p>显示<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.index.html#pandas.DataFrame.index" title="pandas.DataFrame.index"><code>DataFrame.index</code></a>或<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.columns.html#pandas.DataFrame.columns" title="pandas.DataFrame.columns"><code>DataFrame.columns</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [15]: df.index</span><br><span class="line">Out[15]: </span><br><span class="line">DatetimeIndex([&#x27;2013-01-01&#x27;, &#x27;2013-01-02&#x27;, &#x27;2013-01-03&#x27;, &#x27;2013-01-04&#x27;,</span><br><span class="line">               &#x27;2013-01-05&#x27;, &#x27;2013-01-06&#x27;],</span><br><span class="line">              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)</span><br><span class="line"></span><br><span class="line">In [16]: df.columns</span><br><span class="line">Out[16]: Index([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;], dtype=&#x27;object&#x27;)</span><br></pre></td></tr></table></figure>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.to_numpy.html#pandas.DataFrame.to_numpy" title="pandas.DataFrame.to_numpy"><code>DataFrame.to_numpy()</code></a>返回底层数据的 NumPy 表示，不包含索引或列标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [17]: df.to_numpy()</span><br><span class="line">Out[17]: </span><br><span class="line">array([[ 0.4691, -0.2829, -1.5091, -1.1356],</span><br><span class="line">       [ 1.2121, -0.1732,  0.1192, -1.0442],</span><br><span class="line">       [-0.8618, -2.1046, -0.4949,  1.0718],</span><br><span class="line">       [ 0.7216, -0.7068, -1.0396,  0.2719],</span><br><span class="line">       [-0.425 ,  0.567 ,  0.2762, -1.0874],</span><br><span class="line">       [-0.6737,  0.1136, -1.4784,  0.525 ]])</span><br></pre></td></tr></table></figure>
<p>注意</p>
<p><strong>NumPy 数组的整个数组只有一个 dtype，而 pandas DataFrames 的每列有一个 dtype</strong>。当你调用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.to_numpy.html#pandas.DataFrame.to_numpy" title="pandas.DataFrame.to_numpy"><code>DataFrame.to_numpy()</code></a>时，pandas 会找到能够容纳 DataFrame 中 <strong>所有</strong> dtypes 的 NumPy dtype。如果共同的数据类型是 <code>object</code>，则<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.to_numpy.html#pandas.DataFrame.to_numpy" title="pandas.DataFrame.to_numpy"><code>DataFrame.to_numpy()</code></a>将需要复制数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [18]: df2.dtypes</span><br><span class="line">Out[18]: </span><br><span class="line">A          float64</span><br><span class="line">B    datetime64[s]</span><br><span class="line">C          float32</span><br><span class="line">D            int32</span><br><span class="line">E         category</span><br><span class="line">F           object</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line">In [19]: df2.to_numpy()</span><br><span class="line">Out[19]: </span><br><span class="line">array([[1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;test&#x27;, &#x27;foo&#x27;],</span><br><span class="line">       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;train&#x27;, &#x27;foo&#x27;],</span><br><span class="line">       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;test&#x27;, &#x27;foo&#x27;],</span><br><span class="line">       [1.0, Timestamp(&#x27;2013-01-02 00:00:00&#x27;), 1.0, 3, &#x27;train&#x27;, &#x27;foo&#x27;]],</span><br><span class="line">      dtype=object)</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.describe.html#pandas.DataFrame.describe" title="pandas.DataFrame.describe"><code>describe()</code></a>显示数据的快速统计摘要</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [20]: df.describe()</span><br><span class="line">Out[20]: </span><br><span class="line">              A         B         C         D</span><br><span class="line">count  6.000000  6.000000  6.000000  6.000000</span><br><span class="line">mean   0.073711 -0.431125 -0.687758 -0.233103</span><br><span class="line">std    0.843157  0.922818  0.779887  0.973118</span><br><span class="line">min   -0.861849 -2.104569 -1.509059 -1.135632</span><br><span class="line">25%   -0.611510 -0.600794 -1.368714 -1.076610</span><br><span class="line">50%    0.022070 -0.228039 -0.767252 -0.386188</span><br><span class="line">75%    0.658444  0.041933 -0.034326  0.461706</span><br><span class="line">max    1.212112  0.567020  0.276232  1.071804</span><br></pre></td></tr></table></figure>
<p>转置数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [21]: df.T</span><br><span class="line">Out[21]: </span><br><span class="line">   2013-01-01  2013-01-02  2013-01-03  2013-01-04  2013-01-05  2013-01-06</span><br><span class="line">A    0.469112    1.212112   -0.861849    0.721555   -0.424972   -0.673690</span><br><span class="line">B   -0.282863   -0.173215   -2.104569   -0.706771    0.567020    0.113648</span><br><span class="line">C   -1.509059    0.119209   -0.494929   -1.039575    0.276232   -1.478427</span><br><span class="line">D   -1.135632   -1.044236    1.071804    0.271860   -1.087401    0.524988</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.sort_index.html#pandas.DataFrame.sort_index" title="pandas.DataFrame.sort_index"><code>DataFrame.sort_index()</code></a>按轴排序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [22]: df.sort_index(axis=1, ascending=False)</span><br><span class="line">Out[22]: </span><br><span class="line">                   D         C         B         A</span><br><span class="line">2013-01-01 -1.135632 -1.509059 -0.282863  0.469112</span><br><span class="line">2013-01-02 -1.044236  0.119209 -0.173215  1.212112</span><br><span class="line">2013-01-03  1.071804 -0.494929 -2.104569 -0.861849</span><br><span class="line">2013-01-04  0.271860 -1.039575 -0.706771  0.721555</span><br><span class="line">2013-01-05 -1.087401  0.276232  0.567020 -0.424972</span><br><span class="line">2013-01-06  0.524988 -1.478427  0.113648 -0.673690</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values" title="pandas.DataFrame.sort_values"><code>DataFrame.sort_values()</code></a>按值排序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [23]: df.sort_values(by=&quot;B&quot;)</span><br><span class="line">Out[23]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-06 -0.673690  0.113648 -1.478427  0.524988</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401</span><br></pre></td></tr></table></figure>
<h2 id="选择">选择<a href="#selection" title="Link to this heading">#</a></h2>
<p>请参阅索引文档<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/indexing.html#indexing">索引与选择数据</a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/advanced.html#advanced">MultiIndex / 高级索引</a>。</p>
<h3 id="Getitem">Getitem (<code>[]</code>)<a href="#getitem" title="Link to this heading">#</a></h3>
<p>对于<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>，传入单个标签会选择一列并生成一个<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>，等同于 <code>df.A</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [24]: df[&quot;A&quot;]</span><br><span class="line">Out[24]: </span><br><span class="line">2013-01-01    0.469112</span><br><span class="line">2013-01-02    1.212112</span><br><span class="line">2013-01-03   -0.861849</span><br><span class="line">2013-01-04    0.721555</span><br><span class="line">2013-01-05   -0.424972</span><br><span class="line">2013-01-06   -0.673690</span><br><span class="line">Freq: D, Name: A, dtype: float64</span><br></pre></td></tr></table></figure>
<p>对于<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>，传入切片 <code>:</code> 会选择匹配的行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [25]: df[0:3]</span><br><span class="line">Out[25]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br><span class="line"></span><br><span class="line">In [26]: df[&quot;20130102&quot;:&quot;20130104&quot;]</span><br><span class="line">Out[26]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br></pre></td></tr></table></figure>
<h3 id="按标签选择">按标签选择<a href="#selection-by-label" title="Link to this heading">#</a></h3>
<p>更多信息请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/indexing.html#indexing-label">按标签选择</a>，使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc"><code>DataFrame.loc()</code></a>或<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.at.html#pandas.DataFrame.at" title="pandas.DataFrame.at"><code>DataFrame.at()</code></a>。</p>
<p>选择与标签匹配的行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [27]: df.loc[dates[0]]</span><br><span class="line">Out[27]: </span><br><span class="line">A    0.469112</span><br><span class="line">B   -0.282863</span><br><span class="line">C   -1.509059</span><br><span class="line">D   -1.135632</span><br><span class="line">Name: 2013-01-01 00:00:00, dtype: float64</span><br></pre></td></tr></table></figure>
<p>选择所有行 (<code>:</code>) 和选定的列标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [28]: df.loc[:, [&quot;A&quot;, &quot;B&quot;]]</span><br><span class="line">Out[28]: </span><br><span class="line">                   A         B</span><br><span class="line">2013-01-01  0.469112 -0.282863</span><br><span class="line">2013-01-02  1.212112 -0.173215</span><br><span class="line">2013-01-03 -0.861849 -2.104569</span><br><span class="line">2013-01-04  0.721555 -0.706771</span><br><span class="line">2013-01-05 -0.424972  0.567020</span><br><span class="line">2013-01-06 -0.673690  0.113648</span><br></pre></td></tr></table></figure>
<p>对于标签切片，两个端点都<strong>包含</strong>在内</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [29]: df.loc[&quot;20130102&quot;:&quot;20130104&quot;, [&quot;A&quot;, &quot;B&quot;]]</span><br><span class="line">Out[29]: </span><br><span class="line">                   A         B</span><br><span class="line">2013-01-02  1.212112 -0.173215</span><br><span class="line">2013-01-03 -0.861849 -2.104569</span><br><span class="line">2013-01-04  0.721555 -0.706771</span><br></pre></td></tr></table></figure>
<p>选择单个行和列标签会返回一个标量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [30]: df.loc[dates[0], &quot;A&quot;]</span><br><span class="line">Out[30]: 0.4691122999071863</span><br></pre></td></tr></table></figure>
<p>为了快速访问标量（等同于之前的方法）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [31]: df.at[dates[0], &quot;A&quot;]</span><br><span class="line">Out[31]: 0.4691122999071863</span><br></pre></td></tr></table></figure>
<h3 id="按位置选择">按位置选择<a href="#selection-by-position" title="Link to this heading">#</a></h3>
<p>更多信息请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/indexing.html#indexing-integer">按位置选择</a>，使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.iloc.html#pandas.DataFrame.iloc" title="pandas.DataFrame.iloc"><code>DataFrame.iloc()</code></a>或<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.iat.html#pandas.DataFrame.iat" title="pandas.DataFrame.iat"><code>DataFrame.iat()</code></a>。</p>
<p>通过传入整数的位置进行选择</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [32]: df.iloc[3]</span><br><span class="line">Out[32]: </span><br><span class="line">A    0.721555</span><br><span class="line">B   -0.706771</span><br><span class="line">C   -1.039575</span><br><span class="line">D    0.271860</span><br><span class="line">Name: 2013-01-04 00:00:00, dtype: float64</span><br></pre></td></tr></table></figure>
<p>整数切片行为类似于 NumPy/Python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [33]: df.iloc[3:5, 0:2]</span><br><span class="line">Out[33]: </span><br><span class="line">                   A         B</span><br><span class="line">2013-01-04  0.721555 -0.706771</span><br><span class="line">2013-01-05 -0.424972  0.567020</span><br></pre></td></tr></table></figure>
<p>整数位置列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [34]: df.iloc[[1, 2, 4], [0, 2]]</span><br><span class="line">Out[34]: </span><br><span class="line">                   A         C</span><br><span class="line">2013-01-02  1.212112  0.119209</span><br><span class="line">2013-01-03 -0.861849 -0.494929</span><br><span class="line">2013-01-05 -0.424972  0.276232</span><br></pre></td></tr></table></figure>
<p>显式切片行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [35]: df.iloc[1:3, :]</span><br><span class="line">Out[35]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804</span><br></pre></td></tr></table></figure>
<p>显式切片列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [36]: df.iloc[:, 1:3]</span><br><span class="line">Out[36]: </span><br><span class="line">                   B         C</span><br><span class="line">2013-01-01 -0.282863 -1.509059</span><br><span class="line">2013-01-02 -0.173215  0.119209</span><br><span class="line">2013-01-03 -2.104569 -0.494929</span><br><span class="line">2013-01-04 -0.706771 -1.039575</span><br><span class="line">2013-01-05  0.567020  0.276232</span><br><span class="line">2013-01-06  0.113648 -1.478427</span><br></pre></td></tr></table></figure>
<p>显式获取值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [37]: df.iloc[1, 1]</span><br><span class="line">Out[37]: -0.17321464905330858</span><br></pre></td></tr></table></figure>
<p>为了快速访问标量（等同于之前的方法）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [38]: df.iat[1, 1]</span><br><span class="line">Out[38]: -0.17321464905330858</span><br></pre></td></tr></table></figure>
<h3 id="布尔索引">布尔索引<a href="#boolean-indexing" title="Link to this heading">#</a></h3>
<p>选择 <code>df.A</code> 大于 <code>0</code> 的行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [39]: df[df[&quot;A&quot;] &gt; 0]</span><br><span class="line">Out[39]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860</span><br></pre></td></tr></table></figure>
<p>从满足布尔条件的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>中选择值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [40]: df[df &gt; 0]</span><br><span class="line">Out[40]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line">2013-01-01  0.469112       NaN       NaN       NaN</span><br><span class="line">2013-01-02  1.212112       NaN  0.119209       NaN</span><br><span class="line">2013-01-03       NaN       NaN       NaN  1.071804</span><br><span class="line">2013-01-04  0.721555       NaN       NaN  0.271860</span><br><span class="line">2013-01-05       NaN  0.567020  0.276232       NaN</span><br><span class="line">2013-01-06       NaN  0.113648       NaN  0.524988</span><br></pre></td></tr></table></figure>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.isin.html#pandas.Series.isin" title="pandas.Series.isin"><code>isin()</code></a>方法进行过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In [41]: df2 = df.copy()</span><br><span class="line"></span><br><span class="line">In [42]: df2[&quot;E&quot;] = [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;three&quot;]</span><br><span class="line"></span><br><span class="line">In [43]: df2</span><br><span class="line">Out[43]: </span><br><span class="line">                   A         B         C         D      E</span><br><span class="line">2013-01-01  0.469112 -0.282863 -1.509059 -1.135632    one</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209 -1.044236    one</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804    two</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  0.271860  three</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401   four</span><br><span class="line">2013-01-06 -0.673690  0.113648 -1.478427  0.524988  three</span><br><span class="line"></span><br><span class="line">In [44]: df2[df2[&quot;E&quot;].isin([&quot;two&quot;, &quot;four&quot;])]</span><br><span class="line">Out[44]: </span><br><span class="line">                   A         B         C         D     E</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  1.071804   two</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232 -1.087401  four</span><br></pre></td></tr></table></figure>
<h3 id="设置">设置<a href="#setting" title="Link to this heading">#</a></h3>
<p>设置新列会自动按索引对齐数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [45]: s1 = pd.Series([1, 2, 3, 4, 5, 6], index=pd.date_range(&quot;20130102&quot;, periods=6))</span><br><span class="line"></span><br><span class="line">In [46]: s1</span><br><span class="line">Out[46]: </span><br><span class="line">2013-01-02    1</span><br><span class="line">2013-01-03    2</span><br><span class="line">2013-01-04    3</span><br><span class="line">2013-01-05    4</span><br><span class="line">2013-01-06    5</span><br><span class="line">2013-01-07    6</span><br><span class="line">Freq: D, dtype: int64</span><br><span class="line"></span><br><span class="line">In [47]: df[&quot;F&quot;] = s1</span><br></pre></td></tr></table></figure>
<p>按标签设置值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [48]: df.at[dates[0], &quot;A&quot;] = 0</span><br></pre></td></tr></table></figure>
<p>按位置设置值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [49]: df.iat[0, 1] = 0</span><br></pre></td></tr></table></figure>
<p>通过分配 NumPy 数组进行设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [50]: df.loc[:, &quot;D&quot;] = np.array([5] * len(df))</span><br></pre></td></tr></table></figure>
<p>先前的设置操作的结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [51]: df</span><br><span class="line">Out[51]: </span><br><span class="line">                   A         B         C    D    F</span><br><span class="line">2013-01-01  0.000000  0.000000 -1.509059  5.0  NaN</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209  5.0  1.0</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.0</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  5.0  3.0</span><br><span class="line">2013-01-05 -0.424972  0.567020  0.276232  5.0  4.0</span><br><span class="line">2013-01-06 -0.673690  0.113648 -1.478427  5.0  5.0</span><br></pre></td></tr></table></figure>
<p>带设置的 <code>where</code> 操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [52]: df2 = df.copy()</span><br><span class="line"></span><br><span class="line">In [53]: df2[df2 &gt; 0] = -df2</span><br><span class="line"></span><br><span class="line">In [54]: df2</span><br><span class="line">Out[54]: </span><br><span class="line">                   A         B         C    D    F</span><br><span class="line">2013-01-01  0.000000  0.000000 -1.509059 -5.0  NaN</span><br><span class="line">2013-01-02 -1.212112 -0.173215 -0.119209 -5.0 -1.0</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929 -5.0 -2.0</span><br><span class="line">2013-01-04 -0.721555 -0.706771 -1.039575 -5.0 -3.0</span><br><span class="line">2013-01-05 -0.424972 -0.567020 -0.276232 -5.0 -4.0</span><br><span class="line">2013-01-06 -0.673690 -0.113648 -1.478427 -5.0 -5.0</span><br></pre></td></tr></table></figure>
<h2 id="缺失数据">缺失数据<a href="#missing-data" title="Link to this heading">#</a></h2>
<p>对于 NumPy 数据类型，<code>np.nan</code> 表示缺失数据。默认情况下，它不包含在计算中。请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/missing_data.html#missing-data">缺失数据</a>部分。</p>
<p>重新索引允许你更改/添加/删除指定轴上的索引。这会返回数据的副本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [55]: df1 = df.reindex(index=dates[0:4], columns=list(df.columns) + [&quot;E&quot;])</span><br><span class="line"></span><br><span class="line">In [56]: df1.loc[dates[0] : dates[1], &quot;E&quot;] = 1</span><br><span class="line"></span><br><span class="line">In [57]: df1</span><br><span class="line">Out[57]: </span><br><span class="line">                   A         B         C    D    F    E</span><br><span class="line">2013-01-01  0.000000  0.000000 -1.509059  5.0  NaN  1.0</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.0</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.0  NaN</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  5.0  3.0  NaN</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.dropna.html#pandas.DataFrame.dropna" title="pandas.DataFrame.dropna"><code>DataFrame.dropna()</code></a>删除任何包含缺失数据的行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [58]: df1.dropna(how=&quot;any&quot;)</span><br><span class="line">Out[58]: </span><br><span class="line">                   A         B         C    D    F    E</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.0</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.fillna.html#pandas.DataFrame.fillna" title="pandas.DataFrame.fillna"><code>DataFrame.fillna()</code></a>填充缺失数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [59]: df1.fillna(value=5)</span><br><span class="line">Out[59]: </span><br><span class="line">                   A         B         C    D    F    E</span><br><span class="line">2013-01-01  0.000000  0.000000 -1.509059  5.0  5.0  1.0</span><br><span class="line">2013-01-02  1.212112 -0.173215  0.119209  5.0  1.0  1.0</span><br><span class="line">2013-01-03 -0.861849 -2.104569 -0.494929  5.0  2.0  5.0</span><br><span class="line">2013-01-04  0.721555 -0.706771 -1.039575  5.0  3.0  5.0</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.isna.html#pandas.isna" title="pandas.isna"><code>isna()</code></a>获取值为 <code>nan</code> 的布尔掩码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [60]: pd.isna(df1)</span><br><span class="line">Out[60]: </span><br><span class="line">                A      B      C      D      F      E</span><br><span class="line">2013-01-01  False  False  False  False   True  False</span><br><span class="line">2013-01-02  False  False  False  False  False  False</span><br><span class="line">2013-01-03  False  False  False  False  False   True</span><br><span class="line">2013-01-04  False  False  False  False  False   True</span><br></pre></td></tr></table></figure>
<h2 id="操作">操作<a href="#operations" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/basics.html#basics-binop">二元运算基本部分</a>。</p>
<h3 id="统计">统计<a href="#stats" title="Link to this heading">#</a></h3>
<p>操作通常<strong>排除</strong>缺失数据。</p>
<p>计算每列的平均值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [61]: df.mean()</span><br><span class="line">Out[61]: </span><br><span class="line">A   -0.004474</span><br><span class="line">B   -0.383981</span><br><span class="line">C   -0.687758</span><br><span class="line">D    5.000000</span><br><span class="line">F    3.000000</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>计算每行的平均值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [62]: df.mean(axis=1)</span><br><span class="line">Out[62]: </span><br><span class="line">2013-01-01    0.872735</span><br><span class="line">2013-01-02    1.431621</span><br><span class="line">2013-01-03    0.707731</span><br><span class="line">2013-01-04    1.395042</span><br><span class="line">2013-01-05    1.883656</span><br><span class="line">2013-01-06    1.592306</span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></table></figure>
<p>与具有不同索引或列的另一个<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>或<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>进行操作时，结果将与索引或列标签的并集对齐。此外，pandas 会沿指定维度自动广播，并将未对齐的标签填充为<code>np.nan</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">In [63]: s = pd.Series([1, 3, 5, np.nan, 6, 8], index=dates).shift(2)</span><br><span class="line"></span><br><span class="line">In [64]: s</span><br><span class="line">Out[64]: </span><br><span class="line">2013-01-01    NaN</span><br><span class="line">2013-01-02    NaN</span><br><span class="line">2013-01-03    1.0</span><br><span class="line">2013-01-04    3.0</span><br><span class="line">2013-01-05    5.0</span><br><span class="line">2013-01-06    NaN</span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"></span><br><span class="line">In [65]: df.sub(s, axis=&quot;index&quot;)</span><br><span class="line">Out[65]: </span><br><span class="line">                   A         B         C    D    F</span><br><span class="line">2013-01-01       NaN       NaN       NaN  NaN  NaN</span><br><span class="line">2013-01-02       NaN       NaN       NaN  NaN  NaN</span><br><span class="line">2013-01-03 -1.861849 -3.104569 -1.494929  4.0  1.0</span><br><span class="line">2013-01-04 -2.278445 -3.706771 -4.039575  2.0  0.0</span><br><span class="line">2013-01-05 -5.424972 -4.432980 -4.723768  0.0 -1.0</span><br><span class="line">2013-01-06       NaN       NaN       NaN  NaN  NaN</span><br></pre></td></tr></table></figure>
<h3 id="用户定义函数">用户定义函数<a href="#user-defined-functions" title="Link to this heading">#</a></h3>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.agg.html#pandas.DataFrame.agg" title="pandas.DataFrame.agg"><code>DataFrame.agg()</code></a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.transform.html#pandas.DataFrame.transform" title="pandas.DataFrame.transform"><code>DataFrame.transform()</code></a>分别应用一个用户定义函数，该函数会减少或广播其结果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">In [66]: df.agg(lambda x: np.mean(x) * 5.6)</span><br><span class="line">Out[66]: </span><br><span class="line">A    -0.025054</span><br><span class="line">B    -2.150294</span><br><span class="line">C    -3.851445</span><br><span class="line">D    28.000000</span><br><span class="line">F    16.800000</span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line">In [67]: df.transform(lambda x: x * 101.2)</span><br><span class="line">Out[67]: </span><br><span class="line">                     A           B           C      D      F</span><br><span class="line">2013-01-01    0.000000    0.000000 -152.716721  506.0    NaN</span><br><span class="line">2013-01-02  122.665737  -17.529322   12.063922  506.0  101.2</span><br><span class="line">2013-01-03  -87.219115 -212.982405  -50.086843  506.0  202.4</span><br><span class="line">2013-01-04   73.021382  -71.525239 -105.204988  506.0  303.6</span><br><span class="line">2013-01-05  -43.007200   57.382459   27.954680  506.0  404.8</span><br><span class="line">2013-01-06  -68.177398   11.501219 -149.616767  506.0  506.0</span><br></pre></td></tr></table></figure>
<h3 id="值计数">值计数<a href="#value-counts" title="Link to this heading">#</a></h3>
<p>更多信息请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/basics.html#basics-discretization">直方图和离散化</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">In [68]: s = pd.Series(np.random.randint(0, 7, size=10))</span><br><span class="line"></span><br><span class="line">In [69]: s</span><br><span class="line">Out[69]: </span><br><span class="line">0    4</span><br><span class="line">1    2</span><br><span class="line">2    1</span><br><span class="line">3    2</span><br><span class="line">4    6</span><br><span class="line">5    4</span><br><span class="line">6    4</span><br><span class="line">7    6</span><br><span class="line">8    4</span><br><span class="line">9    4</span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line">In [70]: s.value_counts()</span><br><span class="line">Out[70]: </span><br><span class="line">4    5</span><br><span class="line">2    2</span><br><span class="line">6    2</span><br><span class="line">1    1</span><br><span class="line">Name: count, dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="字符串方法">字符串方法<a href="#string-methods" title="Link to this heading">#</a></h3>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>在 <code>str</code> 属性中配备了一组字符串处理方法，可以轻松地对数组的每个元素进行操作，如下面的代码片段所示。更多信息请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/text.html#text-string-methods">矢量化字符串方法</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">In [71]: s = pd.Series([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;Aaba&quot;, &quot;Baca&quot;, np.nan, &quot;CABA&quot;, &quot;dog&quot;, &quot;cat&quot;])</span><br><span class="line"></span><br><span class="line">In [72]: s.str.lower()</span><br><span class="line">Out[72]: </span><br><span class="line">0       a</span><br><span class="line">1       b</span><br><span class="line">2       c</span><br><span class="line">3    aaba</span><br><span class="line">4    baca</span><br><span class="line">5     NaN</span><br><span class="line">6    caba</span><br><span class="line">7     dog</span><br><span class="line">8     cat</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<h2 id="合并">合并<a href="#merge" title="Link to this heading">#</a></h2>
<h3 id="拼接">拼接<a href="#concat" title="Link to this heading">#</a></h3>
<p>pandas 提供了各种功能，可以轻松地将 <a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a> 和 <a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a> 对象与各种集合逻辑（用于索引）和关系代数功能（用于连接/合并类型操作）结合在一起。</p>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/merging.html#merging">合并</a>部分。</p>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.concat.html#pandas.concat" title="pandas.concat"><code>concat()</code></a>按行拼接 pandas 对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">In [73]: df = pd.DataFrame(np.random.randn(10, 4))</span><br><span class="line"></span><br><span class="line">In [74]: df</span><br><span class="line">Out[74]: </span><br><span class="line">          0         1         2         3</span><br><span class="line">0 -0.548702  1.467327 -1.015962 -0.483075</span><br><span class="line">1  1.637550 -1.217659 -0.291519 -1.745505</span><br><span class="line">2 -0.263952  0.991460 -0.919069  0.266046</span><br><span class="line">3 -0.709661  1.669052  1.037882 -1.705775</span><br><span class="line">4 -0.919854 -0.042379  1.247642 -0.009920</span><br><span class="line">5  0.290213  0.495767  0.362949  1.548106</span><br><span class="line">6 -1.131345 -0.089329  0.337863 -0.945867</span><br><span class="line">7 -0.932132  1.956030  0.017587 -0.016692</span><br><span class="line">8 -0.575247  0.254161 -1.143704  0.215897</span><br><span class="line">9  1.193555 -0.077118 -0.408530 -0.862495</span><br><span class="line"></span><br><span class="line"># break it into pieces</span><br><span class="line">In [75]: pieces = [df[:3], df[3:7], df[7:]]</span><br><span class="line"></span><br><span class="line">In [76]: pd.concat(pieces)</span><br><span class="line">Out[76]: </span><br><span class="line">          0         1         2         3</span><br><span class="line">0 -0.548702  1.467327 -1.015962 -0.483075</span><br><span class="line">1  1.637550 -1.217659 -0.291519 -1.745505</span><br><span class="line">2 -0.263952  0.991460 -0.919069  0.266046</span><br><span class="line">3 -0.709661  1.669052  1.037882 -1.705775</span><br><span class="line">4 -0.919854 -0.042379  1.247642 -0.009920</span><br><span class="line">5  0.290213  0.495767  0.362949  1.548106</span><br><span class="line">6 -1.131345 -0.089329  0.337863 -0.945867</span><br><span class="line">7 -0.932132  1.956030  0.017587 -0.016692</span><br><span class="line">8 -0.575247  0.254161 -1.143704  0.215897</span><br><span class="line">9  1.193555 -0.077118 -0.408530 -0.862495</span><br></pre></td></tr></table></figure>
<h3 id="连接">连接<a href="#join" title="Link to this heading">#</a></h3>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.merge.html#pandas.merge" title="pandas.merge"><code>merge()</code></a>支持沿着特定列进行 SQL 风格的连接。请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/merging.html#merging-join">数据库风格连接</a>部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">In [77]: left = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;foo&quot;], &quot;lval&quot;: [1, 2]&#125;)</span><br><span class="line"></span><br><span class="line">In [78]: right = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;foo&quot;], &quot;rval&quot;: [4, 5]&#125;)</span><br><span class="line"></span><br><span class="line">In [79]: left</span><br><span class="line">Out[79]: </span><br><span class="line">   key  lval</span><br><span class="line">0  foo     1</span><br><span class="line">1  foo     2</span><br><span class="line"></span><br><span class="line">In [80]: right</span><br><span class="line">Out[80]: </span><br><span class="line">   key  rval</span><br><span class="line">0  foo     4</span><br><span class="line">1  foo     5</span><br><span class="line"></span><br><span class="line">In [81]: pd.merge(left, right, on=&quot;key&quot;)</span><br><span class="line">Out[81]: </span><br><span class="line">   key  lval  rval</span><br><span class="line">0  foo     1     4</span><br><span class="line">1  foo     1     5</span><br><span class="line">2  foo     2     4</span><br><span class="line">3  foo     2     5</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.merge.html#pandas.merge" title="pandas.merge"><code>merge()</code></a> 基于唯一键进行合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">In [82]: left = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;bar&quot;], &quot;lval&quot;: [1, 2]&#125;)</span><br><span class="line"></span><br><span class="line">In [83]: right = pd.DataFrame(&#123;&quot;key&quot;: [&quot;foo&quot;, &quot;bar&quot;], &quot;rval&quot;: [4, 5]&#125;)</span><br><span class="line"></span><br><span class="line">In [84]: left</span><br><span class="line">Out[84]: </span><br><span class="line">   key  lval</span><br><span class="line">0  foo     1</span><br><span class="line">1  bar     2</span><br><span class="line"></span><br><span class="line">In [85]: right</span><br><span class="line">Out[85]: </span><br><span class="line">   key  rval</span><br><span class="line">0  foo     4</span><br><span class="line">1  bar     5</span><br><span class="line"></span><br><span class="line">In [86]: pd.merge(left, right, on=&quot;key&quot;)</span><br><span class="line">Out[86]: </span><br><span class="line">   key  lval  rval</span><br><span class="line">0  foo     1     4</span><br><span class="line">1  bar     2     5</span><br></pre></td></tr></table></figure>
<h2 id="分组">分组<a href="#grouping" title="Link to this heading">#</a></h2>
<p>“分组”指的是一个或多个以下步骤的过程</p>
<ul>
<li>
<p>根据某些条件将数据<strong>分拆</strong>成组</p>
</li>
<li>
<p>对每个组独立地<strong>应用</strong>一个函数</p>
</li>
<li>
<p>将结果<strong>组合</strong>成一个数据结构</p>
</li>
</ul>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/groupby.html#groupby">分组</a>部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">In [87]: df = pd.DataFrame(</span><br><span class="line">   ....:     &#123;</span><br><span class="line">   ....:         &quot;A&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;, &quot;foo&quot;],</span><br><span class="line">   ....:         &quot;B&quot;: [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;two&quot;, &quot;two&quot;, &quot;one&quot;, &quot;three&quot;],</span><br><span class="line">   ....:         &quot;C&quot;: np.random.randn(8),</span><br><span class="line">   ....:         &quot;D&quot;: np.random.randn(8),</span><br><span class="line">   ....:     &#125;</span><br><span class="line">   ....: )</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [88]: df</span><br><span class="line">Out[88]: </span><br><span class="line">     A      B         C         D</span><br><span class="line">0  foo    one  1.346061 -1.577585</span><br><span class="line">1  bar    one  1.511763  0.396823</span><br><span class="line">2  foo    two  1.627081 -0.105381</span><br><span class="line">3  bar  three -0.990582 -0.532532</span><br><span class="line">4  foo    two -0.441652  1.453749</span><br><span class="line">5  bar    two  1.211526  1.208843</span><br><span class="line">6  foo    one  0.268520 -0.080952</span><br><span class="line">7  foo  three  0.024580 -0.264610</span><br></pre></td></tr></table></figure>
<p>按列标签分组，选择列标签，然后将<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.sum.html#pandas.core.groupby.DataFrameGroupBy.sum" title="pandas.core.groupby.DataFrameGroupBy.sum"><code>DataFrameGroupBy.sum()</code></a>函数应用于结果组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [89]: df.groupby(&quot;A&quot;)[[&quot;C&quot;, &quot;D&quot;]].sum()</span><br><span class="line">Out[89]: </span><br><span class="line">            C         D</span><br><span class="line">A                      </span><br><span class="line">bar  1.732707  1.073134</span><br><span class="line">foo  2.824590 -0.574779</span><br></pre></td></tr></table></figure>
<p>按多列标签分组会形成<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.MultiIndex.html#pandas.MultiIndex" title="pandas.MultiIndex"><code>MultiIndex</code></a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [90]: df.groupby([&quot;A&quot;, &quot;B&quot;]).sum()</span><br><span class="line">Out[90]: </span><br><span class="line">                  C         D</span><br><span class="line">A   B                        </span><br><span class="line">bar one    1.511763  0.396823</span><br><span class="line">    three -0.990582 -0.532532</span><br><span class="line">    two    1.211526  1.208843</span><br><span class="line">foo one    1.614581 -1.658537</span><br><span class="line">    three  0.024580 -0.264610</span><br><span class="line">    two    1.185429  1.348368</span><br></pre></td></tr></table></figure>
<h2 id="重塑">重塑<a href="#reshaping" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/advanced.html#advanced-hierarchical">层次化索引</a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/reshaping.html#reshaping-stacking">重塑</a>部分。</p>
<h3 id="堆叠">堆叠<a href="#stack" title="Link to this heading">#</a></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">In [91]: arrays = [</span><br><span class="line">   ....:    [&quot;bar&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;baz&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;qux&quot;, &quot;qux&quot;],</span><br><span class="line">   ....:    [&quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;, &quot;one&quot;, &quot;two&quot;],</span><br><span class="line">   ....: ]</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [92]: index = pd.MultiIndex.from_arrays(arrays, names=[&quot;first&quot;, &quot;second&quot;])</span><br><span class="line"></span><br><span class="line">In [93]: df = pd.DataFrame(np.random.randn(8, 2), index=index, columns=[&quot;A&quot;, &quot;B&quot;])</span><br><span class="line"></span><br><span class="line">In [94]: df2 = df[:4]</span><br><span class="line"></span><br><span class="line">In [95]: df2</span><br><span class="line">Out[95]: </span><br><span class="line">                     A         B</span><br><span class="line">first second                    </span><br><span class="line">bar   one    -0.727965 -0.589346</span><br><span class="line">      two     0.339969 -0.693205</span><br><span class="line">baz   one    -0.339355  0.593616</span><br><span class="line">      two     0.884345  1.591431</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.stack.html#pandas.DataFrame.stack" title="pandas.DataFrame.stack"><code>stack()</code></a>方法“压缩”了 DataFrame 列中的一个层</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">In [96]: stacked = df2.stack(future_stack=True)</span><br><span class="line"></span><br><span class="line">In [97]: stacked</span><br><span class="line">Out[97]: </span><br><span class="line">first  second   </span><br><span class="line">bar    one     A   -0.727965</span><br><span class="line">               B   -0.589346</span><br><span class="line">       two     A    0.339969</span><br><span class="line">               B   -0.693205</span><br><span class="line">baz    one     A   -0.339355</span><br><span class="line">               B    0.593616</span><br><span class="line">       two     A    0.884345</span><br><span class="line">               B    1.591431</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>对于一个“堆叠”的 DataFrame 或 Series（其 <code>index</code> 为 <a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.MultiIndex.html#pandas.MultiIndex" title="pandas.MultiIndex"><code>MultiIndex</code></a>），<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.stack.html#pandas.DataFrame.stack" title="pandas.DataFrame.stack"><code>stack()</code></a> 的逆操作是 <a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.unstack.html#pandas.DataFrame.unstack" title="pandas.DataFrame.unstack"><code>unstack()</code></a>，它默认会解除堆叠<strong>最底层</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">In [98]: stacked.unstack()</span><br><span class="line">Out[98]: </span><br><span class="line">                     A         B</span><br><span class="line">first second                    </span><br><span class="line">bar   one    -0.727965 -0.589346</span><br><span class="line">      two     0.339969 -0.693205</span><br><span class="line">baz   one    -0.339355  0.593616</span><br><span class="line">      two     0.884345  1.591431</span><br><span class="line"></span><br><span class="line">In [99]: stacked.unstack(1)</span><br><span class="line">Out[99]: </span><br><span class="line">second        one       two</span><br><span class="line">first                      </span><br><span class="line">bar   A -0.727965  0.339969</span><br><span class="line">      B -0.589346 -0.693205</span><br><span class="line">baz   A -0.339355  0.884345</span><br><span class="line">      B  0.593616  1.591431</span><br><span class="line"></span><br><span class="line">In [100]: stacked.unstack(0)</span><br><span class="line">Out[100]: </span><br><span class="line">first          bar       baz</span><br><span class="line">second                      </span><br><span class="line">one    A -0.727965 -0.339355</span><br><span class="line">       B -0.589346  0.593616</span><br><span class="line">two    A  0.339969  0.884345</span><br><span class="line">       B -0.693205  1.591431</span><br></pre></td></tr></table></figure>
<h3 id="透视表">透视表<a href="#pivot-tables" title="Link to this heading">#</a></h3>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/reshaping.html#reshaping-pivot">透视表</a>部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">In [101]: df = pd.DataFrame(</span><br><span class="line">   .....:     &#123;</span><br><span class="line">   .....:         &quot;A&quot;: [&quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;] * 3,</span><br><span class="line">   .....:         &quot;B&quot;: [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;] * 4,</span><br><span class="line">   .....:         &quot;C&quot;: [&quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;, &quot;bar&quot;] * 2,</span><br><span class="line">   .....:         &quot;D&quot;: np.random.randn(12),</span><br><span class="line">   .....:         &quot;E&quot;: np.random.randn(12),</span><br><span class="line">   .....:     &#125;</span><br><span class="line">   .....: )</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [102]: df</span><br><span class="line">Out[102]: </span><br><span class="line">        A  B    C         D         E</span><br><span class="line">0     one  A  foo -1.202872  0.047609</span><br><span class="line">1     one  B  foo -1.814470 -0.136473</span><br><span class="line">2     two  C  foo  1.018601 -0.561757</span><br><span class="line">3   three  A  bar -0.595447 -1.623033</span><br><span class="line">4     one  B  bar  1.395433  0.029399</span><br><span class="line">5     one  C  bar -0.392670 -0.542108</span><br><span class="line">6     two  A  foo  0.007207  0.282696</span><br><span class="line">7   three  B  foo  1.928123 -0.087302</span><br><span class="line">8     one  C  foo -0.055224 -1.575170</span><br><span class="line">9     one  A  bar  2.395985  1.771208</span><br><span class="line">10    two  B  bar  1.552825  0.816482</span><br><span class="line">11  three  C  bar  0.166599  1.100230</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.pivot_table.html#pandas.pivot_table" title="pandas.pivot_table"><code>pivot_table()</code></a>通过指定<code>values</code>、<code>index</code>和<code>columns</code>来透视<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [103]: pd.pivot_table(df, values=&quot;D&quot;, index=[&quot;A&quot;, &quot;B&quot;], columns=[&quot;C&quot;])</span><br><span class="line">Out[103]: </span><br><span class="line">C             bar       foo</span><br><span class="line">A     B                    </span><br><span class="line">one   A  2.395985 -1.202872</span><br><span class="line">      B  1.395433 -1.814470</span><br><span class="line">      C -0.392670 -0.055224</span><br><span class="line">three A -0.595447       NaN</span><br><span class="line">      B       NaN  1.928123</span><br><span class="line">      C  0.166599       NaN</span><br><span class="line">two   A       NaN  0.007207</span><br><span class="line">      B  1.552825       NaN</span><br><span class="line">      C       NaN  1.018601</span><br></pre></td></tr></table></figure>
<h2 id="时间序列">时间序列<a href="#time-series" title="Link to this heading">#</a></h2>
<p>pandas 具有简单、强大且高效的功能，用于在频率转换期间执行重采样操作（例如，将秒级数据转换为 5 分钟级数据）。这在金融应用中非常常见，但不仅限于此。请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/timeseries.html#timeseries">时间序列</a>部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [104]: rng = pd.date_range(&quot;1/1/2012&quot;, periods=100, freq=&quot;s&quot;)</span><br><span class="line"></span><br><span class="line">In [105]: ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng)</span><br><span class="line"></span><br><span class="line">In [106]: ts.resample(&quot;5Min&quot;).sum()</span><br><span class="line">Out[106]: </span><br><span class="line">2012-01-01    24182</span><br><span class="line">Freq: 5min, dtype: int64</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.tz_localize.html#pandas.Series.tz_localize" title="pandas.Series.tz_localize"><code>Series.tz_localize()</code></a>将时间序列本地化到某个时区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">In [107]: rng = pd.date_range(&quot;3/6/2012 00:00&quot;, periods=5, freq=&quot;D&quot;)</span><br><span class="line"></span><br><span class="line">In [108]: ts = pd.Series(np.random.randn(len(rng)), rng)</span><br><span class="line"></span><br><span class="line">In [109]: ts</span><br><span class="line">Out[109]: </span><br><span class="line">2012-03-06    1.857704</span><br><span class="line">2012-03-07   -1.193545</span><br><span class="line">2012-03-08    0.677510</span><br><span class="line">2012-03-09   -0.153931</span><br><span class="line">2012-03-10    0.520091</span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"></span><br><span class="line">In [110]: ts_utc = ts.tz_localize(&quot;UTC&quot;)</span><br><span class="line"></span><br><span class="line">In [111]: ts_utc</span><br><span class="line">Out[111]: </span><br><span class="line">2012-03-06 00:00:00+00:00    1.857704</span><br><span class="line">2012-03-07 00:00:00+00:00   -1.193545</span><br><span class="line">2012-03-08 00:00:00+00:00    0.677510</span><br><span class="line">2012-03-09 00:00:00+00:00   -0.153931</span><br><span class="line">2012-03-10 00:00:00+00:00    0.520091</span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.tz_convert.html#pandas.Series.tz_convert" title="pandas.Series.tz_convert"><code>Series.tz_convert()</code></a>将时区感知的时间序列转换为另一个时区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [112]: ts_utc.tz_convert(&quot;US/Eastern&quot;)</span><br><span class="line">Out[112]: </span><br><span class="line">2012-03-05 19:00:00-05:00    1.857704</span><br><span class="line">2012-03-06 19:00:00-05:00   -1.193545</span><br><span class="line">2012-03-07 19:00:00-05:00    0.677510</span><br><span class="line">2012-03-08 19:00:00-05:00   -0.153931</span><br><span class="line">2012-03-09 19:00:00-05:00    0.520091</span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></table></figure>
<p>向时间序列添加非固定时长（<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.tseries.offsets.BusinessDay.html#pandas.tseries.offsets.BusinessDay" title="pandas.tseries.offsets.BusinessDay"><code>BusinessDay</code></a>）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [113]: rng</span><br><span class="line">Out[113]: </span><br><span class="line">DatetimeIndex([&#x27;2012-03-06&#x27;, &#x27;2012-03-07&#x27;, &#x27;2012-03-08&#x27;, &#x27;2012-03-09&#x27;,</span><br><span class="line">               &#x27;2012-03-10&#x27;],</span><br><span class="line">              dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)</span><br><span class="line"></span><br><span class="line">In [114]: rng + pd.offsets.BusinessDay(5)</span><br><span class="line">Out[114]: </span><br><span class="line">DatetimeIndex([&#x27;2012-03-13&#x27;, &#x27;2012-03-14&#x27;, &#x27;2012-03-15&#x27;, &#x27;2012-03-16&#x27;,</span><br><span class="line">               &#x27;2012-03-16&#x27;],</span><br><span class="line">              dtype=&#x27;datetime64[ns]&#x27;, freq=None)</span><br></pre></td></tr></table></figure>
<h2 id="分类数据">分类数据<a href="#categoricals" title="Link to this heading">#</a></h2>
<p>pandas 可以在<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>中包含分类数据。有关完整文档，请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/categorical.html#categorical">分类简介</a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/arrays.html#api-arrays-categorical">API 文档</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [115]: df = pd.DataFrame(</span><br><span class="line">   .....:     &#123;&quot;id&quot;: [1, 2, 3, 4, 5, 6], &quot;raw_grade&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;a&quot;, &quot;a&quot;, &quot;e&quot;]&#125;</span><br><span class="line">   .....: )</span><br><span class="line">   .....: </span><br></pre></td></tr></table></figure>
<p>将原始等级转换为分类数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [116]: df[&quot;grade&quot;] = df[&quot;raw_grade&quot;].astype(&quot;category&quot;)</span><br><span class="line"></span><br><span class="line">In [117]: df[&quot;grade&quot;]</span><br><span class="line">Out[117]: </span><br><span class="line">0    a</span><br><span class="line">1    b</span><br><span class="line">2    b</span><br><span class="line">3    a</span><br><span class="line">4    a</span><br><span class="line">5    e</span><br><span class="line">Name: grade, dtype: category</span><br><span class="line">Categories (3, object): [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;e&#x27;]</span><br></pre></td></tr></table></figure>
<p>将类别重命名为更有意义的名称</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [118]: new_categories = [&quot;very good&quot;, &quot;good&quot;, &quot;very bad&quot;]</span><br><span class="line"></span><br><span class="line">In [119]: df[&quot;grade&quot;] = df[&quot;grade&quot;].cat.rename_categories(new_categories)</span><br></pre></td></tr></table></figure>
<p>重新排序类别并同时添加缺失的类别（<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.cat.html#pandas.Series.cat" title="pandas.Series.cat"><code>Series.cat()</code></a>下的方法默认返回一个新的<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [120]: df[&quot;grade&quot;] = df[&quot;grade&quot;].cat.set_categories(</span><br><span class="line">   .....:     [&quot;very bad&quot;, &quot;bad&quot;, &quot;medium&quot;, &quot;good&quot;, &quot;very good&quot;]</span><br><span class="line">   .....: )</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [121]: df[&quot;grade&quot;]</span><br><span class="line">Out[121]: </span><br><span class="line">0    very good</span><br><span class="line">1         good</span><br><span class="line">2         good</span><br><span class="line">3    very good</span><br><span class="line">4    very good</span><br><span class="line">5     very bad</span><br><span class="line">Name: grade, dtype: category</span><br><span class="line">Categories (5, object): [&#x27;very bad&#x27;, &#x27;bad&#x27;, &#x27;medium&#x27;, &#x27;good&#x27;, &#x27;very good&#x27;]</span><br></pre></td></tr></table></figure>
<p>排序是按类别顺序，而不是字典顺序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [122]: df.sort_values(by=&quot;grade&quot;)</span><br><span class="line">Out[122]: </span><br><span class="line">   id raw_grade      grade</span><br><span class="line">5   6         e   very bad</span><br><span class="line">1   2         b       good</span><br><span class="line">2   3         b       good</span><br><span class="line">0   1         a  very good</span><br><span class="line">3   4         a  very good</span><br><span class="line">4   5         a  very good</span><br></pre></td></tr></table></figure>
<p>使用 <code>observed=False</code> 按分类列分组也会显示空类别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [123]: df.groupby(&quot;grade&quot;, observed=False).size()</span><br><span class="line">Out[123]: </span><br><span class="line">grade</span><br><span class="line">very bad     1</span><br><span class="line">bad          0</span><br><span class="line">medium       0</span><br><span class="line">good         2</span><br><span class="line">very good    3</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h2 id="绘图">绘图<a href="#plotting" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/visualization.html#visualization">绘图</a>文档。</p>
<p>我们使用标准约定来引用 matplotlib API</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [124]: import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">In [125]: plt.close(&quot;all&quot;)</span><br></pre></td></tr></table></figure>
<p><code>plt.close</code> 方法用于<a target="_blank" rel="noopener" href="https://matplotlib.net.cn/stable/api/_as_gen/matplotlib.pyplot.close.html">关闭</a>图形窗口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [126]: ts = pd.Series(np.random.randn(1000), index=pd.date_range(&quot;1/1/2000&quot;, periods=1000))</span><br><span class="line"></span><br><span class="line">In [127]: ts = ts.cumsum()</span><br><span class="line"></span><br><span class="line">In [128]: ts.plot();</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.ac.cn/docs/_images/series_plot_basic.png" alt="../_images/series_plot_basic.png"></p>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.plot.html#pandas.DataFrame.plot" title="pandas.DataFrame.plot"><code>plot()</code></a>绘制所有列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [129]: df = pd.DataFrame(</span><br><span class="line">   .....:     np.random.randn(1000, 4), index=ts.index, columns=[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]</span><br><span class="line">   .....: )</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [130]: df = df.cumsum()</span><br><span class="line"></span><br><span class="line">In [131]: plt.figure();</span><br><span class="line"></span><br><span class="line">In [132]: df.plot();</span><br><span class="line"></span><br><span class="line">In [133]: plt.legend(loc=&#x27;best&#x27;);</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.ac.cn/docs/_images/frame_plot_basic.png" alt="../_images/frame_plot_basic.png"></p>
<h2 id="导入和导出数据">导入和导出数据<a href="#importing-and-exporting-data" title="Link to this heading">#</a></h2>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/io.html#io">IO 工具</a>部分。</p>
<h3 id="CSV">CSV<a href="#csv" title="Link to this heading">#</a></h3>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/io.html#io-store-in-csv">写入 CSV 文件：</a>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.to_csv.html#pandas.DataFrame.to_csv" title="pandas.DataFrame.to_csv"><code>DataFrame.to_csv()</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [134]: df = pd.DataFrame(np.random.randint(0, 5, (10, 5)))</span><br><span class="line"></span><br><span class="line">In [135]: df.to_csv(&quot;foo.csv&quot;)</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/io.html#io-read-csv-table">从 CSV 文件读取：</a>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv"><code>read_csv()</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [136]: pd.read_csv(&quot;foo.csv&quot;)</span><br><span class="line">Out[136]: </span><br><span class="line">   Unnamed: 0  0  1  2  3  4</span><br><span class="line">0           0  4  3  1  1  2</span><br><span class="line">1           1  1  0  2  3  2</span><br><span class="line">2           2  1  4  2  1  2</span><br><span class="line">3           3  0  4  0  2  2</span><br><span class="line">4           4  4  2  2  3  4</span><br><span class="line">5           5  4  0  4  3  1</span><br><span class="line">6           6  2  1  2  0  3</span><br><span class="line">7           7  4  0  4  4  4</span><br><span class="line">8           8  4  4  1  0  1</span><br><span class="line">9           9  0  4  3  0  3</span><br></pre></td></tr></table></figure>
<h3 id="Parquet">Parquet<a href="#parquet" title="Link to this heading">#</a></h3>
<p>写入 Parquet 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [137]: df.to_parquet(&quot;foo.parquet&quot;)</span><br></pre></td></tr></table></figure>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.read_parquet.html#pandas.read_parquet" title="pandas.read_parquet"><code>read_parquet()</code></a>从 Parquet 文件读取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [138]: pd.read_parquet(&quot;foo.parquet&quot;)</span><br><span class="line">Out[138]: </span><br><span class="line">   0  1  2  3  4</span><br><span class="line">0  4  3  1  1  2</span><br><span class="line">1  1  0  2  3  2</span><br><span class="line">2  1  4  2  1  2</span><br><span class="line">3  0  4  0  2  2</span><br><span class="line">4  4  2  2  3  4</span><br><span class="line">5  4  0  4  3  1</span><br><span class="line">6  2  1  2  0  3</span><br><span class="line">7  4  0  4  4  4</span><br><span class="line">8  4  4  1  0  1</span><br><span class="line">9  0  4  3  0  3</span><br></pre></td></tr></table></figure>
<h3 id="Excel">Excel<a href="#excel" title="Link to this heading">#</a></h3>
<p>读写<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/io.html#io-excel">Excel</a>。</p>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.to_excel.html#pandas.DataFrame.to_excel" title="pandas.DataFrame.to_excel"><code>DataFrame.to_excel()</code></a>写入 Excel 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [139]: df.to_excel(&quot;foo.xlsx&quot;, sheet_name=&quot;Sheet1&quot;)</span><br></pre></td></tr></table></figure>
<p>使用<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.read_excel.html#pandas.read_excel" title="pandas.read_excel"><code>read_excel()</code></a>从 Excel 文件读取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [140]: pd.read_excel(&quot;foo.xlsx&quot;, &quot;Sheet1&quot;, index_col=None, na_values=[&quot;NA&quot;])</span><br><span class="line">Out[140]: </span><br><span class="line">   Unnamed: 0  0  1  2  3  4</span><br><span class="line">0           0  4  3  1  1  2</span><br><span class="line">1           1  1  0  2  3  2</span><br><span class="line">2           2  1  4  2  1  2</span><br><span class="line">3           3  0  4  0  2  2</span><br><span class="line">4           4  4  2  2  3  4</span><br><span class="line">5           5  4  0  4  3  1</span><br><span class="line">6           6  2  1  2  0  3</span><br><span class="line">7           7  4  0  4  4  4</span><br><span class="line">8           8  4  4  1  0  1</span><br><span class="line">9           9  0  4  3  0  3</span><br></pre></td></tr></table></figure>
<h2 id="常见陷阱">常见陷阱<a href="#gotchas" title="Link to this heading">#</a></h2>
<p>如果您尝试对<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.Series"><code>Series</code></a>或<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.DataFrame"><code>DataFrame</code></a>执行布尔操作，可能会看到类似以下的异常：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">In [141]: if pd.Series([False, True, False]):</span><br><span class="line">   .....:      print(&quot;I was true&quot;)</span><br><span class="line">   .....: </span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-141-b27eb9c1dfc0&gt; in ?()</span><br><span class="line">----&gt; 1 if pd.Series([False, True, False]):</span><br><span class="line">      2      print(&quot;I was true&quot;)</span><br><span class="line"></span><br><span class="line">~/work/pandas/pandas/pandas/core/generic.py in ?(self)</span><br><span class="line">   1575     @final</span><br><span class="line">   1576     def __nonzero__(self) -&gt; NoReturn:</span><br><span class="line">-&gt; 1577         raise ValueError(</span><br><span class="line">   1578             f&quot;The truth value of a &#123;type(self).__name__&#125; is ambiguous. &quot;</span><br><span class="line">   1579             &quot;Use a.empty, a.bool(), a.item(), a.any() or a.all().&quot;</span><br><span class="line">   1580         )</span><br><span class="line"></span><br><span class="line">ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</span><br></pre></td></tr></table></figure>
<p>请参阅<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/basics.html#basics-compare">比较</a>和<a target="_blank" rel="noopener" href="https://pandas.ac.cn/docs/user_guide/gotchas.html#gotchas">常见陷阱</a>以获取解释和解决方法。</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">標籤</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="../../../../../tags/pandas/" rel="tag">pandas</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="../../../../10/12/database/mysql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"
                    data-tooltip="mysql基础教程"
                    aria-label="上一篇: mysql基础教程"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="../../../../03/15/Algorithms/23.%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"
                    data-tooltip="23. 最小生成树"
                    aria-label="下一篇: 23. 最小生成树"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Weibo"
                    aria-label="分享到 Weibo"
                >
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="../../../../10/12/database/mysql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"
                    data-tooltip="mysql基础教程"
                    aria-label="上一篇: mysql基础教程"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="../../../../03/15/Algorithms/23.%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"
                    data-tooltip="23. 最小生成树"
                    aria-label="下一篇: 23. 最小生成树"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                    title="分享到 Weibo"
                    aria-label="分享到 Weibo"
                >
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                        aria-label="分享到 Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                        aria-label="分享到 Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                        aria-label="global.share_on_linkedin"
                    >
                        <i class="fab fa-linkedin" aria-hidden="true"></i><span>global.share_on_linkedin</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="http://service.weibo.com/share/share.php?&amp;title=https://chankein.github.io/2015/06/16/database/pandas-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"
                        aria-label="分享到 Weibo"
                    >
                        <i class="fab fa-weibo" aria-hidden="true"></i><span>分享到 Weibo</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../../../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>分享一些技術教程,命令備忘(cheat-sheet)等</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</br>資深技術顧問</br>數據科學家</br>Hit廣島觀光大使</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macau
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/27/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"
                            aria-label=": R语言-环境安装"
                        >
                            <h3 class="media-heading">R语言-环境安装</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月27日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/28/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E5%9F%BA%E7%A1%80/"
                            aria-label=": R语言-基础"
                        >
                            <h3 class="media-heading">R语言-基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/01/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE/"
                            aria-label=": R语言-读取数据"
                        >
                            <h3 class="media-heading">R语言-读取数据</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/02/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BB%98%E5%9B%BE/"
                            aria-label=": R语言-绘图"
                        >
                            <h3 class="media-heading">R语言-绘图</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月2日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/03/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"
                            aria-label=": R语言-线性回归"
                        >
                            <h3 class="media-heading">R语言-线性回归</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月3日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/22/Algorithms/1.%E7%AE%97%E6%B3%95%E5%9C%A8%E8%AE%A1%E7%AE%97%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8/"
                            aria-label=": 1. 算法在计算中的作用"
                        >
                            <h3 class="media-heading">1. 算法在计算中的作用</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月22日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/23/Algorithms/2.%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/"
                            aria-label=": 2. 算法基础"
                        >
                            <h3 class="media-heading">2. 算法基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月23日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/24/Algorithms/3.%E5%87%BD%E6%95%B0%E7%9A%84%E5%A2%9E%E9%95%BF/"
                            aria-label=": 3. 函数的增长"
                        >
                            <h3 class="media-heading">3. 函数的增长</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月24日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/25/Algorithms/4.%E5%88%86%E6%B2%BB%E7%AD%96%E7%95%A5/"
                            aria-label=": 4. 分治策略"
                        >
                            <h3 class="media-heading">4. 分治策略</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月25日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/02/26/Algorithms/5.%E6%A6%82%E7%8E%87%E5%88%86%E6%9E%90%E5%92%8C%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95/"
                            aria-label=": 5. 概率分析和随机算法"
                        >
                            <h3 class="media-heading">5. 概率分析和随机算法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年2月26日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 210 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../../../../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../../../../../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
