
<!DOCTYPE html>
<html lang="zh-tw">
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">

    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    
      <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/locale/zh-tw.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script>
      window.algoliaConfig = {
        appId: 'AWFC86Q51O',
        apiKey: 'c9d952906eb1b154d75cf863e75c1ede',
        indexName: 'MyBlog'
      };
      var algoliaIndex = algoliasearch(
        algoliaConfig.appId,
        algoliaConfig.apiKey
      ).initIndex(algoliaConfig.indexName);
    </script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"Website","@id":"https://chankein.github.io","author":{"@type":"Person","name":"Kein Chan","sameAs":["https://github.com/chankein/","https://www.linkedin.com/profile/","mailto:kein.chan85@gmail.com"],"image":"profile.jpg"},"name":"Kein's blog","description":"","url":"https://chankein.github.io"}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Kein&#39;s blog">
<meta property="og:url" content="https://chankein.github.io/page/7/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Kein Chan">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../../#about"
            >
        
        
            <img class="header-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2017/04/28/linux%E5%9F%BA%E7%A1%80/"
                            aria-label=": linux基础"
                        >
                            linux基础
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2017-04-28T22:06:40+08:00">
	
		    2017 年 4 月 28 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E5%90%8E%E7%AB%AF/">后端</a>, <a class="category-link" href="../../categories/%E5%90%8E%E7%AB%AF/linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>Linux 基础操作笔记</h1>
<h2 id="1-文件操作">1. 文件操作</h2>
<h3 id="1-1-创建文件">1.1 创建文件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建单个文件</span></span><br><span class="line"><span class="built_in">touch</span> file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量创建文件（创建love_1_linux.txt到love_10_linux.txt）</span></span><br><span class="line"><span class="built_in">touch</span> love_&#123;1..10&#125;_linux.txt</span><br></pre></td></tr></table></figure>
<h3 id="1-2-文件权限查看">1.2 文件权限查看</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l  <span class="comment"># 详细列表显示文件权限</span></span><br></pre></td></tr></table></figure>
<p>输出示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r-- 1 user group 1024 Mar 1 10:00 example.txt</span><br></pre></td></tr></table></figure>
<p>权限字段说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[文件类型][所有者权限][组权限][其他用户权限]</span><br><span class="line">d rwx r-x r-x</span><br></pre></td></tr></table></figure>
<ul>
<li>文件类型：<code>-</code>普通文件，<code>d</code>目录，<code>l</code>链接文件</li>
<li>权限组成：<code>r</code>读(4) + <code>w</code>写(2) + <code>x</code>执行(1)</li>
</ul>
<h2 id="2-帮助系统">2. 帮助系统</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">man &lt;<span class="built_in">command</span>&gt;  <span class="comment"># 查看命令手册</span></span><br><span class="line">man <span class="built_in">ls</span>         <span class="comment"># 示例：查看ls命令手册</span></span><br></pre></td></tr></table></figure>
<p>常用操作键：</p>
<ul>
<li>空格键：向下翻页</li>
<li><code>q</code>：退出手册</li>
<li><code>/</code>：搜索内容</li>
</ul>
<h2 id="3-用户管理">3. 用户管理</h2>
<h3 id="3-1-用户查看命令">3.1 用户查看命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">whoami</span>        <span class="comment"># 显示当前用户名</span></span><br><span class="line"><span class="built_in">who</span> am i      <span class="comment"># 显示登录信息</span></span><br><span class="line"><span class="built_in">who</span> -m        <span class="comment"># 同&quot;who am i&quot;</span></span><br><span class="line"><span class="built_in">who</span> mom likes <span class="comment"># 显示特定用户信息（需实际用户存在）</span></span><br></pre></td></tr></table></figure>
<h3 id="3-2-用户操作">3.2 用户操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建用户（自动创建home目录）</span></span><br><span class="line"><span class="built_in">sudo</span> adduser lilei</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已创建用户</span></span><br><span class="line"><span class="built_in">ls</span> /home</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换用户</span></span><br><span class="line">su -l lilei   <span class="comment"># &quot;-l&quot;模拟完整登录环境</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除用户及home目录</span></span><br><span class="line"><span class="built_in">sudo</span> deluser lilei --remove-home</span><br></pre></td></tr></table></figure>
<h2 id="4-用户组管理">4. 用户组管理</h2>
<h3 id="4-1-用户组查看">4.1 用户组查看</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看指定用户所属组</span></span><br><span class="line"><span class="built_in">groups</span> shiyanlou</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有组（按字母排序）</span></span><br><span class="line"><span class="built_in">cat</span> /etc/group | <span class="built_in">sort</span></span><br></pre></td></tr></table></figure>
<p><code>/etc/group</code> 文件格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group_name:password:GID:user_list</span><br></pre></td></tr></table></figure>
<h3 id="4-2-用户组操作">4.2 用户组操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加用户到组（需要root权限）</span></span><br><span class="line"><span class="built_in">sudo</span> usermod -aG <span class="built_in">sudo</span> lilei  <span class="comment"># 示例：添加sudo组</span></span><br></pre></td></tr></table></figure>
<h2 id="5-权限管理">5. 权限管理</h2>
<h3 id="5-1-文件权限修改">5.1 文件权限修改</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 变更文件所有者</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> shiyanlou iphone6</span><br><span class="line"></span><br><span class="line"><span class="comment"># 变更文件所属组</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chgrp</span> group_name file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改所有权限（所有者/组/其他用户）</span></span><br><span class="line"><span class="built_in">chmod</span> 755 filename  <span class="comment"># rwxr-xr-x</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-权限数字表示法">5.2 权限数字表示法</h3>
<table>
<thead>
<tr>
<th>权限</th>
<th>数字</th>
</tr>
</thead>
<tbody>
<tr>
<td>r–</td>
<td>4</td>
</tr>
<tr>
<td>-w-</td>
<td>2</td>
</tr>
<tr>
<td>–x</td>
<td>1</td>
</tr>
<tr>
<td>rwx</td>
<td>7 (4+2+1)</td>
</tr>
</tbody>
</table>
<h2 id="6-文件类型说明">6. 文件类型说明</h2>
<p>Linux 一切皆文件，主要类型包括：</p>
<ul>
<li><code>-</code>：普通文件</li>
<li><code>d</code>：目录文件</li>
<li><code>l</code>：符号链接（相当于快捷方式）</li>
<li><code>c</code>：字符设备文件</li>
<li><code>b</code>：块设备文件</li>
<li><code>s</code>：套接字文件</li>
<li><code>p</code>：管道文件</li>
</ul>
<h2 id="7-重要补充说明">7. 重要补充说明</h2>
<ol>
<li>
<p>目录权限特殊含义：</p>
<ul>
<li>读权限：可查看目录内容</li>
<li>写权限：可创建/删除文件</li>
<li>执行权限：可进入目录</li>
</ul>
</li>
<li>
<p>新建用户默认会：</p>
<ul>
<li>创建同名用户组</li>
<li>在<code>/home</code>下创建用户目录</li>
<li>基本配置文件从<code>/etc/skel</code>复制</li>
</ul>
</li>
<li>
<p>sudo权限配置路径：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/sudoers</span><br><span class="line">/etc/sudoers.d/</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>建议后续可补充：</p>
<ul>
<li>实际权限修改案例</li>
<li>用户组管理实验</li>
<li>sudoers文件的配置方法</li>
<li>ACL高级权限控制</li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2017/04/28/linux%E5%9F%BA%E7%A1%80/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2015/10/12/mysql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"
                            aria-label=": mysql基础教程"
                        >
                            mysql基础教程
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2015-10-12T10:00:15+08:00">
	
		    2015 年 10 月 12 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/database/">database</a>, <a class="category-link" href="../../categories/database/mysql/">mysql</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>为什么需要数据库？</p>
<p>因为应用程序需要保存用户的数据，比如Word需要把用户文档保存起来，以便下次继续编辑或者拷贝到另一台电脑。</p>
<p>要保存用户的数据，一个最简单的方法是把用户数据写入文件。例如，要保存一个班级所有学生的信息，可以向文件中写入一个CSV文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id,name,gender,score</span><br><span class="line">1,小明,M,90</span><br><span class="line">2,小红,F,95</span><br><span class="line">3,小军,M,88</span><br><span class="line">4,小丽,F,88</span><br></pre></td></tr></table></figure>
<p>如果要保存学校所有班级的信息，可以写入另一个CSV文件。</p>
<p>但是，随着应用程序的功能越来越复杂，数据量越来越大，如何管理这些数据就成了大问题：</p>
<ul>
<li>读写文件并解析出数据需要大量重复代码；</li>
<li>从成千上万的数据中快速查询出指定数据需要复杂的逻辑。</li>
</ul>
<p>如果每个应用程序都各自写自己的读写数据的代码，一方面效率低，容易出错，另一方面，每个应用程序访问数据的接口都不相同，数据难以复用。</p>
<p>所以，数据库作为一种专门管理数据的软件就出现了。应用程序不需要自己管理数据，而是通过数据库软件提供的接口来读写数据。至于数据本身如何存储到文件，那是数据库软件的事情，应用程序自己并不关心：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌───────────┐</span><br><span class="line">│application│</span><br><span class="line">└───────────┘</span><br><span class="line">     ▲ │</span><br><span class="line">     │ │</span><br><span class="line"> read│ │write</span><br><span class="line">     │ │</span><br><span class="line">     │ ▼</span><br><span class="line">┌───────────┐</span><br><span class="line">│ database  │</span><br><span class="line">└───────────┘</span><br></pre></td></tr></table></figure>
<p>这样一来，编写应用程序的时候，数据读写的功能就被大大地简化了。</p>
<h3 id="数据模型">数据模型</h3>
<p>数据库按照数据结构来组织、存储和管理数据，实际上，数据库一共有三种模型：</p>
<ul>
<li>层次模型</li>
<li>网状模型</li>
<li>关系模型</li>
</ul>
<p>层次模型就是以“上下级”的层次关系来组织数据的一种方式，层次模型的数据结构看起来就像一颗树：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">            ┌─────┐</span><br><span class="line">            │     │</span><br><span class="line">            └─────┘</span><br><span class="line">               │</span><br><span class="line">       ┌───────┴───────┐</span><br><span class="line">       │               │</span><br><span class="line">    ┌─────┐         ┌─────┐</span><br><span class="line">    │     │         │     │</span><br><span class="line">    └─────┘         └─────┘</span><br><span class="line">       │               │</span><br><span class="line">   ┌───┴───┐       ┌───┴───┐</span><br><span class="line">   │       │       │       │</span><br><span class="line">┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐</span><br><span class="line">│     │ │     │ │     │ │     │</span><br><span class="line">└─────┘ └─────┘ └─────┘ └─────┘</span><br></pre></td></tr></table></figure>
<p>网状模型把每个数据节点和其他很多节点都连接起来，它的数据结构看起来就像很多城市之间的路网：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">     ┌─────┐      ┌─────┐</span><br><span class="line">   ┌─│     │──────│     │──┐</span><br><span class="line">   │ └─────┘      └─────┘  │</span><br><span class="line">   │    │            │     │</span><br><span class="line">   │    └──────┬─────┘     │</span><br><span class="line">   │           │           │</span><br><span class="line">┌─────┐     ┌─────┐     ┌─────┐</span><br><span class="line">│     │─────│     │─────│     │</span><br><span class="line">└─────┘     └─────┘     └─────┘</span><br><span class="line">   │           │           │</span><br><span class="line">   │     ┌─────┴─────┐     │</span><br><span class="line">   │     │           │     │</span><br><span class="line">   │  ┌─────┐     ┌─────┐  │</span><br><span class="line">   └──│     │─────│     │──┘</span><br><span class="line">      └─────┘     └─────┘</span><br></pre></td></tr></table></figure>
<p>关系模型把数据看作是一个二维表格，任何数据都可以通过行号+列号来唯一确定，它的数据模型看起来就是一个Excel表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌─────┬─────┬─────┬─────┬─────┐</span><br><span class="line">│     │     │     │     │     │</span><br><span class="line">├─────┼─────┼─────┼─────┼─────┤</span><br><span class="line">│     │     │     │     │     │</span><br><span class="line">├─────┼─────┼─────┼─────┼─────┤</span><br><span class="line">│     │     │     │     │     │</span><br><span class="line">├─────┼─────┼─────┼─────┼─────┤</span><br><span class="line">│     │     │     │     │     │</span><br><span class="line">└─────┴─────┴─────┴─────┴─────┘</span><br></pre></td></tr></table></figure>
<p>随着时间的推移和市场竞争，最终，基于关系模型的关系数据库获得了绝对市场份额。</p>
<p>为什么关系数据库获得了最广泛的应用？</p>
<p>因为相比层次模型和网状模型，关系模型理解和使用起来最简单。</p>
<p>关系数据库的关系模型是基于数学理论建立的。我们把域（Domain）定义为一组具有相同数据类型的值的集合，给定一组域D1,D2,…,Dn，它们的笛卡尔集定义为D1×D2×……×Dn={(d1,d2,…,dn)|di∈Di,i=1,2,…,n}， 而D1×D2×……×Dn的子集叫作在域D1,D2,…,Dn上的关系，表示为R(D1,D2,…,Dn)，这里的R表示#%&amp;^@!&amp;$#;!~％¥%……算了，根本讲不明白，大家也不用理解。</p>
<p>基于数学理论的关系模型虽然讲起来挺复杂，但是，基于日常生活的关系模型却十分容易理解。我们以学校班级为例，一个班级的学生就可以用一个表格存起来，并且定义如下：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>姓名</th>
<th>班级ID</th>
<th>性别</th>
<th>年龄</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>小明</td>
<td>201</td>
<td>M</td>
<td>9</td>
</tr>
<tr>
<td>2</td>
<td>小红</td>
<td>202</td>
<td>F</td>
<td>8</td>
</tr>
<tr>
<td>3</td>
<td>小军</td>
<td>202</td>
<td>M</td>
<td>8</td>
</tr>
<tr>
<td>4</td>
<td>小白</td>
<td>201</td>
<td>F</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>其中，班级ID对应着另一个班级表：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>名称</th>
<th>班主任</th>
</tr>
</thead>
<tbody>
<tr>
<td>201</td>
<td>二年级一班</td>
<td>王老师</td>
</tr>
<tr>
<td>202</td>
<td>二年级二班</td>
<td>李老师</td>
</tr>
</tbody>
</table>
<p>通过给定一个班级名称，可以查到一条班级记录，根据班级ID，又可以查到多条学生记录，这样，二维表之间就通过ID映射建立了“一对多”关系。</p>
<h3 id="数据类型">数据类型</h3>
<p>对于一个关系表，除了定义每一列的名称外，还需要定义每一列的数据类型。关系数据库支持的标准数据类型包括数值、字符串、时间等：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>INT</td>
<td>整型</td>
<td>4字节整数类型，范围约+/-21亿</td>
</tr>
<tr>
<td>BIGINT</td>
<td>长整型</td>
<td>8字节整数类型，范围约+/-922亿亿</td>
</tr>
<tr>
<td>REAL</td>
<td>浮点型</td>
<td>4字节浮点数，范围约+/-1038</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>浮点型</td>
<td>8字节浮点数，范围约+/-10308</td>
</tr>
<tr>
<td>DECIMAL(M,N)</td>
<td>高精度小数</td>
<td>由用户指定精度的小数，例如，DECIMAL(20,10)表示一共20位，其中小数10位，通常用于财务计算</td>
</tr>
<tr>
<td>CHAR(N)</td>
<td>定长字符串</td>
<td>存储指定长度的字符串，例如，CHAR(100)总是存储100个字符的字符串</td>
</tr>
<tr>
<td>VARCHAR(N)</td>
<td>变长字符串</td>
<td>存储可变长度的字符串，例如，VARCHAR(100)可以存储0~100个字符的字符串</td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>布尔类型</td>
<td>存储True或者False</td>
</tr>
<tr>
<td>DATE</td>
<td>日期类型</td>
<td>存储日期，例如，2018-06-22</td>
</tr>
<tr>
<td>TIME</td>
<td>时间类型</td>
<td>存储时间，例如，12:20:59</td>
</tr>
<tr>
<td>DATETIME</td>
<td>日期和时间类型</td>
<td>存储日期+时间，例如，2018-06-22 12:20:59</td>
</tr>
</tbody>
</table>
<p>上面的表中列举了最常用的数据类型。很多数据类型还有别名，例如，<code>REAL</code>又可以写成<code>FLOAT(24)</code>。还有一些不常用的数据类型，例如，<code>TINYINT</code>（范围在0~255）。各数据库厂商还会支持特定的数据类型，例如<code>JSON</code>。</p>
<p>选择数据类型的时候，要根据业务规则选择合适的类型。通常来说，<code>BIGINT</code>能满足整数存储的需求，<code>VARCHAR(N)</code>能满足字符串存储的需求，这两种类型是使用最广泛的。</p>
<h3 id="主流关系数据库">主流关系数据库</h3>
<p>目前，主流的关系数据库主要分为以下几类：</p>
<ol>
<li>商用数据库，例如：<a target="_blank" rel="noopener" href="https://www.oracle.com/">Oracle</a>，<a target="_blank" rel="noopener" href="https://www.microsoft.com/sql-server/">SQL Server</a>，<a target="_blank" rel="noopener" href="https://www.ibm.com/db2/">DB2</a>等；</li>
<li>开源数据库，例如：<a target="_blank" rel="noopener" href="https://www.mysql.com/">MySQL</a>，<a target="_blank" rel="noopener" href="https://www.postgresql.org/">PostgreSQL</a>等；</li>
<li>桌面数据库，以微软<a target="_blank" rel="noopener" href="https://products.office.com/access">Access</a>为代表，适合桌面应用程序使用；</li>
<li>嵌入式数据库，以<a target="_blank" rel="noopener" href="https://sqlite.org/">Sqlite</a>为代表，适合手机应用和桌面程序。</li>
</ol>
<h3 id="SQL">SQL</h3>
<p>什么是SQL？SQL是结构化查询语言的缩写，用来访问和操作数据库系统。SQL语句既可以查询数据库中的数据，也可以添加、更新和删除数据库中的数据，还可以对数据库进行管理和维护操作。不同的数据库，都支持SQL，这样，我们通过学习SQL这一种语言，就可以操作各种不同的数据库。</p>
<p>虽然SQL已经被ANSI组织定义为标准，不幸地是，各个不同的数据库对标准的SQL支持不太一致。并且，大部分数据库都在标准的SQL上做了扩展。也就是说，如果只使用标准SQL，理论上所有数据库都可以支持，但如果使用某个特定数据库的扩展SQL，换一个数据库就不能执行了。例如，Oracle把自己扩展的SQL称为<code>PL/SQL</code>，Microsoft把自己扩展的SQL称为<code>T-SQL</code>。</p>
<p>现实情况是，如果我们只使用标准SQL的核心功能，那么所有数据库通常都可以执行。不常用的SQL功能，不同的数据库支持的程度都不一样。而各个数据库支持的各自扩展的功能，通常我们把它们称之为“方言”。</p>
<p>总的来说，SQL语言定义了这么几种操作数据库的能力：</p>
<h4 id="DDL：Data-Definition-Language">DDL：Data Definition Language</h4>
<p>DDL允许用户定义数据，也就是创建表、删除表、修改表结构这些操作。通常，DDL由数据库管理员执行。</p>
<h4 id="DML：Data-Manipulation-Language">DML：Data Manipulation Language</h4>
<p>DML为用户提供添加、删除、更新数据的能力，这些是应用程序对数据库的日常操作。</p>
<h4 id="DQL：Data-Query-Language">DQL：Data Query Language</h4>
<p>DQL允许用户查询数据，这也是通常最频繁的数据库日常操作。</p>
<h3 id="语法特点">语法特点</h3>
<p>SQL语言关键字不区分大小写！！！但是，针对不同的数据库，对于表名和列名，有的数据库区分大小写，有的数据库不区分大小写。同一个数据库，有的在Linux上区分大小写，有的在Windows上不区分大小写。</p>
<p>所以，本教程约定：SQL关键字总是大写，以示突出，表名和列名均使用小写。</p>
<p>MySQL是目前应用最广泛的开源关系数据库。MySQL最早是由瑞典的MySQL AB公司开发，该公司在2008年被SUN公司收购，紧接着，SUN公司在2009年被Oracle公司收购，所以MySQL最终就变成了Oracle旗下的产品。</p>
<p>和其他关系数据库有所不同的是，MySQL本身实际上只是一个SQL接口，它的内部还包含了多种数据引擎，常用的包括：</p>
<ul>
<li>InnoDB：由Innobase Oy公司开发的一款支持事务的数据库引擎，2006年被Oracle收购；</li>
<li>MyISAM：MySQL早期集成的默认数据库引擎，不支持事务。</li>
</ul>
<p>MySQL接口和数据库引擎的关系就好比某某浏览器和浏览器引擎（IE引擎或Webkit引擎）的关系。对用户而言，切换浏览器引擎不影响浏览器界面，切换MySQL引擎不影响自己写的应用程序使用MySQL的接口。</p>
<p>使用MySQL时，不同的表还可以使用不同的数据库引擎。如果你不知道应该采用哪种引擎，记住总是选择<em>InnoDB</em>就好了。</p>
<p>因为MySQL一开始就是开源的，所以基于MySQL的开源版本，又衍生出了各种版本：</p>
<h3 id="MariaDB">MariaDB</h3>
<p>由MySQL的创始人创建的一个开源分支版本，使用XtraDB引擎。</p>
<h3 id="Aurora">Aurora</h3>
<p>由Amazon改进的一个MySQL版本，专门提供给在AWS托管MySQL用户，号称5倍的性能提升。</p>
<h3 id="PolarDB">PolarDB</h3>
<p>由Alibaba改进的一个MySQL版本，专门提供给在阿里云托管的MySQL用户，号称6倍的性能提升。</p>
<p>而MySQL官方版本又分了好几个版本：</p>
<ul>
<li>Community Edition：社区开源版本，免费；</li>
<li>Standard Edition：标准版；</li>
<li>Enterprise Edition：企业版；</li>
<li>Cluster Carrier Grade Edition：集群版。</li>
</ul>
<p>以上版本的功能依次递增，价格也依次递增。不过，功能增加的主要是监控、集群等管理功能，对于基本的SQL功能是完全一样的。</p>
<p>所以使用MySQL就带来了一个巨大的好处：可以在自己的电脑上安装免费的Community Edition版本，进行学习、开发、测试，部署的时候，可以选择付费的高级版本，或者云服务商提供的兼容版本，而不需要对应用程序本身做改动。</p>
<h3 id="安装MySQL">安装MySQL</h3>
<p>要安装MySQL，可以从MySQL官方网站下载最新的MySQL Community Server版本：</p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a></p>
<p>选择对应的操作系统版本，下载安装即可。在安装过程中，MySQL会自动创建一个<code>root</code>用户，并提示输入<code>root</code>口令。</p>
<p>要在Linux上安装MySQL，可以使用发行版的包管理器。例如，Debian和Ubuntu用户可以简单地通过命令<code>apt install mysql-server</code>安装最新的MySQL版本。</p>
<p>MySQL安装后会自动在后台运行。为了验证MySQL安装是否正确，我们需要通过<code>mysql</code>这个命令行程序来连接MySQL服务器。</p>
<p>在命令提示符下输入<code>mysql -u root -p</code>，然后输入口令，如果一切正确，就会连接到MySQL服务器，同时提示符变为<code>mysql&gt;</code>。</p>
<p>输入<code>exit</code>退出MySQL命令行。注意，MySQL服务器仍在后台运行。</p>
<h3 id="使用Docker运行MySQL">使用Docker运行MySQL</h3>
<p>另一种运行MySQL的方式不需要下载安装包，而是直接通过Docker安装最新的MySQL：</p>
<p>首先安装<a target="_blank" rel="noopener" href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a>，然后在命令行输入以下命令拉取MySQL最新版：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker pull mysql</span><br></pre></td></tr></table></figure>
<p>拉取完成后，输入以下命令直接启动MySQL服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=password -v /Users/chankein/mysql-data:/var/lib/mysql mysql</span><br></pre></td></tr></table></figure>
<p>命令<code>docker run</code>表示启动一个容器，后面各参数含义如下：</p>
<ul>
<li><code>-d</code>：表示在后台执行；</li>
<li><code>--name mysql</code>：表示容器的名字，不输入Docker会自动选择一个名字；</li>
<li><code>-p 3306:3306</code>：表示把容器的端口3306映射到本机，这样可以在本机通过3306端口连接MySQL；</li>
<li><code>-e MYSQL_ROOT_PASSWORD=password</code>：表示传入一个环境变量，作为root的口令，这里设置的口令是<code>password</code>，不输入此项则会自动生成一个口令，需要查看日志才能知道口令；</li>
<li><code>-v /Users/chankein/mysql-data:/var/lib/mysql</code>：表示将本地目录映射到容器目录<code>/var/lib/mysql</code>作为MySQL数据库存放的位置，需要将<code>/Users/chankein/mysql-data</code>改为你的电脑上的实际目录；</li>
<li><code>mysql</code>：最后一个参数是Docker镜像的名称。</li>
</ul>
<p>可以在Docker Desktop的管理窗口中选择<code>Containers</code>，看到正在运行的MySQL：</p>
<p><img src="https://liaoxuefeng.com/books/sql/rdbms/install-mysql/docker-mysql.png" alt="docker-mysql"></p>
<p>点击MySQL查看日志：</p>
<p><img src="https://liaoxuefeng.com/books/sql/rdbms/install-mysql/docker-mysql-log.png" alt="docker-mysql-log"></p>
<p>点击Exec进入命令行，输入命令<code>mysql -u root -p</code>，输入口令，即可进入MySQL命令行界面：</p>
<p><img src="https://liaoxuefeng.com/books/sql/rdbms/install-mysql/docker-mysql-exec.png" alt="docker-mysql-exec"></p>
<p>使用Docker运行MySQL时，任何时候都可以删除MySQL容器并重新运行。如果删除了本地映射的目录，重新运行就相当于一个全新的MySQL，因此，建议仅作为学习和开发使用，不要存储重要的数据。</p>
<h2 id="关系模型">关系模型</h2>
<p>我们已经知道，关系数据库是建立在关系模型上的。而关系模型本质上就是若干个存储数据的二维表，可以把它们看作很多Excel表。</p>
<p>表的每一行称为记录（Record），记录是一个逻辑意义上的数据。</p>
<p>表的每一列称为字段（Column），同一个表的每一行记录都拥有相同的若干字段。</p>
<p>字段定义了数据类型（整型、浮点型、字符串、日期等），以及是否允许为<code>NULL</code>。注意<code>NULL</code>表示字段数据不存在。一个整型字段如果为<code>NULL</code>不表示它的值为<code>0</code>，同样的，一个字符串型字段为<code>NULL</code>也不表示它的值为空串<code>''</code>。</p>
<p>提示</p>
<p>通常情况下，字段应该避免允许为NULL。不允许为NULL可以简化查询条件，加快查询速度，也利于应用程序读取数据后无需判断是否为NULL。</p>
<p>和Excel表有所不同的是，关系数据库的表和表之间需要建立“一对多”，“多对一”和“一对一”的关系，这样才能够按照应用程序的逻辑来组织和存储数据。</p>
<p>例如，一个班级表：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>名称</th>
<th>班主任</th>
</tr>
</thead>
<tbody>
<tr>
<td>201</td>
<td>二年级一班</td>
<td>王老师</td>
</tr>
<tr>
<td>202</td>
<td>二年级二班</td>
<td>李老师</td>
</tr>
</tbody>
</table>
<p>每一行对应着一个班级，而一个班级对应着多个学生，所以班级表和学生表的关系就是“一对多”：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>姓名</th>
<th>班级ID</th>
<th>性别</th>
<th>年龄</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>小明</td>
<td>201</td>
<td>M</td>
<td>9</td>
</tr>
<tr>
<td>2</td>
<td>小红</td>
<td>202</td>
<td>F</td>
<td>8</td>
</tr>
<tr>
<td>3</td>
<td>小军</td>
<td>202</td>
<td>M</td>
<td>8</td>
</tr>
<tr>
<td>4</td>
<td>小白</td>
<td>201</td>
<td>F</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>反过来，如果我们先在学生表中定位了一行记录，例如<code>ID=1</code>的小明，要确定他的班级，只需要根据他的“班级ID”对应的值<code>201</code>找到班级表中<code>ID=201</code>的记录，即二年级一班。所以，学生表和班级表是“多对一”的关系。</p>
<p>如果我们把班级表分拆得细一点，例如，单独创建一个教师表：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>名称</th>
<th>年龄</th>
</tr>
</thead>
<tbody>
<tr>
<td>A1</td>
<td>王老师</td>
<td>26</td>
</tr>
<tr>
<td>A2</td>
<td>张老师</td>
<td>39</td>
</tr>
<tr>
<td>A3</td>
<td>李老师</td>
<td>32</td>
</tr>
<tr>
<td>A4</td>
<td>赵老师</td>
<td>27</td>
</tr>
</tbody>
</table>
<p>班级表只存储教师ID：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>名称</th>
<th>班主任ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>201</td>
<td>二年级一班</td>
<td>A1</td>
</tr>
<tr>
<td>202</td>
<td>二年级二班</td>
<td>A3</td>
</tr>
</tbody>
</table>
<p>这样，一个班级总是对应一个教师，班级表和教师表就是“一对一”关系。</p>
<p>在关系数据库中，关系是通过<em>主键</em>和<em>外键</em>来维护的。我们在后面会分别深入讲解。</p>
<h2 id="主键">主键</h2>
<p>在关系数据库中，一张表中的每一行数据被称为一条记录。一条记录就是由多个字段组成的。例如，<code>students</code>表的两行记录：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>class_id</th>
<th>name</th>
<th>gender</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>小明</td>
<td>M</td>
<td>90</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>小红</td>
<td>F</td>
<td>95</td>
</tr>
</tbody>
</table>
<p>每一条记录都包含若干定义好的字段。同一个表的所有记录都有相同的字段定义。</p>
<p>对于关系表，有个很重要的约束，就是任意两条记录不能重复。不能重复不是指两条记录不完全相同，而是指能够通过某个字段唯一区分出不同的记录，这个字段被称为<em>主键</em>。</p>
<p>例如，假设我们把<code>name</code>字段作为主键，那么通过名字<code>小明</code>或<code>小红</code>就能唯一确定一条记录。但是，这么设定，就没法存储同名的同学了，因为插入相同主键的两条记录是不被允许的。</p>
<p>对主键的要求，最关键的一点是：记录一旦插入到表中，主键最好不要再修改，因为主键是用来唯一定位记录的，修改了主键，会造成一系列的影响。</p>
<p>由于主键的作用十分重要，如何选取主键会对业务开发产生重要影响。如果我们以学生的身份证号作为主键，似乎能唯一定位记录。然而，身份证号也是一种业务场景，如果身份证号升位了，或者需要变更，作为主键，不得不修改的时候，就会对业务产生严重影响。</p>
<p>所以，选取主键的一个基本原则是：不使用任何业务相关的字段作为主键。</p>
<p>因此，身份证号、手机号、邮箱地址这些看上去可以唯一的字段，均<em>不可</em>用作主键。</p>
<p>作为主键最好是完全业务无关的字段，我们一般把这个字段命名为<code>id</code>。常见的可作为<code>id</code>字段的类型有：</p>
<ol>
<li>自增整数类型：数据库会在插入数据时自动为每一条记录分配一个自增整数，这样我们就完全不用担心主键重复，也不用自己预先生成主键；</li>
<li>全局唯一GUID类型：也称UUID，使用一种全局唯一的字符串作为主键，类似<code>8f55d96b-8acc-4636-8cb8-76bf8abc2f57</code>。GUID算法通过网卡MAC地址、时间戳和随机数保证任意计算机在任意时间生成的字符串都是不同的，大部分编程语言都内置了GUID算法，可以自己预算出主键。</li>
</ol>
<p>对于大部分应用来说，通常自增类型的主键就能满足需求。我们在<code>students</code>表中定义的主键也是<code>BIGINT NOT NULL AUTO_INCREMENT</code>类型。</p>
<p>注意</p>
<p>如果使用INT自增类型，那么当一张表的记录数超过2147483647（约21亿）时，会达到上限而出错。使用BIGINT自增类型则可以最多约922亿亿条记录。</p>
<h3 id="联合主键">联合主键</h3>
<p>关系数据库实际上还允许通过多个字段唯一标识记录，即两个或更多的字段都设置为主键，这种主键被称为联合主键。</p>
<p>对于联合主键，允许一列有重复，只要不是所有主键列都重复即可：</p>
<table>
<thead>
<tr>
<th>id_num</th>
<th>id_type</th>
<th>other columns…</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>A</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>如果我们把上述表的<code>id_num</code>和<code>id_type</code>这两列作为联合主键，那么上面的3条记录都是允许的，因为没有两列主键组合起来是相同的。</p>
<p>没有必要的情况下，我们尽量不使用联合主键，因为它给关系表带来了复杂度的上升。</p>
<h3 id="小结">小结</h3>
<p>主键是关系表中记录的唯一标识。主键的选取非常重要：主键不要带有业务含义，而应该使用BIGINT自增或者GUID类型。主键也不应该允许<code>NULL</code>。</p>
<p>可以使用多个列作为联合主键，但联合主键并不常用。</p>
<p>当我们用主键唯一标识记录时，我们就可以在<code>students</code>表中确定任意一个学生的记录：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>other columns…</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>小明</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>小红</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>我们还可以在<code>classes</code>表中确定任意一个班级记录：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>other columns…</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>一班</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>二班</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>但是我们如何确定<code>students</code>表的一条记录，例如，<code>id=1</code>的小明，属于哪个班级呢？</p>
<p>由于一个班级可以有多个学生，在关系模型中，这两个表的关系可以称为“一对多”，即一个<code>classes</code>的记录可以对应多个<code>students</code>表的记录。</p>
<p>为了表达这种一对多的关系，我们需要在<code>students</code>表中加入一列<code>class_id</code>，让它的值与<code>classes</code>表的某条记录相对应：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>class_id</th>
<th>name</th>
<th>other columns…</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>小明</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>小红</td>
<td>…</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>小白</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>这样，我们就可以根据<code>class_id</code>这个列直接定位出一个<code>students</code>表的记录应该对应到<code>classes</code>的哪条记录。</p>
<p>例如：</p>
<ul>
<li>小明的<code>class_id</code>是<code>1</code>，因此，对应的<code>classes</code>表的记录是<code>id=1</code>的一班；</li>
<li>小红的<code>class_id</code>是<code>1</code>，因此，对应的<code>classes</code>表的记录是<code>id=1</code>的一班；</li>
<li>小白的<code>class_id</code>是<code>2</code>，因此，对应的<code>classes</code>表的记录是<code>id=2</code>的二班。</li>
</ul>
<p>在<code>students</code>表中，通过<code>class_id</code>的字段，可以把数据与另一张表关联起来，这种列称为<code>外键</code>。</p>
<p>外键并不是通过列名实现的，而是通过定义外键约束实现的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">ADD CONSTRAINT</span> fk_class_id</span><br><span class="line"><span class="keyword">FOREIGN KEY</span> (class_id)</span><br><span class="line"><span class="keyword">REFERENCES</span> classes (id);</span><br></pre></td></tr></table></figure>
<p>其中，外键约束的名称<code>fk_class_id</code>可以任意，<code>FOREIGN KEY (class_id)</code>指定了<code>class_id</code>作为外键，<code>REFERENCES classes (id)</code>指定了这个外键将关联到<code>classes</code>表的<code>id</code>列（即<code>classes</code>表的主键）。</p>
<p>通过定义外键约束，关系数据库可以保证无法插入无效的数据。即如果<code>classes</code>表不存在<code>id=99</code>的记录，<code>students</code>表就无法插入<code>class_id=99</code>的记录。</p>
<p>由于外键约束会降低数据库的性能，大部分互联网应用程序为了追求速度，并不设置外键约束，而是仅靠应用程序自身来保证逻辑的正确性。这种情况下，<code>class_id</code>仅仅是一个普通的列，只是它起到了外键的作用而已。</p>
<p>要删除一个外键约束，也是通过<code>ALTER TABLE</code>实现的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN KEY</span> fk_class_id;</span><br></pre></td></tr></table></figure>
<p>注意：删除外键约束并没有删除外键这一列。删除列是通过<code>DROP COLUMN ...</code>实现的。</p>
<h3 id="多对多">多对多</h3>
<p>通过一个表的外键关联到另一个表，我们可以定义出一对多关系。有些时候，还需要定义“多对多”关系。例如，一个老师可以对应多个班级，一个班级也可以对应多个老师，因此，班级表和老师表存在多对多关系。</p>
<p>多对多关系实际上是通过两个一对多关系实现的，即通过一个中间表，关联两个一对多关系，就形成了多对多关系：</p>
<p><code>teachers</code>表：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>张老师</td>
</tr>
<tr>
<td>2</td>
<td>王老师</td>
</tr>
<tr>
<td>3</td>
<td>李老师</td>
</tr>
<tr>
<td>4</td>
<td>赵老师</td>
</tr>
</tbody>
</table>
<p><code>classes</code>表：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>一班</td>
</tr>
<tr>
<td>2</td>
<td>二班</td>
</tr>
</tbody>
</table>
<p>中间表<code>teacher_class</code>关联两个一对多关系：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>teacher_id</th>
<th>class_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>通过中间表<code>teacher_class</code>可知<code>teachers</code>到<code>classes</code>的关系：</p>
<ul>
<li><code>id=1</code>的张老师对应<code>id=1,2</code>的一班和二班；</li>
<li><code>id=2</code>的王老师对应<code>id=1,2</code>的一班和二班；</li>
<li><code>id=3</code>的李老师对应<code>id=1</code>的一班；</li>
<li><code>id=4</code>的赵老师对应<code>id=2</code>的二班。</li>
</ul>
<p>同理可知<code>classes</code>到<code>teachers</code>的关系：</p>
<ul>
<li><code>id=1</code>的一班对应<code>id=1,2,3</code>的张老师、王老师和李老师；</li>
<li><code>id=2</code>的二班对应<code>id=1,2,4</code>的张老师、王老师和赵老师；</li>
</ul>
<p>因此，通过中间表，我们就定义了一个“多对多”关系。</p>
<h3 id="一对一">一对一</h3>
<p>一对一关系是指，一个表的记录对应到另一个表的唯一一个记录。</p>
<p>例如，<code>students</code>表的每个学生可以有自己的联系方式，如果把联系方式存入另一个表<code>contacts</code>，我们就可以得到一个“一对一”关系：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>student_id</th>
<th>mobile</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>135xxxx6300</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>138xxxx2209</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
<td>139xxxx8086</td>
</tr>
</tbody>
</table>
<p>有细心的童鞋会问，既然是一对一关系，那为啥不给<code>students</code>表增加一个<code>mobile</code>列，这样就能合二为一了？</p>
<p>如果业务允许，完全可以把两个表合为一个表。但是，有些时候，如果某个学生没有手机号，那么，<code>contacts</code>表就不存在对应的记录。实际上，一对一关系准确地说，是<code>contacts</code>表一对一对应<code>students</code>表。</p>
<p>还有一些应用会把一个大表拆成两个一对一的表，目的是把经常读取和不经常读取的字段分开，以获得更高的性能。例如，把一个大的用户表分拆为用户基本信息表<code>user_info</code>和用户详细信息表<code>user_profiles</code>，大部分时候，只需要查询<code>user_info</code>表，并不需要查询<code>user_profiles</code>表，这样就提高了查询速度。</p>
<h3 id="小结-2">小结</h3>
<p>关系数据库通过外键可以实现一对多、多对多和一对一的关系。外键既可以通过数据库来约束，也可以不设置约束，仅依靠应用程序的逻辑来保证。</p>
<p>在关系数据库中，如果有上万甚至上亿条记录，在查找记录的时候，想要获得非常快的速度，就需要使用索引。</p>
<p>索引是关系数据库中对某一列或多个列的值进行预排序的数据结构。通过使用索引，可以让数据库系统不必扫描整个表，而是直接定位到符合条件的记录，这样就大大加快了查询速度。</p>
<p>例如，对于<code>students</code>表：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>class_id</th>
<th>name</th>
<th>gender</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>小明</td>
<td>M</td>
<td>90</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>小红</td>
<td>F</td>
<td>95</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>小军</td>
<td>M</td>
<td>88</td>
</tr>
</tbody>
</table>
<p>如果要经常根据<code>score</code>列进行查询，就可以对<code>score</code>列创建索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> INDEX idx_score (score);</span><br></pre></td></tr></table></figure>
<p>使用<code>ADD INDEX idx_score (score)</code>就创建了一个名称为<code>idx_score</code>，使用列<code>score</code>的索引。索引名称是任意的，索引如果有多列，可以在括号里依次写上，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> INDEX idx_name_score (name, score);</span><br></pre></td></tr></table></figure>
<p>索引的效率取决于索引列的值是否散列，即该列的值如果越互不相同，那么索引效率越高。反过来，如果记录的列存在大量相同的值，例如<code>gender</code>列，大约一半的记录值是<code>M</code>，另一半是<code>F</code>，因此，对该列创建索引就没有意义。</p>
<p>可以对一张表创建多个索引。索引的优点是提高了查询效率，缺点是在插入、更新和删除记录时，需要同时修改索引，因此，索引越多，插入、更新和删除记录的速度就越慢。</p>
<p>对于主键，关系数据库会自动对其创建主键索引。使用主键索引的效率是最高的，因为主键会保证绝对唯一。</p>
<h3 id="唯一索引">唯一索引</h3>
<p>在设计关系数据表的时候，看上去唯一的列，例如身份证号、邮箱地址等，因为他们具有业务含义，因此不宜作为主键。</p>
<p>但是，这些列根据业务要求，又具有唯一性约束：即不能出现两条记录存储了同一个身份证号。这个时候，就可以给该列添加一个唯一索引。例如，我们假设<code>students</code>表的<code>name</code>不能重复：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> INDEX uni_name (name);</span><br></pre></td></tr></table></figure>
<p>通过<code>UNIQUE</code>关键字我们就添加了一个唯一索引。</p>
<p>也可以只对某一列添加一个唯一约束而不创建唯一索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> students</span><br><span class="line"><span class="keyword">ADD CONSTRAINT</span> uni_name <span class="keyword">UNIQUE</span> (name);</span><br></pre></td></tr></table></figure>
<p>这种情况下，<code>name</code>列没有索引，但仍然具有唯一性保证。</p>
<p>无论是否创建索引，对于用户和应用程序来说，使用关系数据库不会有任何区别。这里的意思是说，当我们在数据库中查询时，如果有相应的索引可用，数据库系统就会自动使用索引来提高查询效率，如果没有索引，查询也能正常执行，只是速度会变慢。因此，索引可以在使用数据库的过程中逐步优化。</p>
<h3 id="小结-3">小结</h3>
<p>通过对数据库表创建索引，可以提高查询速度；</p>
<p>通过创建唯一索引，可以保证某一列的值具有唯一性；</p>
<p>数据库索引对于用户和应用程序来说都是透明的。</p>
<p>在关系数据库中，最常用的操作就是查询。</p>
<h3 id="准备数据">准备数据</h3>
<p>为了便于讲解和练习，我们先准备好了一个<code>students</code>表和一个<code>classes</code>表，它们的结构和数据如下：</p>
<p><code>students</code>表存储了学生信息：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>class_id</th>
<th>name</th>
<th>gender</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>小明</td>
<td>M</td>
<td>90</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>小红</td>
<td>F</td>
<td>95</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>小军</td>
<td>M</td>
<td>88</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>小米</td>
<td>F</td>
<td>73</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>小白</td>
<td>F</td>
<td>81</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
<td>小兵</td>
<td>M</td>
<td>55</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
<td>小林</td>
<td>M</td>
<td>85</td>
</tr>
<tr>
<td>8</td>
<td>3</td>
<td>小新</td>
<td>F</td>
<td>91</td>
</tr>
<tr>
<td>9</td>
<td>3</td>
<td>小王</td>
<td>M</td>
<td>89</td>
</tr>
<tr>
<td>10</td>
<td>3</td>
<td>小丽</td>
<td>F</td>
<td>85</td>
</tr>
</tbody>
</table>
<p><code>classes</code>表存储了班级信息：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>一班</td>
</tr>
<tr>
<td>2</td>
<td>二班</td>
</tr>
<tr>
<td>3</td>
<td>三班</td>
</tr>
<tr>
<td>4</td>
<td>四班</td>
</tr>
</tbody>
</table>
<p>请注意，和<code>MySQL</code>的持久化存储不同的是，由于我们使用的是<a target="_blank" rel="noopener" href="https://alasql.org/">AlaSQL</a>内存数据库，两张表的数据在页面加载时导入，并且只存在于浏览器的内存中，因此，刷新页面后，数据会重置为上述初始值。</p>
<h3 id="MySQL">MySQL</h3>
<p>如果你想用MySQL练习，可以<a target="_blank" rel="noopener" href="https://liaoxuefeng.com/books/sql/query/mysql-init-test-data.sql">下载这个SQL脚本</a>，然后在命令行运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p &lt; init-test-data.sql</span><br></pre></td></tr></table></figure>
<p>就可以自动创建<code>test</code>数据库，并且在<code>test</code>数据库下创建<code>students</code>表和<code>classes</code>表，以及必要的初始化数据。</p>
<p>和内存数据库不同的是，对MySQL数据库做的所有修改，都会保存下来。如果你希望恢复到初始状态，可以再次运行该脚本。</p>
<h2 id="基本查询">基本查询</h2>
<p>要查询数据库表的数据，我们使用如下的SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>假设表名是<code>students</code>，要查询<code>students</code>表的所有行，我们用如下SQL语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查询students表的所有数据</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>使用<code>SELECT * FROM students</code>时，<code>SELECT</code>是关键字，表示将要执行一个查询，<code>*</code>表示“所有列”，<code>FROM</code>表示将要从哪个表查询，本例中是<code>students</code>表。</p>
<p>该SQL将查询出<code>students</code>表的所有数据。注意：查询结果也是一个二维表，它包含列名和每一行的数据。</p>
<p>要查询<code>classes</code>表的所有行，我们用如下SQL语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查询classes表的所有数据</span><br><span class="line">SELECT * FROM classes;</span><br></pre></td></tr></table></figure>
<p>运行上述SQL语句，观察查询结果。</p>
<p><code>SELECT</code>语句其实并不要求一定要有<code>FROM</code>子句。我们来试试下面的<code>SELECT</code>语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 计算100+200</span><br><span class="line">SELECT 100+200;</span><br></pre></td></tr></table></figure>
<p>上述查询会直接计算出表达式的结果。虽然<code>SELECT</code>可以用作计算，但它并不是SQL的强项。但是，不带<code>FROM</code>子句的<code>SELECT</code>语句有一个有用的用途，就是用来判断当前到数据库的连接是否有效。许多检测工具会执行一条<code>SELECT 1;</code>来测试数据库连接。</p>
<h3 id="小结-4">小结</h3>
<p>使用SELECT查询的基本语句<code>SELECT * FROM &lt;表名&gt;</code>可以查询一个表的所有行和所有列的数据；</p>
<p>SELECT查询的结果是一个二维表。</p>
<p>使用<code>SELECT * FROM &lt;表名&gt;</code>可以查询到一张表的所有记录。但是，很多时候，我们并不希望获得所有记录，而是根据条件选择性地获取指定条件的记录，例如，查询分数在80分以上的学生记录。在一张表有数百万记录的情况下，获取所有记录不仅费时，还费内存和网络带宽。</p>
<p>SELECT语句可以通过<code>WHERE</code>条件来设定查询条件，查询结果是满足查询条件的记录。例如，要指定条件“分数在80分或以上的学生”，写成<code>WHERE</code>条件就是<code>SELECT * FROM students WHERE score &gt;= 80</code>。</p>
<p>其中，<code>WHERE</code>关键字后面的<code>score &gt;= 80</code>就是条件。<code>score</code>是列名，该列存储了学生的成绩，因此，<code>score &gt;= 80</code>就筛选出了指定条件的记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按条件查询students:</span><br><span class="line">SELECT * FROM students WHERE score &gt;= 80;</span><br></pre></td></tr></table></figure>
<p>因此，条件查询的语法就是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>条件表达式可以用<code>&lt;条件1&gt; AND &lt;条件2&gt;</code>表达满足条件1并且满足条件2。例如，符合条件“分数在80分或以上”，并且还符合条件“男生”，把这两个条件写出来：</p>
<ul>
<li>条件1：根据score列的数据判断：<code>score &gt;= 80</code>；</li>
<li>条件2：根据gender列的数据判断：<code>gender = 'M'</code>，注意<code>gender</code>列存储的是字符串，需要用单引号括起来。</li>
</ul>
<p>就可以写出<code>WHERE</code>条件：<code>score &gt;= 80 AND gender = 'M'</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按AND条件查询students:</span><br><span class="line">SELECT * FROM students WHERE score &gt;= 80 AND gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<p>第二种条件是<code>&lt;条件1&gt; OR &lt;条件2&gt;</code>，表示满足条件1或者满足条件2。例如，把上述<code>AND</code>查询的两个条件改为<code>OR</code>，查询结果就是“分数在80分或以上”或者“男生”，满足任意之一的条件即选出该记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按OR条件查询students:</span><br><span class="line">SELECT * FROM students WHERE score &gt;= 80 OR gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<p>很显然<code>OR</code>条件要比<code>AND</code>条件宽松，返回的符合条件的记录也更多。</p>
<p>第三种条件是<code>NOT &lt;条件&gt;</code>，表示“不符合该条件”的记录。例如，写一个“不是2班的学生”这个条件，可以先写出“是2班的学生”：<code>class_id = 2</code>，再加上<code>NOT</code>：<code>NOT class_id = 2</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按NOT条件查询students:</span><br><span class="line">SELECT * FROM students WHERE NOT class_id = 2;</span><br></pre></td></tr></table></figure>
<p>上述<code>NOT</code>条件<code>NOT class_id = 2</code>其实等价于<code>class_id &lt;&gt; 2</code>，因此，<code>NOT</code>查询不是很常用。</p>
<p>要组合三个或者更多的条件，就需要用小括号<code>()</code>表示如何进行条件运算。例如，编写一个复杂的条件：分数在80以下或者90以上，并且是男生：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按多个条件查询students:</span><br><span class="line">SELECT * FROM students WHERE (score &lt; 80 OR score &gt; 90) AND gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<p>如果不加括号，条件运算按照<code>NOT</code>、<code>AND</code>、<code>OR</code>的优先级进行，即<code>NOT</code>优先级最高，其次是<code>AND</code>，最后是<code>OR</code>。加上括号可以改变优先级。</p>
<h3 id="常用的条件表达式">常用的条件表达式</h3>
<table>
<thead>
<tr>
<th>条件</th>
<th>表达式举例1</th>
<th>表达式举例2</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>使用=判断相等</td>
<td>score = 80</td>
<td>name = ‘abc’</td>
<td>字符串需要用单引号括起来</td>
</tr>
<tr>
<td>使用&gt;判断大于</td>
<td>score &gt; 80</td>
<td>name &gt; ‘abc’</td>
<td>字符串比较根据ASCII码，中文字符比较根据数据库设置</td>
</tr>
<tr>
<td>使用&gt;=判断大于或相等</td>
<td>score &gt;= 80</td>
<td>name &gt;= ‘abc’</td>
<td></td>
</tr>
<tr>
<td>使用&lt;判断小于</td>
<td>score &lt; 80</td>
<td>name &lt;= ‘abc’</td>
<td></td>
</tr>
<tr>
<td>使用&lt;=判断小于或相等</td>
<td>score &lt;= 80</td>
<td>name &lt;= ‘abc’</td>
<td></td>
</tr>
<tr>
<td>使用&lt;&gt;判断不相等</td>
<td>score &lt;&gt; 80</td>
<td>name &lt;&gt; ‘abc’</td>
<td></td>
</tr>
<tr>
<td>使用LIKE判断相似</td>
<td>name LIKE ‘ab%’</td>
<td>name LIKE ‘%bc%’</td>
<td>%表示任意字符，例如’ab%‘将匹配’ab’，‘abc’，‘abcd’</td>
</tr>
</tbody>
</table>
<p>查询分数在60分(含)～90分(含)之间的学生可以使用的WHERE语句是：</p>
<h3 id="小结-5">小结</h3>
<p>通过<code>WHERE</code>条件查询，可以筛选出符合指定条件的记录，而不是整个表的所有记录。</p>
<h2 id="投影查询">投影查询</h2>
<p>使用<code>SELECT * FROM &lt;表名&gt; WHERE &lt;条件&gt;</code>可以选出表中的若干条记录。我们注意到返回的二维表结构和原表是相同的，即结果集的所有列与原表的所有列都一一对应。</p>
<p>如果我们只希望返回某些列的数据，而不是所有列的数据，我们可以用<code>SELECT 列1, 列2, 列3 FROM ...</code>，让结果集仅包含指定列。这种操作称为投影查询。</p>
<p>例如，从<code>students</code>表中返回<code>id</code>、<code>score</code>和<code>name</code>这三列：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用投影查询</span><br><span class="line">SELECT id, score, name FROM students;</span><br></pre></td></tr></table></figure>
<p>这样返回的结果集就只包含了我们指定的列，并且，结果集的列的顺序和原表可以不一样。</p>
<p>使用<code>SELECT 列1, 列2, 列3 FROM ...</code>时，还可以给每一列起个别名，这样，结果集的列名就可以与原表的列名不同。它的语法是<code>SELECT 列1 别名1, 列2 别名2, 列3 别名3 FROM ...</code>。</p>
<p>例如，以下<code>SELECT</code>语句将列名<code>score</code>重命名为<code>points</code>，而<code>id</code>和<code>name</code>列名保持不变：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用投影查询，并将列名重命名：</span><br><span class="line">SELECT id, score points, name FROM students;</span><br></pre></td></tr></table></figure>
<p>投影查询同样可以接<code>WHERE</code>条件，实现复杂的查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用投影查询+WHERE条件：</span><br><span class="line">SELECT id, score points, name FROM students WHERE gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="小结-6">小结</h3>
<p>使用<code>SELECT *</code>表示查询表的所有列，使用<code>SELECT 列1, 列2, 列3</code>则可以仅返回指定列，这种操作称为投影；</p>
<p><code>SELECT</code>语句可以对结果集的列进行重命名。</p>
<h2 id="排序">排序</h2>
<h3 id="排序-2">排序</h3>
<p>我们使用SELECT查询时，细心的读者可能注意到，查询结果集通常是按照<code>id</code>排序的，也就是根据主键排序。这也是大部分数据库的做法。如果我们要根据其他条件排序怎么办？可以加上<code>ORDER BY</code>子句。例如按照成绩从低到高进行排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按score从低到高:</span><br><span class="line">SELECT id, name, gender, score FROM students ORDER BY score;</span><br></pre></td></tr></table></figure>
<p>如果要反过来，按照成绩从高到底排序，我们可以加上<code>DESC</code>表示“倒序”：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按score从高到低:</span><br><span class="line">SELECT id, name, gender, score FROM students ORDER BY score DESC;</span><br></pre></td></tr></table></figure>
<p>如果<code>score</code>列有相同的数据，要进一步排序，可以继续添加列名。例如，使用<code>ORDER BY score DESC, gender</code>表示先按<code>score</code>列倒序，如果有相同分数的，再按<code>gender</code>列排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按score, gender排序:</span><br><span class="line">SELECT id, name, gender, score FROM students ORDER BY score DESC, gender;</span><br></pre></td></tr></table></figure>
<p>默认的排序规则是<code>ASC</code>：“升序”，即从小到大。<code>ASC</code>可以省略，即<code>ORDER BY score ASC</code>和<code>ORDER BY score</code>效果一样。</p>
<p>如果有<code>WHERE</code>子句，那么<code>ORDER BY</code>子句要放到<code>WHERE</code>子句后面。例如，查询一班的学生成绩，并按照倒序排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 带WHERE条件的ORDER BY:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">WHERE class_id = 1</span><br><span class="line">ORDER BY score DESC;</span><br></pre></td></tr></table></figure>
<p>这样，结果集仅包含符合<code>WHERE</code>条件的记录，并按照<code>ORDER BY</code>的设定排序。</p>
<h3 id="小结-7">小结</h3>
<p>使用<code>ORDER BY</code>可以对结果集进行排序；</p>
<p>可以对多列进行升序、倒序排序。</p>
<p>使用SELECT查询时，如果结果集数据量很大，比如几万行数据，放在一个页面显示的话数据量太大，不如分页显示，每次显示100条。</p>
<p>要实现分页功能，实际上就是从结果集中显示第1~100条记录作为第1页，显示第101~200条记录作为第2页，以此类推。</p>
<p>因此，分页实际上就是从结果集中“截取”出第M~N条记录。这个查询可以通过<code>LIMIT &lt;N-M&gt; OFFSET &lt;M&gt;</code>子句实现。我们先把所有学生按照成绩从高到低进行排序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按score从高到低:</span><br><span class="line">SELECT id, name, gender, score FROM students ORDER BY score DESC;</span><br></pre></td></tr></table></figure>
<p>现在，我们把结果集分页，每页3条记录。要获取第1页的记录，可以使用<code>LIMIT 3 OFFSET 0</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询第1页:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">ORDER BY score DESC</span><br><span class="line">LIMIT 3 OFFSET 0;</span><br></pre></td></tr></table></figure>
<p>上述查询<code>LIMIT 3 OFFSET 0</code>表示，对结果集从0号记录开始，最多取3条。注意SQL记录集的索引从0开始。</p>
<p>如果要查询第2页，那么我们只需要“跳过”头3条记录，也就是对结果集从3号记录开始查询，把<code>OFFSET</code>设定为3：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询第2页:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">ORDER BY score DESC</span><br><span class="line">LIMIT 3 OFFSET 3;</span><br></pre></td></tr></table></figure>
<p>类似的，查询第3页的时候，<code>OFFSET</code>应该设定为6:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询第3页:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">ORDER BY score DESC</span><br><span class="line">LIMIT 3 OFFSET 6;</span><br></pre></td></tr></table></figure>
<p>查询第4页的时候，<code>OFFSET</code>应该设定为9:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查询第4页:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">ORDER BY score DESC</span><br><span class="line">LIMIT 3 OFFSET 9;</span><br></pre></td></tr></table></figure>
<p>由于第4页只有1条记录，因此最终结果集按实际数量1显示。<code>LIMIT 3</code>表示的意思是“最多3条记录”。</p>
<p>可见，分页查询的关键在于，首先要确定每页需要显示的结果数量<code>pageSize</code>（这里是3），然后根据当前页的索引<code>pageIndex</code>（从1开始），确定<code>LIMIT</code>和<code>OFFSET</code>应该设定的值：</p>
<ul>
<li><code>LIMIT</code>总是设定为<code>pageSize</code>；</li>
<li><code>OFFSET</code>计算公式为<code>pageSize * (pageIndex - 1)</code>。</li>
</ul>
<p>这样就能正确查询出第N页的记录集。</p>
<p>如果原本记录集一共就10条记录，但我们把<code>OFFSET</code>设置为20，会得到什么结果呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- OFFSET设定为20:</span><br><span class="line">SELECT id, name, gender, score</span><br><span class="line">FROM students</span><br><span class="line">ORDER BY score DESC</span><br><span class="line">LIMIT 3 OFFSET 20;</span><br></pre></td></tr></table></figure>
<p><code>OFFSET</code>超过了查询的最大数量并不会报错，而是得到一个空的结果集。</p>
<h3 id="注意">注意</h3>
<p><code>OFFSET</code>是可选的，如果只写<code>LIMIT 15</code>，那么相当于<code>LIMIT 15 OFFSET 0</code>。</p>
<p>在MySQL中，<code>LIMIT 15 OFFSET 30</code>还可以简写成<code>LIMIT 30, 15</code>。</p>
<p>使用<code>LIMIT &lt;M&gt; OFFSET &lt;N&gt;</code>分页时，随着<code>N</code>越来越大，查询效率也会越来越低。</p>
<h3 id="思考">思考</h3>
<p>在分页查询之前，如何计算一共有几页？</p>
<h3 id="小结-8">小结</h3>
<p>使用<code>LIMIT &lt;M&gt; OFFSET &lt;N&gt;</code>可以对结果集进行分页，每次查询返回结果集的一部分；</p>
<p>分页查询需要先确定每页的数量和当前页数，然后确定<code>LIMIT</code>和<code>OFFSET</code>的值。</p>
<p>如果我们要统计一张表的数据量，例如，想查询<code>students</code>表一共有多少条记录，难道必须用<code>SELECT * FROM students</code>查出来然后再数一数有多少行吗？</p>
<p>这个方法当然可以，但是比较弱智。对于统计总数、平均数这类计算，SQL提供了专门的聚合函数，使用聚合函数进行查询，就是聚合查询，它可以快速获得结果。</p>
<p>仍然以查询<code>students</code>表一共有多少条记录为例，我们可以使用SQL内置的<code>COUNT()</code>函数查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用聚合查询:</span><br><span class="line">SELECT COUNT(*) FROM students;</span><br></pre></td></tr></table></figure>
<p><code>COUNT(*)</code>表示查询所有列的行数，要注意聚合的计算结果虽然是一个数字，但查询的结果仍然是一个二维表，只是这个二维表只有一行一列，并且列名是<code>COUNT(*)</code>。</p>
<p>通常，使用聚合查询时，我们应该给列名设置一个别名，便于处理结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用聚合查询并设置结果集的列名为num:</span><br><span class="line">SELECT COUNT(*) num FROM students;</span><br></pre></td></tr></table></figure>
<p><code>COUNT(*)</code>和<code>COUNT(id)</code>实际上是一样的效果。另外注意，聚合查询同样可以使用<code>WHERE</code>条件，因此我们可以方便地统计出有多少男生、多少女生、多少80分以上的学生等：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用聚合查询并设置WHERE条件:</span><br><span class="line">SELECT COUNT(*) boys FROM students WHERE gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<p>除了<code>COUNT()</code>函数外，SQL还提供了如下聚合函数：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUM</td>
<td>计算某一列的合计值，该列必须为数值类型</td>
</tr>
<tr>
<td>AVG</td>
<td>计算某一列的平均值，该列必须为数值类型</td>
</tr>
<tr>
<td>MAX</td>
<td>计算某一列的最大值</td>
</tr>
<tr>
<td>MIN</td>
<td>计算某一列的最小值</td>
</tr>
</tbody>
</table>
<p>注意，<code>MAX()</code>和<code>MIN()</code>函数并不限于数值类型。如果是字符类型，<code>MAX()</code>和<code>MIN()</code>会返回排序最后和排序最前的字符。</p>
<p>要统计男生的平均成绩，我们用下面的聚合查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用聚合查询计算男生平均成绩:</span><br><span class="line">SELECT AVG(score) average FROM students WHERE gender = &#x27;M&#x27;;</span><br></pre></td></tr></table></figure>
<p>要特别注意：如果聚合查询的<code>WHERE</code>条件没有匹配到任何行，<code>COUNT()</code>会返回0，而<code>SUM()</code>、<code>AVG()</code>、<code>MAX()</code>和<code>MIN()</code>会返回<code>NULL</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- WHERE条件gender = &#x27;X&#x27;匹配不到任何行:</span><br><span class="line">SELECT AVG(score) average FROM students WHERE gender = &#x27;X&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="分组">分组</h3>
<p>如果我们要统计一班的学生数量，我们知道，可以用<code>SELECT COUNT(*) num FROM students WHERE class_id = 1;</code>。如果要继续统计二班、三班的学生数量，难道必须不断修改<code>WHERE</code>条件来执行<code>SELECT</code>语句吗？</p>
<p>对于聚合查询，SQL还提供了“分组聚合”的功能。我们观察下面的聚合查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按class_id分组:</span><br><span class="line">SELECT COUNT(*) num FROM students GROUP BY class_id;</span><br></pre></td></tr></table></figure>
<p>执行这个查询，<code>COUNT()</code>的结果不再是一个，而是3个，这是因为，<code>GROUP BY</code>子句指定了按<code>class_id</code>分组，因此，执行该<code>SELECT</code>语句时，会把<code>class_id</code>相同的列先分组，再分别计算，因此，得到了3行结果。</p>
<p>但是这3行结果分别是哪三个班级的，不好看出来，所以我们可以把<code>class_id</code>列也放入结果集中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按class_id分组:</span><br><span class="line">SELECT class_id, COUNT(*) num FROM students GROUP BY class_id;</span><br></pre></td></tr></table></figure>
<p>这下结果集就可以一目了然地看出各个班级的学生人数。我们再试试把<code>name</code>放入结果集：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按class_id分组:</span><br><span class="line">SELECT name, class_id, COUNT(*) num FROM students GROUP BY class_id;</span><br></pre></td></tr></table></figure>
<p>不出意外，执行这条查询我们会得到一个语法错误，因为在任意一个分组中，只有<code>class_id</code>都相同，<code>name</code>是不同的，SQL引擎不能把多个<code>name</code>的值放入一行记录中。因此，聚合查询的列中，只能放入分组的列。</p>
<p>注意</p>
<p>AlaSQL并没有严格执行SQL标准，上述SQL在浏览器可以正常执行，但是在MySQL、Oracle等环境下将报错，请自行在MySQL中测试。</p>
<p>也可以使用多个列进行分组。例如，我们想统计各班的男生和女生人数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 按class_id, gender分组:</span><br><span class="line">SELECT class_id, gender, COUNT(*) num FROM students GROUP BY class_id, gender;</span><br></pre></td></tr></table></figure>
<p>上述查询结果集一共有6条记录，分别对应各班级的男生和女生人数。</p>
<h3 id="练习">练习</h3>
<p>请使用一条SELECT查询查出每个班级的平均分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查出每个班级的平均分，结果集应当有3条记录:</span><br><span class="line">SELECT &#x27;TODO&#x27;;</span><br></pre></td></tr></table></figure>
<p>请使用一条SELECT查询查出每个班级男生和女生的平均分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查出每个班级的平均分，结果集应当有6条记录:</span><br><span class="line">SELECT &#x27;TODO&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="小结-9">小结</h3>
<p>使用SQL提供的聚合查询，我们可以方便地计算总数、合计值、平均值、最大值和最小值；</p>
<p>聚合查询可以用<code>GROUP BY</code>分组聚合；</p>
<p>聚合查询也可以添加<code>WHERE</code>条件。</p>
<p>SELECT查询不但可以从一张表查询数据，还可以从多张表同时查询数据。查询多张表的语法是：<code>SELECT * FROM &lt;表1&gt; &lt;表2&gt;</code>。</p>
<p>例如，同时从<code>students</code>表和<code>classes</code>表的“乘积”，即查询数据，可以这么写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- FROM students, classes:</span><br><span class="line">SELECT * FROM students, classes;</span><br></pre></td></tr></table></figure>
<p>这种一次查询两个表的数据，查询的结果也是一个二维表，它是<code>students</code>表和<code>classes</code>表的“乘积”，即<code>students</code>表的每一行与<code>classes</code>表的每一行都两两拼在一起返回。结果集的列数是<code>students</code>表和<code>classes</code>表的列数之和，行数是<code>students</code>表和<code>classes</code>表的行数之积。</p>
<p>这种多表查询又称笛卡尔查询，使用笛卡尔查询时要非常小心，由于结果集是目标表的行数乘积，对两个各自有100行记录的表进行笛卡尔查询将返回1万条记录，对两个各自有1万行记录的表进行笛卡尔查询将返回1亿条记录。</p>
<p>你可能还注意到了，上述查询的结果集有两列<code>id</code>和两列<code>name</code>，两列<code>id</code>是因为其中一列是<code>students</code>表的<code>id</code>，而另一列是<code>classes</code>表的<code>id</code>，但是在结果集中，不好区分。两列<code>name</code>同理</p>
<p>要解决这个问题，我们仍然可以利用投影查询的“设置列的别名”来给两个表各自的<code>id</code>和<code>name</code>列起别名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- set alias:</span><br><span class="line">SELECT</span><br><span class="line">    students.id sid,</span><br><span class="line">    students.name,</span><br><span class="line">    students.gender,</span><br><span class="line">    students.score,</span><br><span class="line">    classes.id cid,</span><br><span class="line">    classes.name cname</span><br><span class="line">FROM students, classes;</span><br></pre></td></tr></table></figure>
<p>注意，多表查询时，要使用<code>表名.列名</code>这样的方式来引用列和设置别名，这样就避免了结果集的列名重复问题。但是，用<code>表名.列名</code>这种方式列举两个表的所有列实在是很麻烦，所以SQL还允许给表设置一个别名，让我们在投影查询中引用起来稍微简洁一点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- set table alias:</span><br><span class="line">SELECT</span><br><span class="line">    s.id sid,</span><br><span class="line">    s.name,</span><br><span class="line">    s.gender,</span><br><span class="line">    s.score,</span><br><span class="line">    c.id cid,</span><br><span class="line">    c.name cname</span><br><span class="line">FROM students s, classes c;</span><br></pre></td></tr></table></figure>
<p>注意到<code>FROM</code>子句给表设置别名的语法是<code>FROM &lt;表名1&gt; &lt;别名1&gt;, &lt;表名2&gt; &lt;别名2&gt;</code>。这样我们用别名<code>s</code>和<code>c</code>分别表示<code>students</code>表和<code>classes</code>表。</p>
<p>多表查询也是可以添加<code>WHERE</code>条件的，我们来试试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- set where clause:</span><br><span class="line">SELECT</span><br><span class="line">    s.id sid,</span><br><span class="line">    s.name,</span><br><span class="line">    s.gender,</span><br><span class="line">    s.score,</span><br><span class="line">    c.id cid,</span><br><span class="line">    c.name cname</span><br><span class="line">FROM students s, classes c</span><br><span class="line">WHERE s.gender = &#x27;M&#x27; AND c.id = 1;</span><br></pre></td></tr></table></figure>
<p>这个查询的结果集每行记录都满足条件<code>s.gender = 'M'</code>和<code>c.id = 1</code>。添加<code>WHERE</code>条件后结果集的数量大大减少了。</p>
<h3 id="小结-10">小结</h3>
<p>使用多表查询可以获取M x N行记录；</p>
<p>多表查询的结果集可能非常巨大，要小心使用。</p>
<p>连接查询是另一种类型的多表查询。连接查询对多个表进行JOIN运算，简单地说，就是先确定一个主表作为结果集，然后，把其他表的行有选择性地“连接”在主表结果集上。</p>
<p>例如，我们想要选出<code>students</code>表的所有学生信息，可以用一条简单的SELECT语句完成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 选出所有学生:</span><br><span class="line">SELECT s.id, s.name, s.class_id, s.gender, s.score FROM students s;</span><br></pre></td></tr></table></figure>
<p>但是，假设我们希望结果集同时包含所在班级的名称，上面的结果集只有<code>class_id</code>列，缺少对应班级的<code>name</code>列。</p>
<p>现在问题来了，存放班级名称的<code>name</code>列存储在<code>classes</code>表中，只有根据<code>students</code>表的<code>class_id</code>，找到<code>classes</code>表对应的行，再取出<code>name</code>列，就可以获得班级名称。</p>
<p>这时，连接查询就派上了用场。我们先使用最常用的一种内连接——INNER JOIN来实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 选出所有学生，同时返回班级名称:</span><br><span class="line">SELECT s.id, s.name, s.class_id, c.name class_name, s.gender, s.score</span><br><span class="line">FROM students s</span><br><span class="line">INNER JOIN classes c</span><br><span class="line">ON s.class_id = c.id;</span><br></pre></td></tr></table></figure>
<p>注意INNER JOIN查询的写法是：</p>
<ol>
<li>先确定主表，仍然使用<code>FROM &lt;表1&gt;</code>的语法；</li>
<li>再确定需要连接的表，使用<code>INNER JOIN &lt;表2&gt;</code>的语法；</li>
<li>然后确定连接条件，使用<code>ON &lt;条件...&gt;</code>，这里的条件是<code>s.class_id = c.id</code>，表示<code>students</code>表的<code>class_id</code>列与<code>classes</code>表的<code>id</code>列相同的行需要连接；</li>
<li>可选：加上<code>WHERE</code>子句、<code>ORDER BY</code>等子句。</li>
</ol>
<p>使用别名不是必须的，但可以更好地简化查询语句。</p>
<p>那什么是内连接（INNER JOIN）呢？先别着急，有内连接（INNER JOIN）就有外连接（OUTER JOIN）。我们把内连接查询改成外连接查询，看看效果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 使用OUTER JOIN:</span><br><span class="line">SELECT s.id, s.name, s.class_id, c.name class_name, s.gender, s.score</span><br><span class="line">FROM students s</span><br><span class="line">RIGHT OUTER JOIN classes c</span><br><span class="line">ON s.class_id = c.id;</span><br></pre></td></tr></table></figure>
<p>执行上述RIGHT OUTER JOIN可以看到，和INNER JOIN相比，RIGHT OUTER JOIN多了一行，多出来的一行是“四班”，但是，学生相关的列如<code>name</code>、<code>gender</code>、<code>score</code>都为<code>NULL</code>。</p>
<p>这也容易理解，因为根据<code>ON</code>条件<code>s.class_id = c.id</code>，<code>classes</code>表的<code>id=4</code>的行正是“四班”，但是，<code>students</code>表中并不存在<code>class_id=4</code>的行。</p>
<p>有RIGHT OUTER JOIN，就有LEFT OUTER JOIN，以及FULL OUTER JOIN。它们的区别是：</p>
<p>INNER JOIN只返回同时存在于两张表的行数据，由于<code>students</code>表的<code>class_id</code>包含1，2，3，<code>classes</code>表的<code>id</code>包含1，2，3，4，所以，INNER JOIN根据条件<code>s.class_id = c.id</code>返回的结果集仅包含1，2，3。</p>
<p>RIGHT OUTER JOIN返回右表都存在的行。如果某一行仅在右表存在，那么结果集就会以<code>NULL</code>填充剩下的字段。</p>
<p>LEFT OUTER JOIN则返回左表都存在的行。如果我们给students表增加一行，并添加<code>class_id=5</code>，由于classes表并不存在<code>id=5</code>的行，所以，LEFT OUTER JOIN的结果会增加一行，对应的<code>class_name</code>是<code>NULL</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 先增加一列class_id=5:</span><br><span class="line">INSERT INTO students (class_id, name, gender, score) values (5, &#x27;新生&#x27;, &#x27;M&#x27;, 88);</span><br><span class="line">-- 使用LEFT OUTER JOIN:</span><br><span class="line">SELECT s.id, s.name, s.class_id, c.name class_name, s.gender, s.score</span><br><span class="line">FROM students s</span><br><span class="line">LEFT OUTER JOIN classes c</span><br><span class="line">ON s.class_id = c.id;</span><br></pre></td></tr></table></figure>
<p>最后，我们使用FULL OUTER JOIN，它会把两张表的所有记录全部选择出来，并且，自动把对方不存在的列填充为NULL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 使用FULL OUTER JOIN:</span><br><span class="line">SELECT s.id, s.name, s.class_id, c.name class_name, s.gender, s.score</span><br><span class="line">FROM students s</span><br><span class="line">FULL OUTER JOIN classes c</span><br><span class="line">ON s.class_id = c.id;</span><br></pre></td></tr></table></figure>
<p>对于这么多种JOIN查询，到底什么使用应该用哪种呢？其实我们用图来表示结果集就一目了然了。</p>
<p>假设查询语句是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> tableA ??? <span class="keyword">JOIN</span> tableB <span class="keyword">ON</span> tableA.column1 <span class="operator">=</span> tableB.column2;</span><br></pre></td></tr></table></figure>
<p>我们把tableA看作左表，把tableB看成右表，那么INNER JOIN是选出两张表都存在的记录：</p>
<p><img src="https://liaoxuefeng.com/books/sql/query/join/inner-join.jpg" alt="inner-join"></p>
<p>LEFT OUTER JOIN是选出左表存在的记录：</p>
<p><img src="https://liaoxuefeng.com/books/sql/query/join/left-outer-join.jpg" alt="left-outer-join"></p>
<p>RIGHT OUTER JOIN是选出右表存在的记录：</p>
<p><img src="https://liaoxuefeng.com/books/sql/query/join/right-outer-join.jpg" alt="right-outer-join"></p>
<p>FULL OUTER JOIN则是选出左右表都存在的记录：</p>
<p><img src="https://liaoxuefeng.com/books/sql/query/join/full-outer-join.jpg" alt="full-outer-join"></p>
<h3 id="小结-11">小结</h3>
<p>JOIN查询需要先确定主表，然后把另一个表的数据“附加”到结果集上；</p>
<p>INNER JOIN是最常用的一种JOIN查询，它的语法是<code>SELECT ... FROM &lt;表1&gt; INNER JOIN &lt;表2&gt; ON &lt;条件...&gt;</code>；</p>
<p>JOIN查询仍然可以使用<code>WHERE</code>条件和<code>ORDER BY</code>排序。</p>
<p>关系数据库的基本操作就是增删改查，即CRUD：Create、Retrieve、Update、Delete。其中，对于查询，我们已经详细讲述了<code>SELECT</code>语句的详细用法。</p>
<p>而对于增、删、改，对应的SQL语句分别是：</p>
<ul>
<li>INSERT：插入新记录；</li>
<li>UPDATE：更新已有记录；</li>
<li>DELETE：删除已有记录。</li>
</ul>
<p>我们将分别讨论这三种修改数据的语句的使用方法。</p>
<h2 id="插入数据">插入数据</h2>
<p>当我们需要向数据库表中插入一条新记录时，就必须使用<code>INSERT</code>语句。</p>
<p><code>INSERT</code>语句的基本语法是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> (字段<span class="number">1</span>, 字段<span class="number">2</span>, ...) <span class="keyword">VALUES</span> (值<span class="number">1</span>, 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure>
<p>例如，我们向<code>students</code>表插入一条新记录，先列举出需要插入的字段名称，然后在<code>VALUES</code>子句中依次写出对应字段的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 添加一条新记录:</span><br><span class="line">INSERT INTO students (class_id, name, gender, score) VALUES (2, &#x27;大牛&#x27;, &#x27;M&#x27;, 80);</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>注意到我们并没有列出<code>id</code>字段，也没有列出<code>id</code>字段对应的值，这是因为<code>id</code>字段是一个自增主键，它的值可以由数据库自己推算出来。此外，如果一个字段有默认值，那么在<code>INSERT</code>语句中也可以不出现。</p>
<p>要注意，<code>INSERT</code>字段顺序不必和数据库表的字段顺序一致，但值的顺序必须和<code>INSERT</code>字段顺序一致。也就是说，可以写<code>INSERT INTO students (score, gender, name, class_id) ...</code>，但是对应的<code>VALUES</code>就得变成<code>(80, 'M', '大牛', 2)</code>。</p>
<p>还可以一次性添加多条记录，只需要在<code>VALUES</code>子句中指定多个记录值，每个记录是由<code>(...)</code>包含的一组值，每组值用逗号<code>,</code>分隔：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 一次性添加多条新记录:</span><br><span class="line">INSERT INTO students (class_id, name, gender, score) VALUES</span><br><span class="line">  (1, &#x27;大宝&#x27;, &#x27;M&#x27;, 87),</span><br><span class="line">  (2, &#x27;二宝&#x27;, &#x27;M&#x27;, 81),</span><br><span class="line">  (3, &#x27;三宝&#x27;, &#x27;M&#x27;, 83);</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<h3 id="小结-12">小结</h3>
<p>使用<code>INSERT</code>，我们就可以一次向一个表中插入一条或多条记录。</p>
<hr>
<hr>
<p>如果要更新数据库表中的记录，我们就必须使用<code>UPDATE</code>语句。</p>
<p><code>UPDATE</code>语句的基本语法是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">SET</span> 字段<span class="number">1</span><span class="operator">=</span>值<span class="number">1</span>, 字段<span class="number">2</span><span class="operator">=</span>值<span class="number">2</span>, ... <span class="keyword">WHERE</span> ...;</span><br></pre></td></tr></table></figure>
<p>例如，我们想更新<code>students</code>表<code>id=1</code>的记录的<code>name</code>和<code>score</code>这两个字段，先写出<code>UPDATE students SET name='大牛', score=66</code>，然后在<code>WHERE</code>子句中写出需要更新的行的筛选条件<code>id=1</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 更新id=1的记录:</span><br><span class="line">UPDATE students SET name=&#x27;大牛&#x27;, score=66 WHERE id=1;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students WHERE id=1;</span><br></pre></td></tr></table></figure>
<p>注意到<code>UPDATE</code>语句的<code>WHERE</code>条件和<code>SELECT</code>语句的<code>WHERE</code>条件其实是一样的，因此完全可以一次更新多条记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 更新id=5,6,7的记录:</span><br><span class="line">UPDATE students SET name=&#x27;小牛&#x27;, score=77 WHERE id&gt;=5 AND id&lt;=7;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>在<code>UPDATE</code>语句中，更新字段时可以使用表达式。例如，把所有80分以下的同学的成绩加10分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 更新score&lt;80的记录:</span><br><span class="line">UPDATE students SET score=score+10 WHERE score&lt;80;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>其中，<code>SET score=score+10</code>就是给当前行的<code>score</code>字段的值加上了10。</p>
<p>如果<code>WHERE</code>条件没有匹配到任何记录，<code>UPDATE</code>语句不会报错，也不会有任何记录被更新。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 更新id=999的记录:</span><br><span class="line">UPDATE students SET score=100 WHERE id=999;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>最后，要特别小心的是，<code>UPDATE</code>语句可以没有<code>WHERE</code>条件，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> students <span class="keyword">SET</span> score<span class="operator">=</span><span class="number">60</span>;</span><br></pre></td></tr></table></figure>
<p>这时，整个表的所有记录都会被更新。所以，在执行<code>UPDATE</code>语句时要非常小心，最好先用<code>SELECT</code>语句来测试<code>WHERE</code>条件是否筛选出了期望的记录集，然后再用<code>UPDATE</code>更新。</p>
<h3 id="MySQL-2">MySQL</h3>
<p>在使用MySQL这类真正的关系数据库时，<code>UPDATE</code>语句会返回更新的行数以及<code>WHERE</code>条件匹配的行数。</p>
<p>例如，更新<code>id=1</code>的记录时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE students SET name=&#x27;大宝&#x27; WHERE id=1;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>
<p>MySQL会返回<code>1</code>，可以从打印的结果<code>Rows matched: 1 Changed: 1</code>看到。</p>
<p>当更新<code>id=999</code>的记录时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE students SET name=&#x27;大宝&#x27; WHERE id=999;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">Rows matched: 0  Changed: 0  Warnings: 0</span><br></pre></td></tr></table></figure>
<p>MySQL会返回<code>0</code>，可以从打印的结果<code>Rows matched: 0 Changed: 0</code>看到。</p>
<h3 id="小结-13">小结</h3>
<p>使用<code>UPDATE</code>，我们就可以一次更新表中的一条或多条记录。</p>
<h2 id="删除数据">删除数据</h2>
<p>如果要删除数据库表中的记录，我们可以使用<code>DELETE</code>语句。</p>
<p><code>DELETE</code>语句的基本语法是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">WHERE</span> ...;</span><br></pre></td></tr></table></figure>
<p>例如，我们想删除<code>students</code>表中<code>id=1</code>的记录，就需要这么写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 删除id=1的记录:</span><br><span class="line">DELETE FROM students WHERE id=1;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>注意到<code>DELETE</code>语句的<code>WHERE</code>条件也是用来筛选需要删除的行，因此和<code>UPDATE</code>类似，<code>DELETE</code>语句也可以一次删除多条记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 删除id=5,6,7的记录:</span><br><span class="line">DELETE FROM students WHERE id&gt;=5 AND id&lt;=7;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>如果<code>WHERE</code>条件没有匹配到任何记录，<code>DELETE</code>语句不会报错，也不会有任何记录被删除。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 删除id=999的记录:</span><br><span class="line">DELETE FROM students WHERE id=999;</span><br><span class="line">-- 查询并观察结果:</span><br><span class="line">SELECT * FROM students;</span><br></pre></td></tr></table></figure>
<p>最后，要特别小心的是，和<code>UPDATE</code>类似，不带<code>WHERE</code>条件的<code>DELETE</code>语句会删除整个表的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> students;</span><br></pre></td></tr></table></figure>
<p>这时，整个表的所有记录都会被删除。所以，在执行<code>DELETE</code>语句时也要非常小心，最好先用<code>SELECT</code>语句来测试<code>WHERE</code>条件是否筛选出了期望的记录集，然后再用<code>DELETE</code>删除。</p>
<h3 id="MySQL-3">MySQL</h3>
<p>在使用MySQL这类真正的关系数据库时，<code>DELETE</code>语句也会返回删除的行数以及<code>WHERE</code>条件匹配的行数。</p>
<p>例如，分别执行删除<code>id=1</code>和<code>id=999</code>的记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DELETE FROM students WHERE id=1;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DELETE FROM students WHERE id=999;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>
<h3 id="小结-14">小结</h3>
<p>使用<code>DELETE</code>，我们就可以一次删除表中的一条或多条记录。</p>
<h2 id="MySQL-4">MySQL</h2>
<p>安装完MySQL后，除了MySQL Server，即真正的MySQL服务器外，还附赠一个MySQL Client程序。MySQL Client是一个命令行客户端，可以通过MySQL Client登录MySQL，然后，输入SQL语句并执行。</p>
<p>打开命令提示符，输入命令<code>mysql -u root -p</code>，提示输入口令。填入MySQL的root口令，如果正确，就连上了MySQL Server，同时提示符变为<code>mysql&gt;</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────────────────────────┐</span><br><span class="line">│Windows PowerShell                                 - □ x │</span><br><span class="line">├─────────────────────────────────────────────────────────┤</span><br><span class="line">│Windows PowerShell                                       │</span><br><span class="line">│Copyright (C) Microsoft Corporation. All rights reserved.│</span><br><span class="line">│                                                         │</span><br><span class="line">│PS C:\Users\chankein&gt; mysql -u root -p                │</span><br><span class="line">│Enter password: ******                                   │</span><br><span class="line">│                                                         │</span><br><span class="line">│Server version: 5.7                                      │</span><br><span class="line">│Copyright (c) 2000, 2018, ...                            │</span><br><span class="line">│Type &#x27;help;&#x27; or &#x27;\h&#x27; for help.                           │</span><br><span class="line">│                                                         │</span><br><span class="line">│mysql&gt;                                                   │</span><br><span class="line">│                                                         │</span><br><span class="line">└─────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>
<p>输入<code>exit</code>断开与MySQL Server的连接并返回到命令提示符。</p>
<p>提示</p>
<p>MySQL Client的可执行程序是mysql，MySQL Server的可执行程序是mysqld。</p>
<p>MySQL Client和MySQL Server的关系如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──────────────┐  SQL   ┌──────────────┐</span><br><span class="line">│ MySQL Client │───────▶│ MySQL Server │</span><br><span class="line">└──────────────┘  TCP   └──────────────┘</span><br></pre></td></tr></table></figure>
<p>在MySQL Client中输入的SQL语句通过TCP连接发送到MySQL Server。默认端口号是3306，即如果发送到本机MySQL Server，地址就是<code>127.0.0.1:3306</code>。</p>
<p>也可以只安装MySQL Client，然后连接到远程MySQL Server。假设远程MySQL Server的IP地址是<code>10.0.1.99</code>，那么就使用<code>-h</code>指定IP或域名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 10.0.1.99 -u root -p</span><br></pre></td></tr></table></figure>
<h3 id="小结-15">小结</h3>
<p>命令行程序<code>mysql</code>实际上是MySQL客户端，真正的MySQL服务器程序是<code>mysqld</code>，在后台运行。</p>
<hr>
<hr>
<p>要管理MySQL，可以使用可视化图形界面<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/workbench/">MySQL Workbench</a>。</p>
<p>MySQL Workbench可以用可视化的方式查询、创建和修改数据库表，但是，归根到底，MySQL Workbench是一个图形客户端，它对MySQL的操作仍然是发送SQL语句并执行。因此，本质上，MySQL Workbench和MySQL Client命令行都是客户端，和MySQL交互，唯一的接口就是SQL。</p>
<p>因此，MySQL提供了大量的SQL语句用于管理。虽然可以使用MySQL Workbench图形界面来直接管理MySQL，但是，很多时候，通过SSH远程连接时，只能使用SQL命令，所以，了解并掌握常用的SQL管理操作是必须的。</p>
<h3 id="数据库">数据库</h3>
<p>在一个运行MySQL的服务器上，实际上可以创建多个数据库（Database）。要列出所有数据库，使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| shici              |</span><br><span class="line">| sys                |</span><br><span class="line">| test               |</span><br><span class="line">| school             |</span><br><span class="line">+--------------------+</span><br></pre></td></tr></table></figure>
<p>其中，<code>information_schema</code>、<code>mysql</code>、<code>performance_schema</code>和<code>sys</code>是系统库，不要去改动它们。其他的是用户创建的数据库。</p>
<p>注意：在MySQL命令行客户端输入SQL后，记得加一个<code>;</code>表示SQL语句结束，再回车就可以执行该SQL语句。虽然有些SQL命令不需要<code>;</code>也能执行，但类似<code>SELECT</code>等语句不加<code>;</code>会让MySQL客户端换行后继续等待输入。如果在图形界面或程序开发中集成SQL则不需要加<code>;</code>。</p>
<p>要创建一个新数据库，使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE test;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>要删除一个数据库，使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP DATABASE test;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>注意：删除一个数据库将导致该数据库的所有表全部被删除。</p>
<p>对一个数据库进行操作时，要首先将其切换为当前数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; USE test;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>
<h3 id="表">表</h3>
<p>列出当前数据库的所有表，使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW TABLES;</span><br><span class="line">+---------------------+</span><br><span class="line">| Tables_in_test      |</span><br><span class="line">+---------------------+</span><br><span class="line">| classes             |</span><br><span class="line">| statistics          |</span><br><span class="line">| students            |</span><br><span class="line">| students_of_class1  |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>
<p>要查看一个表的结构，使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DESC students;</span><br><span class="line">+----------+--------------+------+-----+---------+----------------+</span><br><span class="line">| Field    | Type         | Null | Key | Default | Extra          |</span><br><span class="line">+----------+--------------+------+-----+---------+----------------+</span><br><span class="line">| id       | bigint(20)   | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| class_id | bigint(20)   | NO   |     | NULL    |                |</span><br><span class="line">| name     | varchar(100) | NO   |     | NULL    |                |</span><br><span class="line">| gender   | varchar(1)   | NO   |     | NULL    |                |</span><br><span class="line">| score    | int(11)      | NO   |     | NULL    |                |</span><br><span class="line">+----------+--------------+------+-----+---------+----------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>还可以使用以下命令查看创建表的SQL语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW CREATE TABLE students;</span><br><span class="line">+----------+-------------------------------------------------------+</span><br><span class="line">| students | CREATE TABLE `students` (                             |</span><br><span class="line">|          |   `id` bigint(20) NOT NULL AUTO_INCREMENT,            |</span><br><span class="line">|          |   `class_id` bigint(20) NOT NULL,                     |</span><br><span class="line">|          |   `name` varchar(100) NOT NULL,                       |</span><br><span class="line">|          |   `gender` varchar(1) NOT NULL,                       |</span><br><span class="line">|          |   `score` int(11) NOT NULL,                           |</span><br><span class="line">|          |   PRIMARY KEY (`id`)                                  |</span><br><span class="line">|          | ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 |</span><br><span class="line">+----------+-------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>创建表使用<code>CREATE TABLE</code>语句，而删除表使用<code>DROP TABLE</code>语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP TABLE students;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>修改表就比较复杂。如果要给<code>students</code>表新增一列<code>birth</code>，使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE students ADD COLUMN birth VARCHAR(10) NOT NULL;</span><br></pre></td></tr></table></figure>
<p>要修改<code>birth</code>列，例如把列名改为<code>birthday</code>，类型改为<code>VARCHAR(20)</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE students CHANGE COLUMN birth birthday VARCHAR(20) NOT NULL;</span><br></pre></td></tr></table></figure>
<p>要删除列，使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE students DROP COLUMN birthday;</span><br></pre></td></tr></table></figure>
<h3 id="退出MySQL">退出MySQL</h3>
<p>使用<code>EXIT</code>命令退出MySQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXIT</span><br><span class="line">Bye</span><br></pre></td></tr></table></figure>
<p>注意<code>EXIT</code>仅仅断开了客户端和服务器的连接，MySQL服务器仍然继续运行。</p>
<p>在编写SQL时，灵活运用一些技巧，可以大大简化程序逻辑。</p>
<h3 id="插入或替换">插入或替换</h3>
<p>如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就先删除原记录，再插入新记录。此时，可以使用<code>REPLACE</code>语句，这样就不必先查询，再决定是否先删除再插入：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPLACE <span class="keyword">INTO</span> students (id, class_id, name, gender, score) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="number">99</span>);</span><br></pre></td></tr></table></figure>
<p>若<code>id=1</code>的记录不存在，<code>REPLACE</code>语句将插入新记录，否则，当前<code>id=1</code>的记录将被删除，然后再插入新记录。</p>
<h3 id="插入或更新">插入或更新</h3>
<p>如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就更新该记录，此时，可以使用<code>INSERT INTO ... ON DUPLICATE KEY UPDATE ...</code>语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> students (id, class_id, name, gender, score) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="number">99</span>) <span class="keyword">ON</span> DUPLICATE KEY <span class="keyword">UPDATE</span> name<span class="operator">=</span><span class="string">&#x27;小明&#x27;</span>, gender<span class="operator">=</span><span class="string">&#x27;F&#x27;</span>, score<span class="operator">=</span><span class="number">99</span>;</span><br></pre></td></tr></table></figure>
<p>若<code>id=1</code>的记录不存在，<code>INSERT</code>语句将插入新记录，否则，当前<code>id=1</code>的记录将被更新，更新的字段由<code>UPDATE</code>指定。</p>
<h3 id="插入或忽略">插入或忽略</h3>
<p>如果我们希望插入一条新记录（INSERT），但如果记录已经存在，就啥事也不干直接忽略，此时，可以使用<code>INSERT IGNORE INTO ...</code>语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> IGNORE <span class="keyword">INTO</span> students (id, class_id, name, gender, score) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="number">99</span>);</span><br></pre></td></tr></table></figure>
<p>若<code>id=1</code>的记录不存在，<code>INSERT</code>语句将插入新记录，否则，不执行任何操作。</p>
<h3 id="快照">快照</h3>
<p>如果想要对一个表进行快照，即复制一份当前表的数据到一个新表，可以结合<code>CREATE TABLE</code>和<code>SELECT</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 对class_id=1的记录进行快照，并存储为新表students_of_class1:</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> students_of_class1 <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> class_id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>新创建的表结构和<code>SELECT</code>使用的表结构完全一致。</p>
<h3 id="写入查询结果集">写入查询结果集</h3>
<p>如果查询结果集需要写入到表中，可以结合<code>INSERT</code>和<code>SELECT</code>，将<code>SELECT</code>语句的结果集直接插入到指定表中。</p>
<p>例如，创建一个统计成绩的表<code>statistics</code>，记录各班的平均成绩：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> statistics (</span><br><span class="line">    id <span class="type">BIGINT</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">    class_id <span class="type">BIGINT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    average <span class="keyword">DOUBLE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>然后，我们就可以用一条语句写入各班的平均成绩：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> statistics (class_id, average) <span class="keyword">SELECT</span> class_id, <span class="built_in">AVG</span>(score) <span class="keyword">FROM</span> students <span class="keyword">GROUP</span> <span class="keyword">BY</span> class_id;</span><br></pre></td></tr></table></figure>
<p>确保<code>INSERT</code>语句的列和<code>SELECT</code>语句的列能一一对应，就可以在<code>statistics</code>表中直接保存查询的结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; SELECT * FROM statistics;</span><br><span class="line">+----+----------+--------------+</span><br><span class="line">| id | class_id | average      |</span><br><span class="line">+----+----------+--------------+</span><br><span class="line">|  1 |        1 |         86.5 |</span><br><span class="line">|  2 |        2 | 73.666666666 |</span><br><span class="line">|  3 |        3 | 88.333333333 |</span><br><span class="line">+----+----------+--------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="强制使用指定索引">强制使用指定索引</h3>
<p>在查询的时候，数据库系统会自动分析查询语句，并选择一个最合适的索引。但是很多时候，数据库系统的查询优化器并不一定总是能使用最优索引。如果我们知道如何选择索引，可以使用<code>FORCE INDEX</code>强制查询使用指定的索引。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> students FORCE INDEX (idx_class_id) <span class="keyword">WHERE</span> class_id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
<p>指定索引的前提是索引<code>idx_class_id</code>必须存在。</p>
<h2 id="事务">事务</h2>
<p>在执行SQL语句的时候，某些业务要求，一系列操作必须全部执行，而不能仅执行一部分。例如，一个转账操作：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 从id=1的账户给id=2的账户转账100元</span></span><br><span class="line"><span class="comment">-- 第一步：将id=1的A账户余额减去100</span></span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 第二步：将id=2的B账户余额加上100</span></span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>这两条SQL语句必须全部执行，或者，由于某些原因，如果第一条语句成功，第二条语句失败，就必须全部撤销。</p>
<p>这种把多条语句作为一个整体进行操作的功能，被称为数据库<em>事务</em>。数据库事务可以确保该事务范围内的所有操作都可以全部成功或者全部失败。如果事务失败，那么效果就和没有执行这些SQL一样，不会对数据库数据有任何改动。</p>
<p>可见，数据库事务具有ACID这4个特性：</p>
<ul>
<li>A：Atomicity，原子性，将所有SQL作为原子工作单元执行，要么全部执行，要么全部不执行；</li>
<li>C：Consistency，一致性，事务完成后，所有数据的状态都是一致的，即A账户只要减去了100，B账户则必定加上了100；</li>
<li>I：Isolation，隔离性，如果有多个事务并发执行，每个事务作出的修改必须与其他事务隔离；</li>
<li>D：Durability，持久性，即事务完成后，对数据库数据的修改被持久化存储。</li>
</ul>
<p>对于单条SQL语句，数据库系统自动将其作为一个事务执行，这种事务被称为<em>隐式事务</em>。</p>
<p>要手动把多条SQL语句作为一个事务执行，使用<code>BEGIN</code>开启一个事务，使用<code>COMMIT</code>提交一个事务，这种事务被称为<em>显式事务</em>，例如，把上述的转账操作作为一个显式事务：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
<p>很显然多条SQL语句要想作为一个事务执行，就必须使用显式事务。</p>
<p><code>COMMIT</code>是指提交事务，即试图把事务内的所有SQL所做的修改永久保存。如果<code>COMMIT</code>语句执行失败了，整个事务也会失败。</p>
<p>有些时候，我们希望主动让事务失败，这时，可以用<code>ROLLBACK</code>回滚事务，整个事务会失败：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>
<p>数据库事务是由数据库系统保证的，我们只需要根据业务逻辑使用它就可以。</p>
<h3 id="隔离级别">隔离级别</h3>
<p>对于两个并发执行的事务，如果涉及到操作同一条记录的时候，可能会发生问题。因为并发操作会带来数据的不一致性，包括脏读、不可重复读、幻读等。数据库系统提供了隔离级别来让我们有针对性地选择事务的隔离级别，避免数据不一致的问题。</p>
<p>SQL标准定义了4种隔离级别，分别对应可能出现的数据不一致的情况：</p>
<table>
<thead>
<tr>
<th>Isolation Level</th>
<th>脏读（Dirty Read）</th>
<th>不可重复读（Non Repeatable Read）</th>
<th>幻读（Phantom Read）</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read Uncommitted</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Read Committed</td>
<td>-</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Repeatable Read</td>
<td>-</td>
<td>-</td>
<td>Yes</td>
</tr>
<tr>
<td>Serializable</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>我们会依次介绍4种隔离级别的数据一致性问题。</p>
<h3 id="小结-16">小结</h3>
<p>数据库事务具有ACID特性，用来保证多条SQL的全部执行。</p>
<h2 id="Read-Uncommitted">Read Uncommitted</h2>
<p>Read Uncommitted是隔离级别最低的一种事务级别。在这种隔离级别下，一个事务会读到另一个事务更新后但未提交的数据，如果另一个事务回滚，那么当前事务读到的数据就是脏数据，这就是脏读（Dirty Read）。</p>
<p>我们来看一个例子。</p>
<p>首先，我们准备好<code>students</code>表的数据，该表仅一行记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from students;</span><br><span class="line">+----+-------+</span><br><span class="line">| id | name  |</span><br><span class="line">+----+-------+</span><br><span class="line">|  1 | Alice |</span><br><span class="line">+----+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>然后，分别开启两个MySQL客户端连接，按顺序依次执行事务A和事务B：</p>
<table>
<thead>
<tr>
<th>时刻</th>
<th>事务A</th>
<th>事务B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</td>
<td>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</td>
</tr>
<tr>
<td>2</td>
<td>BEGIN;</td>
<td>BEGIN;</td>
</tr>
<tr>
<td>3</td>
<td>UPDATE students SET name = ‘Bob’ WHERE id = 1;</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td></td>
<td>SELECT * FROM students WHERE id = 1;</td>
</tr>
<tr>
<td>5</td>
<td>ROLLBACK;</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>SELECT * FROM students WHERE id = 1;</td>
</tr>
<tr>
<td>7</td>
<td></td>
<td>COMMIT;</td>
</tr>
</tbody>
</table>
<p>当事务A执行完第3步时，它更新了<code>id=1</code>的记录，但并未提交，而事务B在第4步读取到的数据就是未提交的数据。</p>
<p>随后，事务A在第5步进行了回滚，事务B再次读取<code>id=1</code>的记录，发现和上一次读取到的数据不一致，这就是脏读。</p>
<p>可见，在Read Uncommitted隔离级别下，一个事务可能读取到另一个事务更新但未提交的数据，这个数据有可能是脏数据。</p>
<h2 id="Read-Committed">Read Committed</h2>
<p>在Read Committed隔离级别下，一个事务不会读到另一个事务还没有提交的数据，但可能会遇到不可重复读（Non Repeatable Read）的问题。</p>
<p>不可重复读是指，在一个事务内，多次读同一数据，在这个事务还没有结束时，如果另一个事务恰好修改了这个数据，那么，在第一个事务中，两次读取的数据就可能不一致。</p>
<p>我们仍然先准备好<code>students</code>表的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from students;</span><br><span class="line">+----+-------+</span><br><span class="line">| id | name  |</span><br><span class="line">+----+-------+</span><br><span class="line">|  1 | Alice |</span><br><span class="line">+----+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>然后，分别开启两个MySQL客户端连接，按顺序依次执行事务A和事务B：</p>
<table>
<thead>
<tr>
<th>时刻</th>
<th>事务A</th>
<th>事务B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SET TRANSACTION ISOLATION LEVEL READ COMMITTED;</td>
<td>SET TRANSACTION ISOLATION LEVEL READ COMMITTED;</td>
</tr>
<tr>
<td>2</td>
<td>BEGIN;</td>
<td>BEGIN;</td>
</tr>
<tr>
<td>3</td>
<td></td>
<td>SELECT * FROM students WHERE id = 1; – Alice</td>
</tr>
<tr>
<td>4</td>
<td>UPDATE students SET name = ‘Bob’ WHERE id = 1;</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>COMMIT;</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>SELECT * FROM students WHERE id = 1; – Bob</td>
</tr>
<tr>
<td>7</td>
<td></td>
<td>COMMIT;</td>
</tr>
</tbody>
</table>
<p>当事务B第一次执行第3步的查询时，得到的结果是<code>Alice</code>，随后，由于事务A在第4步更新了这条记录并提交，所以，事务B在第6步再次执行同样的查询时，得到的结果就变成了<code>Bob</code>，因此，在Read Committed隔离级别下，事务不可重复读同一条记录，因为很可能读到的结果不一致。</p>
<h2 id="Repeatable-Read">Repeatable Read</h2>
<p>在Repeatable Read隔离级别下，一个事务可能会遇到幻读（Phantom Read）的问题。</p>
<p>幻读是指，在一个事务中，第一次查询某条记录，发现没有，但是，当试图更新这条不存在的记录时，竟然能成功，并且，再次读取同一条记录，它就神奇地出现了。</p>
<p>我们仍然先准备好<code>students</code>表的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from students;</span><br><span class="line">+----+-------+</span><br><span class="line">| id | name  |</span><br><span class="line">+----+-------+</span><br><span class="line">|  1 | Alice |</span><br><span class="line">+----+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>然后，分别开启两个MySQL客户端连接，按顺序依次执行事务A和事务B：</p>
<table>
<thead>
<tr>
<th>时刻</th>
<th>事务A</th>
<th>事务B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;</td>
<td>SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;</td>
</tr>
<tr>
<td>2</td>
<td>BEGIN;</td>
<td>BEGIN;</td>
</tr>
<tr>
<td>3</td>
<td></td>
<td>SELECT * FROM students WHERE id = 99; – empty</td>
</tr>
<tr>
<td>4</td>
<td>INSERT INTO students (id, name) VALUES (99, ‘Bob’);</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>COMMIT;</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>SELECT * FROM students WHERE id = 99; – empty</td>
</tr>
<tr>
<td>7</td>
<td></td>
<td>UPDATE students SET name = ‘Alice’ WHERE id = 99; – 1 row affected</td>
</tr>
<tr>
<td>8</td>
<td></td>
<td>SELECT * FROM students WHERE id = 99; – Alice</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td>COMMIT;</td>
</tr>
</tbody>
</table>
<p>事务B在第3步第一次读取<code>id=99</code>的记录时，读到的记录为空，说明不存在<code>id=99</code>的记录。随后，事务A在第4步插入了一条<code>id=99</code>的记录并提交。事务B在第6步再次读取<code>id=99</code>的记录时，读到的记录仍然为空，但是，事务B在第7步试图更新这条不存在的记录时，竟然成功了，并且，事务B在第8步再次读取<code>id=99</code>的记录时，记录出现了。</p>
<p>可见，幻读就是没有读到的记录，以为不存在，但其实是可以更新成功的，并且，更新成功后，再次读取，就出现了。</p>
<hr>
<hr>
<p>Serializable是最严格的隔离级别。在Serializable隔离级别下，所有事务按照次序依次执行，因此，脏读、不可重复读、幻读都不会出现。</p>
<p>虽然Serializable隔离级别下的事务具有最高的安全性，但是，由于事务是串行执行，所以效率会大大下降，应用程序的性能会急剧降低。如果没有特别重要的情景，一般都不会使用Serializable隔离级别。</p>
<h3 id="默认隔离级别">默认隔离级别</h3>
<p>如果没有指定隔离级别，数据库就会使用默认的隔离级别。在MySQL中，如果使用InnoDB，默认的隔离级别是Repeatable Read。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2015/10/12/mysql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2013/05/03/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"
                            aria-label=": R语言-线性回归"
                        >
                            R语言-线性回归
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2013-05-03T22:06:40+08:00">
	
		    2013 年 5 月 3 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80/">R语言</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="R-线性回归">R - 线性回归</h2>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-examples.html"><img src="https://www.runoob.com/images/up.gif" alt="R 语言实例"> R 语言实例</a></p>
<p>在统计学中，线性回归(Linear Regression)是利用称为线性回归方程的最小平方函数对一个或多个自变量和因变量之间关系进行建模的一种回归分析。</p>
<p>简单对来说就是用来确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法。</p>
<p>回归分析中，只包括一个自变量和一个因变量，且二者的关系可用一条直线近似表示，这种回归分析称为一元线性回归分析。如果回归分析中包括两个或两个以上的自变量，且因变量和自变量之间是线性关系，则称为多元线性回归分析。</p>
<p>一元线性回归分析法的数学方程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y = ax + b</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>y</strong> 是因变量的值。</p>
</li>
<li>
<p><strong>x</strong> 是自变量的值。</p>
</li>
<li>
<p><strong>a</strong> 与 <strong>b</strong> 为一元线性回归方程的参数。</p>
</li>
</ul>
<p>接下来我们可以创建一个人体身高与体重的预测模型：</p>
<ul>
<li>1、收集样本数据：身高与体重。</li>
<li>2、使用 lm() 函数来创建一个关系模型。</li>
<li>3、从创建的模型中找到系数，并创建数学方程式。</li>
<li>4、获取关系模型的概要，了解平均误差即残差（估计值与真实值之差）。</li>
<li>5、使用 predict() 函数来预测人的体重。</li>
</ul>
<h3 id="准备数据">准备数据</h3>
<p>以下是人的身高与体重数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 身高，单位 cm</span><br><span class="line">151, 174, 138, 186, 128, 136, 179, 163, 152, 131</span><br><span class="line"></span><br><span class="line"># 体重，单位 kg</span><br><span class="line">63, 81, 56, 91, 47, 57, 76, 72, 62, 48</span><br></pre></td></tr></table></figure>
<h3 id="lm-函数">lm() 函数</h3>
<p>在 R 中，你可以通过函数 lm() 进行线性回归。</p>
<p>lm() 函数用于创建自变量与因变量之间的关系模型。</p>
<p>lm() 函数语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lm(formula,data)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>formula - 一个符号公式，表示 x 和 y 之间的关系。</li>
<li>data - 应用数据。</li>
</ul>
<p>创建关系模型，并获取系数：</p>
<h2 id="实例">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# 样本数据  </span><br><span class="line">x &lt;- c(151, 174, 138, 186, 128, 136, 179, 163, 152, 131)  </span><br><span class="line">y &lt;- c(63, 81, 56, 91, 47, 57, 76, 72, 62, 48)</span><br><span class="line"></span><br><span class="line">\# 提交给 lm() 函数  </span><br><span class="line">relation &lt;- lm(y~x)</span><br><span class="line"></span><br><span class="line">print(relation)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Call:</span><br><span class="line">lm(formula = y ~ x)</span><br><span class="line"></span><br><span class="line">Coefficients:</span><br><span class="line">(Intercept)            x  </span><br><span class="line">    -38.4551       0.6746  </span><br></pre></td></tr></table></figure>
<p>使用 <strong>summary()</strong> 函数获取关系模型的概要:</p>
<h2 id="实例-2">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(151, 174, 138, 186, 128, 136, 179, 163, 152, 131)  </span><br><span class="line">y &lt;- c(63, 81, 56, 91, 47, 57, 76, 72, 62, 48)</span><br><span class="line"></span><br><span class="line">\# 提交给 lm() 函数  </span><br><span class="line">relation &lt;- lm(y~x)</span><br><span class="line"></span><br><span class="line">print(summary(relation))</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Call:</span><br><span class="line">lm(formula = y ~ x)</span><br><span class="line"></span><br><span class="line">Residuals:</span><br><span class="line">    Min      1Q     Median      3Q     Max </span><br><span class="line">-6.3002    -1.6629  0.0412    1.8944  3.9775 </span><br><span class="line"></span><br><span class="line">Coefficients:</span><br><span class="line">             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">(Intercept) -38.45509    8.04901  -4.778  0.00139 ** </span><br><span class="line">x             0.67461    0.05191  12.997 1.16e-06 ***</span><br><span class="line">---</span><br><span class="line">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><br><span class="line"></span><br><span class="line">Residual standard error: 3.253 on 8 degrees of freedom</span><br><span class="line">Multiple R-squared:  0.9548,    Adjusted R-squared:  0.9491 </span><br><span class="line">F-statistic: 168.9 on 1 and 8 DF,  p-value: 1.164e-06</span><br></pre></td></tr></table></figure>
<h3 id="predict-函数">predict() 函数</h3>
<p>predict() 函数用于根据我们建立的模型来预测数值。</p>
<p>predict() 函数语法格式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predict(object, newdata)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>object - lm() 函数创建的公式。</li>
<li>newdata - 要预测的值。</li>
</ul>
<p>以下实例我们预测一个新的体重值：</p>
<h2 id="实例-3">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 样本数据  </span><br><span class="line">x &lt;- c(151, 174, 138, 186, 128, 136, 179, 163, 152, 131)  </span><br><span class="line">y &lt;- c(63, 81, 56, 91, 47, 57, 76, 72, 62, 48)</span><br><span class="line"></span><br><span class="line">\# 提交给 lm() 函数  </span><br><span class="line">relation &lt;- lm(y~x)</span><br><span class="line"></span><br><span class="line">\# 判断身高为 170cm 的体重  </span><br><span class="line">a &lt;- data.frame(x \= 170)  </span><br><span class="line">result &lt;-  predict(relation,a)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 </span><br><span class="line">76.22869 </span><br></pre></td></tr></table></figure>
<p>我们也可以生成一个图表：</p>
<h2 id="实例-4">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 样本数据  </span><br><span class="line">x &lt;- c(151, 174, 138, 186, 128, 136, 179, 163, 152, 131)  </span><br><span class="line">y &lt;- c(63, 81, 56, 91, 47, 57, 76, 72, 62, 48)  </span><br><span class="line">relation &lt;- lm(y~x)</span><br><span class="line"></span><br><span class="line">\# 生成 png 图片  </span><br><span class="line">png(file \= &quot;linearregression.png&quot;)</span><br><span class="line"></span><br><span class="line">\# 生成图表  </span><br><span class="line">plot(y,x,col \= &quot;blue&quot;,main \= &quot;Height &amp; Weight Regression&quot;,  </span><br><span class="line">abline(lm(x~y)),cex \= 1.3,pch \= 16,xlab \= &quot;Weight in Kg&quot;,ylab \= &quot;Height in cm&quot;)</span><br></pre></td></tr></table></figure>
<p>图表如下：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/08/linearregression.png" alt=""></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-examples.html"><img src="https://www.runoob.com/images/up.gif" alt="R 语言实例"> R 语言实例</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2013/05/03/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2013/05/02/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BB%98%E5%9B%BE/"
                            aria-label=": R语言-绘图"
                        >
                            R语言-绘图
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2013-05-02T22:06:40+08:00">
	
		    2013 年 5 月 2 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80/">R语言</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="R-绘图-饼图">R 绘图 - 饼图</h2>
<p>R 语言提供来大量的库来实现绘图功能。</p>
<p>饼图，或称饼状图，是一个划分为几个扇形的圆形统计图表，用于描述量、频率或百分比之间的相对关系。</p>
<p>R 语言使用 pie() 函数来实现饼图，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pie(x, labels = names(x), edges = 200, radius = 0.8,</span><br><span class="line">    clockwise = FALSE, init.angle = if(clockwise) 90 else 0,</span><br><span class="line">    density = NULL, angle = 45, col = NULL, border = NULL,</span><br><span class="line">    lty = NULL, main = NULL, …)</span><br></pre></td></tr></table></figure>
<ul>
<li>x: 数值向量，表示每个扇形的面积。</li>
<li>labels: 字符型向量，表示各扇形面积标签。</li>
<li>edges: 这个参数用处不大，指的是多边形的边数（圆的轮廓类似很多边的多边形）。</li>
<li>radius: 饼图的半径。</li>
<li>main: 饼图的标题。</li>
<li>clockwise: 是一个逻辑值,用来指示饼图各个切片是否按顺时针做出分割。</li>
<li>angle: 设置底纹的斜率。</li>
<li>density: 底纹的密度。默认值为 NULL。</li>
<li>col: 是表示每个扇形的颜色，相当于调色板。</li>
</ul>
<p>绘制饼状图要做这些准备：反映数量的向量、各部分的标签、各部分的颜色（可选）。</p>
<p>接下来我们绘制一个简单的饼图：</p>
<h2 id="实例">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 数据准备  </span><br><span class="line">info = c(1, 2, 4, 8)</span><br><span class="line"></span><br><span class="line">\# 命名  </span><br><span class="line">names = c(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Weibo&quot;)</span><br><span class="line"></span><br><span class="line">\# 涂色（可选）  </span><br><span class="line">cols = c(&quot;#ED1C24&quot;,&quot;#22B14C&quot;,&quot;#FFC90E&quot;,&quot;#3f48CC&quot;)</span><br><span class="line"></span><br><span class="line">\# 绘图  </span><br><span class="line">pie(info, labels\=names, col\=cols)</span><br></pre></td></tr></table></figure>
<p>执行绘图程序，会在当前目录下生存一个 PDF 文件（Rplots.pdf）,打开文件可以看到图形效果如下：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/CE239EAD-2217-4623-A99C-6BB2DB7C72D9.jpg" alt=""></p>
<p>我们也可以使用 png()、jpeg()、bmp() 函数设置输出的文件格式为图片：</p>
<h2 id="实例-2">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\# 数据准备  </span><br><span class="line">info \= c(1, 2, 4, 8)</span><br><span class="line"></span><br><span class="line">\# 命名  </span><br><span class="line">names \= c(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Weibo&quot;)</span><br><span class="line"></span><br><span class="line">\# 涂色（可选）  </span><br><span class="line">cols \= c(&quot;#ED1C24&quot;,&quot;#22B14C&quot;,&quot;#FFC90E&quot;,&quot;#3f48CC&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置输出图片  </span><br><span class="line">png(file\=&#x27;runoob-pie.png&#x27;, height\=300, width\=300)  </span><br><span class="line">\# 绘图  </span><br><span class="line">pie(info, labels\=names, col\=cols)</span><br></pre></td></tr></table></figure>
<p>接下来我们给饼图设置标题，中文字体需要设置字体参数 family=‘GB1’，也可以自己设置字体库，详细参考：<a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-charts-cn.html">R 绘图 - 中文支持</a>。</p>
<h2 id="实例-3">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 数据准备  </span><br><span class="line">info = c(1, 2, 4, 8)</span><br><span class="line"></span><br><span class="line">\# 命名  </span><br><span class="line">names = c(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Weibo&quot;)</span><br><span class="line"></span><br><span class="line">\# 涂色（可选）  </span><br><span class="line">cols = c(&quot;#ED1C24&quot;,&quot;#22B14C&quot;,&quot;#FFC90E&quot;,&quot;#3f48CC&quot;)  </span><br><span class="line">\# 计算百分比  </span><br><span class="line">piepercent = paste(round(100\*info/sum(info)), &quot;%&quot;)  </span><br><span class="line">\# 绘图  </span><br><span class="line">pie(info, labels\=piepercent, main = &quot;网站分析&quot;, col\=cols, family\=&#x27;GB1&#x27;)  </span><br><span class="line">\# 添加颜色样本标注  </span><br><span class="line">legend(&quot;topright&quot;, names, cex\=0.8, fill\=cols)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/065BA223-69F9-4AF5-A3D4-D92A6A895D89.jpg" alt=""></p>
<p>如果要绘制 3D 的饼图，可以使用 plotrix 库的 pie3D() 函数，使用前我们需要先安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;plotrix&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="实例-4">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 plotrix  </span><br><span class="line">library(plotrix)  </span><br><span class="line">\# 数据准备  </span><br><span class="line">info \= c(1, 2, 4, 8)</span><br><span class="line"></span><br><span class="line">\# 命名  </span><br><span class="line">names \= c(&quot;Google&quot;, &quot;Runoob&quot;, &quot;Taobao&quot;, &quot;Weibo&quot;)</span><br><span class="line"></span><br><span class="line">\# 涂色（可选）  </span><br><span class="line">cols \= c(&quot;#ED1C24&quot;,&quot;#22B14C&quot;,&quot;#FFC90E&quot;,&quot;#3f48CC&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置文件名，输出为 png  </span><br><span class="line">png(file \= &quot;3d\_pie\_chart.png&quot;)</span><br><span class="line"></span><br><span class="line">\# 绘制 3D 图，family 要设置你系统支持的中文字体库  </span><br><span class="line">pie3D(info,labels \= names,explode \= 0.1, main \= &quot;3D 图&quot;,family \= &quot;STHeitiTC-Light&quot;)</span><br></pre></td></tr></table></figure>
<p>生成图片如下所示：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/3d_pie_chart.png" alt=""></p>
<h2 id="R-绘图-条形图">R 绘图 - 条形图</h2>
<p>条形图，也称为柱状图条形图，是一种以长方形的长度为变量的统计图表。</p>
<p>条形图可以是水平或垂直的，每个长方形可以有不同的颜色。</p>
<p>R 语言使用 barplot() 函数来创建条形图，格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">barplot(H,xlab,ylab,main, names.arg,col,beside)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><strong>H</strong> 向量或矩阵，包含图表用的数字值，每个数值表示矩形条的高度。</li>
<li><strong>xlab</strong> x 轴标签。</li>
<li><strong>ylab</strong> y 轴标签。</li>
<li><strong>main</strong> 图表标题。</li>
<li><strong>names.arg</strong> 每个矩形条的名称。</li>
<li><strong>col</strong> 每个矩形条的颜色。</li>
</ul>
<p>接下来我们创建一个简单的条形图：</p>
<h2 id="实例-5">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\# 准备一个向量  </span><br><span class="line">cvd19 \= c(83534,2640626,585493)</span><br><span class="line"></span><br><span class="line">\# 显示条形图  </span><br><span class="line">barplot(cvd19)</span><br></pre></td></tr></table></figure>
<p>执行绘图程序，会在当前目录下生存一个 PDF 文件（Rplots.pdf）,打开文件可以看到图形效果如下：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-bar-1.png" alt=""></p>
<p>为了更好地表达信息，我们可以在图表上添加标题、颜色及每个矩形条的名称。</p>
<p>以下我们创建 2020 年 7 月 1 日中国、美国和印度的新冠疫情确诊人数统计图。</p>
<p>中文字体需要设置字体参数 family=‘GB1’：</p>
<h2 id="实例-6">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cvd19 \= c(83534,2640626,585493)</span><br><span class="line"></span><br><span class="line">barplot(cvd19,  </span><br><span class="line">    main\=&quot;新冠疫情条形图&quot;,  </span><br><span class="line">    col\=c(&quot;#ED1C24&quot;,&quot;#22B14C&quot;,&quot;#FFC90E&quot;),  </span><br><span class="line">    names.arg\=c(&quot;中国&quot;,&quot;美国&quot;,&quot;印度&quot;),  </span><br><span class="line">    family\=&#x27;GB1&#x27;  </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-bar-2.png" alt=""></p>
<p>barplot 中的数据既可以是向量，也可以是矩阵，现在我们生成一张新冠疫情 6 月和 7 月对比图。</p>
<p>首先准备数据：</p>
<table>
<thead>
<tr>
<th></th>
<th>中国</th>
<th>美国</th>
<th>印度</th>
</tr>
</thead>
<tbody>
<tr>
<td>6 月</td>
<td>83017</td>
<td>1794546</td>
<td>190535</td>
</tr>
<tr>
<td>7 月</td>
<td>83534</td>
<td>2640626</td>
<td>585493</td>
</tr>
</tbody>
</table>
<p>转换成矩阵，生成条形图，按并排格式显示，而且要显示颜色样本。</p>
<p>这里我们设置了自己的字体库，详细内容可以参考 <a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-charts-cn.html">R 绘图 - 中文支持</a></p>
<h2 id="实例-7">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">library(showtext);  </span><br><span class="line">font\_add(&quot;SyHei&quot;, &quot;SourceHanSansSC-Bold.otf&quot;);  </span><br><span class="line">cvd19 \= matrix(  </span><br><span class="line">  c(83017, 83534, 1794546, 2640626, 190535, 585493),  </span><br><span class="line">  2, 3  </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">\# 设置文件名，输出为 png  </span><br><span class="line">png(file \= &quot;runoob-bar-1.png&quot;)</span><br><span class="line"></span><br><span class="line">#加载字体  </span><br><span class="line">showtext\_begin();</span><br><span class="line"></span><br><span class="line">colnames(cvd19) \= c(&quot;中国&quot;, &quot;美国&quot;, &quot;印度&quot;)  </span><br><span class="line">rownames(cvd19) \= c(&quot;6月&quot;, &quot;7月&quot;)  </span><br><span class="line">barplot(cvd19, main \= &quot;新冠疫情条形图&quot;, beside\=TRUE, legend\=TRUE,  family\=&#x27;SyHei&#x27;)</span><br><span class="line"></span><br><span class="line">\# 去掉字体  </span><br><span class="line">showtext\_end();</span><br></pre></td></tr></table></figure>
<p>以下代码会在当前程序目录下生存一个 runoob-bar-1.png 文件，如下所示：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/runoob-bar-1.png" alt=""></p>
<p>我们设置的颜色样本将是每各组的颜色样本：</p>
<h2 id="实例-8">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">library(plotrix)  </span><br><span class="line">library(showtext);  </span><br><span class="line">font\_add(&quot;SyHei&quot;, &quot;SourceHanSansSC-Bold.otf&quot;);  </span><br><span class="line">cvd19 \= matrix(  </span><br><span class="line">  c(83017, 83534, 1794546, 2640626, 190535, 585493),  </span><br><span class="line">  2, 3  </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">\# 设置文件名，输出为 png  </span><br><span class="line">png(file \= &quot;runoob-bar-2.png&quot;)  </span><br><span class="line">#加载字体  </span><br><span class="line">showtext\_begin();  </span><br><span class="line">colnames(cvd19) \= c(&quot;中国&quot;, &quot;美国&quot;, &quot;印度&quot;)  </span><br><span class="line">rownames(cvd19) \= c(&quot;6月&quot;, &quot;7月&quot;)</span><br><span class="line"></span><br><span class="line">barplot(cvd19, main \= &quot;新冠疫情条形图&quot;, beside\=TRUE, legend\=TRUE,col\=c(&quot;blue&quot;,&quot;green&quot;),  family\=&#x27;SyHei&#x27;)  </span><br><span class="line">\# 去掉字体  </span><br><span class="line">showtext\_end();</span><br></pre></td></tr></table></figure>
<p>以下代码会在当前程序目录下生存一个 runoob-bar-2.png 文件，如下所示：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/runoob-bar-2.png" alt=""></p>
<h3 id="beside-参数">beside 参数</h3>
<p>beside 设置矩形条堆叠的方式，默认为 FALSE：</p>
<ul>
<li>
<p><strong>beside=FALSE</strong> 时，条形图的高度是矩阵的数值，矩形条是水平堆叠的。</p>
</li>
<li>
<p><strong>beside=TRUE</strong> 时，条形图的高度是矩阵的数值，矩形条是并列的。</p>
</li>
</ul>
<h2 id="实例-9">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">library(showtext);  </span><br><span class="line">font\_add(&quot;SyHei&quot;, &quot;SourceHanSansSC-Bold.otf&quot;);  </span><br><span class="line">cvd19 \= matrix(  </span><br><span class="line">  c(83017, 83534, 1794546, 2640626, 190535, 585493),  </span><br><span class="line">  2, 3  </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">\# 设置文件名，输出为 png  </span><br><span class="line">png(file \= &quot;runoob-bar-3.png&quot;)  </span><br><span class="line">#加载字体  </span><br><span class="line">showtext\_begin();  </span><br><span class="line">colnames(cvd19) \= c(&quot;中国&quot;, &quot;美国&quot;, &quot;印度&quot;)  </span><br><span class="line">rownames(cvd19) \= c(&quot;6月&quot;, &quot;7月&quot;)</span><br><span class="line"></span><br><span class="line">barplot(cvd19, main \= &quot;新冠疫情条形图&quot;, beside\=FALSE, legend\=TRUE,col\=c(&quot;blue&quot;,&quot;green&quot;),  family\=&#x27;SyHei&#x27;)  </span><br><span class="line">\# 去掉字体  </span><br><span class="line">showtext\_end();</span><br></pre></td></tr></table></figure>
<p>以下代码会在当前程序目录下生存一个 runoob-bar-3.png 文件，如下所示：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/runoob-bar-3.png" alt=""></p>
<h2 id="R-绘图-函数曲线图">R 绘图 - 函数曲线图</h2>
<p>函数曲线图是研究函数的重要工具。</p>
<p>R 中 curve() 函数可以绘制函数的图像，代码格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curve(expr, from = NULL, to = NULL, n = 101, add = FALSE,</span><br><span class="line">      type = &quot;l&quot;, xname = &quot;x&quot;, xlab = xname, ylab = NULL,</span><br><span class="line">      log = NULL, xlim = NULL, …)</span><br><span class="line"></span><br><span class="line"># S3 函数的方法</span><br><span class="line">plot(x, y = 0, to = 1, from = y, xlim = NULL, ylab = NULL, …)</span><br></pre></td></tr></table></figure>
<p>**注：**R 语言的类有 S3 类和 S4 类，S3 类用的比较广，创建简单粗糙但是灵活，而 S4 类比较精细。</p>
<p>参数：</p>
<ul>
<li>expr：函数表达式</li>
<li>from 和 to：绘图的起止范围</li>
<li>n：一个整数值，表示 x 取值的数量</li>
<li>add：是一个逻辑值，当为 TRUE 时，表示将绘图添加到已存在的绘图中。</li>
<li>type：绘图的类型，p 为点、l 为直线， o 同时绘制点和线，且线穿过点。</li>
<li>xname：用于 x 轴变量的名称。</li>
<li>xlim 和 ylim 表示x轴和y轴的范围。</li>
<li>xlab，ylab：x 轴和 y 轴的标签名称。</li>
</ul>
<p>plot 函数中，x 和 y 分别表示所绘图形的横坐标和纵坐标。</p>
<p>以下我们绘制一个 sin(x) 函数的图表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curve(sin(x), -2 * pi, 2 * pi)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-line-1.png" alt=""></p>
<p>注意：任何计算机绘图工具绘制的都是模式图，它并不能保证与真的函数图像一模一样，它只是每隔一段距离取一个点，然后计算这个点的&quot;高度&quot;并绘制出来，为了保证曲线连续性，相邻两个点之间会有直线连接，所以在某些情况下例如 tan(x) 可能会出现错误：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-line-2.png" alt=""></p>
<p>在每一个 (2n+1)Pi / 2 的位置都会出现断点，但是 R 的图像将它们连接了，希望大家理解这一点。</p>
<p>当然，不是所有的函数都像 sin 一样支持向量处理，我们也可以手动生成一个数字序列然后用 plot 函数生成函数图像。假设函数 f 仅支持单个数值作为参数：</p>
<h2 id="实例-10">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">\# 定义函数 f  </span><br><span class="line">f \= function (x) &#123;  </span><br><span class="line">    if (x \&gt;= 0) &#123;  </span><br><span class="line">        x  </span><br><span class="line">    &#125; else &#123;  </span><br><span class="line">        x ^ 2  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 生成自变量序列  </span><br><span class="line">x \= seq(\-2, 2, length\=100)</span><br><span class="line"></span><br><span class="line">\# 生成因变量序列  </span><br><span class="line">y \= rep(0, length(x))  </span><br><span class="line">j \= 1  </span><br><span class="line">for (i in x) &#123;  </span><br><span class="line">    y\[j\] \= f(i)  </span><br><span class="line">    j \= j + 1  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 绘制图像  </span><br><span class="line">plot(x, y, type\=&#x27;l&#x27;)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-line-3.png" alt=""></p>
<p>接下来我们使用 plot() 函数对向量数据进行绘图：</p>
<h2 id="实例-11">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 向量数据  </span><br><span class="line">v &lt;- c(7,12,28,3,41)</span><br><span class="line"></span><br><span class="line">\# 生成图片  </span><br><span class="line">png(file \= &quot;line\_chart\_label\_colored.jpg&quot;)</span><br><span class="line"></span><br><span class="line">\# 绘图、线图颜色为红色，main 参数用于设置标题  </span><br><span class="line">plot(v,type \= &quot;o&quot;, col \= &quot;red&quot;, xlab \= &quot;Month&quot;, ylab \= &quot;Rain fall&quot;,  </span><br><span class="line">   main \= &quot;Rain fall chart&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/line_chart_label_colored.png" alt=""></p>
<h2 id="R-绘图-散点图">R 绘图 - 散点图</h2>
<p>散点图是将所有的数据以点的形式展现在直角坐标系上，以显示变量之间的相互影响程度，点的位置由变量的数值决定，每个点对应一个 X 和 Y 轴点坐标。</p>
<p>散点图可以使用 plot() 函数来绘制，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot(x, y, type=&quot;p&quot;, main, xlab, ylab, xlim, ylim, axes)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>x</strong> 横坐标 x 轴的数据集合</p>
</li>
<li>
<p><strong>y</strong> 纵坐标 y 轴的数据集合</p>
</li>
<li>
<p>type：绘图的类型，p 为点、l 为直线， o 同时绘制点和线，且线穿过点。</p>
</li>
<li>
<p><strong>main</strong> 图表标题。</p>
</li>
<li>
<p><strong>xlab、ylab</strong> x 轴和 y 轴的标签名称。</p>
</li>
<li>
<p><strong>xlim、ylim</strong> x 轴和 y 轴的范围。</p>
</li>
<li>
<p><strong>axes</strong> 布尔值，是否绘制两个 x 轴。</p>
</li>
</ul>
<p>type 参数可选择值：</p>
<ul>
<li>p：点图</li>
<li>l：线图</li>
<li>b：同时绘制点和线</li>
<li>c：仅绘制参数 b 所示的线</li>
<li>o：同时绘制点和线，且线穿过点</li>
<li>h：绘制出点到横坐标轴的垂直线</li>
<li>s：阶梯图，先横后纵</li>
<li>S：阶梯图，先纵后竖</li>
<li>n： 空图</li>
</ul>
<p>创建一个简单的线图：</p>
<h2 id="实例-12">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x&lt;-c(10,40)  </span><br><span class="line">y&lt;-c(20,60)  </span><br><span class="line">\# 生成 png 图片  </span><br><span class="line">png(file \= &quot;runnob-test-plot2.png&quot;)</span><br><span class="line"></span><br><span class="line">plot(x, y, &quot;l&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/runnob-test-plot2.png" alt=""></p>
<p>创建一个简单的线图，type 使用 o 参数，同时绘制点和线，且线穿过点：</p>
<h2 id="实例-13">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x&lt;-c(10,40)  </span><br><span class="line">y&lt;-c(20,60)  </span><br><span class="line">\# 生成 png 图片  </span><br><span class="line">png(file \= &quot;runnob-test-plot.png&quot;)</span><br><span class="line"></span><br><span class="line">plot(x, y, &quot;o&quot;)</span><br></pre></td></tr></table></figure>
<p>接下来我们使用 R 语言的内置数据集 mtcars 来进行测试。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/runnob-test-plot.png" alt=""></p>
<p>我们使用 mtcars 数据集的 wt 和 mpg 列：</p>
<h2 id="实例-14">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input &lt;- mtcars\[,c(&#x27;wt&#x27;,&#x27;mpg&#x27;)\]  </span><br><span class="line">print(head(input))  </span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wt  mpg</span><br><span class="line">Mazda RX4         2.620 21.0</span><br><span class="line">Mazda RX4 Wag     2.875 21.0</span><br><span class="line">Datsun 710        2.320 22.8</span><br><span class="line">Hornet 4 Drive    3.215 21.4</span><br><span class="line">Hornet Sportabout 3.440 18.7</span><br><span class="line">Valiant           3.460 18.1</span><br></pre></td></tr></table></figure>
<p>接着我们使用以上数据生存一个散点图</p>
<p>：</p>
<h2 id="实例-15">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 数据  </span><br><span class="line">input &lt;- mtcars\[,c(&#x27;wt&#x27;,&#x27;mpg&#x27;)\]</span><br><span class="line"></span><br><span class="line">\# 生成 png 图片  </span><br><span class="line">png(file \= &quot;scatterplot.png&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置坐标 x 轴范围 2.5 到 5, y 轴范围 15 到 30.  </span><br><span class="line">plot(x \= input$wt,y \= input$mpg,  </span><br><span class="line">   xlab \= &quot;Weight&quot;,  </span><br><span class="line">   ylab \= &quot;Milage&quot;,  </span><br><span class="line">   xlim \= c(2.5,5),  </span><br><span class="line">   ylim \= c(15,30),                </span><br><span class="line">   main \= &quot;Weight vs Milage&quot;  </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/scatterplot.png" alt=""></p>
<h3 id="散点图矩阵">散点图矩阵</h3>
<p>散点图矩阵是借助两变量散点图的作图方法，它可以看作是一个大的图形方阵，其每一个非主对角元素的位置上是对应行的变量与对应列的变量的散点图。而主对角元素位置上是各变量名，这样，借助散点图矩阵可以清晰地看到所研究多个变量两两之间的相关关系。</p>
<p>散点图矩阵就是把数据集中的每个数值变量两两绘制散点图。</p>
<p>R 语言使用以下函数创建散点图矩阵：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pairs(formula, data)</span><br></pre></td></tr></table></figure>
<p>参数：</p>
<ul>
<li>
<p><strong>formula</strong> 变量系列</p>
</li>
<li>
<p><strong>data</strong> 变量的数据集</p>
</li>
</ul>
<h2 id="实例-16">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\# 输出图片  </span><br><span class="line">png(file \= &quot;scatterplot\_matrices.png&quot;)</span><br><span class="line"></span><br><span class="line">\# 4 个变量绘制矩阵，12 个图</span><br><span class="line"></span><br><span class="line">pairs(~wt+mpg+disp+cyl,data \= mtcars, main \= &quot;Scatterplot Matrix&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/scatterplot_matrices.png" alt=""></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2013/05/02/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BB%98%E5%9B%BE/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2013/05/01/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE/"
                            aria-label=": R语言-读取数据"
                        >
                            R语言-读取数据
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2013-05-01T22:06:40+08:00">
	
		    2013 年 5 月 1 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80/">R语言</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="R-CSV-文件">R CSV 文件</h2>
<p>R 作为统计学专业工具，如果只能人工的导入和导出数据将使其功能变得没有意义，所以 R 支持批量的从主流的表格存储格式文件（例如 CSV、Excel、XML 等）中获取数据。</p>
<h3 id="CSV-表格交互">CSV 表格交互</h3>
<p>CSV（Comma-Separated Values，CSV，有时也称为字符分隔值，因为分隔字符也可以不是逗号） 是一种非常流行的表格存储文件格式，这种格式适合储存中型或小型数据规模的数据。</p>
<p>由于大多数软件支持这个文件格式，所以常用于数据的储存与交互。</p>
<p>CSV 本质是文本，它的文件格式极度简单：数据一行一行的用文本保存起来而已，每条记录被分隔符分隔为字段，每条记录都有同样的字段序列。</p>
<p>以下是一个简单的 sites.csv 文件（存储在测试程序的相同目录下）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id,name,url,likes</span><br><span class="line">1,Google,www.google.com,111</span><br><span class="line">2,Runoob,www.runoob.com,222</span><br><span class="line">3,Taobao,www.taobao.com,333</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>CSV 用逗号来分割列，如果数据中含有逗号，就要用双引号将整个数据块包括起来。</p>
<p>**注意：**包含非英文字符的文本要注意保存的编码，由于很多计算机普遍使用 UTF-8 编码，所以我是用 UTF-8 进行保存的。</p>
<p><strong>注意：</strong> CSV 文件最后一行需要保留一个空行，不然执行程序会有警告信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Warning message:</span><br><span class="line">In read.table(file = file, header = header, sep = sep, quote = quote,  :</span><br><span class="line">  incomplete final line found by readTableHeader on &#x27;sites.csv&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/057FE509-4EE4-4A74-9F7D-786AC2C5282E.jpg" alt=""></p>
<h3 id="读取-CSV-文件">读取 CSV 文件</h3>
<p>接下来我们就可以使用 read.csv() 函数来读取 CSV 文件的数据：</p>
<h2 id="实例">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)  </span><br><span class="line">print(data)  </span><br></pre></td></tr></table></figure>
<p>如果不设置 encoding 属性，read.csv 函数将默认以操作系统默认的文字编码进行读取，如果你使用的是 Windows 中文版系统且没有设置过系统的默认编码，那系统的默认编码应该是 GBK。所以大家请尽可能地统一文字编码以防出错。</p>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">1  1 Google www.google.com   111</span><br><span class="line">2  2 Runoob www.runoob.com   222</span><br><span class="line">3  3 Taobao www.taobao.com   333</span><br></pre></td></tr></table></figure>
<p>read.csv() 函数返回的是数据框，我们可以很方便的对数据进行统计处理，以下实例我们查看行数和列数：</p>
<h2 id="实例-2">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">print(is.data.frame(data))  \# 查看是否是数据框  </span><br><span class="line">print(ncol(data))  \# 列数  </span><br><span class="line">print(nrow(data))  \# 行数</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1] TRUE</span><br><span class="line">[1] 4</span><br><span class="line">[1] 3</span><br></pre></td></tr></table></figure>
<p>以下统计数据框中 likes 字段最大对数据：</p>
<h2 id="实例-3">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">\# likes 最大的数据  </span><br><span class="line">like &lt;- max(data$likes)  </span><br><span class="line">print(like)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 333</span><br></pre></td></tr></table></figure>
<p>我们也可以指定查找条件，类似 SQL where 子句一样查询数据，需要用到到函数是 <strong>subset()</strong>。</p>
<p>以下实例查找 likes 为 222 到数据：</p>
<h2 id="实例-4">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">\# likes 为 222 的数据  </span><br><span class="line">retval &lt;- subset(data, likes \== 222)  </span><br><span class="line">print(retval)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">2  2 Runoob www.runoob.com   222</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：条件语句等于使用 ==。</p>
<p>多个条件使用 &amp; 分隔符，以下实例查找 likes 大于 1 name 为 Runoob 的数据：</p>
<h2 id="实例-5">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">\# likes 大于 1 name 为 Runoob 的数据  </span><br><span class="line">retval &lt;- subset(data, likes \&gt; 1 &amp; name\==&quot;Runoob&quot;)  </span><br><span class="line">print(retval)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">2  2 Runoob www.runoob.com   222</span><br></pre></td></tr></table></figure>
<h3 id="保存为-CSV-文件">保存为 CSV 文件</h3>
<p>R 语言可以使用 <strong>write.csv()</strong> 函数将数据保存为 CSV 文件。</p>
<p>接着以上实例，我们将 likes 为 222 的数据 保存到 runoob.csv 文件：</p>
<h2 id="实例-6">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">\# likes 为 222 的数据  </span><br><span class="line">retval &lt;- subset(data, likes \== 222)</span><br><span class="line"></span><br><span class="line">\# 写入新的文件  </span><br><span class="line">write.csv(retval,&quot;runoob.csv&quot;)  </span><br><span class="line">newdata &lt;- read.csv(&quot;runoob.csv&quot;)  </span><br><span class="line">print(newdata)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> X id   name            url likes</span><br><span class="line">1 2  2 Runoob www.runoob.com   222</span><br></pre></td></tr></table></figure>
<p>X 来自数据集 newper，可以通过参数 row.names = FALSE 来删除它：</p>
<h2 id="实例-7">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.csv(&quot;sites.csv&quot;, encoding\=&quot;UTF-8&quot;)</span><br><span class="line"></span><br><span class="line">\# likes 为 222 的数据  </span><br><span class="line">retval &lt;- subset(data, likes \== 222)</span><br><span class="line"></span><br><span class="line">\# 写入新的文件  </span><br><span class="line">write.csv(retval,&quot;runoob.csv&quot;, row.names \= FALSE)  </span><br><span class="line">newdata &lt;- read.csv(&quot;runoob.csv&quot;)  </span><br><span class="line">print(newdata)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">1  2 Runoob www.runoob.com   222</span><br></pre></td></tr></table></figure>
<p>执行完后，我们就可以看到 runoob.csv 文件生存：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-csv-1.jpeg" alt=""></p>
<h2 id="R-Excel-文件">R Excel 文件</h2>
<p>Excel 格式的文件主要是 xls 或 xlsx，这两种文件可以在 R 语言中导入 xlsx 库来实现直接的读取。</p>
<p>R 语言读写 Excel 文件需要安装扩展包，我们可以在 R 到控制台输入以下命令来安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;xlsx&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>安装过程如下：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/4C19EC49-38CA-4C21-9A11-B15995728BCD.jpg" alt=""></p>
<p>事实上，几乎所有的 Excel 软件与大多数表格软件一样支持 CSV 格式的数据，所以完全可以通过 CSV 与 R 交互，没必要再使用 Excel。</p>
<p>查看 xlsx 是否安装成功：</p>
<h2 id="实例-8">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\# 验证包是否安装  </span><br><span class="line">any(grepl(&quot;xlsx&quot;,installed.packages()))  </span><br><span class="line">\# 载入包  </span><br><span class="line">library(&quot;xlsx&quot;)  </span><br><span class="line">library(&quot;xlsx&quot;)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] TRUE</span><br><span class="line">Loading required package: rJava</span><br><span class="line">Loading required package: methods</span><br><span class="line">Loading required package: xlsxjars</span><br></pre></td></tr></table></figure>
<p>Excel 文件数据：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/55596D4D-4122-4605-B40E-1826D638A572.jpg" alt=""></p>
<p>点击链接下载 Excel 测试数据：<a target="_blank" rel="noopener" href="https://static.jyshare.com/download/sites.xlsx">https://static.jyshare.com/download/sites.xlsx</a></p>
<p>接下来，我们可以使用 read.xlsx() 函数来读取 Excel 数据：</p>
<h2 id="实例-9">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 读取 sites.xlsx 第一个工作表数据  </span><br><span class="line">data &lt;- read.xlsx(&quot;sites.xlsx&quot;, sheetIndex \= 1)  </span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<h2 id="R-XML-文件">R XML 文件</h2>
<p>XML 指的是可扩展标记语言（eXtensible Markup Language），XML 被设计用来传输和存储数据。</p>
<p>如果你对 XML 还不了解，可以先查阅：<a target="_blank" rel="noopener" href="https://www.runoob.com/xml/xml-tutorial.html">XML 教程</a></p>
<p>R 语言读写 XML 文件需要安装扩展包，我们可以在 R 到控制台输入以下命令来安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;XML&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>查看是否安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; any(grepl(&quot;XML&quot;,installed.packages()))</span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>
<p>创建 sites.xml 文件，xml 文件与测试脚本同一目录下，代码如下：</p>
<h2 id="实例-10">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;sites\&gt; &lt;site\&gt; &lt;id\&gt;1&lt;/id\&gt; &lt;name\&gt;Google&lt;/name\&gt; &lt;url\&gt;www.google.com&lt;/url\&gt; &lt;likes\&gt;111&lt;/likes\&gt; &lt;/site\&gt; &lt;site\&gt; &lt;id\&gt;2&lt;/id\&gt; &lt;name\&gt;Runoob&lt;/name\&gt; &lt;url\&gt;www.runoob.com&lt;/url\&gt; &lt;likes\&gt;222&lt;/likes\&gt; &lt;/site\&gt; &lt;site\&gt; &lt;id\&gt;3&lt;/id\&gt; &lt;name\&gt;Taobao&lt;/name\&gt; &lt;url\&gt;www.taobao.com&lt;/url\&gt; &lt;likes\&gt;333&lt;/likes\&gt; &lt;/site\&gt; &lt;/sites\&gt;</span><br></pre></td></tr></table></figure>
<p>接下来我们可以使用 XML 包来载入 xml 文件的数据：</p>
<h2 id="实例-11">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 XML 包  </span><br><span class="line">library(&quot;XML&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置文件名  </span><br><span class="line">result &lt;- xmlParse(file \= &quot;sites.xml&quot;)</span><br><span class="line"></span><br><span class="line">\# 输出结果  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>统计 xml 数据量：</p>
<h2 id="实例-12">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 XML 包  </span><br><span class="line">library(&quot;XML&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置文件名  </span><br><span class="line">result &lt;- xmlParse(file \= &quot;sites.xml&quot;)</span><br><span class="line"></span><br><span class="line">\# 提取根节点  </span><br><span class="line">rootnode &lt;- xmlRoot(result)</span><br><span class="line"></span><br><span class="line">\# 统计数据量  </span><br><span class="line">rootsize &lt;- xmlSize(rootnode)</span><br><span class="line"></span><br><span class="line">\# 输出结果  </span><br><span class="line">print(rootsize)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 3</span><br></pre></td></tr></table></figure>
<p>查看节点数据，某一行使用 [ ], 指定的行和列使用 [[ ]]:</p>
<h2 id="实例-13">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 XML 包  </span><br><span class="line">library(&quot;XML&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置文件名  </span><br><span class="line">result &lt;- xmlParse(file \= &quot;sites.xml&quot;)</span><br><span class="line"></span><br><span class="line">\# 提取根节点  </span><br><span class="line">rootnode &lt;- xmlRoot(result)</span><br><span class="line"></span><br><span class="line">\# 查看第 2 个节点数据  </span><br><span class="line">print(rootnode\[2\])</span><br><span class="line"></span><br><span class="line">\# 查看第 2 个节点的第  1 个数据  </span><br><span class="line">print(rootnode\[\[2\]\]\[\[1\]\])</span><br><span class="line"></span><br><span class="line">\# 查看第 2 个节点的第 3 个数据</span><br><span class="line"></span><br><span class="line">print(rootnode\[\[2\]\]\[\[3\]\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$site</span><br><span class="line">&lt;site&gt;</span><br><span class="line">  &lt;id&gt;2&lt;/id&gt;</span><br><span class="line">  &lt;name&gt;Runoob&lt;/name&gt;</span><br><span class="line">  &lt;url&gt;www.runoob.com&lt;/url&gt;</span><br><span class="line">  &lt;likes&gt;222&lt;/likes&gt;</span><br><span class="line">&lt;/site&gt; </span><br><span class="line"></span><br><span class="line">attr(,&quot;class&quot;)</span><br><span class="line">[1] &quot;XMLInternalNodeList&quot; &quot;XMLNodeList&quot;        </span><br><span class="line">&lt;id&gt;2&lt;/id&gt; </span><br><span class="line">&lt;url&gt;www.runoob.com&lt;/url&gt; </span><br></pre></td></tr></table></figure>
<h3 id="XML-转为数据列表">XML 转为数据列表</h3>
<p>以上代码对输出都是 xml 格式，我们使用 xmlToList() 函数可以将文件对数据转为列表格式，更方便读取：</p>
<h2 id="实例-14">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 XML 包  </span><br><span class="line">library(&quot;XML&quot;)</span><br><span class="line"></span><br><span class="line">\# 设置文件名  </span><br><span class="line">result &lt;- xmlParse(file \= &quot;sites.xml&quot;)</span><br><span class="line"></span><br><span class="line">\# 转为列表  </span><br><span class="line">xml\_data &lt;- xmlToList(result)</span><br><span class="line"></span><br><span class="line">print(xml\_data)  </span><br><span class="line">print(&quot;============================&quot;)</span><br><span class="line"></span><br><span class="line">\# 输出第一行第二列的数据  </span><br><span class="line">print(xml\_data\[\[1\]\]\[\[2\]\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$site</span><br><span class="line">$site$id</span><br><span class="line">[1] &quot;1&quot;</span><br><span class="line"></span><br><span class="line">$site$name</span><br><span class="line">[1] &quot;Google&quot;</span><br><span class="line"></span><br><span class="line">$site$url</span><br><span class="line">[1] &quot;www.google.com&quot;</span><br><span class="line"></span><br><span class="line">$site$likes</span><br><span class="line">[1] &quot;111&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$site</span><br><span class="line">$site$id</span><br><span class="line">[1] &quot;2&quot;</span><br><span class="line"></span><br><span class="line">$site$name</span><br><span class="line">[1] &quot;Runoob&quot;</span><br><span class="line"></span><br><span class="line">$site$url</span><br><span class="line">[1] &quot;www.runoob.com&quot;</span><br><span class="line"></span><br><span class="line">$site$likes</span><br><span class="line">[1] &quot;222&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$site</span><br><span class="line">$site$id</span><br><span class="line">[1] &quot;3&quot;</span><br><span class="line"></span><br><span class="line">$site$name</span><br><span class="line">[1] &quot;Taobao&quot;</span><br><span class="line"></span><br><span class="line">$site$url</span><br><span class="line">[1] &quot;www.taobao.com&quot;</span><br><span class="line"></span><br><span class="line">$site$likes</span><br><span class="line">[1] &quot;333&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1] &quot;============================&quot;</span><br><span class="line">[1] &quot;Google&quot;</span><br></pre></td></tr></table></figure>
<h3 id="XML-转为数据框">XML 转为数据框</h3>
<p>XML 文件数据可以转为数据框类型，这样我们就更方便对数据进行操作：</p>
<h2 id="实例-15">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 XML 包  </span><br><span class="line">library(&quot;XML&quot;)</span><br><span class="line"></span><br><span class="line">\# xml 文件数据转为数据框  </span><br><span class="line">xmldataframe &lt;- xmlToDataFrame(&quot;sites.xml&quot;)  </span><br><span class="line">print(xmldataframe)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">1  1 Google www.google.com   111</span><br><span class="line">2  2 Runoob www.runoob.com   222</span><br><span class="line">3  3 Taobao www.taobao.com   333</span><br></pre></td></tr></table></figure>
<h2 id="R-JSON-文件">R JSON 文件</h2>
<p>JSON: <strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation(JavaScript 对象表示法)。</p>
<p>JSON 是存储和交换文本信息的语法。</p>
<p>JSON 类似 XML，但比 XML 更小、更快，更易解析。</p>
<p>如果你对 JSON 还不了解，可以先查阅：<a target="_blank" rel="noopener" href="https://www.runoob.com/json/json-tutorial.html">JSON 教程</a></p>
<p>R 语言读写 JSON 文件需要安装扩展包，我们可以在 R 到控制台输入以下命令来安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;rjson&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>查看是否安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; any(grepl(&quot;rjson&quot;,installed.packages()))</span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>
<p>创建 sites.json 文件，json 文件与测试脚本同一目录下，代码如下：</p>
<h2 id="实例-16">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;id&quot;:\[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;\], &quot;name&quot;:\[&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;\], &quot;url&quot;:\[&quot;www.google.com&quot;,&quot;www.runoob.com&quot;,&quot;www.taobao.com&quot;\], &quot;likes&quot;:\[ 111,222,333\] &#125;</span><br></pre></td></tr></table></figure>
<p>接下来我们可以使用 rjson 包来载入 json 文件的数据。</p>
<p>查看数据，某一行使用 [ ], 指定的行和列使用 [[ ]]:</p>
<h2 id="实例-17">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 rjson 包  </span><br><span class="line">library(&quot;rjson&quot;)</span><br><span class="line"></span><br><span class="line">\# 获取 json 数据  </span><br><span class="line">result &lt;- fromJSON(file \= &quot;sites.json&quot;)</span><br><span class="line"></span><br><span class="line">\# 输出结果  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">print(&quot;===============&quot;)</span><br><span class="line"></span><br><span class="line">\# 输出第 1 列的结果  </span><br><span class="line">print(result\[1\])</span><br><span class="line"></span><br><span class="line">print(&quot;===============&quot;)  </span><br><span class="line">\# 输出第 2 行第 2 列的结果  </span><br><span class="line">print(result\[\[2\]\]\[\[2\]\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$id</span><br><span class="line">[1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</span><br><span class="line"></span><br><span class="line">$name</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot; &quot;Taobao&quot;</span><br><span class="line"></span><br><span class="line">$url</span><br><span class="line">[1] &quot;www.google.com&quot; &quot;www.runoob.com&quot; &quot;www.taobao.com&quot;</span><br><span class="line"></span><br><span class="line">$likes</span><br><span class="line">[1] 111 222 333</span><br><span class="line"></span><br><span class="line">[1] &quot;===============&quot;</span><br><span class="line">$id</span><br><span class="line">[1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</span><br><span class="line"></span><br><span class="line">[1] &quot;===============&quot;</span><br><span class="line">[1] &quot;Runoob&quot;</span><br></pre></td></tr></table></figure>
<p>我们也可以使用 <strong>as.data.frame()</strong> 函数将 json 文件数据可以转为数据框类型，这样我们就更方便对数据进行操作：</p>
<h2 id="实例-18">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\# 载入 rjson 包  </span><br><span class="line">library(&quot;rjson&quot;)</span><br><span class="line"></span><br><span class="line">\# 获取 json 数据  </span><br><span class="line">result &lt;- fromJSON(file \= &quot;sites.json&quot;)</span><br><span class="line"></span><br><span class="line">\# 转为数据框  </span><br><span class="line">json\_data\_frame &lt;- as.data.frame(result)</span><br><span class="line"></span><br><span class="line">print(json\_data\_frame)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  id   name            url likes</span><br><span class="line">1  1 Google www.google.com   111</span><br><span class="line">2  2 Runoob www.runoob.com   222</span><br><span class="line">3  3 Taobao www.taobao.com   333</span><br></pre></td></tr></table></figure>
<h2 id="R-MySQL-连接">R MySQL 连接</h2>
<p>MySQL 是最流行的关系型数据库管理系统，在 WEB 应用方面 MySQL 是最好的 RDBMS(Relational Database Management System：关系数据库管理系统)应用软件之一。</p>
<p>如果你对 MySQL 还不了解，可以先查阅：<a target="_blank" rel="noopener" href="https://www.runoob.com/mysql/mysql-tutorial.html">MySQL 教程</a></p>
<p>R 语言读写 MySQL 文件需要安装扩展包，我们可以在 R 到控制台输入以下命令来安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;RMySQL&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>查看是否安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; any(grepl(&quot;RMySQL&quot;,installed.packages()))</span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>
<p>MySQL 目前被甲骨文收购，所以很多人使用来它的复制版本 MariaDB，MariaDB 在 GNU GPL下开源，MariaDB 的开发是由 MySQL 的一些原始开发者领导的，所以语法操作都差不多：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;RMariaDB&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>在 test 数据库中创建数据表 runoob，表结构及数据代码如下：</p>
<h2 id="实例-19">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\-- -- 表的结构 \`runoob\` \-- CREATE TABLE \`runoob\` ( \`id\` int(11) NOT NULL, \`name\` char(20) NOT NULL, \`url\` varchar(255) NOT NULL, \`likes\` int(11) NOT NULL ) ENGINE\=InnoDB DEFAULT CHARSET\=utf8mb4; \-- -- 转存表中的数据 \`runoob\` \-- INSERT INTO \`runoob\` (\`id\`, \`name\`, \`url\`, \`likes\`) VALUES (1, &#x27;Google&#x27;, &#x27;www.google.com&#x27;, 111), (2, &#x27;Runoob&#x27;, &#x27;www.runoob.com&#x27;, 222), (3, &#x27;Taobao&#x27;, &#x27;www.taobao.com&#x27;, 333);</span><br></pre></td></tr></table></figure>
<p>接下来我们可以使用 RMySQL 包来读取数据：</p>
<h2 id="实例-20">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(RMySQL)</span><br><span class="line"></span><br><span class="line">\# dbname 为数据库名，这边的参数请根据自己实际情况填写  </span><br><span class="line">mysqlconnection \= dbConnect(MySQL(), user \= &#x27;root&#x27;, password \= &#x27;&#x27;, dbname \= &#x27;test&#x27;,host \= &#x27;localhost&#x27;)</span><br><span class="line"></span><br><span class="line">\# 查看数据  </span><br><span class="line">dbListTables(mysqlconnection)</span><br></pre></td></tr></table></figure>
<p>接下来我们可以使用 dbSendQuery 来读取数据库的表，结果集通过 fetch() 函数来获取：</p>
<h2 id="实例-21">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(RMySQL)  </span><br><span class="line">\# 查询 sites 表，增删改查操作可以通过第二个参数的 SQL 语句来实现  </span><br><span class="line">result \= dbSendQuery(mysqlconnection, &quot;select \* from sites&quot;)</span><br><span class="line"></span><br><span class="line">\# 获取前面两行数据  </span><br><span class="line">data.frame \= fetch(result, n \= 2)  </span><br><span class="line">print(data.frame)</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2013/05/01/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2013/04/28/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E5%9F%BA%E7%A1%80/"
                            aria-label=": R语言-基础"
                        >
                            R语言-基础
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2013-04-28T22:06:40+08:00">
	
		    2013 年 4 月 28 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80/">R语言</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="R-语言基础">R 语言基础</h2>
<p>一门新的语言学习一般是从输出 “Hello, World!” 程序开始，R 语言的 “Hello, World!” 程序代码如下：</p>
<h2 id="实例（helloworld-R）">实例（helloworld.R）</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myString &lt;- &quot;Hello, World!&quot;</span><br><span class="line"></span><br><span class="line">print ( myString )</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/try/runcode.php?filename=helloworld&amp;type=r">运行实例 »</a></p>
<p>以上实例将字符串 “Hello, World!” 赋值给 myString 变量，然后使用 print() 函数输出。</p>
<p>**注意：**R 语言赋值使用的是左箭头 &lt;- 符号，不过一些新版本也支持等号 <strong>=</strong>。</p>
<h3 id="变量">变量</h3>
<p>R 语言的有效的变量名称由字母，数字以及点号 . 或下划线 _ 组成。</p>
<p>变量名称以字母或点开头。</p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>是否正确</th>
<th>原因</th>
</tr>
</thead>
<tbody>
<tr>
<td>var_name2.</td>
<td>正确</td>
<td>字符开头，并由字母、数字、下划线和点号组成</td>
</tr>
<tr>
<td>var_name%</td>
<td>错误</td>
<td>% 是非法字符</td>
</tr>
<tr>
<td>2var_name</td>
<td>错误</td>
<td>不能数字开头</td>
</tr>
<tr>
<td>.var_name,<a target="_blank" rel="noopener" href="http://var.name">var.name</a></td>
<td>正确</td>
<td>可以 . 号开头，但是要注意 . 号开头后面不能跟着数字</td>
</tr>
<tr>
<td>.2var_name</td>
<td>错误</td>
<td>. 号开头后面不能跟着数字</td>
</tr>
<tr>
<td>_var_name</td>
<td>错误</td>
<td>不能以下划线 _ 开头</td>
</tr>
</tbody>
</table>
<h3 id="变量赋值">变量赋值</h3>
<p>最新版本的 R 语言的赋值可以使用左箭头 &lt;-、等号 = 、右箭头 -&gt; 赋值:</p>
<h2 id="实例">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 使用等号 = 号赋值  </span><br><span class="line">\&gt; var.1 \= c(0,1,2,3)            </span><br><span class="line">\&gt; print(var.1)  </span><br><span class="line">\[1\] 0 1 2 3</span><br><span class="line"></span><br><span class="line">\# 使用左箭头 &lt;-赋值  </span><br><span class="line">\&gt; var.2 &lt;- c(&quot;learn&quot;,&quot;R&quot;)    </span><br><span class="line">\&gt; print(var.2)  </span><br><span class="line">\[1\] &quot;learn&quot; &quot;R&quot;</span><br><span class="line"></span><br><span class="line">    \# 使用右箭头 -&gt; 赋值  </span><br><span class="line">\&gt; c(TRUE,1) \-&gt; var.3  </span><br><span class="line">\&gt; print(var.3)  </span><br><span class="line">\[1\] 1 1</span><br></pre></td></tr></table></figure>
<p>查看已定义的变量可以使用 <strong>ls()</strong> 函数：</p>
<h2 id="实例-2">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&gt; print(ls())  </span><br><span class="line">\[1\] &quot;var.1&quot; &quot;var.2&quot; &quot;var.3&quot;  </span><br></pre></td></tr></table></figure>
<p>删除变量可以使用 <strong>rm()</strong> 函数：</p>
<h2 id="实例-3">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\&gt; rm(var.3)  </span><br><span class="line">\&gt; print(ls())  </span><br><span class="line">\[1\] &quot;var.1&quot; &quot;var.2&quot;  </span><br><span class="line">\&gt;  </span><br></pre></td></tr></table></figure>
<p>上一章节中我们已经学会来如何安装 R 的编程环境，接下来我们将为大家介绍 R 语言的交互式编程与文件脚本编程。</p>
<h3 id="交互式编程">交互式编程</h3>
<p>我们只需要在命令行中执行 R 命令就可以进入交互式的编程窗口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R</span><br></pre></td></tr></table></figure>
<p>执行完这个命令后会调出 R 语言的解释器，我们在 &gt; 符后面输入代码即可。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/AA89F11A-9180-4BD0-8A6A-4BE2FD5F1E8E.jpg" alt=""></p>
<p>交互式命令可以通过输入 q() 来退出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; q()</span><br><span class="line">Save workspace image? [y/n/c]: y</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/DDF9B88F-3BBC-4679-9D93-565E4D0ABBAB.jpg" alt=""></p>
<h3 id="文件脚本">文件脚本</h3>
<p>R 语言文件后缀为 .R。</p>
<p>接下来我们创建一个 runoob-test.R 文件：代码如下：</p>
<h2 id="runoob-test-R-文件">runoob-test.R 文件</h2>
<p>myString &lt;- “RUNOOB”</p>
<p>print ( myString )</p>
<p>接下来我们在命令行窗口使用 Rscript 来执行该脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rscript runoob-test.R</span><br></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;RUNOOB&quot;</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/0E277616-7A0A-423B-A3FB-8BCF0D381C80.jpg" alt=""></p>
<hr>
<h2 id="输入输出">输入输出</h2>
<h3 id="print-输出">print() 输出</h3>
<p>print() 是 R 语言的输出函数。</p>
<p>和其他编程语言一样，R 语言支持数字、字符等输出。</p>
<p>输出的语句十分简单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;RUNOOB&quot;)</span><br><span class="line">print(123)</span><br><span class="line">print(3e2)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;RUNOOB&quot;</span><br><span class="line">[1] 123</span><br><span class="line">[1] 300</span><br></pre></td></tr></table></figure>
<p>R 语言与 node.js 和 Python 一样，是解释型的语言，所以我们往往可以像使用命令行一样使用 R 语言。</p>
<p>如果我们在一行上进输入一个值，那么 R 也会把它直接标准化输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; 5e-2</span><br><span class="line">[1] 0.05</span><br></pre></td></tr></table></figure>
<h3 id="cat-函数">cat() 函数</h3>
<p>如果需要输出结果的拼接，我们可以使用 cat() 函数：</p>
<h2 id="实例-4">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&gt; cat(1, &quot;加&quot;, 1, &quot;等于&quot;, 2, &#x27;\\n&#x27;)  </span><br><span class="line">1 加 1 等于 2  </span><br></pre></td></tr></table></figure>
<p>cat() 函数会在每两个拼接元素之间自动加上空格。</p>
<h3 id="输出内容到文件">输出内容到文件</h3>
<p>R 语言输出到文件的方法十分多样，而且很方便。</p>
<p>cat() 函数支持直接输出结果到文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat(&quot;RUNOOB&quot;, file=&quot;/Users/runoob/runoob-test/r_test.txt&quot;)</span><br></pre></td></tr></table></figure>
<p>这个语句不会在控制台产生结果，而是把 “RUNOOB” 输出到 “/Users/runoob/runoob-test/r_test.txt” 文件中去。</p>
<p>file 参数可以是绝对路径或相对路径，建议使用绝对路径，Windows 路径格式为 D:\\r_test.txt。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat(&quot;RUNOOB&quot;, file=&quot;D:\\r_test.txt&quot;)</span><br></pre></td></tr></table></figure>
<p>注意：这个操作是&quot;覆盖写入&quot;操作，请谨慎使用，因为它会将输出文件的原有数据清除。如果想&quot;追加写入&quot;，请不要忘记设置 append 参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat(&quot;GOOGLE&quot;, file=&quot;/Users/runoob/runoob-test/r_test.txt&quot;, append=TRUE)</span><br></pre></td></tr></table></figure>
<p>执行以上代码后，打开 r_test.txt 文件内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUNOOBGOOGLE</span><br></pre></td></tr></table></figure>
<h3 id="sink">sink()</h3>
<p>sink() 函数可以把控制台输出的文字直接输出到文件中去：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sink(&quot;/Users/runoob/runoob-test/r_test.txt&quot;)</span><br></pre></td></tr></table></figure>
<p>这条语句执行以后，任何控制台上的输出都会被写入到 “/Users/runoob/runoob-test/r_test.txt” 文件中去，控制台将不会显示输出。</p>
<p>注意：这个操作也是&quot;覆盖写入&quot;操作，会直接清除原有的文件内容。</p>
<p>如果我们依然想保留控制台的输出，可以设置 split 属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sink(&quot;/Users/runoob/runoob-test/r_test.txt&quot;, split=TRUE)</span><br></pre></td></tr></table></figure>
<p>如果想取消输出到文件，可以调用无参数的 sink ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sink()</span><br></pre></td></tr></table></figure>
<h2 id="实例-5">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sink(&quot;r\_test.txt&quot;, split\=TRUE)  \# 控制台同样输出  </span><br><span class="line">for (i in 1:5)  </span><br><span class="line">    print(i)  </span><br><span class="line">sink()   \# 取消输出到文件</span><br><span class="line"></span><br><span class="line">sink(&quot;r\_test.txt&quot;, append\=TRUE) \# 控制台不输出，追加写入文件  </span><br><span class="line">print(&quot;RUNOOB&quot;)</span><br></pre></td></tr></table></figure>
<p>执行以上代码，当前目录下会生存一个 r_test.txt 文件，打开文件内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[1] 1</span><br><span class="line">[1] 2</span><br><span class="line">[1] 3</span><br><span class="line">[1] 4</span><br><span class="line">[1] 5</span><br><span class="line">[1] &quot;RUNOOB&quot;</span><br></pre></td></tr></table></figure>
<p>控制台输出为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] 1</span><br><span class="line">[1] 2</span><br><span class="line">[1] 3</span><br><span class="line">[1] 4</span><br><span class="line">[1] 5</span><br></pre></td></tr></table></figure>
<h3 id="文字输入">文字输入</h3>
<p>可能我们会联想到 C 语言中的 scanf 、Java 中的 java.util.Scanner，如果你学习过 Python 可能对 input() 函数更熟悉。但是 R 语言本身作为一种解释型的语言，更类似于一些终端脚本语言（比如 bash 或者 PowerShell），这些语言是基于命令系统的，本身就需要输入和输出且不适合开发面向用户的应用程序（因为他们本身就是给最终用户使用的）。因此 R 语言没有专门再从控制台读取的函数，文字输入在 R 的使用中一直在进行。</p>
<h3 id="从文件读入文字">从文件读入文字</h3>
<p>R 语言中有丰富的文件读取函数，但是如果纯粹的想将某个文件中的内容读取为字符串，可以使用 readLines 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readLines(&quot;/Users/runoob/runoob-test/r_test.txt&quot;)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;RUNOOBGOOGLE&quot;</span><br></pre></td></tr></table></figure>
<p>读取结果是两个字符串，分别是所读取的文件包含的两行内容。</p>
<blockquote>
<p>**注意：**所读取的文本文件每一行 (包括最后一行) 的结束必须有换行符，否则会报错。</p>
</blockquote>
<h3 id="其他方式">其他方式</h3>
<p>除了文字的简单输入输出以外，R 还提供了很多输入数据和输出数据的方法，R 语言最方便的地方就是可以将数据结构直接保存到文件中去，而且支持保存为 CSV、Excel 表格等形式，并且支持直接地读取。这对于数学研究者来说无疑是非常方便的。但是这些功能对于 R 语言的学习影响不大，我们将在之后的章节提到。</p>
<h3 id="工作目录">工作目录</h3>
<p>对于文件操作，我们需要设置文件的路径，R 语言可以通过以下两个函数来获取和设置当前的工作目录：</p>
<ul>
<li><strong>getwd()</strong> : 获取当前工作目录</li>
<li><strong>setwd()</strong> : 设置当前工作目录</li>
</ul>
<h2 id="实例-6">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# 当前工作目录  </span><br><span class="line">print(getwd())</span><br><span class="line"></span><br><span class="line">\# 设置当前工作目录  </span><br><span class="line">setwd(&quot;/Users/runoob/runoob-test2&quot;)</span><br><span class="line"></span><br><span class="line">\# 查看当前工作目录  </span><br><span class="line">print(getwd())</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;/Users/runoob/runoob-test&quot;</span><br><span class="line">[1] &quot;/Users/tianqixin/runoob-test2&quot;</span><br></pre></td></tr></table></figure>
<h2 id="R-注释">R 注释</h2>
<p>注释主要用于一段代码的解析，可以让阅读者更易理解，编程语言的注释会被编译器忽略掉，且不会影响代码的执行。</p>
<p>一般编程语言的注释分为单行注释与多行注释，但是 R 语言只支持单行注释，注释符号为 #。</p>
<p>其实如果有多行注释我们只需要在每一行添加 # 号就好了。</p>
<h2 id="单行注释">单行注释</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\# 这是我的第一个编程代码  </span><br><span class="line">myString &lt;- &quot;Hello, World!&quot;</span><br><span class="line"></span><br><span class="line">print ( myString )</span><br></pre></td></tr></table></figure>
<h2 id="多行注释">多行注释</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# R 语言实现两个数相加</span><br><span class="line"></span><br><span class="line">  \# 变量赋值  </span><br><span class="line">a &lt;- 9  </span><br><span class="line">b &lt;- 4</span><br><span class="line"></span><br><span class="line">  \# 输出结果  </span><br><span class="line">print(a + b)</span><br></pre></td></tr></table></figure>
<p>其实多行注释还有一个变通的写法，就是使用 if 语言，如下实例：</p>
<h2 id="多行注释-2">多行注释</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if(FALSE) &#123;  </span><br><span class="line">    &quot;  </span><br><span class="line">    这是一个多行注释的实例  </span><br><span class="line">    注释内容放在单引号或双引号之间  </span><br><span class="line">    &quot;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myString &lt;- &quot;Hello, World!&quot;  </span><br><span class="line">print ( myString)</span><br></pre></td></tr></table></figure>
<h2 id="R-基础运算">R 基础运算</h2>
<p>本章介绍 R 语言的简单运算。</p>
<h3 id="赋值">赋值</h3>
<p>一般语言的赋值是 <strong>=</strong> 号，但是 R 语言是数学语言，所以赋值符号与我们数学书上的伪代码很相似，是一个左箭头 &lt;- ：</p>
<h2 id="实例-7">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a &lt;- 123  </span><br><span class="line">b &lt;- 456  </span><br><span class="line">print(a + b)  </span><br></pre></td></tr></table></figure>
<p>以上代码执行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 579</span><br></pre></td></tr></table></figure>
<p>这个赋值符号是 R 语言的一个形式上的优点和操作上的缺点：形式上更适合数学工作者，毕竟不是所有的数学工作者都习惯于使用 <strong>=</strong> 作为赋值符号。</p>
<p>操作上来讲，&lt; 符号和 - 符号都不是很好打的字符，这会让很多程序员不适应。因此，R 语言的比较新的版本也支持 = 作为赋值符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = 123</span><br><span class="line">b = 456</span><br><span class="line">print(a + b)</span><br></pre></td></tr></table></figure>
<p>这也是合法的 R 程序。</p>
<p>**注意：**很难考证从 R 的哪个版本开始支持了 <strong>=</strong> 赋值，但是本教程习用的 R 版本是 4.0.0。</p>
<h3 id="数学运算符">数学运算符</h3>
<p>下表列出了主要的数学运算符以及他们的运算顺序：</p>
<table>
<thead>
<tr>
<th>优先级</th>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>()</td>
<td>括号</td>
</tr>
<tr>
<td>2</td>
<td>^</td>
<td>乘方运算</td>
</tr>
<tr>
<td>3</td>
<td>%%</td>
<td>整除求余</td>
</tr>
<tr>
<td></td>
<td>%/%</td>
<td>整除</td>
</tr>
<tr>
<td>4</td>
<td>*</td>
<td>乘法</td>
</tr>
<tr>
<td></td>
<td>/</td>
<td>除法</td>
</tr>
<tr>
<td>5</td>
<td>+</td>
<td>加法</td>
</tr>
<tr>
<td></td>
<td>-</td>
<td>减法</td>
</tr>
</tbody>
</table>
<p>以下实例演示了简单的数学运算：</p>
<h2 id="实例-8">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">\&gt; 1 + 2 \* 3  </span><br><span class="line">\[1\] 7  </span><br><span class="line">\&gt; (1 + 2) \* 3  </span><br><span class="line">\[1\] 9  </span><br><span class="line">\&gt; 3 / 4  </span><br><span class="line">\[1\] 0.75  </span><br><span class="line">\&gt; 3.4 \- 1.2  </span><br><span class="line">\[1\] 2.2  </span><br><span class="line">\&gt; 1 \- 4 \* 0.5^3  </span><br><span class="line">\[1\] 0.5  </span><br><span class="line">\&gt; 8 / 3 %% 2  </span><br><span class="line">\[1\] 8  </span><br><span class="line">\&gt; 8 / 4 %% 2  </span><br><span class="line">\[1\] Inf  </span><br><span class="line">\&gt; 3 %% 2^2  </span><br><span class="line">\[1\] 3  </span><br><span class="line">\&gt; 10 / 3 %/% 2  </span><br><span class="line">\[1\] 10  </span><br></pre></td></tr></table></figure>
<h3 id="关系运算符">关系运算符</h3>
<p>下表列出了 R 语言支持的关系运算符，关系运算符比较两个向量，将第一向量与第二向量的每个元素进行比较，结果返回一个布尔值。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;</td>
<td>判断第一个向量的每个元素是否大于第二个向量的相对应元素。</td>
</tr>
<tr>
<td>&lt;</td>
<td>判断第一个向量的每个元素是否小于第二个向量的相对应元素。</td>
</tr>
<tr>
<td>==</td>
<td>判断第一个向量的每个元素是否等于第二个向量的相对应元素。</td>
</tr>
<tr>
<td>!=</td>
<td>判断第一个向量的每个元素是否不等于第二个向量的相对应元素。</td>
</tr>
<tr>
<td>&gt;=</td>
<td>判断第一个向量的每个元素是否大于等于第二个向量的相对应元素。</td>
</tr>
<tr>
<td>&lt;=</td>
<td>判断第一个向量的每个元素是否小于等于第二个向量的相对应元素。</td>
</tr>
</tbody>
</table>
<h2 id="实例-9">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- c(2,4,6,9)  </span><br><span class="line">t &lt;- c(1,4,7,9)  </span><br><span class="line">print(v\&gt;t)  </span><br><span class="line">print(v &lt; t)  </span><br><span class="line">print(v \== t)  </span><br><span class="line">print(v!=t)  </span><br><span class="line">print(v\&gt;=t)  </span><br><span class="line">print(v&lt;=t)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[1]  TRUE FALSE FALSE FALSE</span><br><span class="line">[1] FALSE FALSE  TRUE FALSE</span><br><span class="line">[1] FALSE  TRUE FALSE  TRUE</span><br><span class="line">[1]  TRUE FALSE  TRUE FALSE</span><br><span class="line">[1]  TRUE  TRUE FALSE  TRUE</span><br><span class="line">[1] FALSE  TRUE  TRUE  TRUE</span><br></pre></td></tr></table></figure>
<h3 id="逻辑运算符">逻辑运算符</h3>
<p>下表列出了 R 语言支持的逻辑运算符，可用于数字、逻辑和复数类型的向量。</p>
<p>非 0 的数字（正数或负数）都为 TRUE。</p>
<p>逻辑运算符比较两个向量，将第一向量与第二向量的每个元素进行比较，结果返回一个布尔值。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;</td>
<td>元素逻辑与运算符，将第一个向量的每个元素与第二个向量的相对应元素进行组合，如果两个元素都为 TRUE，则结果为 TRUE，否则为 FALSE。</td>
</tr>
<tr>
<td>｜</td>
<td>元素逻辑或运算符，将第一个向量的每个元素与第二个向量的相对应元素进行组合，如果两个元素中有一个为 TRUE，则结果为 TRUE，如果都为 FALSE，则返回 FALSE。</td>
</tr>
<tr>
<td>!</td>
<td>逻辑非运算符，返回向量每个元素相反的逻辑值，如果元素为 TRUE 则返回 FALSE，如果元素为 FALSE 则返回 TRUE。</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>逻辑与运算符，只对两个向量对第一个元素进行判断，如果两个元素都为 TRUE，则结果为 TRUE，否则为 FALSE。</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="实例-10">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- c(3,1,TRUE,2+3i)  </span><br><span class="line">t &lt;- c(4,1,FALSE,2+3i)  </span><br><span class="line">print(v&amp;t)  </span><br><span class="line">print(v|t)  </span><br><span class="line">print(!v)</span><br><span class="line"></span><br><span class="line">\# &amp;&amp;、||只对第一个元素进行比较  </span><br><span class="line">v &lt;- c(3,0,TRUE,2+2i)  </span><br><span class="line">t &lt;- c(1,3,TRUE,2+3i)  </span><br><span class="line">print(v&amp;&amp;t)</span><br><span class="line"></span><br><span class="line">v &lt;- c(0,0,TRUE,2+2i)  </span><br><span class="line">t &lt;- c(0,3,TRUE,2+3i)  </span><br><span class="line">print(v||t)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1]  TRUE  TRUE FALSE  TRUE</span><br><span class="line">[1] TRUE TRUE TRUE TRUE</span><br><span class="line">[1] FALSE FALSE FALSE FALSE</span><br><span class="line">[1] TRUE</span><br><span class="line">[1] FALSE</span><br></pre></td></tr></table></figure>
<h3 id="赋值运算符">赋值运算符</h3>
<p>R 语言变量可以使用向左，向右或等于操作符来赋值。</p>
<p>下表列出了 R 语言支持的赋值运算符。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;−</code>, <code>=</code>，<code>&lt;&lt;−</code></td>
<td>向左赋值。</td>
</tr>
<tr>
<td><code>−&gt;</code>, <code>−&gt;&gt;</code></td>
<td>向右赋值。</td>
</tr>
</tbody>
</table>
<h2 id="实例-11">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\# 向左赋值  </span><br><span class="line">v1 &lt;- c(3,1,TRUE,&quot;runoob&quot;)  </span><br><span class="line">v2 &lt;&lt;- c(3,1,TRUE,&quot;runoob&quot;)  </span><br><span class="line">v3 \= c(3,1,TRUE,&quot;runoob&quot;)  </span><br><span class="line">print(v1)  </span><br><span class="line">print(v2)  </span><br><span class="line">print(v3)</span><br><span class="line"></span><br><span class="line">\# 向右赋值  </span><br><span class="line">c(3,1,TRUE,&quot;runoob&quot;) \-&gt; v1  </span><br><span class="line">c(3,1,TRUE,&quot;runoob&quot;) \-&gt;&gt; v2  </span><br><span class="line">print(v1)  </span><br><span class="line">print(v2)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;3&quot;      &quot;1&quot;      &quot;TRUE&quot;   &quot;runoob&quot;</span><br><span class="line">[1] &quot;3&quot;      &quot;1&quot;      &quot;TRUE&quot;   &quot;runoob&quot;</span><br><span class="line">[1] &quot;3&quot;      &quot;1&quot;      &quot;TRUE&quot;   &quot;runoob&quot;</span><br><span class="line">[1] &quot;3&quot;      &quot;1&quot;      &quot;TRUE&quot;   &quot;runoob&quot;</span><br><span class="line">[1] &quot;3&quot;      &quot;1&quot;      &quot;TRUE&quot;   &quot;runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="其他运算符">其他运算符</h3>
<p>R 语言还包含了一些特别的运算符。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:</td>
<td>冒号运算符，用于创建一系列数字的向量。</td>
</tr>
<tr>
<td>%in%</td>
<td>用于判断元素是否在向量里，返回布尔值，有的话返回 TRUE，没有返回 FALSE。</td>
</tr>
<tr>
<td>%*%</td>
<td>用于矩阵与它转置的矩阵相乘。</td>
</tr>
</tbody>
</table>
<h2 id="实例-12">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# 1 到 10 的向量  </span><br><span class="line">v &lt;- 1:10  </span><br><span class="line">print(v)</span><br><span class="line"></span><br><span class="line">\# 判断数字是否在向量 v 中  </span><br><span class="line">v1 &lt;- 3  </span><br><span class="line">v2 &lt;- 15  </span><br><span class="line">print(v1 %in% v)  </span><br><span class="line">print(v2 %in% v)</span><br><span class="line"></span><br><span class="line">\# 矩阵与它转置的矩阵相乘  </span><br><span class="line">M \= matrix( c(2,6,5,1,10,4), nrow \= 2,ncol \= 3,byrow \= TRUE)  </span><br><span class="line">t \= M %\*% t(M)  </span><br><span class="line">print(t)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[1]  1  2  3  4  5  6  7  8  9 10</span><br><span class="line">[1] TRUE</span><br><span class="line">[1] FALSE</span><br><span class="line">     [,1] [,2]</span><br><span class="line">[1,]   65   82</span><br><span class="line">[2,]   82  117</span><br></pre></td></tr></table></figure>
<h3 id="数学函数">数学函数</h3>
<p>常见对一些数学函数有：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sqrt(n)</td>
<td>n的平方根</td>
</tr>
<tr>
<td>exp(n)</td>
<td>自然常数e的n次方，</td>
</tr>
<tr>
<td>log(m,n)</td>
<td>m的对数函数，返回n的几次方等于m</td>
</tr>
<tr>
<td>log10(m)</td>
<td>相当于log(m,10)</td>
</tr>
</tbody>
</table>
<p>以下实例演示了数学函数的应用：</p>
<h2 id="实例-13">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\&gt; sqrt(4)  </span><br><span class="line">\[1\] 2  </span><br><span class="line">\&gt; exp(1)  </span><br><span class="line">\[1\] 2.718282  </span><br><span class="line">\&gt; exp(2)  </span><br><span class="line">\[1\] 7.389056  </span><br><span class="line">\&gt; log(2,4)  </span><br><span class="line">\[1\] 0.5  </span><br><span class="line">\&gt; log10(10000)  </span><br><span class="line">\[1\] 4  </span><br></pre></td></tr></table></figure>
<p>取整函数：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>参数模型</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>round</td>
<td>(n)</td>
<td>对 n 四舍五入取整</td>
</tr>
<tr>
<td></td>
<td>(n, m)</td>
<td>对 n 保留 m 位小数四舍五入</td>
</tr>
<tr>
<td>ceiling</td>
<td>(n)</td>
<td>对 n 向上取整</td>
</tr>
<tr>
<td>floor</td>
<td>(n)</td>
<td>对 n 向下取整</td>
</tr>
</tbody>
</table>
<p>以下实例演示了取整函数的应用：</p>
<h2 id="实例-14">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\&gt; round(1.5)  </span><br><span class="line">\[1\] 2  </span><br><span class="line">\&gt; round(2.5)  </span><br><span class="line">\[1\] 2  </span><br><span class="line">\&gt; round(3.5)  </span><br><span class="line">\[1\] 4  </span><br><span class="line">\&gt; round(4.5)  </span><br><span class="line">\[1\] 4  </span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：R 中的 round 函数有些情况下可能会&quot;舍掉五&quot;。</p>
<p>当取整位是偶数的时候，五也会被舍去，这一点与 C 语言有所不同。</p>
<p>R 的三角函数是弧度制：</p>
<h2 id="实例-15">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; sin(pi/6)  </span><br><span class="line">\[1\] 0.5  </span><br><span class="line">\&gt; cos(pi/4)  </span><br><span class="line">\[1\] 0.7071068  </span><br><span class="line">\&gt; tan(pi/3)  </span><br><span class="line">\[1\] 1.732051  </span><br></pre></td></tr></table></figure>
<p>反三角函数：</p>
<h2 id="实例-16">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; asin(0.5)  </span><br><span class="line">\[1\] 0.5235988  </span><br><span class="line">\&gt; acos(0.7071068)  </span><br><span class="line">\[1\] 0.7853981  </span><br><span class="line">\&gt; atan(1.732051)  </span><br><span class="line">\[1\] 1.047198  </span><br></pre></td></tr></table></figure>
<p>如果学习过概率论和统计学，应该对以下的概率分布函数比较了解，因为 R 语言为数学工作者设计，所以经常会用到：</p>
<h2 id="实例-17">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\&gt; dnorm(0)  </span><br><span class="line">\[1\] 0.3989423  </span><br><span class="line">\&gt; pnorm(0)  </span><br><span class="line">\[1\] 0.5  </span><br><span class="line">\&gt; qnorm(0.95)  </span><br><span class="line">\[1\] 1.644854  </span><br><span class="line">\&gt; rnorm(3, 5, 2) \# 产生 3 个平均值为 5，标准差为 2 的正态随机数  </span><br><span class="line">\[1\] 4.177589 6.413927 4.206032  </span><br></pre></td></tr></table></figure>
<p>这四个都是用来计算正态分布的函数。它们的名字都以 norm 结尾，代表&quot;正态分布&quot;。</p>
<p>分布函数名字的前缀有四种：</p>
<ul>
<li><strong>d</strong> - 概率密度函数</li>
<li><strong>p</strong> - 概率密度积分函数（从无限小到 x 的积分）</li>
<li><strong>q</strong> - 分位数函数</li>
<li><strong>r</strong> - 随机数函数（常用于概率仿真）</li>
</ul>
<p><strong>注</strong>：由于本教程不是阐述数学专业理论的教程，所以对有关概率分布的数学理论不作详细解释。R 语言除了含有正态分布函数以外还有泊松分布 (pois, Poisson) 等常见分布函数，如果想详细了解可以学习&quot;概率论与数理统计&quot;。</p>
<h2 id="R-数据类型">R 数据类型</h2>
<p>数据类型指的是用于声明不同类型的变量或函数的一个广泛的系统。</p>
<p>变量的类型决定了变量存储占用的空间，以及如何解释存储的位模式。</p>
<p>R 语言中的最基本数据类型主要有三种：</p>
<ul>
<li>数字</li>
<li>逻辑</li>
<li>文本</li>
</ul>
<p>数字常量主要有两种：</p>
<table>
<thead>
<tr>
<th>一般型</th>
<th>123 -0.125</th>
</tr>
</thead>
<tbody>
<tr>
<td>科学计数法</td>
<td>1.23e2 -1.25E-1</td>
</tr>
</tbody>
</table>
<p>逻辑类型在许多其他编程语言中常称为布尔型（Boolean），常量值只有 <strong>TRUE</strong> 和 <strong>FALSE</strong>。</p>
<p>**注意：**R 语言区分大小写，true 或 True 不能代表 TRUE。</p>
<p>最直观的数据类型就是文本类型。文本就是其它语言中常出现的字符串（String），常量用双引号包含。在 R 语言中，文本常量既可以用单引号包含，也可以用双引号包含，例如：</p>
<h2 id="实例-18">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&gt; &#x27;runoob&#x27; \== &quot;runoob&quot;  </span><br><span class="line">\[1\] TRUE  </span><br></pre></td></tr></table></figure>
<p>有关于 R 语言的变量定义，并不像一些强类型语言中的语法规则，需要专门为变量设置名称和数据类型，每当在 R 中使用赋值运算符时，实际上就是定义了一个新的变量：</p>
<h2 id="实例-19">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a \= 1  </span><br><span class="line">b &lt;- TRUE  </span><br><span class="line">b \= &quot;abc&quot;  </span><br></pre></td></tr></table></figure>
<p>按对象类型来分是以下 6 种（后面会详细介绍这几种类型）：</p>
<ul>
<li>向量（vector）</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-list.html">列表（list）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-matrix.html">矩阵（matrix）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-array.html">数组（array）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-factor.html">因子（factor)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-data-frame.html">数据框（data.frame)</a></li>
</ul>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/52988954-D570-42FD-9CFC-90CD78D361C3.jpg" alt=""></p>
<h3 id="向量">向量</h3>
<p>向量（Vector）在 Java、Rust、C# 这些专门编程的的语言的标准库里往往会提供，这是因为向量在数学运算中是不可或缺的工具——我们最常见的向量是二维向量，这种向量在平面坐标系中必然会用到。</p>
<p>向量从数据结构上看就是一个线性表，可以看成一个数组。</p>
<p>R 语言中向量作为一种类型存在可以让向量的操作变得更加容易：</p>
<h2 id="实例-20">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; a \= c(3, 4)  </span><br><span class="line">\&gt; b \= c(5, 0)  </span><br><span class="line">\&gt; a + b  </span><br><span class="line">\[1\] 8 4  </span><br><span class="line">\&gt;  </span><br></pre></td></tr></table></figure>
<p>c() 是一个创造向量的函数。</p>
<p>这里把两个二维向量相加，得到一个新的二维向量 (8, 4)。如果将一个二维向量和三维向量做运算，将失去数学意义，虽然不会停止运行，但会被警告。</p>
<p>我建议大家从习惯上杜绝这种情况的出现。</p>
<p>向量中的每一个元素可以通过下标单独取出：</p>
<h2 id="实例-21">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\&gt; a \= c(10, 20, 30, 40, 50)  </span><br><span class="line">\&gt; a\[2\]  </span><br><span class="line">\[1\] 20  </span><br></pre></td></tr></table></figure>
<p>**注意：**R 语言中的&quot;下标&quot;不代表偏移量，而代表第几个，也就是说是从 1 开始的！</p>
<p>R 也可以方便的取出向量的一部分：</p>
<h2 id="实例-22">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; a\[1:4\] \# 取出第 1 到 4 项，包含第 1 和第 4 项  </span><br><span class="line">\[1\] 10 20 30 40  </span><br><span class="line">\&gt; a\[c(1, 3, 5)\] \# 取出第 1, 3, 5 项  </span><br><span class="line">\[1\] 10 30 50  </span><br><span class="line">\&gt; a\[c(\-1, \-5)\] \# 去掉第 1 和第 5 项  </span><br><span class="line">\[1\] 20 30 40  </span><br></pre></td></tr></table></figure>
<p>这三种部分取出方法是最常用的。</p>
<p>向量支持标量计算：</p>
<h2 id="实例-23">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; c(1.1, 1.2, 1.3) \- 0.5  </span><br><span class="line">\[1\] 0.6 0.7 0.8  </span><br><span class="line">\&gt; a \= c(1,2)  </span><br><span class="line">\&gt; a ^ 2  </span><br><span class="line">\[1\] 1 4  </span><br></pre></td></tr></table></figure>
<p>之前讲述的常用的数学运算函数，如 sqrt 、exp 等，同样可以用于对向量作标量运算。</p>
<p>&quot;向量&quot;作为线性表结构，应该具备一些常用的线性表处理函数，R 确实具备这些函数：</p>
<p>向量排序：</p>
<h2 id="实例-24">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\&gt; a \= c(1, 3, 5, 2, 4, 6)  </span><br><span class="line">\&gt; sort(a)  </span><br><span class="line">\[1\] 1 2 3 4 5 6  </span><br><span class="line">\&gt; rev(a)  </span><br><span class="line">\[1\] 6 4 2 5 3 1  </span><br><span class="line">\&gt; order(a)  </span><br><span class="line">\[1\] 1 4 2 5 3 6  </span><br><span class="line">\&gt; a\[order(a)\]  </span><br><span class="line">\[1\] 1 2 3 4 5 6  </span><br></pre></td></tr></table></figure>
<p>order() 函数返回的是一个向量排序之后的下标向量。</p>
<p><strong>向量统计</strong></p>
<p>R 中有十分完整的统计学函数：</p>
<table>
<thead>
<tr>
<th><strong>函数名</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sum</td>
<td>求和</td>
</tr>
<tr>
<td>mean</td>
<td>求平均值</td>
</tr>
<tr>
<td>var</td>
<td>方差</td>
</tr>
<tr>
<td>sd</td>
<td>标准差</td>
</tr>
<tr>
<td>min</td>
<td>最小值</td>
</tr>
<tr>
<td>max</td>
<td>最大值</td>
</tr>
<tr>
<td>range</td>
<td>取值范围（二维向量，最大值和最小值）</td>
</tr>
</tbody>
</table>
<p>向量统计实例：</p>
<h2 id="实例-25">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; sum(1:5)  </span><br><span class="line">\[1\] 15  </span><br><span class="line">\&gt; sd(1:5)  </span><br><span class="line">\[1\] 1.581139  </span><br><span class="line">\&gt; range(1:5)  </span><br><span class="line">\[1\] 1 5  </span><br></pre></td></tr></table></figure>
<p><strong>向量生成</strong></p>
<p>向量的生成可以用 <strong>c()</strong> 函数生成，也可以用 min:max 运算符生成连续的序列。</p>
<p>如果想生成有间隙的等差数列，可以用 seq 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; seq(1, 9, 2)</span><br><span class="line">[1] 1 3 5 7 9</span><br></pre></td></tr></table></figure>
<p>seq 还可以生成从 m 到 n 的等差数列，只需要指定 m, n 以及数列的长度：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; seq(0, 1, length.out=3)</span><br><span class="line">[1] 0.0 0.5 1.0</span><br></pre></td></tr></table></figure>
<p>rep 是 repeat（重复）的意思，可以用于产生重复出现的数字序列：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; rep(0, 5)</span><br><span class="line">[1] 0 0 0 0 0</span><br></pre></td></tr></table></figure>
<p>向量中常会用到 NA 和 NULL ，这里介绍一下这两个词语与区别：</p>
<ul>
<li>NA 代表的是&quot;缺失&quot;，NULL 代表的是&quot;不存在&quot;。</li>
<li>NA 缺失就像占位符，代表这里没有一个值，但位置存在。</li>
<li>NULL 代表的就是数据不存在。</li>
</ul>
<p>实例说明：</p>
<h2 id="实例-26">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\&gt; length(c(NA, NA, NULL))  </span><br><span class="line">\[1\] 2  </span><br><span class="line">\&gt; c(NA, NA, NULL, NA)  </span><br><span class="line">\[1\] NA NA NA  </span><br></pre></td></tr></table></figure>
<p>很显然， NULL 在向量中没有任何意义。</p>
<hr>
<h2 id="逻辑型">逻辑型</h2>
<p>逻辑向量主要用于向量的逻辑运算，例如：</p>
<h2 id="实例-27">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&gt; c(11, 12, 13) \&gt; 12  </span><br><span class="line">\[1\] FALSE FALSE  TRUE  </span><br></pre></td></tr></table></figure>
<p>which 函数是十分常见的逻辑型向量处理函数，可以用于筛选我们需要的数据的下标:</p>
<h2 id="实例-28">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; a \= c(11, 12, 13)  </span><br><span class="line">\&gt; b \= a \&gt; 12  </span><br><span class="line">\&gt; print(b)  </span><br><span class="line">\[1\] FALSE FALSE  TRUE  </span><br><span class="line">\&gt; which(b)  </span><br><span class="line">\[1\] 3  </span><br></pre></td></tr></table></figure>
<p>例如我们需要从一个线性表中筛选大于等于 60 且小于 70 的数据：</p>
<h2 id="实例-29">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\&gt; vector \= c(10, 40, 78, 64, 53, 62, 69, 70)  </span><br><span class="line">\&gt; print(vector\[which(vector \&gt;= 60 &amp; vector &lt; 70)\])  </span><br><span class="line">\[1\] 64 62 69  </span><br></pre></td></tr></table></figure>
<p>类似的函数还有 all 和 any：</p>
<h2 id="实例-30">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\&gt; all(c(TRUE, TRUE, TRUE))  </span><br><span class="line">\[1\] TRUE  </span><br><span class="line">\&gt; all(c(TRUE, TRUE, FALSE))  </span><br><span class="line">\[1\] FALSE  </span><br><span class="line">\&gt; any(c(TRUE, FALSE, FALSE))  </span><br><span class="line">\[1\] TRUE  </span><br><span class="line">\&gt; any(c(FALSE, FALSE, FALSE))  </span><br><span class="line">\[1\] FALSE  </span><br></pre></td></tr></table></figure>
<p>all() 用于检查逻辑向量是否全部为 TRUE，any() 用于检查逻辑向量是否含有 TRUE。</p>
<hr>
<h2 id="字符串">字符串</h2>
<p>字符串数据类型本身并不复杂，这里注重介绍字符串的操作函数：</p>
<h2 id="实例-31">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">\&gt; toupper(&quot;Runoob&quot;) \# 转换为大写  </span><br><span class="line">\[1\] &quot;RUNOOB&quot;  </span><br><span class="line">\&gt; tolower(&quot;Runoob&quot;) \# 转换为小写  </span><br><span class="line">\[1\] &quot;runoob&quot;  </span><br><span class="line">\&gt; nchar(&quot;中文&quot;, type\=&quot;bytes&quot;) \# 统计字节长度  </span><br><span class="line">\[1\] 4  </span><br><span class="line">\&gt; nchar(&quot;中文&quot;, type\=&quot;char&quot;) \# 总计字符数量  </span><br><span class="line">\[1\] 2  </span><br><span class="line">\&gt; substr(&quot;123456789&quot;, 1, 5) \# 截取字符串，从 1 到 5  </span><br><span class="line">\[1\] &quot;12345&quot;  </span><br><span class="line">\&gt; substring(&quot;1234567890&quot;, 5) \# 截取字符串，从 5 到结束  </span><br><span class="line">\[1\] &quot;567890&quot;  </span><br><span class="line">\&gt; as.numeric(&quot;12&quot;) \# 将字符串转换为数字  </span><br><span class="line">\[1\] 12  </span><br><span class="line">\&gt; as.character(12.34) \# 将数字转换为字符串  </span><br><span class="line">\[1\] &quot;12.34&quot;  </span><br><span class="line">\&gt; strsplit(&quot;2019;10;1&quot;, &quot;;&quot;) \# 分隔符拆分字符串  </span><br><span class="line">\[\[1\]\]  </span><br><span class="line">\[1\] &quot;2019&quot; &quot;10&quot;   &quot;1&quot;  </span><br><span class="line">\&gt; gsub(&quot;/&quot;, &quot;-&quot;, &quot;2019/10/1&quot;) \# 替换字符串  </span><br><span class="line">\[1\] &quot;2019-10-1&quot;  </span><br></pre></td></tr></table></figure>
<p>在 Windows 计算机上实现，使用的是 GBK 编码标准，所以一个中文字符是两个字节，如果在 UTF-8 编码的计算机上运行，单个中文字符的字节长度应该是 3。</p>
<p>R 支持 perl 语言格式的正则表达式：</p>
<h2 id="实例-32">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\&gt; gsub(&quot;\[\[:alpha:\]\]+&quot;, &quot;$&quot;, &quot;Two words&quot;)  </span><br><span class="line">\[1\] &quot;$ $&quot;  </span><br></pre></td></tr></table></figure>
<p>更多字符串内容参考：<a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-string.html">R 语言字符串介绍</a>。</p>
<hr>
<h2 id="矩阵">矩阵</h2>
<p>R 语言为线性代数的研究提供了矩阵类型，这种数据结构很类似于其它语言中的二维数组，但 R 提供了语言级的矩阵运算支持。</p>
<p>首先看看矩阵的生成：</p>
<h2 id="实例-33">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; vector\=c(1, 2, 3, 4, 5, 6)  </span><br><span class="line">\&gt; matrix(vector, 2, 3)  </span><br><span class="line">     \[,1\] \[,2\] \[,3\]  </span><br><span class="line">\[1,\]    1    3    5  </span><br><span class="line">\[2,\]    2    4    6  </span><br></pre></td></tr></table></figure>
<p>矩阵初始化内容是由一个向量来传递的，其次要表达一个矩阵有几行、有几列。</p>
<p>向量中的值会一列一列的填充到矩阵中。如果想按行填充，需要指定 byrow 属性：</p>
<h2 id="实例-34">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\&gt; matrix(vector, 2, 3, byrow\=TRUE)  </span><br><span class="line">     \[,1\] \[,2\] \[,3\]  </span><br><span class="line">\[1,\]    1    2    3  </span><br><span class="line">\[2,\]    4    5    6  </span><br></pre></td></tr></table></figure>
<p>矩阵中的每一个值都可以被直接访问：</p>
<h2 id="实例-35">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; m1 \= matrix(vector, 2, 3, byrow\=TRUE)  </span><br><span class="line">\&gt; m1\[1,1\] \# 第 1 行 第 1 列  </span><br><span class="line">\[1\] 1  </span><br><span class="line">\&gt; m1\[1,3\] \# 第 1 行 第 3 列  </span><br><span class="line">\[1\] 3  </span><br></pre></td></tr></table></figure>
<p>R 中的矩阵的每一个列和每一行都可以设定名称，这个过程通过字符串向量批量完成：</p>
<h2 id="实例-36">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\&gt; colnames(m1) \= c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;)  </span><br><span class="line">\&gt; rownames(m1) \= c(&quot;a&quot;, &quot;b&quot;)  </span><br><span class="line">\&gt; m1  </span><br><span class="line">  x y z  </span><br><span class="line">a 1 2 3  </span><br><span class="line">b 4 5 6  </span><br><span class="line">\&gt; m1\[&quot;a&quot;, \]  </span><br><span class="line">x y z  </span><br><span class="line">1 2 3  </span><br></pre></td></tr></table></figure>
<p>矩阵的四则运算与向量基本一致，既可以与标量做运算，也可以与同规模的矩阵做对应位置的运算。</p>
<p>矩阵乘法运算：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/MVGBECflKCDs5GnJ__thumbnail.png" alt=""></p>
<h2 id="实例-37">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; m1 \= matrix(c(1, 2), 1, 2)  </span><br><span class="line">\&gt; m2 \= matrix(c(3, 4), 2, 1)  </span><br><span class="line">\&gt; m1 %\*% m2  </span><br><span class="line">     \[,1\]  </span><br><span class="line">\[1,\]   11  </span><br></pre></td></tr></table></figure>
<p>逆矩阵：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/GOSMbhCW6t98uvPl__thumbnail.png" alt=""></p>
<h2 id="实例-38">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&gt; A \= matrix(c(1, 3, 2, 4), 2, 2)  </span><br><span class="line">\&gt; solve(A)  </span><br><span class="line">     \[,1\] \[,2\]  </span><br><span class="line">\[1,\] \-2.0  1.0  </span><br><span class="line">\[2,\]  1.5 \-0.5  </span><br></pre></td></tr></table></figure>
<p><strong>solve()</strong> 函数用于求解线性代数方程，基本用法是 solve(A,b)，其中，<strong>A</strong> 为方程组的系数矩阵，<strong>b</strong> 方程的向量或矩阵。</p>
<p><strong>apply()</strong> 函数可以将矩阵的每一行或每一列当作向量来进行操作：</p>
<h2 id="实例-39">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\&gt; (A \= matrix(c(1, 3, 2, 4), 2, 2))  </span><br><span class="line">     \[,1\] \[,2\]  </span><br><span class="line">\[1,\]    1    2  </span><br><span class="line">\[2,\]    3    4  </span><br><span class="line">\&gt; apply(A, 1, sum) \# 第二个参数为 1 按行操作，用 sum() 函数  </span><br><span class="line">\[1\] 3 7  </span><br><span class="line">\&gt; apply(A, 2, sum) \# 第二个参数为 2 按列操作  </span><br><span class="line">\[1\] 4 6  </span><br></pre></td></tr></table></figure>
<p>更多矩阵内容参考：<a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-matrix.html">R 矩阵</a>。</p>
<h2 id="R-判断语句">R 判断语句</h2>
<p>判断结构要求程序员指定一个或多个要评估或测试的条件，以及条件为真时要执行的语句（必需的）和条件为假时要执行的语句（可选的）。</p>
<p>下面是大多数编程语言中典型的判断结构的一般形式：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2015/12/if.png" alt=""></p>
<p>R 语言提供了以下类型的判断语句：</p>
<ul>
<li>if 语句</li>
<li>if…else 语句</li>
<li>switch 语句</li>
</ul>
<h3 id="if-语句">if 语句</h3>
<p>一个 if 语句 由一个布尔表达式后跟一个或多个语句组成。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(boolean_expression) &#123;</span><br><span class="line">    // 布尔表达式为真将执行的语句</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果布尔表达式 boolean_expression 为 ture 执行这里面的代码，如果 为 false 则不执行。</p>
<h2 id="实例-40">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- 50L  </span><br><span class="line">if(is.integer(x)) &#123;  </span><br><span class="line">   print(&quot;X 是一个整数&quot;)  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;X 是一个整数&quot;</span><br></pre></td></tr></table></figure>
<h3 id="if…else-语句">if…else 语句</h3>
<p>一个 if 语句 后可跟一个可选的 else 语句，else 语句在布尔表达式为假时执行。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(boolean_expression) &#123;</span><br><span class="line">    // 如果布尔表达式为真将执行的语句</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    // 如果布尔表达式为假将执行的语句</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果布尔表达式 boolean_expression 为 true，则执行 if 块内的代码。如果布尔表达式为 false，则执行 else 块内的代码。</p>
<h2 id="实例-41">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(&quot;google&quot;,&quot;runoob&quot;,&quot;taobao&quot;)</span><br><span class="line"></span><br><span class="line">if(&quot;runoob&quot; %in% x) &#123;  </span><br><span class="line">   print(&quot;包含 runoob&quot;)  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">   print(&quot;不包含 runoob&quot;)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;包含 runoob&quot;</span><br></pre></td></tr></table></figure>
<p>如果有多个条件判断，可以使用 if…else if…else：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if(boolean_expression 1) &#123;</span><br><span class="line">    // 如果布尔表达式 boolean_expression 1 为真将执行的语句</span><br><span class="line">&#125; else if( boolean_expression 2) &#123;</span><br><span class="line">    // 如果布尔表达式 boolean_expression 2 为真将执行的语句</span><br><span class="line">&#125; else if( boolean_expression 3) &#123;</span><br><span class="line">    // 如果布尔表达式 boolean_expression 3 为真将执行的语句</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    // 以上所有的布尔表达式都为 false 时执行</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="实例-42">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(&quot;google&quot;,&quot;runoob&quot;,&quot;taobao&quot;)</span><br><span class="line"></span><br><span class="line">if(&quot;weibo&quot; %in% x) &#123;  </span><br><span class="line">   print(&quot;第一个 if 包含 weibo&quot;)  </span><br><span class="line">&#125; else if (&quot;runoob&quot; %in% x) &#123;  </span><br><span class="line">   print(&quot;第二个 if 包含 runoob&quot;)  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">   print(&quot;没有找到&quot;)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;第二个 if 包含 runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="switch-语句">switch 语句</h3>
<p>一个 switch 语句允许测试一个变量等于多个值时的情况。每个值称为一个 case。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">switch(expression, case1, case2, case3....)</span><br></pre></td></tr></table></figure>
<p><strong>switch</strong> 语句必须遵循下面的规则：</p>
<ul>
<li><strong>switch</strong> 语句中的 <strong>expression</strong> 是一个常量表达式，可以是整数或字符串，如果是整数则返回对应的 case 位置值，如果整数不在位置的范围内则返回 NULL。</li>
<li>如果匹配到多个值则返回第一个。</li>
<li><strong>expression</strong>如果是字符串，则对应的是 case 中的变量名对应的值，没有匹配则没有返回值。</li>
<li>switch 没有默认参数可用。</li>
</ul>
<p>以下实例返回第三个值：</p>
<h2 id="实例-43">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- switch(  </span><br><span class="line">   3,  </span><br><span class="line">   &quot;google&quot;,  </span><br><span class="line">   &quot;runoob&quot;,  </span><br><span class="line">   &quot;taobao&quot;,  </span><br><span class="line">   &quot;weibo&quot;  </span><br><span class="line">)  </span><br><span class="line">print(x)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;taobao&quot;</span><br></pre></td></tr></table></figure>
<p>如果是字符串返回字符串变量对应的值：</p>
<h2 id="实例-44">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">you.like&lt;-&quot;runoob&quot;  </span><br><span class="line">switch(you.like, google\=&quot;www.google.com&quot;, runoob \= &quot;www.runoob.com&quot;, taobao \= &quot;www.taobao.com&quot;)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;www.runoob.com&quot;</span><br></pre></td></tr></table></figure>
<p>如果整数不在范围内的则返回 NULL</p>
<h2 id="实例-45">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">\&gt; x &lt;- switch(4,&quot;google&quot;,&quot;runoob&quot;,&quot;taobao&quot;)  </span><br><span class="line">\&gt; x  </span><br><span class="line">NULL  </span><br><span class="line">\&gt; x &lt;- switch(4,&quot;google&quot;,&quot;runoob&quot;,&quot;taobao&quot;)  </span><br><span class="line">\&gt; x  </span><br><span class="line">NULL</span><br></pre></td></tr></table></figure>
<h2 id="R-循环">R 循环</h2>
<p>有的时候，我们可能需要多次执行同一块代码。一般情况下，语句是按顺序执行的：函数中的第一个语句先执行，接着是第二个语句，依此类推。</p>
<p>编程语言提供了更为复杂执行路径的多种控制结构。</p>
<p>循环语句允许我们多次执行一个语句或语句组，下面是大多数编程语言中循环语句的流程图：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2015/12/loop.png" alt="循环结构"></p>
<p>R 语言提供的循环类型有:</p>
<ul>
<li>repeat 循环</li>
<li>while 循环</li>
<li>for 循环</li>
</ul>
<p>R 语言提供的循环控制语句有：</p>
<ul>
<li>break 语句</li>
<li>Next 语句</li>
</ul>
<p>循环控制语句改变你代码的执行顺序，通过它你可以实现代码的跳转。</p>
<h2 id="循环类型">循环类型</h2>
<h3 id="repeat">repeat</h3>
<p>repeat 循环会一直执行代码，直到条件语句为 true 时才退出循环，退出要使用到 break 语句。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">repeat &#123; </span><br><span class="line">    // 相关代码 </span><br><span class="line">    if(condition) &#123;</span><br><span class="line">       break</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下实例在变量 cnt 为 5 时退出循环，cnt 为计数变量：</p>
<h2 id="实例-46">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- c(&quot;Google&quot;,&quot;Runoob&quot;)  </span><br><span class="line">cnt &lt;- 2</span><br><span class="line"></span><br><span class="line">repeat &#123;  </span><br><span class="line">   print(v)  </span><br><span class="line">   cnt &lt;- cnt+1</span><br><span class="line"></span><br><span class="line">       if(cnt \&gt; 5) &#123;  </span><br><span class="line">      break  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输入结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="while">while</h3>
<p>只要给定的条件为 true，R 语言中的 while 循环语句会重复执行一个目标语句。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while(condition)</span><br><span class="line">&#123;</span><br><span class="line">   statement(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里，statement(s) 可以是一个单独的语句，也可以是几个语句组成的代码块。</p>
<p>condition 可以是任意的表达式，当为任意非零值时都为 true。当条件为 true 时执行循环。 当条件为 false 时，退出循环，程序流将继续执行紧接着循环的下一条语句。</p>
<p>以下实例在在变量 cnt 小于 7 时输出 while 语句块中的内容，cnt 为计数变量：</p>
<h2 id="实例-47">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- c(&quot;Google&quot;,&quot;Runoob&quot;)  </span><br><span class="line">cnt &lt;- 2</span><br><span class="line"></span><br><span class="line">while (cnt &lt; 7) &#123;  </span><br><span class="line">   print(v)  </span><br><span class="line">   cnt \= cnt + 1  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输入结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="for">for</h3>
<p>R 编程语言中 for 循环语句可以重复执行指定语句，重复次数可在 for 语句中控制。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (value in vector) &#123;</span><br><span class="line">    statements</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>R 语言的 for 循环特别灵活，不仅可以循环整数变量，还可以对字符向量，逻辑向量，列表等数据类型进行迭代。</p>
<p>以下实例输出 26 个字母对前面四个字母：</p>
<h2 id="实例-48">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- LETTERS\[1:4\]  </span><br><span class="line">for ( i in v) &#123;  </span><br><span class="line">   print(i)  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>执行以上代码，输入结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;A&quot;</span><br><span class="line">[1] &quot;B&quot;</span><br><span class="line">[1] &quot;C&quot;</span><br><span class="line">[1] &quot;D&quot;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="循环控制">循环控制</h2>
<h3 id="break">break</h3>
<p>R 语言的 break 语句插入在循环体中，用于退出当前循环或语句，并开始脚本执行紧接着的语句。</p>
<p>如果你使用循环嵌套，break 语句将停止最内层循环的执行，并开始执行的外层的循环语句。</p>
<p>break 也常用于 switch 语句中。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break</span><br></pre></td></tr></table></figure>
<p>以下实例在变量 cnt 为 5 时使用 break 退出循环，cnt 为计数变量：</p>
<h2 id="实例-49">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- c(&quot;Google&quot;,&quot;Runoob&quot;)  </span><br><span class="line">cnt &lt;- 2</span><br><span class="line"></span><br><span class="line">repeat &#123;  </span><br><span class="line">   print(v)  </span><br><span class="line">   cnt &lt;- cnt+1</span><br><span class="line"></span><br><span class="line">       if(cnt \&gt; 5) &#123;  </span><br><span class="line">      break  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输入结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="next">next</h3>
<p>next 语句用于跳过当前循环，开始下一次循环（类似其他语言的 continue）。</p>
<p>语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">next</span><br></pre></td></tr></table></figure>
<p>以下实例输出 26 个字母的前面 6 个字母，在字母为 D 的时候跳过当前的循环，进行下一次循环：</p>
<h2 id="实例-50">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- LETTERS\[1:6\]  </span><br><span class="line">for ( i in v) &#123;</span><br><span class="line"></span><br><span class="line">       if (i \== &quot;D&quot;) &#123;  \# D 不会输出，跳过这次循环，进入下一次  </span><br><span class="line">      next  </span><br><span class="line">   &#125;  </span><br><span class="line">   print(i)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输入结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;A&quot;</span><br><span class="line">[1] &quot;B&quot;</span><br><span class="line">[1] &quot;C&quot;</span><br><span class="line">[1] &quot;E&quot;</span><br><span class="line">[1] &quot;F&quot;</span><br></pre></td></tr></table></figure>
<h2 id="R-函数">R 函数</h2>
<p>函数是一组一起执行一个任务的语句。R 语言本身提供了很多的内置函数，当然我们也可以自己创建函数。</p>
<p>您可以把代码划分到不同的函数中。如何划分代码到不同的函数中是由您来决定的，但在逻辑上，划分通常是根据每个函数执行一个特定的任务来进行的。</p>
<p>函数<strong>声明</strong>告诉编译器函数的名称、返回类型和参数。函数<strong>定义</strong>提供了函数的实际主体。</p>
<p>R 语言中函数是一个对象，可以拥有属性。</p>
<h2 id="定义函数">定义函数</h2>
<p>函数定义通常由以下几个部分组成：</p>
<ul>
<li><strong>函数名:</strong> 为函数指定一个唯一的名称，以便在调用时使用。</li>
<li><strong>参数:</strong> 定义函数接受的输入值。参数是可选的，可以有多个。</li>
<li><strong>函数体:</strong> 包含实际执行的代码块，用大括号 {} 括起来。</li>
<li><strong>返回值:</strong> 指定函数的输出结果，使用关键字<code>return</code>。</li>
</ul>
<p>R 语言中的函数定义使用 function 关键字，一般形式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function_name &lt;- function(arg_1, arg_2, ...) &#123;</span><br><span class="line">    # 函数体</span><br><span class="line">    # 执行的代码块</span><br><span class="line">    return(output)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li>function_name : 为函数名</li>
<li>arg_1, arg_2, … : 形式参数列表</li>
</ul>
<p>函数返回值使用 return()。</p>
<p>以下是一个简单的例子，展示如何定义和使用函数：</p>
<h2 id="实例-51">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 定义一个加法函数  </span><br><span class="line">add\_numbers &lt;- function(x, y) &#123;  </span><br><span class="line">  result &lt;- x + y  </span><br><span class="line">  return(result)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 调用函数  </span><br><span class="line">sum\_result &lt;- add\_numbers(3, 4)  </span><br><span class="line">print(sum\_result)  \# 输出 7</span><br></pre></td></tr></table></figure>
<p>以上代码中，我们定义了一个名为 <strong>add_numbers</strong> 的函数，它接受两个参数 <strong>x</strong> 和 <strong>y</strong>。函数体中的代码将这两个参数相加，并将结果存储在变量 <strong>result</strong> 中。最后，使用 <strong>return</strong> 关键字返回结果。</p>
<p>要调用函数，我们使用函数名后跟参数列表的形式，将参数的值传递给函数。在本例中，我们调用 <strong>add_numbers</strong> 函数，并传递参数 3 和 4。函数执行后，返回结果 7，我们将其存储在变量 <strong>sum_result</strong> 中，并打印输出。</p>
<h3 id="自定义函数">自定义函数</h3>
<p>我们可以自己创建函数，用于特定到功能，定义后可以向内置函数一样使用它们。</p>
<p>下面演示两如何自定义函数：</p>
<h2 id="实例-52">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\# 定义一个函数，用于计数一个系列到平方值  </span><br><span class="line">new.function &lt;- function(a) &#123;  </span><br><span class="line">   for(i in 1:a) &#123;  </span><br><span class="line">      b &lt;- i^2  </span><br><span class="line">      print(b)  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>接下来我们可以调用函数：</p>
<h2 id="实例-53">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">new.function &lt;- function(a) &#123;  </span><br><span class="line">    for(i in 1:a) &#123;  </span><br><span class="line">       b &lt;- i^2  </span><br><span class="line">       print(b)  </span><br><span class="line">    &#125;  </span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">  \# 调用函数，并传递参数  </span><br><span class="line">new.function(6)</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[1] 1</span><br><span class="line">[1] 4</span><br><span class="line">[1] 9</span><br><span class="line">[1] 16</span><br><span class="line">[1] 25</span><br><span class="line">[1] 36</span><br></pre></td></tr></table></figure>
<p>我们也可以创建一个不带参数的函数：</p>
<h2 id="实例-54">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new.function &lt;- function() &#123;  </span><br><span class="line">    for(i in 1:5) &#123;  </span><br><span class="line">        print(i^2)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  \# 调用函数，不需要传递参数  </span><br><span class="line">new.function()</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] 1</span><br><span class="line">[1] 4</span><br><span class="line">[1] 9</span><br><span class="line">[1] 16</span><br><span class="line">[1] 25</span><br></pre></td></tr></table></figure>
<h3 id="带有参数值的函数">带有参数值的函数</h3>
<p>函数参数，可以按函数创建时的顺序来传递，也可以不按顺序，但需要指定参数名：</p>
<h2 id="实例-55">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 创建函数  </span><br><span class="line">new.function &lt;- function(a,b,c) &#123;  </span><br><span class="line">   result &lt;- a \* b + c  </span><br><span class="line">   print(result)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 不带参数名  </span><br><span class="line">new.function(5,3,11)</span><br><span class="line"></span><br><span class="line">\# 带参数名  </span><br><span class="line">new.function(a \= 11, b \= 5, c \= 3)</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1] 26</span><br><span class="line">[1] 58</span><br></pre></td></tr></table></figure>
<p>函数创建时也可以为参数指定默认值，如果调用的时候不传递参数就会使用默认值：</p>
<h2 id="实例-56">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 创建带默认参数的函数  </span><br><span class="line">new.function &lt;- function(a \= 3, b \= 6) &#123;  </span><br><span class="line">   result &lt;- a \* b  </span><br><span class="line">   print(result)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 调用函数，但不传递参数，会使用默认的  </span><br><span class="line">new.function()</span><br><span class="line"></span><br><span class="line">\# 调用函数，传递参数  </span><br><span class="line">new.function(9,5)</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<p>[1] 18 [1] 45</p>
<h3 id="懒惰计算的函数">懒惰计算的函数</h3>
<p>懒惰计算将推迟计算工作直到系统需要这些计算的结果。如果不需要结果，将不用进行计算。</p>
<p>默认情况下，R 函数对参数的计算是懒惰的，就是只有我们在计算它的时候才会调用：</p>
<h2 id="实例-57">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f &lt;- function(x) &#123;  </span><br><span class="line">  10  </span><br><span class="line">&#125;  </span><br><span class="line">f()  </span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 10</span><br></pre></td></tr></table></figure>
<p>以上代码执行，并没有报错，虽然我们没有传入参数，但函数体内没有使用参数 x，所以不会去调用它，也不会报错。</p>
<h2 id="实例-58">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new.function &lt;- function(a, b) &#123;  </span><br><span class="line">   print(a^2)  </span><br><span class="line">   print(a)  </span><br><span class="line">   print(b)  \# 使用到 b，但未传入，所以会报错  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\# 传入一个参数  </span><br><span class="line">new.function(6)</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[1] 36</span><br><span class="line">[1] 6</span><br><span class="line">Error in print(b) : 缺少参数&quot;b&quot;,也没有缺省值</span><br><span class="line">Calls: new.function -&gt; print</span><br><span class="line">停止执行</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="内置函数">内置函数</h2>
<p>R 语言提供了很多有用的内置函数，我们无需定义它就可以直接使用。</p>
<p>例如：seq(), mean(), max(), sum(x) 以及 paste(…) 等。</p>
<h2 id="实例-59">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# 输出  32 到 44 到的所有数字  </span><br><span class="line">print(seq(32,44))</span><br><span class="line"></span><br><span class="line">\# 计算两个数的平均数  </span><br><span class="line">print(mean(25:82))</span><br><span class="line"></span><br><span class="line">\# 计算 41 到 68 所有数字之和  </span><br><span class="line">print(sum(41:68))</span><br></pre></td></tr></table></figure>
<p>执行以上代码，输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> [1] 32 33 34 35 36 37 38 39 40 41 42 43 44</span><br><span class="line">[1] 53.5</span><br><span class="line">[1] 1526</span><br></pre></td></tr></table></figure>
<p>sum(): 计算向量或矩阵的总和。</p>
<h2 id="实例-60">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 向量求和  </span><br><span class="line">x &lt;- c(1, 2, 3, 4, 5)  </span><br><span class="line">total &lt;- sum(x)  </span><br><span class="line">print(total)  \# 输出 15</span><br><span class="line"></span><br><span class="line">\# 矩阵求和  </span><br><span class="line">matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">total &lt;- sum(matrix)  </span><br><span class="line">print(total)  \# 输出 45</span><br></pre></td></tr></table></figure>
<p>mean(): 计算向量或矩阵的平均值。</p>
<h2 id="实例-61">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 向量平均值  </span><br><span class="line">x &lt;- c(1, 2, 3, 4, 5)  </span><br><span class="line">avg &lt;- mean(x)  </span><br><span class="line">print(avg)  \# 输出 3</span><br><span class="line"></span><br><span class="line">\# 矩阵平均值  </span><br><span class="line">matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">avg &lt;- mean(matrix)  </span><br><span class="line">print(avg)  \# 输出 5</span><br></pre></td></tr></table></figure>
<p>paste(): 将多个字符串连接成一个字符串。</p>
<h2 id="实例-62">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- &quot;Hello&quot;  </span><br><span class="line">y &lt;- &quot;World&quot;  </span><br><span class="line">result &lt;- paste(x, y)  </span><br><span class="line">print(result)  \# 输出 &quot;Hello World&quot;  </span><br></pre></td></tr></table></figure>
<p>length(): 返回向量的长度或对象的元素个数。</p>
<h2 id="实例-63">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(1, 2, 3, 4, 5)  </span><br><span class="line">length\_x &lt;- length(x)  </span><br><span class="line">print(length\_x)  \# 输出 5</span><br><span class="line"></span><br><span class="line">matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">length\_matrix &lt;- length(matrix)  </span><br><span class="line">print(length\_matrix)  \# 输出 9</span><br></pre></td></tr></table></figure>
<p>str(): 显示对象的结构和内容摘要。</p>
<h2 id="实例-64">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(1, 2, 3, 4, 5)  </span><br><span class="line">str(x)  </span><br><span class="line">\# 输出：  </span><br><span class="line">\# num \[1:5\] 1 2 3 4 5</span><br><span class="line"></span><br><span class="line">matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">str(matrix)  </span><br><span class="line">\# 输出：  </span><br><span class="line">\#  int \[1:3, 1:3\] 1 2 3 4 5 6 7 8 9</span><br></pre></td></tr></table></figure>
<p>以上只列举了一小部分的 R 语言函数实例，R 有大量的内置函数和扩展包提供的函数，可以满足各种数据处理、统计分析、绘图等需求，您可以查阅 R 语言的官方文档获得更详细的函数列表和使用说明。</p>
<h2 id="R-字符串">R 字符串</h2>
<p>R 语言中，字符串是一种表示文本数据的数据类型，它由字符（字符向量）组成，可以包含字母、数字、符号和空格等字符。</p>
<p>R 语言字符串可以使用一对单引号 ’ ’ 或一对双引号 &quot; &quot; 来表示。</p>
<ul>
<li>单引号字符串中可以包含双引号。</li>
<li>单引号字符串中不可以包含单引号。</li>
<li>双引号字符串中可以包含单引号。</li>
<li>双引号字符串中不可以包含双引号。</li>
</ul>
<p>**创建字符串：**您可以使用单引号或双引号来创建字符串。</p>
<p>以下实例演示来字符串的使用：</p>
<h2 id="实例-65">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a &lt;- &#x27;使用单引号&#x27;  </span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">b &lt;- &quot;使用双引号&quot;  </span><br><span class="line">print(b)</span><br><span class="line"></span><br><span class="line">c &lt;- &quot;双引号字符串中可以包含单引号（&#x27;） &quot;  </span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">d &lt;- &#x27;单引号字符串中可以包含双引号（&quot;） &#x27;  </span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;使用单引号&quot;</span><br><span class="line">[1] &quot;使用双引号&quot;</span><br><span class="line">[1] &quot;双引号字符串中可以包含单引号（&#x27;） &quot;</span><br><span class="line">[1] &quot;单引号字符串中可以包含双引号（\&quot;） &quot;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="字符串操作">字符串操作</h2>
<p>R 语言提供了多种操作字符串的函数和操作符，使得处理和操作文本数据变得方便。</p>
<p>以下我们来看下 R 语言一些内置函数对字符串对操作。</p>
<h3 id="paste-函数">paste() 函数</h3>
<p>paste() 函数用于使用指定对分隔符来对字符串进行连接，默认的分隔符为空格。</p>
<p>语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste(..., sep = &quot; &quot;, collapse = NULL)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>… ： 字符串列表</li>
<li>sep ： 分隔符，默认为空格</li>
<li>collapse ： 两个或者更多字符串对象根据元素对应关系拼接到一起，在字符串进行连接后，再使用 collapse 指定对连接符进行连接</li>
</ul>
<h2 id="实例-66">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a &lt;- &quot;Google&quot;  </span><br><span class="line">b &lt;- &#x27;Runoob&#x27;  </span><br><span class="line">c &lt;- &quot;Taobao&quot;</span><br><span class="line"></span><br><span class="line">print(paste(a,b,c))</span><br><span class="line"></span><br><span class="line">print(paste(a,b,c, sep \= &quot;-&quot;))</span><br><span class="line"></span><br><span class="line">print(paste(letters\[1:6\],1:6, sep \= &quot;&quot;, collapse \= &quot;=&quot;))  </span><br><span class="line">paste(letters\[1:6\],1:6, collapse \= &quot;.&quot;)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;Google Runoob Taobao&quot;</span><br><span class="line">[1] &quot;Google-Runoob-Taobao&quot;</span><br><span class="line">[1] &quot;a1=b2=c3=d4=e5=f6&quot;</span><br><span class="line">[1] &quot;a 1.b 2.c 3.d 4.e 5.f 6&quot;</span><br></pre></td></tr></table></figure>
<h3 id="format-函数">format() 函数</h3>
<p>format() 函数用于格式化字符串，format() 可作用于字符串或数字。</p>
<p>语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">format(x, digits, nsmall, scientific, width, justify = c(&quot;left&quot;, &quot;right&quot;, &quot;centre&quot;, &quot;none&quot;)) </span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>x ： 输入对向量</li>
<li>digits ： 显示的位数</li>
<li>nsmall ： 小数点右边显示的最少位数</li>
<li>scientific ： 设置科学计数法</li>
<li>width ： 通过开头填充空白来显示最小的宽度</li>
<li>justify：设置位置，显示可以是左边、右边、中间等。</li>
</ul>
<h2 id="实例-67">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">\# 显示 9 位，最后一位四舍五入  </span><br><span class="line">result &lt;- format(23.123456789, digits \= 9)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 使用科学计数法显示  </span><br><span class="line">result &lt;- format(c(6, 13.14521), scientific \= TRUE)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 小数点右边最小显示 5 位，没有的以 0 补充  </span><br><span class="line">result &lt;- format(23.47, nsmall \= 5)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 将数字转为字符串  </span><br><span class="line">result &lt;- format(6)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 宽度为 6 位，不够的在开头添加空格  </span><br><span class="line">result &lt;- format(13.7, width \= 6)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 左对齐字符串  </span><br><span class="line">result &lt;- format(&quot;Runoob&quot;, width \= 9, justify \= &quot;l&quot;)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 居中显示  </span><br><span class="line">result &lt;- format(&quot;Runoob&quot;, width \= 10, justify \= &quot;c&quot;)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;23.1234568&quot;</span><br><span class="line">[1] &quot;6.000000e+00&quot; &quot;1.314521e+01&quot;</span><br><span class="line">[1] &quot;23.47000&quot;</span><br><span class="line">[1] &quot;6&quot;</span><br><span class="line">[1] &quot;  13.7&quot;</span><br><span class="line">[1] &quot;Runoob   &quot;</span><br><span class="line">[1] &quot;  Runoob  &quot;</span><br></pre></td></tr></table></figure>
<h3 id="nchar-函数">nchar() 函数</h3>
<p>nchar() 函数用于计数字符串或数字列表的长度。</p>
<p>语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nchar(x)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>x ： 向量或字符串</li>
</ul>
<h2 id="实例-68">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result &lt;- nchar(&quot;Google Runoob Taobao&quot;)  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 20</span><br></pre></td></tr></table></figure>
<h3 id="toupper-tolower-函数">toupper() &amp; tolower() 函数</h3>
<p>toupper() &amp; tolower() 函数用于将字符串的字母转化为大写或者小写。</p>
<p>语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">toupper(x)</span><br><span class="line">tolower(x)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>x ： 向量或字符串</li>
</ul>
<p># 转大写</p>
<h2 id="实例-69">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">result &lt;- toupper(&quot;Runoob&quot;)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 转小写  </span><br><span class="line">result &lt;- tolower(&quot;Runoob&quot;)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;RUNOOB&quot;</span><br><span class="line">[1] &quot;runoob&quot;</span><br></pre></td></tr></table></figure>
<h3 id="substring-函数">substring() 函数</h3>
<p>substring() 函数用于截取字符串。</p>
<p>语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">substring(x,first,last)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>x ： 向量或字符串</li>
<li>first ： 开始截取的位置</li>
<li>last： 结束截取的位置</li>
</ul>
<h2 id="实例-70">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 从第 2 位截取到第 5 位  </span><br><span class="line">result &lt;- substring(&quot;Runoob&quot;, 2, 5)  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;unoo&quot;</span><br></pre></td></tr></table></figure>
<h3 id="字符串替换">字符串替换</h3>
<p>使用 <strong>gsub()</strong> 函数来替换字符串中的特定字符或模式。</p>
<h2 id="实例-71">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str &lt;- &quot;Hello, World!&quot;  </span><br><span class="line">new\_str &lt;- gsub(&quot;World&quot;, &quot;R&quot;, str)  </span><br><span class="line">\# 输出： &quot;Hello, R!&quot;  </span><br></pre></td></tr></table></figure>
<h3 id="字符串拆分">字符串拆分</h3>
<p>使用 <strong>strsplit()</strong> 函数将字符串拆分为子字符串。</p>
<h2 id="实例-72">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str &lt;- &quot;Hello, World!&quot;  </span><br><span class="line">split\_str &lt;- strsplit(str, &quot;,&quot;)  </span><br><span class="line">\# 输出： List of 1  </span><br><span class="line">\#         \[\[1\]\]  </span><br><span class="line">\#         \[1\] &quot;Hello&quot;   &quot; World!&quot;  </span><br></pre></td></tr></table></figure>
<p>以上只列举了一小部分的 R 语言字符串操作实例，R 有大量的字符串处理函数和操作符，例如模式匹配、大小写转换、字符串比较等，您可以查阅 R 语言的官方文档获得更多字符串操作函数列表和使用说明。</p>
<h2 id="R-列表">R 列表</h2>
<p>列表是 R 语言的对象集合，可以用来保存不同类型的数据，可以是数字、字符串、向量、另一个列表、矩阵、数据框等，当然还可以包含矩阵和函数。</p>
<p>列表是一种灵活的数据结构，可以存储和操作多种类型的数据对象。</p>
<h3 id="创建列表">创建列表</h3>
<p>R 语言创建列表使用 list() 函数。</p>
<p>如下实例，我们创建一个列表，包含了字符串、向量和数字：</p>
<h2 id="实例-73">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list\_data &lt;- list(&quot;runoob&quot;, &quot;google&quot;, c(11,22,33), 123, 51.23, 119.1)  </span><br><span class="line">print(list\_data)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[[1]]</span><br><span class="line">[1] &quot;runoob&quot;</span><br><span class="line"></span><br><span class="line">[[2]]</span><br><span class="line">[1] &quot;google&quot;</span><br><span class="line"></span><br><span class="line">[[3]]</span><br><span class="line">[1] 11 22 33</span><br><span class="line"></span><br><span class="line">[[4]]</span><br><span class="line">[1] 123</span><br><span class="line"></span><br><span class="line">[[5]]</span><br><span class="line">[1] 51.23</span><br><span class="line"></span><br><span class="line">[[6]]</span><br><span class="line">[1] 119.1</span><br></pre></td></tr></table></figure>
<p>我们也可以使用 c() 函数来创建列表，也可以使用该函数将多个对象合并为一个列表，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_list &lt;- c(object1, object2, object3)</span><br></pre></td></tr></table></figure>
<h2 id="实例-74">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 创建包含数字的向量  </span><br><span class="line">numbers &lt;- c(1, 2, 3, 4, 5)</span><br><span class="line"></span><br><span class="line">\# 创建包含字符的向量  </span><br><span class="line">characters &lt;- c(&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;)</span><br><span class="line"></span><br><span class="line">\# 合并两个数字向量  </span><br><span class="line">merged\_vector &lt;- c(numbers, c(6, 7, 8))</span><br><span class="line"></span><br><span class="line">\# 合并两个字符向量  </span><br><span class="line">merged\_characters &lt;- c(characters, c(&quot;grape&quot;, &quot;melon&quot;))</span><br></pre></td></tr></table></figure>
<p>我们可以使用 names() 函数给列表的元素命名：</p>
<h2 id="实例-75">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 列表包含向量、矩阵、列表  </span><br><span class="line">list\_data &lt;- list(c(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;), matrix(c(1,2,3,4,5,6), nrow \= 2),  </span><br><span class="line">   list(&quot;runoob&quot;,12.3))</span><br><span class="line"></span><br><span class="line">\# 给列表元素设置名字  </span><br><span class="line">names(list\_data) &lt;- c(&quot;Sites&quot;, &quot;Numbers&quot;, &quot;Lists&quot;)</span><br><span class="line"></span><br><span class="line">\# 显示列表  </span><br><span class="line">print(list\_data)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$Sites</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot; &quot;Taobao&quot;</span><br><span class="line"></span><br><span class="line">$Numbers</span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    1    3    5</span><br><span class="line">[2,]    2    4    6</span><br><span class="line"></span><br><span class="line">$Lists</span><br><span class="line">$Lists[[1]]</span><br><span class="line">[1] &quot;runoob&quot;</span><br><span class="line"></span><br><span class="line">$Lists[[2]]</span><br><span class="line">[1] 12.3</span><br></pre></td></tr></table></figure>
<h3 id="访问列表">访问列表</h3>
<p>列表中的元素可以使用索引来访问，如果使用来 <strong>names()</strong> 函数命名后，我们还可以使用对应名字来访问：</p>
<h2 id="实例-76">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">\# 列表包含向量、矩阵、列表  </span><br><span class="line">list\_data &lt;- list(c(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;), matrix(c(1,2,3,4,5,6), nrow \= 2),  </span><br><span class="line">   list(&quot;runoob&quot;,12.3))</span><br><span class="line"></span><br><span class="line">\# 给列表元素设置名字  </span><br><span class="line">names(list\_data) &lt;- c(&quot;Sites&quot;, &quot;Numbers&quot;, &quot;Lists&quot;)</span><br><span class="line"></span><br><span class="line">\# 显示列表  </span><br><span class="line">print(list\_data\[1\])</span><br><span class="line"></span><br><span class="line">\# 访问列表的第三个元素  </span><br><span class="line">print(list\_data\[3\])</span><br><span class="line"></span><br><span class="line">\# 访问第一个向量元素  </span><br><span class="line">print(list\_data$Numbers)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$Sites</span><br><span class="line">[1] &quot;Google&quot; &quot;Runoob&quot; &quot;Taobao&quot;</span><br><span class="line"></span><br><span class="line">$Lists</span><br><span class="line">$Lists[[1]]</span><br><span class="line">[1] &quot;runoob&quot;</span><br><span class="line"></span><br><span class="line">$Lists[[2]]</span><br><span class="line">[1] 12.3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    1    3    5</span><br><span class="line">[2,]    2    4    6</span><br></pre></td></tr></table></figure>
<h3 id="操作列表元素">操作列表元素</h3>
<p>我们可以对列表进行添加、删除、更新的操作，如下实例：</p>
<h2 id="实例-77">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">\# 列表包含向量、矩阵、列表  </span><br><span class="line">list\_data &lt;- list(c(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;), matrix(c(1,2,3,4,5,6), nrow \= 2),  </span><br><span class="line">   list(&quot;runoob&quot;,12.3))</span><br><span class="line"></span><br><span class="line">\# 给列表元素设置名字  </span><br><span class="line">names(list\_data) &lt;- c(&quot;Sites&quot;, &quot;Numbers&quot;, &quot;Lists&quot;)</span><br><span class="line"></span><br><span class="line">\# 添加元素  </span><br><span class="line">list\_data\[4\] &lt;- &quot;新元素&quot;  </span><br><span class="line">print(list\_data\[4\])</span><br><span class="line"></span><br><span class="line">\# 删除元素  </span><br><span class="line">list\_data\[4\] &lt;- NULL</span><br><span class="line"></span><br><span class="line">\# 删除后输出为 NULL  </span><br><span class="line">print(list\_data\[4\])</span><br><span class="line"></span><br><span class="line">\# 更新元素  </span><br><span class="line">list\_data\[3\] &lt;- &quot;我替换来第三个元素&quot;  </span><br><span class="line">print(list\_data\[3\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[1]]</span><br><span class="line">[1] &quot;新元素&quot;</span><br><span class="line"></span><br><span class="line">$&lt;NA&gt;</span><br><span class="line">NULL</span><br><span class="line"></span><br><span class="line">$Lists</span><br><span class="line">[1] &quot;我替换来第三个元素&quot;</span><br></pre></td></tr></table></figure>
<p>使用 for 循环遍历列表时：</p>
<h2 id="实例-78">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个包含数字和字符的列表  </span><br><span class="line">my\_list &lt;- list(1, 2, 3, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span><br><span class="line"></span><br><span class="line">\# 使用 for 循环遍历列表中的每个元素  </span><br><span class="line">for (element in my\_list) &#123;  </span><br><span class="line">  print(element)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上代码中，for 循环会依次遍历列表 my_list 中的每个元素，并将每个元素存储在变量 element 中。然后，我们可以在循环体内对每个元素执行特定的操作，例如使用 print() 函数打印元素的值。</p>
<p>for 循环遍历列表时，每次循环都将当前元素赋值给变量 element。因此，在循环体内可以对 element 进行任何需要的操作，例如计算、条件判断等。</p>
<p>需要注意的是，使用 for 循环遍历列表时，循环变量 element 将依次取到列表中的每个元素，但不能直接修改列表元素本身。如果需要修改列表中的元素值，可以通过索引来实现，例如 my_list[[index]] &lt;- new_value。</p>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[1] 1</span><br><span class="line">[1] 2</span><br><span class="line">[1] 3</span><br><span class="line">[1] &quot;a&quot;</span><br><span class="line">[1] &quot;b&quot;</span><br><span class="line">[1] &quot;c&quot;</span><br></pre></td></tr></table></figure>
<h3 id="合并列表">合并列表</h3>
<p>我们可以使用 c() 函数将多个列表合并为一个列表：</p>
<h2 id="实例-79">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个列表  </span><br><span class="line">list1 &lt;- list(1,2,3)  </span><br><span class="line">list2 &lt;- list(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;)</span><br><span class="line"></span><br><span class="line">\# 合并列表  </span><br><span class="line">merged.list &lt;- c(list1,list2)</span><br><span class="line"></span><br><span class="line">\# 显示合并后的列表  </span><br><span class="line">print(merged.list)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[[1]]</span><br><span class="line">[1] 1</span><br><span class="line"></span><br><span class="line">[[2]]</span><br><span class="line">[1] 2</span><br><span class="line"></span><br><span class="line">[[3]]</span><br><span class="line">[1] 3</span><br><span class="line"></span><br><span class="line">[[4]]</span><br><span class="line">[1] &quot;Google&quot;</span><br><span class="line"></span><br><span class="line">[[5]]</span><br><span class="line">[1] &quot;Runoob&quot;</span><br><span class="line"></span><br><span class="line">[[6]]</span><br><span class="line">[1] &quot;Taobao&quot;</span><br></pre></td></tr></table></figure>
<h3 id="列表转换为向量">列表转换为向量</h3>
<p>要将列表转换为向量可以使用 unlist() 函数，将列表转换为向量，可以方便我们进行算术运算：</p>
<h2 id="实例-80">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">\# 创建列表  </span><br><span class="line">list1 &lt;- list(1:5)  </span><br><span class="line">print(list1)</span><br><span class="line"></span><br><span class="line">list2 &lt;-list(10:14)  </span><br><span class="line">print(list2)</span><br><span class="line"></span><br><span class="line">\# 转换为向量  </span><br><span class="line">v1 &lt;- unlist(list1)  </span><br><span class="line">v2 &lt;- unlist(list2)</span><br><span class="line"></span><br><span class="line">print(v1)  </span><br><span class="line">print(v2)</span><br><span class="line"></span><br><span class="line">\# 两个向量相加  </span><br><span class="line">result &lt;- v1+v2  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[[1]]</span><br><span class="line">[1] 1 2 3 4 5</span><br><span class="line"></span><br><span class="line">[[1]]</span><br><span class="line">[1] 10 11 12 13 14</span><br><span class="line"></span><br><span class="line">[1] 1 2 3 4 5</span><br><span class="line">[1] 10 11 12 13 14</span><br><span class="line">[1] 11 13 15 17 19</span><br></pre></td></tr></table></figure>
<h3 id="归纳总结">归纳总结</h3>
<p>以下是一些常用的 R 语言列表操作和函数：</p>
<p><strong>创建列表：</strong></p>
<ul>
<li>使用 c() 函数：例如，list1 &lt;- c(1, 2, 3) 创建一个包含 1、2 和 3 的列表。</li>
<li>使用 list() 函数：例如，list2 &lt;- list(1, “a”, TRUE) 创建一个包含不同类型元素的列表。</li>
</ul>
<p><strong>访问列表元素：</strong></p>
<ul>
<li>使用索引：通过索引访问列表中的元素。例如，list1[1] 返回列表中的第一个元素。</li>
<li>使用元素名称：如果列表中的元素有名称，可以使用名称来访问它们。例如，list3 &lt;- list(a = 1, b = 2) 可以通过 list3a 和 list3b 来访问元素。</li>
</ul>
<p><strong>列表操作：</strong></p>
<ul>
<li>长度：使用 length() 函数获取列表的长度。例如，length(list1) 返回列表 list1 的长度。</li>
<li>合并：使用 c() 函数或 append() 函数将两个或多个列表合并为一个列表。例如，list4 &lt;- c(list1, list2) 合并列表 list1 和 list2。</li>
<li>增加元素：使用 c() 函数将元素添加到现有列表中。例如，list1 &lt;- c(list1, 4) 将 4 添加到列表 list1 的末尾。</li>
<li>删除元素：使用索引和负索引操作符 - 删除列表中的元素。例如，list1 &lt;- list1[-2] 删除列表 list1 中的第二个元素。</li>
</ul>
<p><strong>列表循环：</strong></p>
<ul>
<li>for 循环：使用 for 循环遍历列表中的元素。例如，for (element in list1) { … } 遍历列表 list1 中的每个元素。</li>
<li>lapply() 函数：将一个函数应用于列表中的每个元素，并返回结果列表。例如，new_list &lt;- lapply(list1, function(x) x * 2) 将列表 list1 中的每个元素乘以 2。</li>
</ul>
<h2 id="R-矩阵">R 矩阵</h2>
<p>R 语言为线性代数的研究提供了矩阵类型，这种数据结构很类似于其它语言中的二维数组，但 R 提供了语言级的矩阵运算支持。</p>
<p>矩阵里的元素可以是数字、符号或数学式。</p>
<p>一个 M x N 的矩阵是一个由 <strong>M（row） 行</strong> 和 **N 列（column）**元素排列成的矩形阵列。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/Matrix_zh-hans.png" alt=""></p>
<p>以下是一个由 6 个数字元素构成的 2 行 3 列的矩阵：</p>
<p><img src="https://static.jyshare.com/images/mix/61f786996bcfb75972dd77712c90122bc8765269.svg" alt=""></p>
<p>R 语言的矩阵可以使用 matrix() 函数来创建，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matrix(data = NA, nrow = 1, ncol = 1, byrow = FALSE,dimnames = NULL)</span><br></pre></td></tr></table></figure>
<p><strong>参数说明：</strong></p>
<ul>
<li>
<p><strong>data</strong> 向量，矩阵的数据</p>
</li>
<li>
<p><strong>nrow</strong> 行数</p>
</li>
<li>
<p><strong>ncol</strong> 列数</p>
</li>
<li>
<p><strong>byrow</strong> 逻辑值，为 FALSE 按列排列，为 TRUE 按行排列</p>
</li>
<li>
<p><strong>dimname</strong> 设置行和列的名称</p>
</li>
</ul>
<p>创建一个数字矩阵：</p>
<h2 id="实例-81">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\# byrow 为 TRUE 元素按行排列  </span><br><span class="line">M &lt;- matrix(c(3:14), nrow \= 4, byrow \= TRUE)  </span><br><span class="line">print(M)</span><br><span class="line"></span><br><span class="line">\# Ebyrow 为 FALSE 元素按列排列  </span><br><span class="line">N &lt;- matrix(c(3:14), nrow \= 4, byrow \= FALSE)  </span><br><span class="line">print(N)</span><br><span class="line"></span><br><span class="line">\# 定义行和列的名称  </span><br><span class="line">rownames \= c(&quot;row1&quot;, &quot;row2&quot;, &quot;row3&quot;, &quot;row4&quot;)  </span><br><span class="line">colnames \= c(&quot;col1&quot;, &quot;col2&quot;, &quot;col3&quot;)</span><br><span class="line"></span><br><span class="line">P &lt;- matrix(c(3:14), nrow \= 4, byrow \= TRUE, dimnames \= list(rownames, colnames))  </span><br><span class="line">print(P)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[,1] [,2] [,3]</span><br><span class="line">[1,]    3    4    5</span><br><span class="line">[2,]    6    7    8</span><br><span class="line">[3,]    9   10   11</span><br><span class="line">[4,]   12   13   14</span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    3    7   11</span><br><span class="line">[2,]    4    8   12</span><br><span class="line">[3,]    5    9   13</span><br><span class="line">[4,]    6   10   14</span><br><span class="line">     col1 col2 col3</span><br><span class="line">row1    3    4    5</span><br><span class="line">row2    6    7    8</span><br><span class="line">row3    9   10   11</span><br><span class="line">row4   12   13   14</span><br></pre></td></tr></table></figure>
<h3 id="转置矩阵">转置矩阵</h3>
<p>R 语言矩阵提供了 t() 函数，可以实现矩阵的行列互换。</p>
<p>例如有个 m 行 n 列的矩阵，使用 t() 函数就能转换为 n 行 m 列的矩阵。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/Matrix_transpose.gif" alt=""></p>
<p><img src="https://static.jyshare.com/images/mix/4a92835c45d5cd15dd00a8d90c14bdb4b8150ef0.svg" alt=""></p>
<p><img src="https://static.jyshare.com/images/mix/8a1e10800e0d0e3ffa90917139532cfb8348fc63.svg" alt=""></p>
<h2 id="实例-82">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个 2 行 3 列的矩阵  </span><br><span class="line">M \= matrix( c(2,6,5,1,10,4), nrow \= 2,ncol \= 3,byrow \= TRUE)  </span><br><span class="line">print(M)  </span><br><span class="line">     \[,1\] \[,2\] \[,3\]  </span><br><span class="line">\[1,\]    2    6    5  </span><br><span class="line">\[2,\]    1   10    4  </span><br><span class="line">\# 转换为 3 行 2 列的矩阵  </span><br><span class="line">print(t(M))  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    2    6    5</span><br><span class="line">[2,]    1   10    4</span><br><span class="line">[1] &quot;-----转换-----&quot;</span><br><span class="line">     [,1] [,2]</span><br><span class="line">[1,]    2    1</span><br><span class="line">[2,]    6   10</span><br><span class="line">[3,]    5    4</span><br></pre></td></tr></table></figure>
<h3 id="访问矩阵元素">访问矩阵元素</h3>
<p>如果想获取矩阵元素，可以通过使用元素的列索引和行索引，类似坐标形式。</p>
<h2 id="实例-83">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">\# 定义行和列的名称  </span><br><span class="line">rownames \= c(&quot;row1&quot;, &quot;row2&quot;, &quot;row3&quot;, &quot;row4&quot;)  </span><br><span class="line">colnames \= c(&quot;col1&quot;, &quot;col2&quot;, &quot;col3&quot;)</span><br><span class="line"></span><br><span class="line">\# 创建矩阵  </span><br><span class="line">P &lt;- matrix(c(3:14), nrow \= 4, byrow \= TRUE, dimnames \= list(rownames, colnames))  </span><br><span class="line">print(P)  </span><br><span class="line">\# 获取第一行第三列的元素  </span><br><span class="line">print(P\[1,3\])</span><br><span class="line"></span><br><span class="line">\# 获取第四行第二列的元素  </span><br><span class="line">print(P\[4,2\])</span><br><span class="line"></span><br><span class="line">\# 获取第二行  </span><br><span class="line">print(P\[2,\])</span><br><span class="line"></span><br><span class="line">\# 获取第三列  </span><br><span class="line">print(P\[,3\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">col1 col2 col3</span><br><span class="line">row1    3    4    5</span><br><span class="line">row2    6    7    8</span><br><span class="line">row3    9   10   11</span><br><span class="line">row4   12   13   14</span><br><span class="line">[1] 5</span><br><span class="line">[1] 13</span><br><span class="line">col1 col2 col3 </span><br><span class="line">    6    7    8 </span><br><span class="line">row1 row2 row3 row4 </span><br><span class="line">    5    8   11   14 </span><br></pre></td></tr></table></figure>
<h3 id="矩阵计算">矩阵计算</h3>
<p>大小相同（行数列数都相同）的矩阵之间可以相互加减，具体是对每个位置上的元素做加减法。矩阵的乘法则较为复杂。两个矩阵可以相乘，当且仅当第一个矩阵的列数等于第二个矩阵的行数。</p>
<h3 id="矩阵加减法">矩阵加减法</h3>
<h2 id="实例-84">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">\# 创建 2 行 3 列的矩阵  </span><br><span class="line">matrix1 &lt;- matrix(c(7, 9, \-1, 4, 2, 3), nrow \= 2)  </span><br><span class="line">print(matrix1)</span><br><span class="line"></span><br><span class="line">matrix2 &lt;- matrix(c(6, 1, 0, 9, 3, 2), nrow \= 2)  </span><br><span class="line">print(matrix2)</span><br><span class="line"></span><br><span class="line">\# 两个矩阵相加  </span><br><span class="line">result &lt;- matrix1 + matrix2  </span><br><span class="line">cat(&quot;相加结果：&quot;,&quot;\\n&quot;)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 两个矩阵相减  </span><br><span class="line">result &lt;- matrix1 \- matrix2  </span><br><span class="line">cat(&quot;相减结果：&quot;,&quot;\\n&quot;)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[,1] [,2] [,3]</span><br><span class="line">[1,]    7   -1    2</span><br><span class="line">[2,]    9    4    3</span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    6    0    3</span><br><span class="line">[2,]    1    9    2</span><br><span class="line">相加结果： </span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]   13   -1    5</span><br><span class="line">[2,]   10   13    5</span><br><span class="line">相减结果： </span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    1   -1   -1</span><br><span class="line">[2,]    8   -5    1</span><br></pre></td></tr></table></figure>
<h3 id="矩阵乘除法">矩阵乘除法</h3>
<h2 id="实例-85">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">\# 创建 2 行 3 列的矩阵  </span><br><span class="line">matrix1 &lt;- matrix(c(7, 9, \-1, 4, 2, 3), nrow \= 2)  </span><br><span class="line">print(matrix1)</span><br><span class="line"></span><br><span class="line">matrix2 &lt;- matrix(c(6, 1, 0, 9, 3, 2), nrow \= 2)  </span><br><span class="line">print(matrix2)</span><br><span class="line"></span><br><span class="line">\# 两个矩阵相乘  </span><br><span class="line">result &lt;- matrix1 \* matrix2  </span><br><span class="line">cat(&quot;相乘结果：&quot;,&quot;\\n&quot;)  </span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">\# 两个矩阵相除  </span><br><span class="line">result &lt;- matrix1 / matrix2  </span><br><span class="line">cat(&quot;相除结果：&quot;,&quot;\\n&quot;)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[,1] [,2] [,3]</span><br><span class="line">[1,]    7   -1    2</span><br><span class="line">[2,]    9    4    3</span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    6    0    3</span><br><span class="line">[2,]    1    9    2</span><br><span class="line">相乘结果： </span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]   42    0    6</span><br><span class="line">[2,]    9   36    6</span><br><span class="line">相除结果： </span><br><span class="line">         [,1]      [,2]      [,3]</span><br><span class="line">[1,] 1.166667      -Inf 0.6666667</span><br><span class="line">[2,] 9.000000 0.4444444 1.5000000</span><br></pre></td></tr></table></figure>
<h2 id="R-数组">R 数组</h2>
<p>数组也是 R 语言的对象，R 语言可以创建一维或多维数组。</p>
<p>R 语言数组是一个同一类型的集合，前面我们学的矩阵 matrix 其实就是一个二维数组。</p>
<p>向量、矩阵、数组关系可以看下图：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/2039-08-06Done.png" alt=""></p>
<p>R 语言数组创建使用 array() 函数，该函数使用向量作为输入参数，可以使用 dim 设置数组维度。</p>
<p>array() 函数语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array(data = NA, dim = length(data), dimnames = NULL)</span><br></pre></td></tr></table></figure>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong>data</strong> - 指定数组的数据源，可以是一个向量、矩阵或列表。</li>
<li><strong>dim</strong> - 指定数组的维度，可以是一个整数向量或一个表示维度的元组，默认是一维数组。例如，dim = c(2, 3, 4) 表示创建一个 <strong>2x3x4</strong> 的三维数组。</li>
<li><strong>dimnames</strong> - 可选参数，用于指定数组每个维度的名称，可以是一个包含维度名称的列表。</li>
</ul>
<p>在 R 中，数组索引是从 1 开始的，与其他编程语言的习惯有所不同。</p>
<p>此外，R 还提供了丰富的函数和操作符用于处理数组数据，如索引、切片、重塑、聚合等。</p>
<p>在 R 中，可以使用<a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-matrix.html">矩阵（Matrix）</a>或<a target="_blank" rel="noopener" href="https://www.runoob.com/r/r-list.html">列表（List）</a>来表示多维数组。</p>
<p>**矩阵（Matrix）：**矩阵是 R 中最常用的表示数组的形式，它是一个二维的结构，具有固定的行数和列数。</p>
<p>可以使用 matrix() 函数创建矩阵，指定数据元素和维度。</p>
<h2 id="实例-86">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个3x3的矩阵  </span><br><span class="line">my\_matrix &lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow \= 3, ncol \= 3)  </span><br><span class="line">print(my\_matrix)  </span><br></pre></td></tr></table></figure>
<p><strong>列表（List）</strong>：列表是 R 中更通用的多维数组形式，它可以包含不同类型的元素，并且每个元素可以是一个矩阵、向量或其他数据结构。</p>
<h2 id="实例-87">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个包含矩阵和向量的列表  </span><br><span class="line">my\_list &lt;- list(matrix(c(1, 2, 3, 4), nrow \= 2), c(5, 6, 7))  </span><br><span class="line">print(my\_list)  </span><br></pre></td></tr></table></figure>
<h2 id="实例-88">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个包含矩阵和向量的列表  </span><br><span class="line">my\_list &lt;- list(matrix(c(1, 2, 3, 4), nrow \= 2), c(5, 6, 7))  </span><br><span class="line">print(my\_list)  </span><br></pre></td></tr></table></figure>
<p>除了矩阵和列表，R 还提供了其他数据结构来表示多维数组，如数组（Array）和数据帧（Data Frame）。</p>
<h3 id="实例-89">实例</h3>
<p>下面是一些示例来演示 <strong>array()</strong> 函数的使用：</p>
<p>使用向量创建一维数组：</p>
<h2 id="实例-90">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my\_vector &lt;- c(1, 2, 3, 4)  </span><br><span class="line">my\_array &lt;- array(my\_vector, dim \= c(4))  </span><br><span class="line">print(my\_array)  </span><br></pre></td></tr></table></figure>
<p>以下实例我们创建一个 3 行 3 列的的二维数组：</p>
<h2 id="实例-91">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector1 &lt;- c(5,9,3)  </span><br><span class="line">vector2 &lt;- c(10,11,12,13,14,15)</span><br><span class="line"></span><br><span class="line">\# 创建数组  </span><br><span class="line">result &lt;- array(c(vector1,vector2),dim \= c(3,3,2))  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">, , 1</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    5   10   13</span><br><span class="line">[2,]    9   11   14</span><br><span class="line">[3,]    3   12   15</span><br><span class="line"></span><br><span class="line">, , 2</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    5   10   13</span><br><span class="line">[2,]    9   11   14</span><br><span class="line">[3,]    3   12   15</span><br></pre></td></tr></table></figure>
<p>使用 dimnames 参数来设置各个维度的名称：：</p>
<h2 id="实例-92">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector1 &lt;- c(5,9,3)  </span><br><span class="line">vector2 &lt;- c(10,11,12,13,14,15)  </span><br><span class="line">column.names &lt;- c(&quot;COL1&quot;,&quot;COL2&quot;,&quot;COL3&quot;)  </span><br><span class="line">row.names &lt;- c(&quot;ROW1&quot;,&quot;ROW2&quot;,&quot;ROW3&quot;)  </span><br><span class="line">matrix.names &lt;- c(&quot;Matrix1&quot;,&quot;Matrix2&quot;)</span><br><span class="line"></span><br><span class="line">\# 创建数组，并设置各个维度的名称  </span><br><span class="line">result &lt;- array(c(vector1,vector2),dim \= c(3,3,2),dimnames \= list(row.names,column.names,matrix.names))  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">, , Matrix1</span><br><span class="line"></span><br><span class="line">     COL1 COL2 COL3</span><br><span class="line">ROW1    5   10   13</span><br><span class="line">ROW2    9   11   14</span><br><span class="line">ROW3    3   12   15</span><br><span class="line"></span><br><span class="line">, , Matrix2</span><br><span class="line"></span><br><span class="line">     COL1 COL2 COL3</span><br><span class="line">ROW1    5   10   13</span><br><span class="line">ROW2    9   11   14</span><br><span class="line">ROW3    3   12   15</span><br></pre></td></tr></table></figure>
<h3 id="访问数组元素">访问数组元素</h3>
<p>在 R 语言中，可以使用索引操作符 [ ] 来访问多维数组的元素。</p>
<p>索引操作符允许您按照指定的索引位置获取数组中的特定元素。</p>
<p>如果想获取数组元素，可以通过使用元素的列索引和行索引，类似坐标形式。</p>
<p>访问单个元素：</p>
<h2 id="实例-93">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my\_array &lt;- array(1:12, dim \= c(2, 3, 2))  \# 创建一个3维数组  </span><br><span class="line">element &lt;- my\_array\[1, 2, 1\]  \# 访问第一个维度为1，第二个维度为2，第三个维度为1的元素  </span><br><span class="line">print(element)  </span><br></pre></td></tr></table></figure>
<p>访问多个元素：</p>
<h2 id="实例-94">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my\_array &lt;- array(1:12, dim \= c(2, 3, 2))  \# 创建一个3维数组  </span><br><span class="line">elements &lt;- my\_array\[c(1, 2), c(2, 3), c(1, 2)\]  \# 访问多个元素，其中每个维度的索引分别为1和2  </span><br><span class="line">print(elements)  </span><br></pre></td></tr></table></figure>
<p>访问二维数组的元素：</p>
<h2 id="实例-95">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector1 &lt;- c(5,9,3)  </span><br><span class="line">vector2 &lt;- c(10,11,12,13,14,15)  </span><br><span class="line">column.names &lt;- c(&quot;COL1&quot;,&quot;COL2&quot;,&quot;COL3&quot;)  </span><br><span class="line">row.names &lt;- c(&quot;ROW1&quot;,&quot;ROW2&quot;,&quot;ROW3&quot;)  </span><br><span class="line">matrix.names &lt;- c(&quot;Matrix1&quot;,&quot;Matrix2&quot;)</span><br><span class="line"></span><br><span class="line">\# 创建数组  </span><br><span class="line">result &lt;- array(c(vector1,vector2),dim \= c(3,3,2),dimnames \= list(row.names, column.names, matrix.names))</span><br><span class="line"></span><br><span class="line">\# 显示数组第二个矩阵中第三行的元素  </span><br><span class="line">print(result\[3,,2\])</span><br><span class="line"></span><br><span class="line">\# 显示数组第一个矩阵中第一行第三列的元素  </span><br><span class="line">print(result\[1,3,1\])</span><br><span class="line"></span><br><span class="line">\# 输出第二个矩阵  </span><br><span class="line">print(result\[,,2\])</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">COL1 COL2 COL3 </span><br><span class="line">   3   12   15 </span><br><span class="line">[1] 13</span><br><span class="line">     COL1 COL2 COL3</span><br><span class="line">ROW1    5   10   13</span><br><span class="line">ROW2    9   11   14</span><br><span class="line">ROW3    3   12   15</span><br></pre></td></tr></table></figure>
<p>使用逻辑条件进行筛选：</p>
<h2 id="实例-96">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my\_array &lt;- array(1:12, dim \= c(2, 3, 2))  \# 创建一个3维数组  </span><br><span class="line">filtered\_elements &lt;- my\_array\[my\_array \&gt; 5\]  \# 选择大于5的元素  </span><br><span class="line">print(filtered\_elements)  \# 输出：6 7 8 9 10 11 12  </span><br></pre></td></tr></table></figure>
<h3 id="操作数组元素">操作数组元素</h3>
<p>由于数组是由多个维度的矩阵组成，所以我们可以通过访问矩阵的元素来访问数组元素。</p>
<h2 id="实例-97">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector1 &lt;- c(5,9,3)  </span><br><span class="line">vector2 &lt;- c(10,11,12,13,14,15)</span><br><span class="line"></span><br><span class="line">\# 创建数组  </span><br><span class="line">array1 &lt;- array(c(vector1,vector2),dim \= c(3,3,2))</span><br><span class="line"></span><br><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector3 &lt;- c(9,1,0)  </span><br><span class="line">vector4 &lt;- c(6,0,11,3,14,1,2,6,9)  </span><br><span class="line">array2 &lt;- array(c(vector3,vector4),dim \= c(3,3,2))</span><br><span class="line"></span><br><span class="line">\# 从数组中创建矩阵  </span><br><span class="line">matrix1 &lt;- array1\[,,2\]  </span><br><span class="line">matrix2 &lt;- array2\[,,2\]</span><br><span class="line"></span><br><span class="line">\# 矩阵相加  </span><br><span class="line">result &lt;- matrix1+matrix2  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    7   19   19</span><br><span class="line">[2,]   15   12   14</span><br><span class="line">[3,]   12   12   26</span><br></pre></td></tr></table></figure>
<p>另外我们可以使用 <strong>apply()</strong> 元素对数组元素进行跨维度计算，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply(X, MARGIN, FUN, ...)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>X</code>：要应用函数的数组或矩阵。</li>
<li><code>MARGIN</code>：指定应用函数的维度，可以是1表示行，2表示列，或者c(1, 2)表示同时应用于行和列。</li>
<li><code>FUN</code>：要应用的函数，可以是内置函数（如<code>mean</code>、<code>sum</code>等）或自定义函数。</li>
<li><code>...</code>：可选参数，用于传递给函数的其他参数。</li>
</ul>
<p>以下我们使用 apply() 函数来计算数组两个矩阵中每一行对数字之和。</p>
<h2 id="实例-98">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\# 创建两个不同长度的向量  </span><br><span class="line">vector1 &lt;- c(5,9,3)  </span><br><span class="line">vector2 &lt;- c(10,11,12,13,14,15)</span><br><span class="line"></span><br><span class="line">\# 创建数组  </span><br><span class="line">new.array &lt;- array(c(vector1,vector2),dim \= c(3,3,2))  </span><br><span class="line">print(new.array)</span><br><span class="line"></span><br><span class="line">\# 计算数组中所有矩阵第一行的数字之和  </span><br><span class="line">result &lt;- apply(new.array, c(1), sum)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">, , 1</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    5   10   13</span><br><span class="line">[2,]    9   11   14</span><br><span class="line">[3,]    3   12   15</span><br><span class="line"></span><br><span class="line">, , 2</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    5   10   13</span><br><span class="line">[2,]    9   11   14</span><br><span class="line">[3,]    3   12   15</span><br><span class="line"></span><br><span class="line">[1] 56 68 60</span><br></pre></td></tr></table></figure>
<p>对矩阵的行或列应用内置函数：</p>
<h2 id="实例-99">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个3x3的矩阵  </span><br><span class="line">my\_matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">\# 对每列应用sum函数  </span><br><span class="line">col\_sums &lt;- apply(my\_matrix, 2, sum)  </span><br><span class="line">print(col\_sums)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1]  6 15 24</span><br></pre></td></tr></table></figure>
<p>对矩阵的行或列应用自定义函数：</p>
<h2 id="实例-100">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个3x3的矩阵  </span><br><span class="line">my\_matrix &lt;- matrix(1:9, nrow \= 3)  </span><br><span class="line">\# 自定义函数：计算每行的平均值  </span><br><span class="line">row\_mean &lt;- function(x) &#123;  </span><br><span class="line">  return(mean(x))  </span><br><span class="line">&#125;  </span><br><span class="line">\# 对每行应用row\_mean函数  </span><br><span class="line">row\_means &lt;- apply(my\_matrix, 1, row\_mean)  </span><br><span class="line">print(row\_means)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1] 4 5 6</span><br></pre></td></tr></table></figure>
<p>对数组的多个维度同时应用函数：</p>
<h2 id="实例-101">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\# 创建一个3维数组  </span><br><span class="line">my\_array &lt;- array(1:12, dim \= c(2, 3, 2))  </span><br><span class="line">\# 对第一个和第三个维度同时应用mean函数  </span><br><span class="line">result &lt;- apply(my\_array, c(1, 3), mean)  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">     [,1] [,2]</span><br><span class="line">[1,]    3    9</span><br><span class="line">[2,]    4   10</span><br></pre></td></tr></table></figure>
<h2 id="R-因子">R 因子</h2>
<p>因子用于存储不同类别的数据类型，例如人的性别有男和女两个类别，年龄来分可以有未成年人和成年人。</p>
<p>R 语言创建因子使用 factor() 函数，向量作为输入参数。</p>
<p>factor() 函数语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">factor(x = character(), levels, labels = levels,</span><br><span class="line">       exclude = NA, ordered = is.ordered(x), nmax = NA)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>x：向量。</li>
<li>levels：指定各水平值, 不指定时由x的不同值来求得。</li>
<li>labels：水平的标签, 不指定时用各水平值的对应字符串。</li>
<li>exclude：排除的字符。</li>
<li>ordered：逻辑值，用于指定水平是否有序。</li>
<li>nmax：水平的上限数量。</li>
</ul>
<p>以下实例把字符型向量转换成因子：</p>
<h2 id="实例-102">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(&quot;男&quot;, &quot;女&quot;, &quot;男&quot;, &quot;男&quot;,  &quot;女&quot;)  </span><br><span class="line">sex &lt;- factor(x)  </span><br><span class="line">print(sex)  </span><br><span class="line">print(is.factor(sex))  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1] 男 女 男 男 女</span><br><span class="line">Levels: 男 女</span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>
<p>以下实例设置因子水平为 c(‘男’,‘女’)：</p>
<h2 id="实例-103">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(&quot;男&quot;, &quot;女&quot;, &quot;男&quot;, &quot;男&quot;,  &quot;女&quot;,levels\=c(&#x27;男&#x27;,&#x27;女&#x27;))  </span><br><span class="line">sex &lt;- factor(x)  </span><br><span class="line">print(sex)  </span><br><span class="line">print(is.factor(sex))  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">levels1 levels2 </span><br><span class="line">男      女      男      男      女      男      女 </span><br><span class="line">Levels: 男 女</span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>
<h3 id="因子水平标签">因子水平标签</h3>
<p>接下来我们使用 labels 参数为每个因子水平添加标签，labels 参数的字符顺序，要和 levels 参数的字符顺序保持一致，例如：</p>
<h2 id="实例-104">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sex\=factor(c(&#x27;f&#x27;,&#x27;m&#x27;,&#x27;f&#x27;,&#x27;f&#x27;,&#x27;m&#x27;),levels\=c(&#x27;f&#x27;,&#x27;m&#x27;),labels\=c(&#x27;female&#x27;,&#x27;male&#x27;),ordered\=TRUE)  </span><br><span class="line">print(sex)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1] female male   female female male  </span><br><span class="line">Levels: female &lt; male</span><br></pre></td></tr></table></figure>
<h3 id="生成因子水平">生成因子水平</h3>
<p>我们可以使用 gl() 函数来生成因子水平，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl(n, k, length = n*k, labels = seq_len(n), ordered = FALSE)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><strong>n</strong>: 设置 level 的个数</li>
<li><strong>k</strong>: 设置每个 level 重复的次数</li>
<li><strong>length</strong>: 设置长度</li>
<li><strong>labels</strong>: 设置 level 的值</li>
<li><strong>ordered</strong>: 设置是否 level 是排列好顺序的，布尔值。</li>
</ul>
<h2 id="实例-105">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v &lt;- gl(3, 4, labels \= c(&quot;Google&quot;, &quot;Runoob&quot;,&quot;Taobao&quot;))  </span><br><span class="line">print(v)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> [1] Google Google Google Google Runoob Runoob Runoob Runoob Taobao Taobao</span><br><span class="line">[11] Taobao Taobao</span><br><span class="line">Levels: Google Runoob Taobao</span><br></pre></td></tr></table></figure>
<h2 id="R-数据框">R 数据框</h2>
<p>数据框（Data frame）可以理解成我们常说的&quot;表格&quot;。</p>
<p>数据框是 R 语言的数据结构，是特殊的二维列表。</p>
<p>数据框每一列都有一个唯一的列名，长度都是相等的，同一列的数据类型需要一致，不同列的数据类型可以不一样。</p>
<p><img src="https://static.jyshare.com/images/mix/data-frame.svg" alt=""></p>
<p>R 语言数据框使用 data.frame() 函数来创建，语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data.frame(…, row.names = NULL, check.rows = FALSE,</span><br><span class="line">           check.names = TRUE, fix.empty.names = TRUE,</span><br><span class="line">           stringsAsFactors = default.stringsAsFactors())</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>…</strong>: 列向量，可以是任何类型（字符型、数值型、逻辑型），一般以 tag = value 的形式表示，也可以是 value。</li>
<li><strong>row.names</strong>: 行名，默认为 NULL，可以设置为单个数字、字符串或字符串和数字的向量。</li>
<li><strong>check.rows</strong>: 检测行的名称和长度是否一致。</li>
<li><strong>check.names</strong>: 检测数据框的变量名是否合法。</li>
<li><strong>fix.empty.names</strong>: 设置未命名的参数是否自动设置名字。</li>
<li><strong>stringsAsFactors</strong>: 布尔值，字符是否转换为因子，factory-fresh 的默认值是 TRUE，可以通过设置选项（stringsAsFactors=FALSE）来修改。</li>
</ul>
<p>以下创建一个简单的数据框，包含姓名、工号、月薪：</p>
<h2 id="实例-106">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000)</span><br><span class="line"></span><br><span class="line">    )  </span><br><span class="line">print(table) \# 查看 table 数据</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">姓名 工号 月薪</span><br><span class="line">1 张三  001 1000</span><br><span class="line">2 李四  002 2000</span><br></pre></td></tr></table></figure>
<p>数据框的数据结构可以通过 <strong>str()</strong> 函数来展示：</p>
<h2 id="实例-107">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000)  </span><br><span class="line">)  </span><br><span class="line">\# 获取数据结构  </span><br><span class="line">str(table)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x27;data.frame&#x27;:   2 obs. of  3 variables:</span><br><span class="line"> $ 姓名: chr  &quot;张三&quot; &quot;李四&quot;</span><br><span class="line"> $ 工号: chr  &quot;001&quot; &quot;002&quot;</span><br><span class="line"> $ 月薪: num  1000 2000</span><br></pre></td></tr></table></figure>
<p><strong>summary()</strong> 可以显示数据框的概要信息：</p>
<h2 id="实例-108">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000)</span><br><span class="line"></span><br><span class="line">    )  </span><br><span class="line">\# 显示概要  </span><br><span class="line">print(summary(table))</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">姓名               工号                月薪     </span><br><span class="line">Length:2           Length:2           Min.   :1000  </span><br><span class="line">Class :character   Class :character   1st Qu.:1250  </span><br><span class="line">Mode  :character   Mode  :character   Median :1500  </span><br><span class="line">                                      Mean   :1500  </span><br><span class="line">                                      3rd Qu.:1750  </span><br><span class="line">                                      Max.   :2000  </span><br></pre></td></tr></table></figure>
<p>我们也可以提取指定的列：</p>
<h2 id="实例-109">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000)  </span><br><span class="line">)  </span><br><span class="line">\# 提取指定的列  </span><br><span class="line">result &lt;- data.frame(table$姓名,table$月薪)  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">table.姓名 table.月薪</span><br><span class="line">1       张三       1000</span><br><span class="line">2       李四       2000</span><br></pre></td></tr></table></figure>
<p>以下形式显示前面两行：</p>
<h2 id="实例-110">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;,&quot;王五&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;,&quot;003&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000,3000)  </span><br><span class="line">)  </span><br><span class="line">print(table)  </span><br><span class="line">\# 提取前面两行  </span><br><span class="line">print(&quot;---输出前面两行----&quot;)  </span><br><span class="line">result &lt;- table\[1:2,\]  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">姓名 工号 月薪</span><br><span class="line">1 张三  001 1000</span><br><span class="line">2 李四  002 2000</span><br><span class="line">3 王五  003 3000</span><br><span class="line">[1] &quot;---输出前面两行----&quot;</span><br><span class="line">  姓名 工号 月薪</span><br><span class="line">1 张三  001 1000</span><br><span class="line">2 李四  002 2000</span><br></pre></td></tr></table></figure>
<p>我们可以通过类似坐标的形式读取指定行的某一列的数据，以下我们读取第 2 、3 行的第 1 、2 列数据：</p>
<h2 id="实例-111">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;,&quot;王五&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;,&quot;003&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000,3000)  </span><br><span class="line">)  </span><br><span class="line">\# 读取第 2 、3 行的第 1 、2 列数据：  </span><br><span class="line">result &lt;- table\[c(2,3),c(1,2)\]  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">姓名 工号</span><br><span class="line">2 李四  002</span><br><span class="line">3 王五  003</span><br></pre></td></tr></table></figure>
<h3 id="扩展数据框">扩展数据框</h3>
<p>我们可以对已有的数据框进行扩展，以下实例我们添加部门列：</p>
<h2 id="实例-112">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;,&quot;王五&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;,&quot;003&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000,3000)  </span><br><span class="line">)  </span><br><span class="line">\# 添加部门列  </span><br><span class="line">table$部门 &lt;- c(&quot;运营&quot;,&quot;技术&quot;,&quot;编辑&quot;)</span><br><span class="line"></span><br><span class="line">print(table)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">姓名 工号 月薪 部门</span><br><span class="line">1 张三  001 1000 运营</span><br><span class="line">2 李四  002 2000 技术</span><br><span class="line">3 王五  003 3000 编辑</span><br></pre></td></tr></table></figure>
<p>我们可以使用 <strong>cbind()</strong> 函数将多个向量合成一个数据框：</p>
<h2 id="实例-113">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\# 创建向量  </span><br><span class="line">sites &lt;- c(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;)  </span><br><span class="line">likes &lt;- c(222,111,123)  </span><br><span class="line">url &lt;- c(&quot;www.google.com&quot;,&quot;www.runoob.com&quot;,&quot;www.taobao.com&quot;)</span><br><span class="line"></span><br><span class="line">\# 将向量组合成数据框  </span><br><span class="line">addresses &lt;- cbind(sites,likes,url)</span><br><span class="line"></span><br><span class="line">\# 查看数据框  </span><br><span class="line">print(addresses)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     sites    likes url             </span><br><span class="line">[1,] &quot;Google&quot; &quot;222&quot; &quot;www.google.com&quot;</span><br><span class="line">[2,] &quot;Runoob&quot; &quot;111&quot; &quot;www.runoob.com&quot;</span><br><span class="line">[3,] &quot;Taobao&quot; &quot;123&quot; &quot;www.taobao.com&quot;</span><br></pre></td></tr></table></figure>
<p>如果要对两个数据框进行合并可以使用 <strong>rbind()</strong> 函数：</p>
<h2 id="实例-114">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">table \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;张三&quot;, &quot;李四&quot;,&quot;王五&quot;),  </span><br><span class="line">    工号 \= c(&quot;001&quot;,&quot;002&quot;,&quot;003&quot;),  </span><br><span class="line">    月薪 \= c(1000, 2000,3000)  </span><br><span class="line">)  </span><br><span class="line">newtable \= data.frame(  </span><br><span class="line">    姓名 \= c(&quot;小明&quot;, &quot;小白&quot;),  </span><br><span class="line">    工号 \= c(&quot;101&quot;,&quot;102&quot;),  </span><br><span class="line">    月薪 \= c(5000, 7000)  </span><br><span class="line">)  </span><br><span class="line">\# 合并两个数据框  </span><br><span class="line">result &lt;- rbind(table,newtable)  </span><br><span class="line">print(result)  </span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">姓名 工号 月薪</span><br><span class="line">1 张三  001 1000</span><br><span class="line">2 李四  002 2000</span><br><span class="line">3 王五  003 3000</span><br><span class="line">4 小明  101 5000</span><br><span class="line">5 小白  102 7000</span><br></pre></td></tr></table></figure>
<h2 id="R-数据重塑">R 数据重塑</h2>
<h3 id="合并数据框">合并数据框</h3>
<p>R 语言合并数据框使用 <strong>merge()</strong> 函数。</p>
<p>merge() 函数语法格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># S3 方法</span><br><span class="line">merge(x, y, …)</span><br><span class="line"></span><br><span class="line"># data.frame 的 S3 方法 </span><br><span class="line">merge(x, y, by = intersect(names(x), names(y)),</span><br><span class="line">      by.x = by, by.y = by, all = FALSE, all.x = all, all.y = all,</span><br><span class="line">      sort = TRUE, suffixes = c(&quot;.x&quot;,&quot;.y&quot;), no.dups = TRUE,</span><br><span class="line">      incomparables = NULL, …)</span><br></pre></td></tr></table></figure>
<p>常用参数说明：</p>
<ul>
<li>x, y： 数据框</li>
<li>by, by.x, by.y：指定两个数据框中匹配列名称，默认情况下使用两个数据框中相同列名称。</li>
<li>all：逻辑值; all = L 是 all.x = L 和 all.y = L 的简写，L 可以是 TRUE 或 FALSE。</li>
<li>all.x：逻辑值，默认为 FALSE。如果为 TRUE, 显示 x 中匹配的行，即便 y 中没有对应匹配的行，y 中没有匹配的行用 NA 来表示。</li>
<li>all.y：逻辑值，默认为 FALSE。如果为 TRUE, 显示 y 中匹配的行，即便 x 中没有对应匹配的行，x 中没有匹配的行用 NA 来表示。</li>
<li>sort：逻辑值，是否对列进行排序。</li>
</ul>
<p>merge() 函数和 SQL 的 JOIN 功能很相似：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-merge-join.jpg" alt=""></p>
<ul>
<li><strong>Natural join 或 INNER JOIN</strong>：如果表中有至少一个匹配，则返回行</li>
<li><strong>Left outer join 或 LEFT JOIN</strong>：即使右表中没有匹配，也从左表返回所有的行</li>
<li><strong>Right outer join 或 RIGHT JOIN</strong>：即使左表中没有匹配，也从右表返回所有的行</li>
<li><strong>Full outer join 或 FULL JOIN</strong>：只要其中一个表中存在匹配，则返回行</li>
</ul>
<h2 id="实例-115">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">\# data frame 1  </span><br><span class="line">df1 \= data.frame(SiteId \= c(1:6), Site \= c(&quot;Google&quot;,&quot;Runoob&quot;,&quot;Taobao&quot;,&quot;Facebook&quot;,&quot;Zhihu&quot;,&quot;Weibo&quot;))</span><br><span class="line"></span><br><span class="line">\# data frame 2  </span><br><span class="line">df2 \= data.frame(SiteId \= c(2, 4, 6, 7, 8), Country \= c(&quot;CN&quot;,&quot;USA&quot;,&quot;CN&quot;,&quot;USA&quot;,&quot;IN&quot;))</span><br><span class="line"></span><br><span class="line">\# INNER JOIN  </span><br><span class="line">df1 \= merge(x\=df1,y\=df2,by\=&quot;SiteId&quot;)  </span><br><span class="line">print(&quot;----- INNER JOIN -----&quot;)  </span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">\# FULL JOIN  </span><br><span class="line">df2 \= merge(x\=df1,y\=df2,by\=&quot;SiteId&quot;,all\=TRUE)  </span><br><span class="line">print(&quot;----- FULL JOIN -----&quot;)  </span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">\# LEFT JOIN  </span><br><span class="line">df3 \= merge(x\=df1,y\=df2,by\=&quot;SiteId&quot;,all.x\=TRUE)  </span><br><span class="line">print(&quot;----- LEFT JOIN -----&quot;)  </span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">\# RIGHT JOIN  </span><br><span class="line">df4 \= merge(x\=df1,y\=df2,by\=&quot;SiteId&quot;,all.y\=TRUE)  </span><br><span class="line">print(&quot;----- RIGHT JOIN -----&quot;)  </span><br><span class="line">print(df4)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[1] &quot;----- INNER JOIN -----&quot;</span><br><span class="line">  SiteId     Site Country</span><br><span class="line">1      2   Runoob      CN</span><br><span class="line">2      4 Facebook     USA</span><br><span class="line">3      6    Weibo      CN</span><br><span class="line">[1] &quot;----- FULL JOIN -----&quot;</span><br><span class="line">  SiteId     Site Country.x Country.y</span><br><span class="line">1      2   Runoob        CN        CN</span><br><span class="line">2      4 Facebook       USA       USA</span><br><span class="line">3      6    Weibo        CN        CN</span><br><span class="line">4      7     &lt;NA&gt;      &lt;NA&gt;       USA</span><br><span class="line">5      8     &lt;NA&gt;      &lt;NA&gt;        IN</span><br><span class="line">[1] &quot;----- LEFT JOIN -----&quot;</span><br><span class="line">  SiteId   Site.x Country   Site.y Country.x Country.y</span><br><span class="line">1      2   Runoob      CN   Runoob        CN        CN</span><br><span class="line">2      4 Facebook     USA Facebook       USA       USA</span><br><span class="line">3      6    Weibo      CN    Weibo        CN        CN</span><br><span class="line">[1] &quot;----- RIGHT JOIN -----&quot;</span><br><span class="line">  SiteId   Site.x Country   Site.y Country.x Country.y</span><br><span class="line">1      2   Runoob      CN   Runoob        CN        CN</span><br><span class="line">2      4 Facebook     USA Facebook       USA       USA</span><br><span class="line">3      6    Weibo      CN    Weibo        CN        CN</span><br><span class="line">4      7     &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;      &lt;NA&gt;       USA</span><br><span class="line">5      8     &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;      &lt;NA&gt;        IN</span><br></pre></td></tr></table></figure>
<h3 id="数据整合和拆分">数据整合和拆分</h3>
<p>R 语言使用 <strong>melt()</strong> 和 <strong>cast()</strong> 函数来对数据进行整合和拆分。</p>
<ul>
<li>melt() ：宽格式数据转化成长格式。</li>
<li>cast() ：长格式数据转化成宽格式。</li>
</ul>
<p>下图很好展示来 melt() 和 cast() 函数的功能(后面实例会详细说明)：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/08/6634703-5e733d531862b668.webp" alt=""></p>
<p>melt() 将数据集的每个列堆叠到一个列中，函数语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">melt(data, ..., na.rm = FALSE, value.name = &quot;value&quot;)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>data：数据集。</li>
<li>…：传递给其他方法或来自其他方法的其他参数。</li>
<li>na.rm：是否删除数据集中的 NA 值。</li>
<li><a target="_blank" rel="noopener" href="http://value.name">value.name</a> 变量名称，用于存储值。</li>
</ul>
<p>进行以下操作之前，我们先安装依赖包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 安装库，MASS 包含很多统计相关的函数，工具和数据集</span><br><span class="line">install.packages(&quot;MASS&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;) </span><br><span class="line">  </span><br><span class="line">#  melt() 和 cast() 函数需要对库 </span><br><span class="line">install.packages(&quot;reshape2&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;) </span><br><span class="line">install.packages(&quot;reshape&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;) </span><br></pre></td></tr></table></figure>
<p>测试实例：</p>
<h2 id="实例-116">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">\# 载入库  </span><br><span class="line">library(MASS)  </span><br><span class="line">library(reshape2)  </span><br><span class="line">library(reshape)</span><br><span class="line"></span><br><span class="line">  \# 创建数据框  </span><br><span class="line">id&lt;\- c(1, 1, 2, 2)  </span><br><span class="line">time &lt;\- c(1, 2, 1, 2)  </span><br><span class="line">x1 &lt;\- c(5, 3, 6, 2)  </span><br><span class="line">x2 &lt;\- c(6, 5, 1, 4)  </span><br><span class="line">mydata &lt;\- data.frame(id, time, x1, x2)</span><br><span class="line"></span><br><span class="line">  \# 原始数据框  </span><br><span class="line">cat(&quot;原始数据框:\\n&quot;)  </span><br><span class="line">print(mydata)  </span><br><span class="line">\# 整合  </span><br><span class="line">md &lt;\- melt(mydata, id = c(&quot;id&quot;,&quot;time&quot;))</span><br><span class="line"></span><br><span class="line">  cat(&quot;\\n整合后:\\n&quot;)  </span><br><span class="line">print(md)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">原始数据框:</span><br><span class="line">id time x1 x2</span><br><span class="line">1  1    1  5  6</span><br><span class="line">2  1    2  3  5</span><br><span class="line">3  2    1  6  1</span><br><span class="line">4  2    2  2  4</span><br><span class="line"></span><br><span class="line">整合后:</span><br><span class="line">id time variable value</span><br><span class="line">1  1    1       x1     5</span><br><span class="line">2  1    2       x1     3</span><br><span class="line">3  2    1       x1     6</span><br><span class="line">4  2    2       x1     2</span><br><span class="line">5  1    1       x2     6</span><br><span class="line">6  1    2       x2     5</span><br><span class="line">7  2    1       x2     1</span><br><span class="line">8  2    2       x2     4</span><br></pre></td></tr></table></figure>
<p>cast 函数用于对合并对数据框进行还原，dcast() 返回数据框，acast() 返回一个向量/矩阵/数组。</p>
<p>cast() 函数语法格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dcast(</span><br><span class="line">  data,</span><br><span class="line">  formula,</span><br><span class="line">  fun.aggregate = NULL,</span><br><span class="line">  ...,</span><br><span class="line">  margins = NULL,</span><br><span class="line">  subset = NULL,</span><br><span class="line">  fill = NULL,</span><br><span class="line">  drop = TRUE,</span><br><span class="line">  value.var = guess_value(data)</span><br><span class="line">)</span><br><span class="line">acast(</span><br><span class="line">  data,</span><br><span class="line">  formula,</span><br><span class="line">  fun.aggregate = NULL,</span><br><span class="line">  ...,</span><br><span class="line">  margins = NULL,</span><br><span class="line">  subset = NULL,</span><br><span class="line">  fill = NULL,</span><br><span class="line">  drop = TRUE,</span><br><span class="line">  value.var = guess_value(data)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>data：合并的数据框。</li>
<li>formula：重塑的数据的格式，类似 x ~ y 格式，x 为行标签，y 为列标签 。</li>
<li>fun.aggregate：聚合函数，用于对 value 值进行处理。</li>
<li>margins：变量名称的向量（可以包含&quot;grand\_col&quot; 和 “grand\_row”），用于计算边距，设置 TURE 计算所有边距。</li>
<li>subset：对结果进行条件筛选，格式类似 <strong>subset = .(variable==“length”)</strong>。</li>
<li>drop：是否保留默认值。</li>
<li>value.var：后面跟要处理的字段。</li>
</ul>
<h2 id="实例-117">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">\# 载入库  </span><br><span class="line">library(MASS)  </span><br><span class="line">library(reshape2)  </span><br><span class="line">library(reshape)</span><br><span class="line"></span><br><span class="line">  \# 创建数据框  </span><br><span class="line">id&lt;- c(1, 1, 2, 2)  </span><br><span class="line">time &lt;- c(1, 2, 1, 2)  </span><br><span class="line">x1 &lt;- c(5, 3, 6, 2)  </span><br><span class="line">x2 &lt;- c(6, 5, 1, 4)  </span><br><span class="line">mydata &lt;- data.frame(id, time, x1, x2)  </span><br><span class="line">\# 整合  </span><br><span class="line">md &lt;- melt(mydata, id \= c(&quot;id&quot;,&quot;time&quot;))  </span><br><span class="line">\# Print recasted dataset using cast() function  </span><br><span class="line">cast.data &lt;- cast(md, id~variable, mean)</span><br><span class="line"></span><br><span class="line">  print(cast.data)</span><br><span class="line"></span><br><span class="line">  cat(&quot;\\n&quot;)  </span><br><span class="line">time.cast &lt;- cast(md, time~variable, mean)  </span><br><span class="line">print(time.cast)</span><br><span class="line"></span><br><span class="line">cat(&quot;\\n&quot;)  </span><br><span class="line">id.time &lt;- cast(md, id~time, mean)  </span><br><span class="line">print(id.time)</span><br><span class="line"></span><br><span class="line">cat(&quot;\\n&quot;)  </span><br><span class="line">id.time.cast &lt;- cast(md, id+time~variable)  </span><br><span class="line">print(id.time.cast)</span><br><span class="line"></span><br><span class="line">cat(&quot;\\n&quot;)  </span><br><span class="line">id.variable.time &lt;- cast(md, id+variable~time)  </span><br><span class="line">print(id.variable.time)</span><br><span class="line"></span><br><span class="line">cat(&quot;\\n&quot;)  </span><br><span class="line">id.variable.time2 &lt;- cast(md, id~variable+time)  </span><br><span class="line">print(id.variable.time2)</span><br></pre></td></tr></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">id x1  x2</span><br><span class="line">1  1  4 5.5</span><br><span class="line">2  2  4 2.5</span><br><span class="line"></span><br><span class="line">  time  x1  x2</span><br><span class="line">1    1 5.5 3.5</span><br><span class="line">2    2 2.5 4.5</span><br><span class="line"></span><br><span class="line">  id   1 2</span><br><span class="line">1  1 5.5 4</span><br><span class="line">2  2 3.5 3</span><br><span class="line"></span><br><span class="line">  id time x1 x2</span><br><span class="line">1  1    1  5  6</span><br><span class="line">2  1    2  3  5</span><br><span class="line">3  2    1  6  1</span><br><span class="line">4  2    2  2  4</span><br><span class="line"></span><br><span class="line">  id variable 1 2</span><br><span class="line">1  1       x1 5 3</span><br><span class="line">2  1       x2 6 5</span><br><span class="line">3  2       x1 6 2</span><br><span class="line">4  2       x2 1 4</span><br><span class="line"></span><br><span class="line">  id x1_1 x1_2 x2_1 x2_2</span><br><span class="line">1  1    5    3    6    5</span><br><span class="line">2  2    6    2    1    4</span><br></pre></td></tr></table></figure>
<h2 id="R-包">R 包</h2>
<p>包是 R 函数、实例数据、预编译代码的集合，包括 R 程序，注释文档、实例、测试数据等。</p>
<p>R 语言相关的包一般存储安装目录下对 “library” 目录，默认情况在 R 语言安装完成已经自带来一些常用对包，当然我们也可以在后期自定义添加一些要使用的包。</p>
<p>R 语言完整的相关包可以查阅：<a target="_blank" rel="noopener" href="https://cran.r-project.org/web/packages/available_packages_by_name.html">https://cran.r-project.org/web/packages/available_packages_by_name.html</a></p>
<p>接下来我们主要介绍如何安装 R 语言的包。</p>
<h3 id="查看-R-包的安装目录">查看 R 包的安装目录</h3>
<p>我们可以使用以下函数来查看 R 包的安装目录：</p>
<h2 id="实例-118">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\&gt; .libPaths()  </span><br><span class="line">\[1\] &quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library&quot;  </span><br><span class="line">\&gt;  </span><br></pre></td></tr></table></figure>
<h3 id="查看已安装的包">查看已安装的包</h3>
<p>我们可以使用以下函数来查看已安装的包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library()</span><br></pre></td></tr></table></figure>
<p>输出结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">base                    The R Base Package</span><br><span class="line">boot                    Bootstrap Functions (Originally by Angelo Canty</span><br><span class="line">                        for S)</span><br><span class="line">class                   Functions for Classification</span><br><span class="line">cluster                 &quot;Finding Groups in Data&quot;: Cluster Analysis</span><br><span class="line">                        Extended Rousseeuw et al.</span><br><span class="line">codetools               Code Analysis Tools for R</span><br><span class="line">compiler                The R Compiler Package</span><br><span class="line">datasets                The R Datasets Package</span><br><span class="line">foreign                 Read Data Stored by &#x27;Minitab&#x27;, &#x27;S&#x27;, &#x27;SAS&#x27;,</span><br><span class="line">                        &#x27;SPSS&#x27;, &#x27;Stata&#x27;, &#x27;Systat&#x27;, &#x27;Weka&#x27;, &#x27;dBase&#x27;, ...</span><br><span class="line">graphics                The R Graphics Package</span><br><span class="line">grDevices               The R Graphics Devices and Support for Colours</span><br><span class="line">                        and Fonts</span><br><span class="line">grid                    The Grid Graphics Package</span><br><span class="line">KernSmooth              Functions for Kernel Smoothing Supporting Wand</span><br><span class="line">                        &amp; Jones (1995)</span><br><span class="line">lattice                 Trellis Graphics for R</span><br><span class="line">MASS                    Support Functions and Datasets for Venables and</span><br><span class="line">                        Ripley&#x27;s MASS</span><br></pre></td></tr></table></figure>
<h3 id="查看已载入的包">查看已载入的包</h3>
<p>我们可以使用以下函数来查看编译环境已载入的包：</p>
<h2 id="实例-119">实例</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\&gt; search()  </span><br><span class="line">\[1\] &quot;.GlobalEnv&quot;        &quot;package:stats&quot;     &quot;package:graphics&quot;  </span><br><span class="line">\[4\] &quot;package:grDevices&quot; &quot;package:utils&quot;     &quot;package:datasets&quot;  </span><br><span class="line">\[7\] &quot;package:methods&quot;   &quot;Autoloads&quot;         &quot;package:base&quot;    </span><br></pre></td></tr></table></figure>
<hr>
<h2 id="安装新包">安装新包</h2>
<p>安装新包可以使用 <strong>install.packages()</strong> 函数，格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;要安装的包名&quot;)</span><br></pre></td></tr></table></figure>
<p>我们可以直接设置包名，从 <a target="_blank" rel="noopener" href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a> 网站上获取包，如下实例我们载入 XML 包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 安装 XML 包</span><br><span class="line">install.packages(&quot;XML&quot;)</span><br></pre></td></tr></table></figure>
<p>或者我们可以直接在 <a target="_blank" rel="noopener" href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a> 上下载相关包，直接在本地安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;./XML_3.98-1.3.zip&quot;)</span><br></pre></td></tr></table></figure>
<p>我们国内一般建议大家使用国内镜像，以下实例使用中国科学技术大学源进行安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 安装 XML 包</span><br><span class="line">install.packages(&quot;XML&quot;, repos = &quot;https://mirrors.ustc.edu.cn/CRAN/&quot;)</span><br></pre></td></tr></table></figure>
<p>CRAN (The Comprehensive R Archive Network) 镜像源配置文件之一是 .Rprofile (linux 下位于 ~/.Rprofile )。</p>
<p>在文末添加如下语句:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))</span><br></pre></td></tr></table></figure>
<p>打开 R 即可使用该 CRAN 镜像源安装 R 软件包。</p>
<h3 id="使用包">使用包</h3>
<p>新安装的包需要先载入 R 编译环境中才可以使用，格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library(&quot;包名&quot;)</span><br></pre></td></tr></table></figure>
<p>以下实例载入 XML 包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library(&quot;XML&quot;)</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2013/04/28/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E5%9F%BA%E7%A1%80/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../2013/04/27/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"
                            aria-label=": R语言-环境安装"
                        >
                            R语言-环境安装
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2013-04-27T22:06:40+08:00">
	
		    2013 年 4 月 27 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>, <a class="category-link" href="../../categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80/">R语言</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="R-环境安装">R 环境安装</h2>
<p>R 语言的开发环境本身具备了图形开发环境，这与其他很多工程语言是不同的，所以开发环境最好安装在为桌面个人计算机设计的操作系统上（如 Windows, macOS 或 Ubuntu 桌面版 等）。</p>
<p>首先，我们需要下载 R 语言环境的安装包：</p>
<h3 id="Windows">Windows</h3>
<ul>
<li>官方地址：<a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/windows/base/">https://cloud.r-project.org/bin/windows/base/</a></li>
<li>USTC 镜像：<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/CRAN/bin/windows/base/">https://mirrors.ustc.edu.cn/CRAN/bin/windows/base/</a></li>
<li>TUNA 镜像：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/windows/base/">https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/windows/base/</a></li>
</ul>
<h3 id="Linux">Linux</h3>
<ul>
<li>官方地址：<a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/linux/">https://cloud.r-project.org/bin/linux/</a></li>
<li>USTC 镜像：<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/CRAN/bin/linux/">https://mirrors.ustc.edu.cn/CRAN/bin/linux/</a></li>
<li>TUNA 镜像：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/linux/">https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/linux/</a></li>
</ul>
<h3 id="macOS">macOS</h3>
<ul>
<li>官方地址：<a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/macosx/">https://cloud.r-project.org/bin/macosx/</a></li>
<li>USTC 镜像：<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/CRAN/bin/macosx/">https://mirrors.ustc.edu.cn/CRAN/bin/macosx/</a></li>
<li>TUNA 镜像：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/macosx/">https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/macosx/</a></li>
</ul>
<p>以上的版本有可能是过时的，如果你需要最新版本，可以访问：</p>
<ul>
<li>清华大学源： <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/">https://mirrors.tuna.tsinghua.edu.cn/CRAN/bin/</a></li>
<li>官网：<a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/">https://cloud.r-project.org/bin/</a></li>
</ul>
<hr>
<h2 id="Windows-操作系统">Windows 操作系统</h2>
<p>Windows 安装很简单，下载安装包后，双击下载的安装包，开始安装向导：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-setup-1.png" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-setup-2.png" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-setup-3.png" alt=""></p>
<p>**注意：**这里使用的操作系统是 64 位的，但现在仍有少数的计算机使用的是 32 位的操作系统，如果你的操作系统是 32 位的，请在此步骤选择&quot;32-bit 用户安装&quot;选项。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-setup-4.png" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/r-setup-5.png" alt=""></p>
<p>当我们在交互式的命令窗口输入以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;Hello, world&quot;)</span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Hello, world&quot;</span><br></pre></td></tr></table></figure>
<h2 id="Linux-2">Linux</h2>
<h3 id="Ubuntu-安装">Ubuntu 安装</h3>
<p>执行以下命令安装 R 语言执行环境：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># sudo apt update</span><br><span class="line"># sudo apt -y upgrade</span><br><span class="line"># sudo apt -y install r-base</span><br></pre></td></tr></table></figure>
<p>安装成功后，执行 R 命令就可以进入交互式的编程窗口了：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/AA1FF155-B2EB-48F9-8660-DB32706A134B.jpg" alt=""></p>
<h3 id="Centos-安装">Centos 安装</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># sudo yum install R</span><br></pre></td></tr></table></figure>
<p>输入以下命令，查看安装的版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># R --version</span><br></pre></td></tr></table></figure>
<p>交互式命令可以通过输入 q() 来退出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; q()</span><br><span class="line">Save workspace image? [y/n/c]: y</span><br></pre></td></tr></table></figure>
<h2 id="macOS-安装">macOS 安装</h2>
<p>macOS 安装 R 语言环境类似 Windows，下载 pkg 安装包，双击安装包打开，然后按安装向导安装：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/R-setup-macos-1.jpg" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/R-setup-macos-2.jpg" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/R-setup-macos-3.jpg" alt=""></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/R-setup-macos-4.jpg" alt=""></p>
<p>安装成功后，执行 R 命令就可以进入交互式的编程窗口了：</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/AA89F11A-9180-4BD0-8A6A-4BE2FD5F1E8E.jpg" alt=""></p>
<p>交互式命令可以通过输入 q() 来退出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; q()</span><br><span class="line">Save workspace image? [y/n/c]: y</span><br></pre></td></tr></table></figure>
<p><img src="https://www.runoob.com/wp-content/uploads/2020/07/DDF9B88F-3BBC-4679-9D93-565E4D0ABBAB.jpg" alt=""></p>
<h3 id="脚本执行">脚本执行</h3>
<p>在 R 语言中，可以在命令行中使用 Rscript 命令来执行 R 脚本文件。</p>
<p>Rscript 命令允许您直接从命令行运行 R 脚本，而无需打开 R 控制台。。</p>
<p>要使用 Rscript命令 执行 R 脚本文件，可以按照以下步骤进行操作：</p>
<p>创建一个 R 脚本文件，其中包含要执行的R代码。例如，将以下代码保存为 <strong>script.R</strong> 文件：</p>
<h2 id="script-R-文件代码：">script.R 文件代码：</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\# script.R  </span><br><span class="line">x &lt;- 1:10  </span><br><span class="line">y &lt;- x^2  </span><br><span class="line">print(y)  </span><br></pre></td></tr></table></figure>
<p>打开终端或命令行界面，进入当前文件 <strong>script.R</strong> 所在目录，在命令行中使用 Rscript 命令来执行脚本文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rscript script.R</span><br></pre></td></tr></table></figure>
<p>执行以上命令后，R 脚本文件将被 Rscript 解释器读取和执行。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../2013/04/27/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="../6/"
                aria-label="上一頁"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>上一頁</span>
            </a>
          </li>
        
        
        <li class="pagination-number">第 7 頁 共 7 頁</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macao
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/27/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"
                            aria-label=": R语言-环境安装"
                        >
                            <h3 class="media-heading">R语言-环境安装</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月27日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/04/28/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E5%9F%BA%E7%A1%80/"
                            aria-label=": R语言-基础"
                        >
                            <h3 class="media-heading">R语言-基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/01/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE/"
                            aria-label=": R语言-读取数据"
                        >
                            <h3 class="media-heading">R语言-读取数据</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/02/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BB%98%E5%9B%BE/"
                            aria-label=": R语言-绘图"
                        >
                            <h3 class="media-heading">R语言-绘图</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月2日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2013/05/03/R%E8%AF%AD%E8%A8%80/R%E8%AF%AD%E8%A8%80-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"
                            aria-label=": R语言-线性回归"
                        >
                            <h3 class="media-heading">R语言-线性回归</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2013年5月3日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2015/10/12/mysql%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"
                            aria-label=": mysql基础教程"
                        >
                            <h3 class="media-heading">mysql基础教程</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2015年10月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/linux%E5%9F%BA%E7%A1%80/"
                            aria-label=": linux基础"
                        >
                            <h3 class="media-heading">linux基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/iptables/"
                            aria-label=": iptables"
                        >
                            <h3 class="media-heading">iptables</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/08/12/git/git%E6%95%99%E7%A8%8B/"
                            aria-label=": git教程"
                        >
                            <h3 class="media-heading">git教程</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年8月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/09/15/git/git-flow/"
                            aria-label=": git flow"
                        >
                            <h3 class="media-heading">git flow</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年9月15日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 67 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
