
<!DOCTYPE html>
<html lang="zh-tw">
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">

    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    
      <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/locale/zh-tw.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
    <script>
      window.algoliaConfig = {
        appId: 'AWFC86Q51O',
        apiKey: 'c9d952906eb1b154d75cf863e75c1ede',
        indexName: 'MyBlog'
      };
      var algoliaIndex = algoliasearch(
        algoliaConfig.appId,
        algoliaConfig.apiKey
      ).initIndex(algoliaConfig.indexName);
    </script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kein&#39;s blog">
    <title>分類: 后端 - Kein&#39;s blog</title>
    <meta name="author" content="Kein Chan">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Kein&#39;s blog">
<meta property="og:url" content="https://chankein.github.io/categories/%E5%90%8E%E7%AB%AF/page/2/index.html">
<meta property="og:site_name" content="Kein&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Kein Chan">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://chankein.github.io../../../../assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../../../../assets/css/style-l9zwheso7r7pnk98nvirovsz9dl7fhkrc9mlb5vmuxw7tk5movrk0eevsrpr.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../../../../index.html"
            aria-label=""
        >
            Kein&#39;s blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打開鏈接: ../../../../#about"
            >
        
        
            <img class="header-picture" src="../../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../../../../#about"
                    aria-label="閱讀有關作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="../../../../assets/images/profile.jpg" alt="作者的圖片"/>
                </a>
                <h4 class="sidebar-profile-name">Kein Chan</h4>
                
                    <h5 class="sidebar-profile-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../index.html"
                            
                            rel="noopener"
                            title="首頁"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首頁</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../all-categories"
                            
                            rel="noopener"
                            title="分類"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分類</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../all-tags"
                            
                            rel="noopener"
                            title="標籤"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">標籤</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../all-archives"
                            
                            rel="noopener"
                            title="所有文章"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">所有文章</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜尋"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜尋</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="關於"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">關於</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/chankein/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../mailto:kein.chan85@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Email"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Email</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../../../../atom.xml"
                            
                            rel="noopener"
                            title="Atom"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Atom</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/11/08/linux/12-%E5%86%85%E6%A0%B8/"
                            aria-label=": 12.内核"
                        >
                            12.内核
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-08T21:06:24+08:00">
	
		    2020 年 11 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-内核版本管理">1. 内核版本管理</h2>
<h3 id="版本号说明">版本号说明</h3>
<ul>
<li>
<p><strong>2.X.Y 旧版本格式</strong>：</p>
<ul>
<li>X：偶数表示稳定版，奇数表示开发版</li>
<li>Y：修订版本号</li>
<li>后缀说明：
<ul>
<li><code>-rcN</code>：Release Candidate（候选版本）</li>
<li><code>-gitN</code>：开发中的Git版本</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>3.0+ 新版本分类</strong>：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prepatch</td>
<td>稳定版前的测试版本</td>
</tr>
<tr>
<td>Mainline</td>
<td>包含新特性的主线开发版本</td>
</tr>
<tr>
<td>Stable</td>
<td>稳定版本</td>
</tr>
<tr>
<td>Longterm</td>
<td>长期支持版本(LTS)</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="版本查询命令">版本查询命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> [选项]</span><br></pre></td></tr></table></figure>
<h4 id="常用选项">常用选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示全部系统信息</td>
</tr>
<tr>
<td>-r</td>
<td>显示内核版本</td>
</tr>
<tr>
<td>-m</td>
<td>显示硬件架构</td>
</tr>
</tbody>
</table>
<h4 id="其他查询方式">其他查询方式</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看/proc版本信息</span></span><br><span class="line"><span class="built_in">cat</span> /proc/version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Makefile查看</span></span><br><span class="line"><span class="built_in">head</span> -4 /usr/src/linux/Makefile</span><br></pre></td></tr></table></figure>
<h2 id="2-内核模块管理">2. 内核模块管理</h2>
<h3 id="核心命令对比">核心命令对比</h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>lsmod</td>
<td>显示已加载模块</td>
<td>读取/proc/modules</td>
</tr>
<tr>
<td>insmod</td>
<td>加载单个模块</td>
<td>不处理依赖关系</td>
</tr>
<tr>
<td>rmmod</td>
<td>卸载模块</td>
<td>需确保无依赖</td>
</tr>
<tr>
<td>modprobe</td>
<td>智能加载/卸载模块</td>
<td>自动处理依赖关系</td>
</tr>
<tr>
<td>depmod</td>
<td>生成模块依赖关系文件</td>
<td>创建modules.dep</td>
</tr>
</tbody>
</table>
<h3 id="命令详解">命令详解</h3>
<h4 id="lsmod-输出说明">lsmod 输出说明</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Module                  Size  Used by    Dependent modules</span><br></pre></td></tr></table></figure>
<ul>
<li>显示模块名、大小、引用计数和被哪些模块使用</li>
</ul>
<h4 id="modinfo-模块信息">modinfo 模块信息</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modinfo [选项] 模块名</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示作者信息</td>
</tr>
<tr>
<td>-d</td>
<td>显示描述信息</td>
</tr>
<tr>
<td>-l</td>
<td>显示许可证信息</td>
</tr>
<tr>
<td>-n</td>
<td>显示模块文件路径</td>
</tr>
</tbody>
</table>
<h4 id="modprobe-高级用法">modprobe 高级用法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modprobe [选项] 模块名</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>加载所有匹配模块</td>
</tr>
<tr>
<td>-c</td>
<td>显示当前配置</td>
</tr>
<tr>
<td>-l</td>
<td>列出所有可用模块</td>
</tr>
<tr>
<td>-r</td>
<td>递归卸载模块及依赖</td>
</tr>
<tr>
<td>-t 类型</td>
<td>仅操作指定类型模块</td>
</tr>
<tr>
<td>–show-depends</td>
<td>显示模块依赖关系</td>
</tr>
</tbody>
</table>
<h3 id="配置文件">配置文件</h3>
<ul>
<li><code>/etc/modprobe.conf</code>：模块别名和参数配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias eth0 e1000</span><br><span class="line">options e1000 speed=1000 duplex=full</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-内核编译流程">3. 内核编译流程</h2>
<h3 id="编译步骤">编译步骤</h3>
<ol>
<li><strong>准备源代码</strong></li>
<li><strong>配置内核</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">make oldconfig    <span class="comment"># 基于旧配置更新</span></span><br><span class="line">make menuconfig  <span class="comment"># 文本界面配置</span></span><br><span class="line">make xconfig     <span class="comment"># Qt图形界面配置</span></span><br><span class="line">make gconfig     <span class="comment"># GTK图形界面配置</span></span><br></pre></td></tr></table></figure>
</li>
<li><strong>编译内核</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make           <span class="comment"># 编译内核和模块</span></span><br><span class="line">make bzImage   <span class="comment"># 仅编译内核</span></span><br><span class="line">make modules   <span class="comment"># 仅编译模块</span></span><br></pre></td></tr></table></figure>
</li>
<li><strong>安装组件</strong>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make modules_install  <span class="comment"># 安装模块到/lib/modules/</span></span><br><span class="line">make install          <span class="comment"># 自动安装内核</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="手动安装示例">手动安装示例</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制内核文件</span></span><br><span class="line"><span class="built_in">cp</span> <span class="built_in">arch</span>/x86/boot/bzImage /boot/vmlinuz-2.6.32</span><br><span class="line"><span class="built_in">cp</span> System.map /boot/System.map-2.6.32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建链接</span></span><br><span class="line"><span class="built_in">ln</span> -s /boot/vmlinuz-2.6.32 /boot/vmlinuz</span><br><span class="line"><span class="built_in">ln</span> -s /boot/System.map-2.6.32 /boot/System.map</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成initramfs</span></span><br><span class="line">mkinitramfs -o /boot/initrd-2.6.32.img 2.6.32</span><br></pre></td></tr></table></figure>
<h3 id="其他make目标">其他make目标</h3>
<table>
<thead>
<tr>
<th>目标</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>clean</td>
<td>清除编译文件</td>
</tr>
<tr>
<td>mrproper</td>
<td>彻底清除(含配置)</td>
</tr>
<tr>
<td>rpm-pkg</td>
<td>生成RPM包</td>
</tr>
<tr>
<td>deb-pkg</td>
<td>生成Debian包</td>
</tr>
</tbody>
</table>
<h2 id="4-内核参数调优">4. 内核参数调优</h2>
<h3 id="proc-sys-关键参数">/proc/sys 关键参数</h3>
<table>
<thead>
<tr>
<th>路径</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>kernel/ctrl-alt-del</td>
<td>Ctrl+Alt+Del行为</td>
</tr>
<tr>
<td>kernel/shmall</td>
<td>共享内存页数上限</td>
</tr>
<tr>
<td>kernel/shmmax</td>
<td>共享内存段最大大小</td>
</tr>
<tr>
<td>net/ipv4/ip_forward</td>
<td>IP转发开关(1/0)</td>
</tr>
<tr>
<td>fs/file-max</td>
<td>系统最大文件句柄数</td>
</tr>
</tbody>
</table>
<h3 id="sysctl-工具">sysctl 工具</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl [选项] [参数=值]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示所有可用参数</td>
</tr>
<tr>
<td>-p</td>
<td>从/etc/sysctl.conf加载配置</td>
</tr>
<tr>
<td>-w</td>
<td>临时修改参数</td>
</tr>
</tbody>
</table>
<h3 id="initramfs-管理">initramfs 管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建initramfs</span></span><br><span class="line">mkinitramfs -o initrd.img 3.16.0-4-amd64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压分析</span></span><br><span class="line"><span class="built_in">mkdir</span> initrd &amp;&amp; <span class="built_in">cd</span> initrd</span><br><span class="line">zcat ../initrd.img | cpio -<span class="built_in">id</span></span><br></pre></td></tr></table></figure>
<h2 id="5-内核调试与设备管理">5. 内核调试与设备管理</h2>
<h3 id="proc-关键文件">/proc 关键文件</h3>
<table>
<thead>
<tr>
<th>文件</th>
<th>内容说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/proc/cpuinfo</td>
<td>CPU详细信息</td>
</tr>
<tr>
<td>/proc/meminfo</td>
<td>内存使用情况</td>
</tr>
<tr>
<td>/proc/modules</td>
<td>已加载模块列表</td>
</tr>
<tr>
<td>/proc/partitions</td>
<td>分区信息</td>
</tr>
</tbody>
</table>
<h3 id="硬件信息工具">硬件信息工具</h3>
<h4 id="lspci">lspci</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci [选项]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-vv</td>
<td>超详细输出</td>
</tr>
<tr>
<td>-t</td>
<td>树状显示设备层级</td>
</tr>
</tbody>
</table>
<h4 id="lsusb">lsusb</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsusb [选项]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-v</td>
<td>详细输出设备描述符</td>
</tr>
<tr>
<td>-t</td>
<td>树状显示USB设备拓扑</td>
</tr>
</tbody>
</table>
<h3 id="udev-设备管理">udev 设备管理</h3>
<h4 id="规则文件示例">规则文件示例</h4>
<p><code>/etc/udev/rules.d/70-persistent-net.rules</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, </span><br><span class="line">ATTR&#123;address&#125;==&quot;08:00:27:aa:11:3c&quot;, NAME=&quot;eth0&quot;</span><br></pre></td></tr></table></figure>
<h4 id="udevadm-工具">udevadm 工具</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udevadm info [选项]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示父设备属性</td>
</tr>
<tr>
<td>-n</td>
<td>指定设备节点路径</td>
</tr>
</tbody>
</table>
<h4 id="实时监控">实时监控</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udevadm monitor</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/11/08/linux/12-%E5%86%85%E6%A0%B8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/11/07/linux/11-%E6%80%A7%E8%83%BD%E6%B5%8B%E5%AE%9A/"
                            aria-label=": 11.性能测定"
                        >
                            11.性能测定
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-11-07T21:06:24+08:00">
	
		    2020 年 11 月 7 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-top-命令-实时进程监控">1. top 命令 - 实时进程监控</h2>
<h3 id="基本用法">基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top [选项]</span><br></pre></td></tr></table></figure>
<h3 id="常用选项">常用选项</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-b</td>
<td>批处理模式（非交互式）</td>
</tr>
<tr>
<td>-d 秒</td>
<td>设置刷新间隔时间</td>
</tr>
<tr>
<td>-n 次数</td>
<td>指定刷新次数后退出</td>
</tr>
<tr>
<td>-u 用户</td>
<td>只显示指定用户的进程</td>
</tr>
<tr>
<td>-p PID</td>
<td>只监控指定PID的进程</td>
</tr>
</tbody>
</table>
<h3 id="显示字段说明">显示字段说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>PID</td>
<td>进程ID</td>
</tr>
<tr>
<td>PPID</td>
<td>父进程ID</td>
</tr>
<tr>
<td>USER</td>
<td>进程所有者</td>
</tr>
<tr>
<td>RUSER</td>
<td>实际用户名</td>
</tr>
<tr>
<td>UID</td>
<td>用户ID</td>
</tr>
<tr>
<td>GROUP</td>
<td>所属组</td>
</tr>
<tr>
<td>PR</td>
<td>优先级</td>
</tr>
<tr>
<td>NI</td>
<td>nice值</td>
</tr>
<tr>
<td>VIRT</td>
<td>虚拟内存使用量(KB)</td>
</tr>
<tr>
<td>RES</td>
<td>物理内存使用量(KB)</td>
</tr>
<tr>
<td>SHR</td>
<td>共享内存大小(KB)</td>
</tr>
<tr>
<td>S</td>
<td>进程状态</td>
</tr>
<tr>
<td>TTY</td>
<td>关联终端</td>
</tr>
<tr>
<td>%CPU</td>
<td>CPU使用率</td>
</tr>
<tr>
<td>%MEM</td>
<td>内存使用率</td>
</tr>
<tr>
<td>TIME+</td>
<td>CPU占用时间累计</td>
</tr>
<tr>
<td>COMMAND</td>
<td>执行的命令</td>
</tr>
</tbody>
</table>
<h3 id="交互式操作">交互式操作</h3>
<table>
<thead>
<tr>
<th>按键</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>空格/Enter</td>
<td>立即刷新</td>
</tr>
<tr>
<td>f</td>
<td>选择显示字段</td>
</tr>
<tr>
<td>o</td>
<td>修改排序字段</td>
</tr>
<tr>
<td>l</td>
<td>切换负载显示</td>
</tr>
<tr>
<td>m</td>
<td>切换内存显示</td>
</tr>
<tr>
<td>u</td>
<td>筛选用户进程</td>
</tr>
<tr>
<td>t</td>
<td>切换CPU状态显示</td>
</tr>
<tr>
<td>P</td>
<td>按CPU%排序</td>
</tr>
<tr>
<td>M</td>
<td>按内存%排序</td>
</tr>
<tr>
<td>N</td>
<td>按PID排序</td>
</tr>
<tr>
<td>T</td>
<td>按运行时间排序</td>
</tr>
<tr>
<td>W</td>
<td>保存当前配置</td>
</tr>
<tr>
<td>k</td>
<td>结束进程</td>
</tr>
<tr>
<td>h/?</td>
<td>帮助信息</td>
</tr>
<tr>
<td>q</td>
<td>退出程序</td>
</tr>
<tr>
<td>A</td>
<td>切换显示模式</td>
</tr>
<tr>
<td>d/s</td>
<td>修改刷新间隔</td>
</tr>
<tr>
<td>&lt;/&gt;</td>
<td>切换排序顺序</td>
</tr>
</tbody>
</table>
<h2 id="2-vmstat-系统资源监控">2. vmstat - 系统资源监控</h2>
<h3 id="基本用法-2">基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat [刷新间隔(秒)] [刷新次数]</span><br></pre></td></tr></table></figure>
<h3 id="输出字段说明">输出字段说明</h3>
<table>
<thead>
<tr>
<th>类别</th>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>procs</td>
<td>r</td>
<td>运行队列中的进程数（若持续超过CPU核心数表示CPU瓶颈）</td>
</tr>
<tr>
<td></td>
<td>b</td>
<td>等待I/O的进程数</td>
</tr>
<tr>
<td>memory</td>
<td>swpd</td>
<td>使用的swap空间大小</td>
</tr>
<tr>
<td></td>
<td>free</td>
<td>空闲内存</td>
</tr>
<tr>
<td></td>
<td>buff</td>
<td>用作buffer的内存</td>
</tr>
<tr>
<td></td>
<td>cache</td>
<td>用作cache的内存</td>
</tr>
<tr>
<td>swap</td>
<td>si</td>
<td>每秒从swap读入内存量</td>
</tr>
<tr>
<td></td>
<td>so</td>
<td>每秒从内存写入swap量</td>
</tr>
<tr>
<td>io</td>
<td>bi</td>
<td>块设备每秒接收的块数</td>
</tr>
<tr>
<td></td>
<td>bo</td>
<td>块设备每秒发送的块数</td>
</tr>
<tr>
<td>system</td>
<td>in</td>
<td>每秒中断数</td>
</tr>
<tr>
<td></td>
<td>cs</td>
<td>每秒上下文切换数</td>
</tr>
<tr>
<td>cpu</td>
<td>us</td>
<td>用户空间CPU时间占比</td>
</tr>
<tr>
<td></td>
<td>sy</td>
<td>内核空间CPU时间占比</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>CPU空闲时间占比</td>
</tr>
<tr>
<td></td>
<td>wa</td>
<td>I/O等待时间占比</td>
</tr>
<tr>
<td></td>
<td>st</td>
<td>虚拟机偷取时间占比</td>
</tr>
</tbody>
</table>
<h2 id="3-iostat-I-O监控">3. iostat - I/O监控</h2>
<h3 id="基本用法-3">基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat [选项] [间隔秒数] [次数]</span><br></pre></td></tr></table></figure>
<h3 id="常用选项-2">常用选项</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-c</td>
<td>只显示CPU统计</td>
</tr>
<tr>
<td>-d</td>
<td>只显示磁盘统计</td>
</tr>
<tr>
<td>-k</td>
<td>以KB为单位显示</td>
</tr>
<tr>
<td>-t</td>
<td>显示时间戳</td>
</tr>
</tbody>
</table>
<h3 id="CPU统计字段">CPU统计字段</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>%user</td>
<td>用户进程CPU占比</td>
</tr>
<tr>
<td>%nice</td>
<td>调整优先级进程的CPU占比</td>
</tr>
<tr>
<td>%system</td>
<td>内核CPU占比</td>
</tr>
<tr>
<td>%iowait</td>
<td>I/O等待占比</td>
</tr>
<tr>
<td>%steal</td>
<td>虚拟机占用占比</td>
</tr>
<tr>
<td>%idle</td>
<td>空闲占比</td>
</tr>
</tbody>
</table>
<h3 id="磁盘统计字段">磁盘统计字段</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tps</td>
<td>每秒I/O请求数</td>
</tr>
<tr>
<td>Blk_read/s</td>
<td>每秒读取块数</td>
</tr>
<tr>
<td>Blk_wrtn/s</td>
<td>每秒写入块数</td>
</tr>
<tr>
<td>Blk_read</td>
<td>总读取块数</td>
</tr>
<tr>
<td>Blk_wrtn</td>
<td>总写入块数</td>
</tr>
</tbody>
</table>
<h2 id="4-sar-系统活动报告">4. sar - 系统活动报告</h2>
<h3 id="基本用法-4">基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar [选项] [-s 开始时间] [-e 结束时间] [-f 日志文件] [间隔] [次数]</span><br></pre></td></tr></table></figure>
<h3 id="常用选项-3">常用选项</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-A</td>
<td>显示所有报告</td>
</tr>
<tr>
<td>-b</td>
<td>I/O和传输速率统计</td>
</tr>
<tr>
<td>-c</td>
<td>进程创建统计</td>
</tr>
<tr>
<td>-f 文件</td>
<td>指定日志文件</td>
</tr>
<tr>
<td>-n DEV</td>
<td>网络设备统计</td>
</tr>
<tr>
<td>-n EDEV</td>
<td>网络错误统计</td>
</tr>
<tr>
<td>-r</td>
<td>内存和swap统计</td>
</tr>
<tr>
<td>-u</td>
<td>CPU利用率</td>
</tr>
<tr>
<td>-P ALL</td>
<td>每个CPU核心统计</td>
</tr>
<tr>
<td>-R</td>
<td>内存统计</td>
</tr>
<tr>
<td>-W</td>
<td>swap统计</td>
</tr>
</tbody>
</table>
<h3 id="详细字段说明">详细字段说明</h3>
<h4 id="sar-b-I-O统计">sar -b (I/O统计)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tps</td>
<td>每秒I/O请求数</td>
</tr>
<tr>
<td>rtps</td>
<td>每秒读请求数</td>
</tr>
<tr>
<td>wtps</td>
<td>每秒写请求数</td>
</tr>
<tr>
<td>bread/s</td>
<td>每秒读取块数</td>
</tr>
<tr>
<td>bwrtn/s</td>
<td>每秒写入块数</td>
</tr>
</tbody>
</table>
<h4 id="sar-n-DEV-网络统计">sar -n DEV (网络统计)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>IFACE</td>
<td>网络接口名</td>
</tr>
<tr>
<td>rxpck/s</td>
<td>每秒接收包数</td>
</tr>
<tr>
<td>txpck/s</td>
<td>每秒发送包数</td>
</tr>
<tr>
<td>rxkB/s</td>
<td>每秒接收KB数</td>
</tr>
<tr>
<td>txkB/s</td>
<td>每秒发送KB数</td>
</tr>
</tbody>
</table>
<h4 id="sar-r-内存统计">sar -r (内存统计)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>kbmemfree</td>
<td>空闲内存(KB)</td>
</tr>
<tr>
<td>kbmemused</td>
<td>已用内存(KB)</td>
</tr>
<tr>
<td>%memused</td>
<td>内存使用率</td>
</tr>
<tr>
<td>kbbuffers</td>
<td>buffer使用量(KB)</td>
</tr>
<tr>
<td>kbcached</td>
<td>cache使用量(KB)</td>
</tr>
</tbody>
</table>
<h2 id="5-系统负载命令">5. 系统负载命令</h2>
<h3 id="uptime">uptime</h3>
<p>显示：</p>
<ol>
<li>系统运行时间</li>
<li>登录用户数</li>
<li>1/5/15分钟平均负载</li>
</ol>
<h3 id="w-命令">w 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w [选项] [用户名]</span><br></pre></td></tr></table></figure>
<h4 id="选项">选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h</td>
<td>不显示标题</td>
</tr>
<tr>
<td>-s</td>
<td>精简格式(不显示登录时间/JCPU/PCPU)</td>
</tr>
</tbody>
</table>
<h4 id="输出字段">输出字段</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>USER</td>
<td>用户名</td>
</tr>
<tr>
<td>TTY</td>
<td>终端名</td>
</tr>
<tr>
<td>FROM</td>
<td>远程主机</td>
</tr>
<tr>
<td>LOGIN@</td>
<td>登录时间</td>
</tr>
<tr>
<td>IDLE</td>
<td>空闲时间</td>
</tr>
<tr>
<td>JCPU</td>
<td>该终端所有进程CPU时间</td>
</tr>
<tr>
<td>PCPU</td>
<td>当前进程CPU时间</td>
</tr>
<tr>
<td>WHAT</td>
<td>正在执行的命令</td>
</tr>
</tbody>
</table>
<h2 id="6-进程监控">6. 进程监控</h2>
<h3 id="ps-命令">ps 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps [选项]</span><br></pre></td></tr></table></figure>
<h4 id="常用选项-4">常用选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>e</td>
<td>显示环境变量</td>
</tr>
<tr>
<td>x</td>
<td>包括无终端进程</td>
</tr>
<tr>
<td>u</td>
<td>显示用户信息</td>
</tr>
<tr>
<td>r</td>
<td>只显示运行中进程</td>
</tr>
<tr>
<td>l</td>
<td>长格式显示</td>
</tr>
<tr>
<td>U 用户</td>
<td>筛选指定用户</td>
</tr>
<tr>
<td>-C 命令</td>
<td>筛选指定命令</td>
</tr>
<tr>
<td>-e</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>-f</td>
<td>完整格式显示</td>
</tr>
<tr>
<td>-l</td>
<td>长格式显示</td>
</tr>
<tr>
<td>-p PID</td>
<td>筛选指定PID</td>
</tr>
<tr>
<td>-t tty</td>
<td>筛选指定终端</td>
</tr>
</tbody>
</table>
<h4 id="显示字段">显示字段</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>USER</td>
<td>用户名</td>
</tr>
<tr>
<td>PID</td>
<td>进程ID</td>
</tr>
<tr>
<td>PPID</td>
<td>父进程ID</td>
</tr>
<tr>
<td>%CPU</td>
<td>CPU使用率</td>
</tr>
<tr>
<td>%MEM</td>
<td>内存使用率</td>
</tr>
<tr>
<td>VSZ</td>
<td>虚拟内存大小</td>
</tr>
<tr>
<td>RSS</td>
<td>物理内存大小</td>
</tr>
<tr>
<td>TTY</td>
<td>关联终端</td>
</tr>
<tr>
<td>STAT</td>
<td>进程状态</td>
</tr>
<tr>
<td>START</td>
<td>启动时间</td>
</tr>
<tr>
<td>TIME</td>
<td>CPU占用时间</td>
</tr>
<tr>
<td>COMMAND</td>
<td>执行的命令</td>
</tr>
</tbody>
</table>
<h3 id="其他进程工具">其他进程工具</h3>
<ul>
<li><code>pstree</code>：以树状显示进程关系</li>
<li><code>lsof</code>：列出打开的文件</li>
</ul>
<h2 id="7-内存监控">7. 内存监控</h2>
<h3 id="free-命令">free 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free [选项]</span><br></pre></td></tr></table></figure>
<h4 id="选项-2">选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-b</td>
<td>以字节显示</td>
</tr>
<tr>
<td>-k</td>
<td>以KB显示(默认)</td>
</tr>
<tr>
<td>-m</td>
<td>以MB显示</td>
</tr>
<tr>
<td>-t</td>
<td>显示总计行</td>
</tr>
<tr>
<td>-o</td>
<td>不显示buffer行</td>
</tr>
<tr>
<td>-s 秒</td>
<td>持续监控间隔</td>
</tr>
</tbody>
</table>
<h4 id="输出字段-2">输出字段</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>总内存量</td>
</tr>
<tr>
<td>used</td>
<td>已用量(含buffer/cache)</td>
</tr>
<tr>
<td>free</td>
<td>空闲量(含buffer/cache)</td>
</tr>
<tr>
<td>shared</td>
<td>共享内存</td>
</tr>
<tr>
<td>buffers</td>
<td>buffer缓存</td>
</tr>
<tr>
<td>cached</td>
<td>page cache</td>
</tr>
<tr>
<td>-/+ buffers/cache</td>
<td>实际内存使用</td>
</tr>
<tr>
<td>used</td>
<td>不含buffer/cache的用量</td>
</tr>
<tr>
<td>free</td>
<td>含buffer/cache的空闲量</td>
</tr>
</tbody>
</table>
<h2 id="8-磁盘与网络监控">8. 磁盘与网络监控</h2>
<h3 id="df-命令">df 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> [选项] [目录]</span><br></pre></td></tr></table></figure>
<h4 id="选项-3">选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示所有文件系统</td>
</tr>
<tr>
<td>-h</td>
<td>人性化显示(1024进制)</td>
</tr>
<tr>
<td>-H</td>
<td>人性化显示(1000进制)</td>
</tr>
<tr>
<td>-i</td>
<td>显示inode信息</td>
</tr>
<tr>
<td>-l</td>
<td>只显示本地文件系统</td>
</tr>
<tr>
<td>-m</td>
<td>以MB为单位显示</td>
</tr>
</tbody>
</table>
<h3 id="网络测试工具">网络测试工具</h3>
<ul>
<li><code>netserver</code>：启动测试服务(监听12865端口)</li>
<li><code>netperf</code>：网络性能测试客户端</li>
</ul>
<h2 id="9-高级监控系统">9. 高级监控系统</h2>
<h3 id="collectd">collectd</h3>
<p>监控项目包括：</p>
<ul>
<li>CPU使用率</li>
<li>系统温度和风扇状态</li>
<li>进程状态</li>
<li>网络流量和延迟</li>
<li>Web服务器状态(APACHE/Nginx)</li>
<li>DNS服务器状态</li>
<li>数据库状态</li>
<li>SWAP使用情况</li>
<li>用户登录情况</li>
</ul>
<h3 id="Nagios">Nagios</h3>
<p>功能特点：</p>
<ul>
<li>网络服务监控</li>
<li>系统资源监控</li>
<li>基于Web的监控界面</li>
<li>邮件/SMS告警通知</li>
<li>自定义事件处理</li>
<li>日志自动轮转</li>
<li>支持分层主机结构</li>
</ul>
<h3 id="可视化工具">可视化工具</h3>
<ul>
<li><strong>MRTG</strong>：网络流量可视化</li>
<li><strong>Cacti</strong>：MRTG的增强替代品，提供更丰富的监控功能</li>
</ul>
<pre><code></code></pre>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/11/07/linux/11-%E6%80%A7%E8%83%BD%E6%B5%8B%E5%AE%9A/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/06/24/linux/10-%E5%AE%89%E5%85%A8/"
                            aria-label=": 10.安全"
                        >
                            10.安全
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-06-24T21:06:24+08:00">
	
		    2020 年 6 月 24 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>守护进程管理与系统安全笔记整理</h1>
<h2 id="守护进程管理">守护进程管理</h2>
<h3 id="Super-Server-超级服务器">Super Server (超级服务器)</h3>
<ul>
<li><strong>作用</strong>：代替其他服务监视服务请求，建立连接后转交给实际服务处理</li>
<li><strong>优势</strong>：降低系统负载，不需要为每个服务都启动独立进程</li>
</ul>
<h3 id="inetd-Internet-Daemon">inetd (Internet Daemon)</h3>
<ul>
<li>传统的超级服务器守护进程</li>
<li>配置文件：<code>/etc/inetd.conf</code></li>
</ul>
<h4 id="inetd-conf-字段说明">inetd.conf 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_name</td>
<td><code>/etc/services</code>中定义的服务名</td>
</tr>
<tr>
<td>socket_type</td>
<td>socket类型(TCP=stream, UDP=dgram)</td>
</tr>
<tr>
<td>protocol</td>
<td>协议类型(通常TCP/UDP)</td>
</tr>
<tr>
<td>flags</td>
<td>请求处理方式(wait=等待处理完成, nowait=立即处理下一个)</td>
</tr>
<tr>
<td>user</td>
<td>执行用户</td>
</tr>
<tr>
<td>program</td>
<td>程序绝对路径</td>
</tr>
<tr>
<td>args</td>
<td>转发参数</td>
</tr>
</tbody>
</table>
<h4 id="重启inetd">重启inetd</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -HUP inetd的PID</span><br><span class="line">killall -HUP inetd</span><br><span class="line">/etc/init.d/inetd restart</span><br></pre></td></tr></table></figure>
<h3 id="TCP-Wrapper">TCP Wrapper</h3>
<ul>
<li>访问控制机制，检查顺序：
<ol>
<li>先查<code>/etc/hosts.allow</code> → 匹配则允许</li>
<li>再查<code>/etc/hosts.deny</code> → 匹配则拒绝</li>
<li>都不匹配则允许</li>
</ol>
</li>
</ul>
<h4 id="通配符说明">通配符说明</h4>
<table>
<thead>
<tr>
<th>通配符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALL</td>
<td>所有服务和主机</td>
</tr>
<tr>
<td>A EXCEPT B</td>
<td>除B以外的A</td>
</tr>
<tr>
<td>LOCAL</td>
<td>本地主机(不含.)</td>
</tr>
<tr>
<td>PARANOID</td>
<td>主机名与DNS解析IP不一致的情况</td>
</tr>
</tbody>
</table>
<h4 id="示例配置">示例配置</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">in.telnetd: .lpic.jp  # 允许lpic.jp域访问telnet</span><br><span class="line">ALL: 192.168.2.      # 允许192.168.2.x网段所有服务</span><br></pre></td></tr></table></figure>
<h3 id="xinetd-扩展的inetd">xinetd (扩展的inetd)</h3>
<ul>
<li>更安全的超级服务器，支持分服务配置</li>
<li>主配置文件：<code>/etc/xinetd.conf</code></li>
<li>服务配置文件：<code>/etc/xinetd.d/</code></li>
</ul>
<h4 id="xinetd-conf-主要参数">xinetd.conf 主要参数</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">default</span><br><span class="line">&#123;</span><br><span class="line">    instance = 60               <span class="comment"># 最大守护进程数</span></span><br><span class="line">    log_type = SYSLOG authpriv  <span class="comment"># 日志类型</span></span><br><span class="line">    log_on_success = HOST PID   <span class="comment"># 成功日志内容</span></span><br><span class="line">    log_on_failure = HOST       <span class="comment"># 失败日志内容</span></span><br><span class="line">    cps = 25 30                 <span class="comment"># 每秒最大连接数(超限后暂停30秒)</span></span><br><span class="line">&#125;</span><br><span class="line">includedir /etc/xinetd.d        <span class="comment"># 包含服务配置目录</span></span><br></pre></td></tr></table></figure>
<h4 id="服务配置示例-telnet">服务配置示例(telnet)</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">service telnet</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">disable</span> = no</span><br><span class="line">    socket_type = stream</span><br><span class="line">    <span class="built_in">wait</span> = no</span><br><span class="line">    user = root</span><br><span class="line">    server = /usr/sbin/in.telnetd</span><br><span class="line">    log_on_failure += USERID</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="重启xinetd">重启xinetd</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/xinetd restart</span><br></pre></td></tr></table></figure>
<h2 id="端口安全">端口安全</h2>
<h3 id="检查开放端口">检查开放端口</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -atun       <span class="comment"># 显示所有TCP/UDP端口</span></span><br><span class="line">lsof -i -n          <span class="comment"># 查看网络连接</span></span><br><span class="line">lsof -i :22         <span class="comment"># 查看指定端口</span></span><br><span class="line">lsof -c ssh         <span class="comment"># 查看指定进程</span></span><br></pre></td></tr></table></figure>
<h3 id="nmap-扫描">nmap 扫描</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 目标主机       <span class="comment"># 扫描主机开放端口</span></span><br></pre></td></tr></table></figure>
<h3 id="查找特殊权限文件">查找特殊权限文件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u+s -<span class="built_in">ls</span>   <span class="comment"># 查找SUID文件</span></span><br><span class="line">find / -perm -g+s -<span class="built_in">ls</span>   <span class="comment"># 查找SGID文件</span></span><br><span class="line">find / -perm -o+t -<span class="built_in">ls</span>   <span class="comment"># 查找sticky bit文件</span></span><br></pre></td></tr></table></figure>
<h2 id="用户安全">用户安全</h2>
<h3 id="密码有效期设置-chage">密码有效期设置(chage)</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chage [选项] 用户名</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-l</td>
<td>显示有效期</td>
</tr>
<tr>
<td>-m 天数</td>
<td>密码最小使用天数</td>
</tr>
<tr>
<td>-M 天数</td>
<td>密码最大有效期</td>
</tr>
<tr>
<td>-d 日期</td>
<td>最后修改日期</td>
</tr>
<tr>
<td>-W 天数</td>
<td>密码过期前警告天数</td>
</tr>
<tr>
<td>-I 天数</td>
<td>密码过期后锁定前天数</td>
</tr>
<tr>
<td>-E 日期</td>
<td>账号失效日期</td>
</tr>
</tbody>
</table>
<h3 id="禁止登录方法">禁止登录方法</h3>
<ol>
<li>创建<code>/etc/nologin</code>文件：禁止所有非root用户登录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /etc/nologin</span><br></pre></td></tr></table></figure>
</li>
<li>修改用户shell：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -s /sbin/nologin 用户名  <span class="comment"># 禁止指定用户登录</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="su-sudo">su/sudo</h3>
<h4 id="su-切换用户">su (切换用户)</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - 用户名   <span class="comment"># 完全切换(加载环境变量)</span></span><br><span class="line">su 用户名     <span class="comment"># 部分切换(保留当前环境)</span></span><br></pre></td></tr></table></figure>
<h4 id="sudo-超级用户权限">sudo (超级用户权限)</h4>
<ul>
<li>配置文件：<code>/etc/sudoers</code> (使用<code>visudo</code>编辑)</li>
<li>示例配置：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 允许student用户执行shutdown</span></span><br><span class="line">student ALL=(ALL) /sbin/shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许wheel组成员执行所有命令且不输密码</span></span><br><span class="line">%wheel ALL=(ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="资源限制-ulimit">资源限制(ulimit)</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> [选项] [限制值]</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示所有限制</td>
</tr>
<tr>
<td>-c size</td>
<td>核心文件大小</td>
</tr>
<tr>
<td>-f size</td>
<td>最大文件大小</td>
</tr>
<tr>
<td>-n num</td>
<td>打开文件数限制</td>
</tr>
<tr>
<td>-u num</td>
<td>用户最大进程数</td>
</tr>
<tr>
<td>-v size</td>
<td>最大虚拟内存</td>
</tr>
</tbody>
</table>
<h2 id="OpenSSH-安全">OpenSSH 安全</h2>
<h3 id="SSH密钥文件">SSH密钥文件</h3>
<table>
<thead>
<tr>
<th>文件名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssh_host_key</td>
<td>SSH1私钥</td>
</tr>
<tr>
<td>ssh_host_dsa_key</td>
<td>SSH2 DSA私钥</td>
</tr>
<tr>
<td>ssh_host_rsa_key</td>
<td>SSH2 RSA私钥</td>
</tr>
<tr>
<td>*.pub</td>
<td>对应公钥</td>
</tr>
</tbody>
</table>
<h3 id="sshd配置-etc-ssh-sshd-config">sshd配置(/etc/ssh/sshd_config)</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Port</td>
<td>SSH端口(默认22)</td>
</tr>
<tr>
<td>Protocol</td>
<td>SSH版本(1,2)</td>
</tr>
<tr>
<td>HostKey</td>
<td>私钥文件路径</td>
</tr>
<tr>
<td>PermitRootLogin</td>
<td>是否允许root登录</td>
</tr>
<tr>
<td>RSAAuthentication</td>
<td>是否启用SSH1公钥认证</td>
</tr>
<tr>
<td>PubkeyAuthentication</td>
<td>是否启用SSH2公钥认证</td>
</tr>
<tr>
<td>AuthorizedKeysFile</td>
<td>授权公钥文件路径</td>
</tr>
<tr>
<td>PermitEmptyPasswords</td>
<td>是否允许空密码</td>
</tr>
<tr>
<td>PasswordAuthentication</td>
<td>是否启用密码认证</td>
</tr>
<tr>
<td>X11Forwarding</td>
<td>是否允许X11转发</td>
</tr>
</tbody>
</table>
<h3 id="SSH密钥认证流程">SSH密钥认证流程</h3>
<ol>
<li>客户端生成密钥对：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa   <span class="comment"># 生成RSA密钥对</span></span><br></pre></td></tr></table></figure>
</li>
<li>上传公钥到服务器：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id 用户名@服务器</span><br></pre></td></tr></table></figure>
</li>
<li>服务器端公钥存储在：<code>~/.ssh/authorized_keys</code></li>
</ol>
<h3 id="SSH实用命令">SSH实用命令</h3>
<h4 id="scp-安全复制">scp (安全复制)</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp 文件 用户@主机:路径   <span class="comment"># 上传</span></span><br><span class="line">scp -r 目录 用户@主机:路径 <span class="comment"># 递归复制目录</span></span><br></pre></td></tr></table></figure>
<h4 id="ssh-agent-密钥代理">ssh-agent (密钥代理)</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> `ssh-agent`   <span class="comment"># 启动代理</span></span><br><span class="line">ssh-add            <span class="comment"># 添加密钥</span></span><br><span class="line">ssh-add -l         <span class="comment"># 列出已加载密钥</span></span><br></pre></td></tr></table></figure>
<h4 id="端口转发">端口转发</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地端口转发</span></span><br><span class="line">ssh -L 本地端口:远程主机:远程端口 用户@网关</span><br><span class="line"></span><br><span class="line"><span class="comment"># X11转发</span></span><br><span class="line">ssh -X 用户@主机</span><br></pre></td></tr></table></figure>
<h2 id="GnuPG-文件加密">GnuPG 文件加密</h2>
<h3 id="密钥管理">密钥管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-key              <span class="comment"># 生成密钥对</span></span><br><span class="line">gpg --list-keys            <span class="comment"># 列出密钥</span></span><br><span class="line">gpg --<span class="built_in">export</span> -a <span class="string">&quot;用户&quot;</span> &gt; pubkey.asc  <span class="comment"># 导出公钥</span></span><br><span class="line">gpg --import pubkey.asc    <span class="comment"># 导入公钥</span></span><br></pre></td></tr></table></figure>
<h3 id="文件加密-解密">文件加密/解密</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加密文件(给指定用户)</span></span><br><span class="line">gpg -e -a -r 接收者邮件 文件</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密文件</span></span><br><span class="line">gpg 加密文件.asc</span><br></pre></td></tr></table></figure>
<h3 id="密钥吊销">密钥吊销</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-revoke 用户邮件 &gt; revoke.asc  <span class="comment"># 生成吊销证书</span></span><br><span class="line">gpg --import revoke.asc                 <span class="comment"># 导入吊销证书</span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/06/24/linux/10-%E5%AE%89%E5%85%A8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/06/18/linux/9-TCP-IP/"
                            aria-label=": 9.TCP-IP"
                        >
                            9.TCP-IP
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-06-18T19:06:24+08:00">
	
		    2020 年 6 月 18 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>TCP/IP 基础笔记整理</h1>
<h2 id="IPv4-地址分类">IPv4 地址分类</h2>
<h3 id="标准分类">标准分类</h3>
<table>
<thead>
<tr>
<th>类别</th>
<th>IP 地址范围</th>
<th>子网掩码</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>0.0.0.0 ~ 127.255.255.255</td>
<td>255.0.0.0</td>
</tr>
<tr>
<td>B</td>
<td>128.0.0.0 ~ 191.255.255.255</td>
<td>255.255.0.0</td>
</tr>
<tr>
<td>C</td>
<td>192.0.0.0 ~ 223.255.255.255</td>
<td>255.255.255.0</td>
</tr>
</tbody>
</table>
<h3 id="私有地址范围">私有地址范围</h3>
<table>
<thead>
<tr>
<th>类别</th>
<th>IP 地址范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>10.0.0.0 ~ 10.255.255.255</td>
</tr>
<tr>
<td>B</td>
<td>172.16.0.0 ~ 172.31.255.255</td>
</tr>
<tr>
<td>C</td>
<td>192.168.0.0 ~ 192.168.255.255</td>
</tr>
</tbody>
</table>
<h2 id="CIDR-Classless-Inter-Domain-Routing">CIDR (Classless Inter-Domain Routing)</h2>
<ul>
<li>无类别域间路由</li>
<li>允许更灵活的子网划分方式，不再受传统 A/B/C 类限制</li>
</ul>
<h2 id="IPv6">IPv6</h2>
<ul>
<li>128 比特地址，用 16 进制表示，分为 8 个 block</li>
<li>表示规则：
<ol>
<li>每个 block 开头的 0 可以省略</li>
<li>连续的 0 可以用 <code>::</code> 表示，但整个地址中 <code>::</code> 只能出现一次</li>
</ol>
</li>
</ul>
<h3 id="IPv6-地址类型">IPv6 地址类型</h3>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>单播地址 (Unicast)</td>
<td>标识单个接口，类似 IPv4 单播地址</td>
</tr>
<tr>
<td>组播地址 (Multicast)</td>
<td>标识一组接口，类似 IPv4 组播地址</td>
</tr>
<tr>
<td>任播地址 (Anycast)</td>
<td>新增类型，数据包发送给最近的一个接口</td>
</tr>
</tbody>
</table>
<h2 id="端口-Port">端口 (Port)</h2>
<ul>
<li><code>/etc/services</code>：端口与服务对应关系文件</li>
<li>常用端口：</li>
</ul>
<table>
<thead>
<tr>
<th>端口</th>
<th>协议</th>
<th>服务</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td>TCP</td>
<td>FTP</td>
<td>文件传输(数据)</td>
</tr>
<tr>
<td>21</td>
<td>TCP</td>
<td>FTP</td>
<td>文件传输(控制)</td>
</tr>
<tr>
<td>22</td>
<td>TCP</td>
<td>SSH</td>
<td>安全Shell</td>
</tr>
<tr>
<td>23</td>
<td>TCP</td>
<td>Telnet</td>
<td>远程登录</td>
</tr>
<tr>
<td>25</td>
<td>TCP/UDP</td>
<td>SMTP</td>
<td>邮件发送</td>
</tr>
<tr>
<td>53</td>
<td>TCP/UDP</td>
<td>DNS</td>
<td>域名解析</td>
</tr>
<tr>
<td>80</td>
<td>TCP</td>
<td>HTTP</td>
<td>Web服务</td>
</tr>
<tr>
<td>110</td>
<td>TCP</td>
<td>POP3</td>
<td>邮件接收</td>
</tr>
<tr>
<td>119</td>
<td>TCP</td>
<td>NNTP</td>
<td>网络新闻</td>
</tr>
<tr>
<td>139</td>
<td>TCP/UDP</td>
<td>NetBIOS</td>
<td>Windows网络</td>
</tr>
<tr>
<td>143</td>
<td>TCP</td>
<td>IMAP</td>
<td>邮件访问</td>
</tr>
<tr>
<td>161</td>
<td>UDP</td>
<td>SNMP</td>
<td>网络管理</td>
</tr>
<tr>
<td>443</td>
<td>TCP</td>
<td>HTTPS</td>
<td>安全Web</td>
</tr>
<tr>
<td>465</td>
<td>TCP</td>
<td>SMTPS</td>
<td>安全SMTP</td>
</tr>
<tr>
<td>993</td>
<td>TCP</td>
<td>IMAPS</td>
<td>安全IMAP</td>
</tr>
<tr>
<td>995</td>
<td>TCP</td>
<td>POP3S</td>
<td>安全POP3</td>
</tr>
</tbody>
</table>
<h2 id="nsswitch-conf-文件">nsswitch.conf 文件</h2>
<p>控制各种系统数据库的搜索顺序和方法</p>
<h3 id="1-信息类型-Info">1. 信息类型(Info)</h3>
<ul>
<li><code>automount</code>：自动挂载信息</li>
<li><code>bootparams</code>：引导选项</li>
<li><code>ethers</code>：MAC地址</li>
<li><code>group</code>：用户组信息</li>
<li><code>hosts</code>：主机名和IP</li>
<li><code>networks</code>：网络信息</li>
<li><code>passwd</code>：用户信息</li>
<li><code>protocols</code>：网络协议</li>
<li><code>publickey</code>：NIS+/NFS公钥</li>
<li><code>rpc</code>：远程过程调用</li>
<li><code>services</code>：网络服务</li>
<li><code>shadow</code>：用户密码信息</li>
<li><code>aliases</code>：邮件别名</li>
</ul>
<h3 id="2-搜索方法-method">2. 搜索方法(method)</h3>
<ul>
<li><code>files</code>：搜索本地文件</li>
<li><code>nis</code>：搜索NIS数据库</li>
<li><code>dns</code>：查询DNS</li>
<li><code>compat</code>：兼容模式(±语法)</li>
</ul>
<h3 id="3-搜索顺序">3. 搜索顺序</h3>
<p>从左到右依次尝试，先找到的结果优先</p>
<h3 id="4-动作项-action">4. 动作项([action])</h3>
<p>格式：<code>[[!]STATUS=action]</code></p>
<ul>
<li>STATUS：
<ul>
<li><code>NOTFOUND</code>：未找到</li>
<li><code>SUCCESS</code>：成功找到</li>
<li><code>UNAVAIL</code>：永久不可用</li>
<li><code>TRYAGAIN</code>：临时不可用</li>
</ul>
</li>
<li>action：
<ul>
<li><code>return</code>：返回结果</li>
<li><code>continue</code>：继续尝试下个方法</li>
</ul>
</li>
</ul>
<h3 id="5-compat方法">5. compat方法</h3>
<p>在passwd/group/shadow文件中使用<code>+</code>和<code>-</code>来合并NIS信息</p>
<h2 id="网络故障排除命令">网络故障排除命令</h2>
<h3 id="ping">ping</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping 主机名或IP地址</span><br><span class="line">ping -c 次数 目标  <span class="comment"># 指定发送次数</span></span><br><span class="line">ping -i 间隔 目标  <span class="comment"># 指定发送间隔</span></span><br></pre></td></tr></table></figure>
<ul>
<li>TTL：ICMP包最大生存时间</li>
<li>time：响应时间</li>
</ul>
<h3 id="traceroute-tracepath">traceroute/tracepath</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">traceroute 主机名或IP地址</span><br><span class="line">tracepath 主机名或IP地址 [端口]</span><br></pre></td></tr></table></figure>
<ul>
<li>显示到达目标的路径</li>
</ul>
<h3 id="host">host</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host [选项] 主机名或IP [DNS服务器]</span><br><span class="line">host -v 目标  <span class="comment"># 显示详细信息</span></span><br></pre></td></tr></table></figure>
<ul>
<li>查询DNS信息</li>
</ul>
<h3 id="hostname">hostname</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostname  <span class="comment"># 显示当前主机名</span></span><br><span class="line">hostname 新主机名  <span class="comment"># 设置主机名</span></span><br></pre></td></tr></table></figure>
<h3 id="netstat">netstat</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">netstat -a  <span class="comment"># 显示所有socket</span></span><br><span class="line">netstat -c  <span class="comment"># 实时更新</span></span><br><span class="line">netstat -i  <span class="comment"># 显示接口状态</span></span><br><span class="line">netstat -n  <span class="comment"># 显示数字地址</span></span><br><span class="line">netstat -p  <span class="comment"># 显示PID/进程名</span></span><br><span class="line">netstat -r  <span class="comment"># 显示路由表</span></span><br><span class="line">netstat -t  <span class="comment"># 只显示TCP</span></span><br><span class="line">netstat -u  <span class="comment"># 只显示UDP</span></span><br></pre></td></tr></table></figure>
<h3 id="route">route</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">route  <span class="comment"># 显示路由表</span></span><br><span class="line">route add -net 目标网络 netmask 子网掩码 gw 网关</span><br><span class="line">route add default gw 默认网关</span><br><span class="line">route del -net 目标网络</span><br></pre></td></tr></table></figure>
<p>路由表字段说明：</p>
<ul>
<li>Destination：目标网络/主机</li>
<li>Gateway：网关</li>
<li>Genmask：子网掩码</li>
<li>Flags：标志(U=有效,H=主机,G=网关)</li>
<li>Metric：距离</li>
<li>Ref：引用数</li>
<li>Use：使用计数</li>
<li>Iface：接口</li>
</ul>
<h3 id="ifconfig">ifconfig</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig 接口名 IP地址 netmask 子网掩码</span><br><span class="line">ifconfig 接口名 up/down  <span class="comment"># 启用/禁用接口</span></span><br></pre></td></tr></table></figure>
<h3 id="ifup-ifdown">ifup/ifdown</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifup 接口名  <span class="comment"># 启用接口</span></span><br><span class="line">ifdown 接口名  <span class="comment"># 禁用接口</span></span><br></pre></td></tr></table></figure>
<h2 id="网络服务命令">网络服务命令</h2>
<h3 id="telnet">telnet</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 主机 [端口]  <span class="comment"># 默认端口23</span></span><br></pre></td></tr></table></figure>
<h3 id="ftp">ftp</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ftp 主机</span><br><span class="line"><span class="comment"># 常用命令：</span></span><br><span class="line"><span class="built_in">ls</span>      <span class="comment"># 列出远程文件</span></span><br><span class="line"><span class="built_in">pwd</span>     <span class="comment"># 显示远程当前目录</span></span><br><span class="line">get     <span class="comment"># 下载文件</span></span><br><span class="line">mget    <span class="comment"># 下载多个文件</span></span><br><span class="line">put     <span class="comment"># 上传文件</span></span><br><span class="line">ascii   <span class="comment"># ASCII传输模式</span></span><br><span class="line">binary  <span class="comment"># 二进制传输模式</span></span><br><span class="line">quit    <span class="comment"># 退出</span></span><br></pre></td></tr></table></figure>
<h3 id="dig">dig</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dig [选项] @DNS服务器 主机名 域名 [查询类型]</span><br><span class="line">dig -x IP地址  <span class="comment"># 反向查询</span></span><br><span class="line"><span class="comment"># 查询类型：</span></span><br><span class="line">a    <span class="comment"># IP地址</span></span><br><span class="line">any  <span class="comment"># 所有信息</span></span><br><span class="line">mx   <span class="comment"># 邮件服务器</span></span><br><span class="line">ns   <span class="comment"># 名称服务器</span></span><br></pre></td></tr></table></figure>
<h3 id="whois">whois</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whois 目标 [@whois服务器]</span><br></pre></td></tr></table></figure>
<ul>
<li>查询域名注册信息</li>
</ul>
<h2 id="网络配置文件">网络配置文件</h2>
<h3 id="etc-hostname">/etc/hostname</h3>
<ul>
<li>存储主机名</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windsor.lpic.jp</span><br></pre></td></tr></table></figure>
<h3 id="etc-hosts">/etc/hosts</h3>
<ul>
<li>主机名与IP映射</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 localhost.localdomain localhost</span><br><span class="line">192.168.0.1 windsor.example.com windsor</span><br></pre></td></tr></table></figure>
<h3 id="etc-nsswitch-conf">/etc/nsswitch.conf</h3>
<ul>
<li>名称服务切换配置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hosts: files ldap dns  # 先查本地文件，再LDAP，最后DNS</span><br></pre></td></tr></table></figure>
<h3 id="etc-resolv-conf">/etc/resolv.conf</h3>
<ul>
<li>DNS配置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">domain lpic.jp</span><br><span class="line">search lpic.jp</span><br><span class="line">nameserver 192.168.1.253</span><br><span class="line">nameserver 192.168.1.2</span><br></pre></td></tr></table></figure>
<h3 id="etc-sysconfig-network">/etc/sysconfig/network</h3>
<ul>
<li>基本网络设置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NETWORKING=YES</span><br><span class="line">HOSTNAME=lpic.example.net</span><br><span class="line">GATEWAY=192.168.0.254</span><br></pre></td></tr></table></figure>
<h3 id="etc-sysconfig-network-scripts">/etc/sysconfig/network-scripts/</h3>
<ul>
<li>网络接口配置文件(如ifcfg-eth0)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth0</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=192.168.0.6</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">NETWORK=192.168.0.0</span><br><span class="line">BROADCAST=192.168.0.255</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/06/18/linux/9-TCP-IP/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/24/linux/8-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/"
                            aria-label=": 8.系统管理"
                        >
                            8.系统管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-24T20:06:24+08:00">
	
		    2020 年 5 月 24 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>Linux 用户、群组与系统管理</h1>
<h2 id="1-用户和群组管理">1. 用户和群组管理</h2>
<h3 id="1-1-用户配置文件">1.1 用户配置文件</h3>
<h4 id="etc-passwd-文件格式">/etc/passwd 文件格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lpic:x:500:500:LPI linux:/home/lpic:/bin/bash</span><br><span class="line">↑    ↑ ↑   ↑   ↑         ↑          ↑</span><br><span class="line">│    │ │   │   │         │          └─ 默认shell</span><br><span class="line">│    │ │   │   │         └─────────── 家目录</span><br><span class="line">│    │ │   │   └───────────────────── 用户备注信息(GECOS)</span><br><span class="line">│    │ │   └───────────────────────── 主组GID</span><br><span class="line">│    │ └───────────────────────────── 用户UID</span><br><span class="line">│    └─────────────────────────────── 密码占位符(实际在/etc/shadow)</span><br><span class="line">└──────────────────────────────────── 用户名</span><br></pre></td></tr></table></figure>
<h4 id="etc-shadow-文件">/etc/shadow 文件</h4>
<ul>
<li>存储用户密码哈希值</li>
<li>只有root用户可访问</li>
<li>包含密码过期时间等安全信息</li>
</ul>
<h4 id="etc-group-文件格式">/etc/group 文件格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">staff:x:500:linux,lpic</span><br><span class="line">↑     ↑ ↑   ↑</span><br><span class="line">│     │ │   └───────────── 附加组成员</span><br><span class="line">│     │ └───────────────── 组GID</span><br><span class="line">│     └─────────────────── 组密码占位符</span><br><span class="line">└───────────────────────── 组名</span><br></pre></td></tr></table></figure>
<h3 id="1-2-用户管理命令">1.2 用户管理命令</h3>
<h4 id="useradd-添加用户">useradd - 添加用户</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -c <span class="string">&quot;开发人员&quot;</span> -d /home/dev -g staff -G developers -s /bin/bash -m devuser</span><br></pre></td></tr></table></figure>
<p>常用选项：</p>
<ul>
<li><code>-c</code>：用户备注信息</li>
<li><code>-d</code>：指定家目录路径</li>
<li><code>-g</code>：指定主组</li>
<li><code>-G</code>：指定附加组</li>
<li><code>-s</code>：指定登录shell</li>
<li><code>-m</code>：自动创建家目录(从/etc/skel复制模板)</li>
</ul>
<h4 id="usermod-修改用户">usermod - 修改用户</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -c <span class="string">&quot;高级开发&quot;</span> -G managers -s /bin/zsh devuser</span><br></pre></td></tr></table></figure>
<p>常用选项：</p>
<ul>
<li><code>-c</code>：备注:指定备注</li>
<li><code>-d</code>：path:home目录</li>
<li><code>-g</code>：组名/GID:所属主组</li>
<li><code>-G</code>：组名/GID:其他所属组</li>
<li><code>-s</code>：path: login shell</li>
<li><code>-L</code>：锁定用户密码</li>
<li><code>-U</code>：解锁用户密码</li>
</ul>
<h4 id="userdel-删除用户">userdel - 删除用户</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel -r devuser  <span class="comment"># 删除用户并移除家目录</span></span><br></pre></td></tr></table></figure>
<h4 id="passwd-密码管理">passwd - 密码管理</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">passwd devuser      <span class="comment"># 设置密码</span></span><br><span class="line">passwd -l devuser   <span class="comment"># 锁定账户</span></span><br><span class="line">passwd -u devuser   <span class="comment"># 解锁账户</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-群组管理命令">1.3 群组管理命令</h3>
<h4 id="groupadd-添加组">groupadd - 添加组</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd developers</span><br></pre></td></tr></table></figure>
<h4 id="groupmod-修改组">groupmod - 修改组</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod -g 1001 -n devgroup developers</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-g</code>：修改GID</li>
<li><code>-n</code>：修改组名</li>
</ul>
<h4 id="groupdel-删除组">groupdel - 删除组</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel devgroup</span><br></pre></td></tr></table></figure>
<h4 id="id-查看用户信息">id - 查看用户信息</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">id</span> devuser  <span class="comment"># 显示用户UID、GID和所属组</span></span><br></pre></td></tr></table></figure>
<h2 id="2-系统时间管理">2. 系统时间管理</h2>
<h3 id="2-1-date-系统时间">2.1 date - 系统时间</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> 093017002012.30    <span class="comment"># 设置为2012年9月30日17:00:30</span></span><br><span class="line"><span class="built_in">date</span> <span class="string">&quot;+%Y/%m/%d (%a)&quot;</span>   <span class="comment"># 格式化为&quot;2023/05/15 (Mon)&quot;</span></span><br></pre></td></tr></table></figure>
<p>常用格式符号：</p>
<ul>
<li><code>%Y</code>：4位年份</li>
<li><code>%m</code>：2位月份</li>
<li><code>%d</code>：2位日期</li>
<li><code>%H</code>：24小时制小时</li>
<li><code>%M</code>：分钟</li>
<li><code>%a</code>：星期缩写</li>
</ul>
<h3 id="2-2-hwclock-硬件时钟">2.2 hwclock - 硬件时钟</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hwclock --show          <span class="comment"># 显示硬件时钟</span></span><br><span class="line">hwclock --systohc       <span class="comment"># 系统时间同步到硬件时钟</span></span><br><span class="line">hwclock --hctosys       <span class="comment"># 硬件时钟同步到系统时间</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-NTP时间同步">2.3 NTP时间同步</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ntpdate time.server.lpic.jp  <span class="comment"># 手动同步时间</span></span><br><span class="line">service ntpd start           <span class="comment"># 启动NTP服务</span></span><br></pre></td></tr></table></figure>
<p>NTP配置文件(<code>/etc/ntp.conf</code>)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">driftfile /etc/ntp.drift</span><br><span class="line">logfile /var/log/ntp.log</span><br><span class="line">server ntp.server.lpic.jp</span><br></pre></td></tr></table></figure>
<h2 id="3-系统日志管理">3. 系统日志管理</h2>
<h3 id="3-1-syslog-配置">3.1 syslog 配置</h3>
<p>配置文件：<code>/etc/syslog.conf</code></p>
<p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">facility.priority    log_location</span><br></pre></td></tr></table></figure>
<h4 id="facility-设施-类型：">facility(设施)类型：</h4>
<ul>
<li><code>auth</code>/<code>authpriv</code>：认证相关</li>
<li><code>cron</code>：定时任务</li>
<li><code>daemon</code>：守护进程</li>
<li><code>kern</code>：内核消息</li>
<li><code>mail</code>：邮件系统</li>
<li><code>syslog</code>：syslog自身</li>
<li><code>local0</code>-<code>local7</code>：自定义设施</li>
</ul>
<h4 id="priority-优先级-：">priority(优先级)：</h4>
<ul>
<li><code>emerg</code>：紧急情况</li>
<li><code>alert</code>：需要立即处理</li>
<li><code>crit</code>：严重错误</li>
<li><code>err</code>：一般错误</li>
<li><code>warning</code>：警告</li>
<li><code>notice</code>：重要通知</li>
<li><code>info</code>：一般信息</li>
<li><code>debug</code>：调试信息</li>
</ul>
<h4 id="输出目标：">输出目标：</h4>
<ul>
<li>文件名：如<code>/var/log/messages</code></li>
<li><code>@host</code>：远程syslog服务器</li>
<li>用户名：发送到用户终端</li>
<li><code>*</code>：所有用户终端</li>
</ul>
<h3 id="3-2-logger-命令">3.2 logger 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logger -p syslog.info -t TEST <span class="string">&quot;测试日志消息&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-3-常用日志文件">3.3 常用日志文件</h3>
<ul>
<li><code>/var/log/secure</code>：认证日志</li>
<li><code>/var/log/messages</code>：系统消息</li>
<li><code>/var/log/boot.log</code>：启动日志</li>
</ul>
<h3 id="3-4-用户登录信息">3.4 用户登录信息</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">who</span>          <span class="comment"># 显示当前登录用户</span></span><br><span class="line">w            <span class="comment"># 显示详细登录信息</span></span><br><span class="line">last         <span class="comment"># 显示登录历史</span></span><br><span class="line">lastlog      <span class="comment"># 显示用户最近登录时间</span></span><br></pre></td></tr></table></figure>
<h3 id="3-5-日志轮转">3.5 日志轮转</h3>
<p>配置文件：<code>/etc/logrotate.conf</code></p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">weekly</span><br><span class="line">rotate 4</span><br><span class="line">create</span><br><span class="line">compress</span><br><span class="line"></span><br><span class="line">/var/log/wtmp &#123;</span><br><span class="line">    monthly</span><br><span class="line">    create 0664 root utmp</span><br><span class="line">    rotate 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-邮件系统">4. 邮件系统</h2>
<h3 id="4-1-邮件组件">4.1 邮件组件</h3>
<ul>
<li><strong>MTA</strong>(邮件传输代理)：sendmail/postfix/exim</li>
<li><strong>MDA</strong>(邮件投递代理)：procmail</li>
<li><strong>MUA</strong>(邮件用户代理)：mail/mutt/thunderbird</li>
</ul>
<h3 id="4-2-启动MTA">4.2 启动MTA</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service sendmail start</span><br><span class="line">service postfix start</span><br><span class="line">service exim4 start</span><br></pre></td></tr></table></figure>
<h3 id="4-3-mail-命令">4.3 mail 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mail -s <span class="string">&quot;测试邮件&quot;</span> user@example.com</span><br><span class="line">邮件正文...</span><br><span class="line">.   <span class="comment"># 单独一行输入点结束</span></span><br><span class="line">Cc: <span class="comment"># 抄送地址(可选)</span></span><br></pre></td></tr></table></figure>
<h3 id="4-4-邮件转发">4.4 邮件转发</h3>
<h4 id="etc-aliases">/etc/aliases</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root: admin,lpic</span><br></pre></td></tr></table></figure>
<p>更新别名数据库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newaliases</span><br></pre></td></tr></table></figure>
<h4 id="用户-forward文件">用户.forward文件</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/home/user/.forward:</span><br><span class="line">user2@example.com</span><br></pre></td></tr></table></figure>
<h2 id="5-打印系统">5. 打印系统</h2>
<h3 id="5-1-CUPS打印系统">5.1 CUPS打印系统</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service cups start  <span class="comment"># 启动CUPS服务</span></span><br></pre></td></tr></table></figure>
<p>主要配置文件：</p>
<ul>
<li><code>/etc/cups/cupsd.conf</code>：服务配置</li>
<li><code>/etc/cups/printers.conf</code>：打印机配置</li>
<li><code>/etc/cups/ppd/</code>：PPD驱动文件</li>
</ul>
<h3 id="5-2-打印命令">5.2 打印命令</h3>
<h4 id="lpr-打印文件">lpr - 打印文件</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpr -P LaserJet -#2 document.pdf</span><br></pre></td></tr></table></figure>
<h4 id="lpq-查看打印队列">lpq - 查看打印队列</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpq -P LaserJet</span><br></pre></td></tr></table></figure>
<h4 id="lprm-删除打印任务">lprm - 删除打印任务</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lprm -P LaserJet 123  <span class="comment"># 删除指定任务</span></span><br><span class="line">lprm -P LaserJet -    <span class="comment"># 删除用户所有任务</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-Web管理界面">5.3 Web管理界面</h3>
<p>访问：<a target="_blank" rel="noopener" href="http://localhost:631">http://localhost:631</a></p>
<h2 id="6-定时任务管理">6. 定时任务管理</h2>
<h3 id="6-1-cron-定时任务系统">6.1 cron 定时任务系统</h3>
<h4 id="crontab-命令">crontab 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab -e            <span class="comment"># 编辑当前用户的crontab</span></span><br><span class="line">crontab -l            <span class="comment"># 列出当前用户的crontab</span></span><br><span class="line">crontab -r            <span class="comment"># 删除当前用户的crontab</span></span><br><span class="line">crontab -u user -e    <span class="comment"># 编辑指定用户的crontab(root权限)</span></span><br></pre></td></tr></table></figure>
<h4 id="crontab-文件格式">crontab 文件格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* * * * * command_to_execute</span><br><span class="line">│ │ │ │ │</span><br><span class="line">│ │ │ │ └── 星期几 (0-6, 0=星期日)</span><br><span class="line">│ │ │ └──── 月份 (1-12)</span><br><span class="line">│ │ └────── 日 (1-31)</span><br><span class="line">│ └──────── 小时 (0-23)</span><br><span class="line">└────────── 分钟 (0-59)</span><br></pre></td></tr></table></figure>
<p>特殊字符：</p>
<ul>
<li><code>*</code>：所有有效值</li>
<li><code>,</code>：值列表分隔符(如1,3,5)</li>
<li><code>-</code>：范围(如1-5)</li>
<li><code>/</code>：步长(如*/2表示每2个单位)</li>
</ul>
<h4 id="系统cron目录">系统cron目录</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/etc/crontab           <span class="comment"># 系统级crontab文件</span></span><br><span class="line">/etc/cron.d/           <span class="comment"># 系统cron片段</span></span><br><span class="line">/etc/cron.hourly/      <span class="comment"># 每小时执行</span></span><br><span class="line">/etc/cron.daily/       <span class="comment"># 每天执行</span></span><br><span class="line">/etc/cron.weekly/      <span class="comment"># 每周执行</span></span><br><span class="line">/etc/cron.monthly/     <span class="comment"># 每月执行</span></span><br></pre></td></tr></table></figure>
<h4 id="anacron">anacron</h4>
<ul>
<li>用于在系统停机后执行错过的定时任务</li>
<li>配置文件：<code>/etc/anacrontab</code></li>
</ul>
<h3 id="6-2-at-一次性任务">6.2 at 一次性任务</h3>
<h4 id="at-命令">at 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">at 17:00 tomorrow      <span class="comment"># 创建定时任务</span></span><br><span class="line">at -f job.sh 23:00     <span class="comment"># 从文件读取任务</span></span><br><span class="line">atq                    <span class="comment"># 查看待执行任务(at -l)</span></span><br><span class="line">atrm 3                 <span class="comment"># 删除任务3(at -d 3)</span></span><br></pre></td></tr></table></figure>
<h4 id="时间格式">时间格式</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HH:MM                  # 24小时制(如23:00)</span><br><span class="line">noon/midnight          # 中午12点/午夜12点</span><br><span class="line">today/tomorrow         # 今天/明天</span><br><span class="line">now + count time-units # 如now + 3 days</span><br></pre></td></tr></table></figure>
<h3 id="6-3-batch-低负荷执行">6.3 batch 低负荷执行</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">batch                  <span class="comment"># 进入交互式输入模式</span></span><br><span class="line">batch -f job.sh        <span class="comment"># 从文件读取任务</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-访问控制">6.4 访问控制</h3>
<h4 id="cron-访问控制">cron 访问控制</h4>
<ol>
<li>如存在<code>/etc/cron.allow</code>，仅允许文件内用户</li>
<li>如无allow文件，检查<code>/etc/cron.deny</code>，拒绝文件内用户</li>
<li>如两者都不存在，默认行为取决于系统配置</li>
</ol>
<h4 id="at-访问控制">at 访问控制</h4>
<ol>
<li>如存在<code>/etc/at.allow</code>，仅允许文件内用户</li>
<li>如无allow文件，检查<code>/etc/at.deny</code>，拒绝文件内用户</li>
<li>如两者都不存在，默认只有root可用</li>
</ol>
<h2 id="7-本地化与国际化">7. 本地化与国际化</h2>
<h3 id="7-1-本地化变量">7.1 本地化变量</h3>
<table>
<thead>
<tr>
<th>变量</th>
<th>作用域</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LC_CTYPE</code></td>
<td>字符分类和大小写转换</td>
</tr>
<tr>
<td><code>LC_COLLATE</code></td>
<td>排序和比较规则</td>
</tr>
<tr>
<td><code>LC_MESSAGES</code></td>
<td>系统消息语言</td>
</tr>
<tr>
<td><code>LC_MONETARY</code></td>
<td>货币格式</td>
</tr>
<tr>
<td><code>LC_NUMERIC</code></td>
<td>数字格式</td>
</tr>
<tr>
<td><code>LC_TIME</code></td>
<td>日期时间格式</td>
</tr>
<tr>
<td><code>LC_ALL</code></td>
<td>覆盖所有LC_*设置</td>
</tr>
<tr>
<td><code>LANG</code></td>
<td>默认设置(未被LC_*覆盖时使用)</td>
</tr>
</tbody>
</table>
<h3 id="7-2-常用locale设置">7.2 常用locale设置</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C/POSIX               <span class="comment"># 最小locale</span></span><br><span class="line">en_US.utf8            <span class="comment"># 英文(美国)</span></span><br><span class="line">ja_JP.utf8            <span class="comment"># 日文(UTF-8)</span></span><br><span class="line">ja_JP.eucJP           <span class="comment"># 日文(EUC-JP)</span></span><br><span class="line">zh_CN.utf8            <span class="comment"># 中文(简体)</span></span><br></pre></td></tr></table></figure>
<h3 id="7-3-locale-命令">7.3 locale 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">locale -a             <span class="comment"># 列出可用locale</span></span><br><span class="line">locale -m             <span class="comment"># 列出可用字符编码</span></span><br><span class="line">locale                <span class="comment"># 显示当前locale设置</span></span><br></pre></td></tr></table></figure>
<h3 id="7-4-字符编码">7.4 字符编码</h3>
<table>
<thead>
<tr>
<th>编码</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ASCII</td>
<td>7位英文字符</td>
</tr>
<tr>
<td>ISO-8859</td>
<td>8位扩展ASCII</td>
</tr>
<tr>
<td>UTF-8</td>
<td>Unicode编码</td>
</tr>
<tr>
<td>EUC-JP</td>
<td>Linux日文编码</td>
</tr>
<tr>
<td>Shift_JIS</td>
<td>Windows/Mac日文编码</td>
</tr>
<tr>
<td>ISO-2022-JP</td>
<td>邮件用日文编码</td>
</tr>
</tbody>
</table>
<h3 id="7-5-iconv-编码转换">7.5 iconv 编码转换</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iconv -f eucjp -t utf8 input.txt &gt; output.txt  <span class="comment"># EUC-JP转UTF-8</span></span><br><span class="line">iconv -l                                      <span class="comment"># 列出支持编码</span></span><br></pre></td></tr></table></figure>
<h2 id="8-时区设置">8. 时区设置</h2>
<h3 id="8-1-时区文件">8.1 时区文件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/zoneinfo/   <span class="comment"># 所有时区定义文件</span></span><br><span class="line">/etc/localtime         <span class="comment"># 系统当前时区链接</span></span><br></pre></td></tr></table></figure>
<h3 id="8-2-设置时区方法">8.2 设置时区方法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1: 复制时区文件</span></span><br><span class="line"><span class="built_in">cp</span> /usr/share/zoneinfo/Asia/Tokyo /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2: 创建符号链接</span></span><br><span class="line"><span class="built_in">ln</span> -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法3: 临时设置(当前会话有效)</span></span><br><span class="line"><span class="built_in">export</span> TZ=<span class="string">&quot;Asia/Tokyo&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-时区配置工具">8.3 时区配置工具</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tzselect   <span class="comment"># 交互式时区选择</span></span><br><span class="line">tzconfig   <span class="comment"># 时区配置工具(部分发行版)</span></span><br><span class="line">dpkg-reconfigure tzdata  <span class="comment"># Debian系重新配置时区</span></span><br><span class="line">timedatectl set-timezone Asia/Tokyo  <span class="comment"># systemd系统设置时区</span></span><br></pre></td></tr></table></figure>
<h2 id="9-打印系统补充">9. 打印系统补充</h2>
<h3 id="9-1-CUPS-Web管理界面">9.1 CUPS Web管理界面</h3>
<p>访问：<code>http://localhost:631</code></p>
<h3 id="9-2-打印命令补充">9.2 打印命令补充</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lpstat -p -d          <span class="comment"># 显示打印机状态和默认打印机</span></span><br><span class="line">lpoptions -d LaserJet <span class="comment"># 设置默认打印机</span></span><br></pre></td></tr></table></figure>
<h3 id="9-3-打印系统日志">9.3 打印系统日志</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/cups/        <span class="comment"># CUPS日志目录</span></span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/24/linux/8-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/08/linux/7-XWindow/"
                            aria-label=": 7.XWindow"
                        >
                            7.XWindow
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T20:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># X Window 系统架构详解</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 基础架构</span></span><br></pre></td></tr></table></figure>
<p>localhost(X server) --X protocol-- remotehost(X client)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 核心组件说明</span><br><span class="line">1. **X Server**：</span><br><span class="line">   - 负责硬件管理（显卡、显示器、输入设备等）</span><br><span class="line">   - 屏幕绘制与渲染</span><br><span class="line">   - 提供字体服务功能</span><br><span class="line">   - 典型实现：Xorg</span><br><span class="line"></span><br><span class="line">2. **X Client**：</span><br><span class="line">   - 应用程序逻辑处理</span><br><span class="line">   - 响应X Server的事件请求</span><br><span class="line">   - 例如：xterm、Firefox等GUI程序</span><br><span class="line"></span><br><span class="line">3. **X Window Manager**：</span><br><span class="line">   - 特殊的X Client</span><br><span class="line">   - 负责管理窗口布局、装饰和交互</span><br><span class="line">   - 常见WM：twm、KWin、Metacity等</span><br><span class="line"></span><br><span class="line">4. **Display Manager**：</span><br><span class="line">   - 提供图形化登录界面</span><br><span class="line">   - 负责加载用户选择的WM和语言环境</span><br><span class="line">   - 常见实现：GDM、KDM、XDM</span><br><span class="line"></span><br><span class="line">## startx 启动流程</span><br><span class="line"></span><br><span class="line">### 命令语法</span><br><span class="line">```bash</span><br><span class="line">startx [X client 参数] -- [X server 参数]</span><br></pre></td></tr></table></figure>
<h3 id="X-server-参数查找顺序">X server 参数查找顺序</h3>
<ol>
<li>startx 命令行参数</li>
<li>用户主目录 <code>~/.xserverrc</code></li>
<li>系统默认 <code>/etc/X11/xinit/xserverrc</code></li>
<li>最终回退 <code>/usr/bin/X</code> (X server可执行文件)</li>
</ol>
<h3 id="X-client-参数查找顺序">X client 参数查找顺序</h3>
<ol>
<li>startx 命令行参数</li>
<li>用户主目录 <code>~/.xinitrc</code></li>
<li>系统默认 <code>/etc/X11/xinit/xinitrc</code></li>
<li>最终回退 <code>xterm</code> (基础终端模拟器)</li>
</ol>
<h3 id="底层调用">底层调用</h3>
<p>startx 最终调用 <code>xinit</code> 启动X系统：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit [client option] -- [server or display option]</span><br></pre></td></tr></table></figure>
<p>默认等效命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit /etc/X11/xinit/xinitrc -- /usr/bin/X</span><br></pre></td></tr></table></figure>
<p>最小化启动示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xinit xterm -geometry +1+1 -n login -display :0 -- X :0</span><br></pre></td></tr></table></figure>
<h2 id="配置文件体系">配置文件体系</h2>
<h3 id="核心配置文件">核心配置文件</h3>
<ul>
<li>主配置文件：<code>/etc/X11/xorg.conf</code></li>
<li>模块目录：<code>/usr/lib64/xorg/modules/</code></li>
<li>字体目录：<code>/usr/share/X11/fonts/</code></li>
<li>显卡驱动：<code>/usr/lib64/xorg/modules/drivers/</code></li>
</ul>
<h3 id="配置段落-Section">配置段落(Section)</h3>
<table>
<thead>
<tr>
<th>Section名称</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Module</td>
<td>X Server加载的功能模块</td>
</tr>
<tr>
<td>InputDevice</td>
<td>输入设备配置（键盘/鼠标）</td>
</tr>
<tr>
<td>Files</td>
<td>字体和颜色资源路径</td>
</tr>
<tr>
<td>Monitor</td>
<td>显示器参数（刷新率等）</td>
</tr>
<tr>
<td>Device</td>
<td>显卡芯片组配置</td>
</tr>
<tr>
<td>Screen</td>
<td>显示分辨率和色深设置</td>
</tr>
<tr>
<td>ServerLayout</td>
<td>各模块的组合配置</td>
</tr>
</tbody>
</table>
<h3 id="配置生成工具">配置生成工具</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Xorg -configure</span><br><span class="line"><span class="comment"># 生成测试配置文件：/root/xorg.conf.new</span></span><br><span class="line"><span class="comment"># 测试命令：X -config /root/xorg.conf.new</span></span><br></pre></td></tr></table></figure>
<h2 id="实用命令工具">实用命令工具</h2>
<h3 id="显示调节">显示调节</h3>
<ul>
<li><code>xvidtune</code>：GUI显示器频率调节工具</li>
<li><code>xhost</code>：X server访问控制<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xhost +hostname  <span class="comment"># 添加访问权限</span></span><br><span class="line">xhost -hostname  <span class="comment"># 移除访问权限</span></span><br><span class="line">xhost +          <span class="comment"># 允许所有主机</span></span><br><span class="line">xhost -          <span class="comment"># 禁用所有远程访问</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="环境变量">环境变量</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DISPLAY=localhost:0  <span class="comment"># 指定显示目标</span></span><br><span class="line"><span class="built_in">export</span> DISPLAY</span><br></pre></td></tr></table></figure>
<h3 id="信息查询">信息查询</h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>showrgb</td>
<td>显示可用RGB颜色值</td>
</tr>
<tr>
<td>xlsclients</td>
<td>列出运行中的X客户端</td>
</tr>
<tr>
<td>xwininfo</td>
<td>查询窗口几何属性</td>
</tr>
<tr>
<td>xdpyinfo</td>
<td>显示X Server详细信息</td>
</tr>
</tbody>
</table>
<h2 id="显示管理器-XDM">显示管理器(XDM)</h2>
<h3 id="类型对比">类型对比</h3>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>XDM</td>
<td>基础X Display Manager</td>
</tr>
<tr>
<td>GDM</td>
<td>GNOME显示管理器</td>
</tr>
<tr>
<td>KDM</td>
<td>KDE显示管理器</td>
</tr>
</tbody>
</table>
<h3 id="XDM启动流程">XDM启动流程</h3>
<ol>
<li>启动XDM服务</li>
<li>加载 <code>/etc/X11/Xsession</code></li>
<li>执行 <code>/etc/X11/xinit/xinitrc.d/</code> 下脚本</li>
<li>读取用户配置 <code>~/.xsession</code></li>
<li>加载 <code>~/.Xclients</code> 或 <code>/etc/X11/xinit/Xclients</code></li>
</ol>
<h3 id="关键配置文件">关键配置文件</h3>
<table>
<thead>
<tr>
<th>文件名</th>
<th>用途描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>xdm-config</td>
<td>基础配置和访问控制</td>
</tr>
<tr>
<td>Xaccess</td>
<td>主机访问权限设置</td>
</tr>
<tr>
<td>Xresources</td>
<td>登录界面样式和X资源定义</td>
</tr>
<tr>
<td>Xservers</td>
<td>X Server与Display映射</td>
</tr>
<tr>
<td>Xsetup_0</td>
<td>登录前环境设置（如壁纸）</td>
</tr>
<tr>
<td>Xsession</td>
<td>会话启动流程控制</td>
</tr>
</tbody>
</table>
<h2 id="窗口管理器列表">窗口管理器列表</h2>
<table>
<thead>
<tr>
<th>名称</th>
<th>特点描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>twm</td>
<td>最基本的窗口管理器</td>
</tr>
<tr>
<td>fvwm</td>
<td>轻量级窗口管理器</td>
</tr>
<tr>
<td>sawfish</td>
<td>GNOME集成WM</td>
</tr>
<tr>
<td>enlightenment</td>
<td>高定制化WM</td>
</tr>
<tr>
<td>metacity</td>
<td>GNOME默认WM</td>
</tr>
<tr>
<td>fluxbox</td>
<td>轻量级高自由度WM</td>
</tr>
<tr>
<td>WindowMaker</td>
<td>NeXTSTEP风格WM</td>
</tr>
<tr>
<td>KWin</td>
<td>KDE标准窗口管理器</td>
</tr>
</tbody>
</table>
<h2 id="辅助功能技术">辅助功能技术</h2>
<h3 id="AccessX-功能">AccessX 功能</h3>
<table>
<thead>
<tr>
<th>功能</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>粘滞键</td>
<td>分离组合键输入</td>
</tr>
<tr>
<td>慢速键</td>
<td>调整按键响应时间</td>
</tr>
<tr>
<td>防反弹键</td>
<td>防止重复输入</td>
</tr>
<tr>
<td>切换键</td>
<td>切换状态声音反馈</td>
</tr>
<tr>
<td>鼠标键</td>
<td>键盘模拟鼠标操作</td>
</tr>
</tbody>
</table>
<h3 id="其他辅助工具">其他辅助工具</h3>
<ul>
<li><strong>高对比度显示</strong>：增强视觉可读性</li>
<li><strong>屏幕阅读器</strong>：Orca等文本转语音工具</li>
<li><strong>盲文显示器</strong>：触觉输出设备</li>
<li><strong>屏幕放大镜</strong>：视觉辅助工具</li>
<li><strong>屏幕键盘</strong>：GOK等虚拟输入工具</li>
</ul>
<h3 id="专用软件">专用软件</h3>
<ul>
<li><strong>Orca</strong>：GNOME屏幕阅读器和放大镜</li>
<li><strong>GOK</strong>：GNOME屏幕键盘</li>
<li><strong>emacspeak</strong>：为Emacs添加语音功能</li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/08/linux/7-XWindow/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/08/linux/6-Shell%E5%8F%98%E9%87%8F%E4%B8%8EShell%E8%84%9A%E6%9C%AC/"
                            aria-label=": 6.Shell变量与Shell脚本"
                        >
                            6.Shell变量与Shell脚本
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T19:16:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>Shell变量与Shell脚本</h1>
<h2 id="Bash设定文档">Bash设定文档</h2>
<ul>
<li><strong>/etc/profile</strong>: 登录时执行，适用于所有用户</li>
<li><strong>~/.bash_profile</strong>: 登录时执行</li>
<li><strong>~/.bash_login</strong>: 当 <code>~/.bash_profile</code> 不存在时，登录时执行</li>
<li><strong>~/.profile</strong>: 当 <code>~/.bash_profile</code> 和 <code>~/.bash_login</code> 都不存在时，登录时执行</li>
<li><strong>~/.bashrc</strong>: 每次启动 Bash 时执行</li>
<li><strong>~/.bash_logout</strong>: 登出时执行</li>
</ul>
<h2 id="Shell环境定制化">Shell环境定制化</h2>
<h3 id="export命令"><code>export</code>命令</h3>
<p>用于将shell变量转化为环境变量，使得该变量能够被其他程序或子进程访问。</p>
<h3 id="set命令"><code>set</code>命令</h3>
<ul>
<li>
<p><code>set</code>: 显示打印当前的环境变量和Shell变量</p>
</li>
<li>
<p><code>set [-o] [+o] option</code>：</p>
<ul>
<li><code>-o</code>：启用该选项</li>
<li><code>+o</code>：禁用该选项</li>
<li>常用选项：
<ul>
<li><code>allexport</code>: 自动将变量导出为环境变量</li>
<li><code>emacs</code>: 设置Emacs风格的键绑定</li>
<li><code>ignoreeof</code>: 禁止通过 Ctrl+D 退出Shell</li>
<li><code>noclobber</code>: 禁止文件重定向覆盖文件</li>
<li><code>noglob</code>: 禁用元字符解析</li>
<li><code>vi</code>: 设置vi风格的键绑定</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>set -o</code>: 显示或更改选项的状态</p>
</li>
</ul>
<h3 id="printenv命令"><code>printenv</code>命令</h3>
<p>用于打印当前的环境变量。</p>
<h3 id="alias-unalias"><code>alias</code>/<code>unalias</code></h3>
<ul>
<li><code>alias</code>: 设置命令别名</li>
<li><code>unalias</code>: 取消命令别名</li>
<li>临时解除别名：可以使用反斜杠 <code>\</code>，例如：<code>alias ls='ls -l'</code> 后，<code>'\ls'</code> 会执行原始的 <code>ls</code> 命令。</li>
</ul>
<h2 id="定义Shell函数">定义Shell函数</h2>
<ul>
<li>
<p>定义函数语法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> [函数名] () &#123;</span><br><span class="line">    运行内容;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<code>&#123;</code> 和 <code>&#125;</code> 前后需要有空格。</p>
</li>
<li>
<p>定义变量：<code>$变量名</code></p>
</li>
<li>
<p>函数名不能与变量名重名。</p>
</li>
<li>
<p>查看已定义的函数：<code>declare -f</code></p>
</li>
<li>
<p>删除函数：<code>unset</code></p>
</li>
</ul>
<h2 id="Shell脚本">Shell脚本</h2>
<h3 id="执行Shell脚本">执行Shell脚本</h3>
<ul>
<li>脚本命令可以分行书写，并逐行执行。</li>
<li>运行脚本时，如果没有执行权限，只需要文件的读取权限和文件夹的运行权限即可。
<ul>
<li>使用 <code>source [脚本名]</code> 或简化版 <code>.[脚本名]</code> 执行脚本。</li>
<li>如果脚本有执行权限，可以省略 <code>source</code>，例如：<code>./[脚本名]</code>。</li>
<li>如果脚本不在 <code>PATH</code> 环境变量指定的文件夹中，需要显式指定脚本路径，或者在当前目录使用 <code>./</code>。</li>
</ul>
</li>
</ul>
<h3 id="传入Shell脚本的变量">传入Shell脚本的变量</h3>
<ul>
<li><code>$0</code>：脚本文件名（全路径）</li>
<li><code>$1</code>：第一个传入的变量值</li>
<li><code>$2</code>：第二个传入的变量值</li>
<li><code>#$</code>：传入的变量数量</li>
<li><code>$@</code>：所有传入的变量值（空格分隔）</li>
<li><code>$*</code>：所有变量值（以系统默认的分隔符分隔）</li>
<li>脚本执行结束后的返回状态：<code>echo $?</code>。正常执行返回0，错误返回1。</li>
</ul>
<h3 id="文件检查">文件检查</h3>
<p>使用 <code>test</code> 命令或者 <code>[</code> <code>]</code> 语法进行文件检查：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> 条件文</span><br><span class="line">[ 条件文 ]</span><br></pre></td></tr></table></figure>
<h4 id="常见条件文：">常见条件文：</h4>
<ul>
<li><code>-f 文件名</code>：检查文件是否存在且为普通文件</li>
<li><code>-d 文件夹名</code>：检查文件夹是否存在</li>
<li><code>-r 文件名</code>：检查文件是否有读取权限</li>
<li><code>-w 文件名</code>：检查文件是否有写入权限</li>
<li><code>-x 文件名</code>：检查文件是否有执行权限</li>
<li><code>-s 文件名</code>：检查文件是否为空</li>
<li><code>-L 文件名</code>：检查是否为软链接</li>
<li><code>-e 文件名</code>：检查文件是否存在</li>
<li><code>文件名1 -nt 文件名2</code>：文件1是否比文件2新</li>
<li><code>文件名1 -ot 文件名2</code>：文件1是否比文件2旧</li>
<li>数值比较：<code>-eq</code>, <code>-ge</code>, <code>-gt</code>, <code>-le</code>, <code>-lt</code>, <code>-ne</code>（等于、大于等于、大于、小于等于、小于、不等于）</li>
<li>字符串比较：<code>-n</code>（字符串长度大于0），<code>-z</code>（字符串长度为0）</li>
<li>字符串相等：<code>字符串1 = 字符串2</code></li>
<li>字符串不等：<code>字符串1 != 字符串2</code></li>
<li>逻辑操作：
<ul>
<li><code>!</code>：条件非</li>
<li><code>-a</code>：与（and）</li>
<li><code>-o</code>：或（or）</li>
</ul>
</li>
</ul>
<h2 id="条件分歧">条件分歧</h2>
<h3 id="if语句"><code>if</code>语句</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件式</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    执行文1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    执行文2</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件式; <span class="keyword">then</span></span><br><span class="line">    执行文1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    执行文2</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="case语句"><code>case</code>语句</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> 式 <span class="keyword">in</span></span><br><span class="line">    值1)</span><br><span class="line">        执行文1 ;;</span><br><span class="line">    值2)</span><br><span class="line">        执行文2 ;;</span><br><span class="line">    *)</span><br><span class="line">        执行其他文 ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<p>注意：每个 <code>执行文</code> 后面要有 <code>;;</code>，并且最后使用 <code>esac</code> 结束。</p>
<h3 id="for循环"><code>for</code>循环</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量名 <span class="keyword">in</span> 变量值列表</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    执行文</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> Vine SUSE Gentoo</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$var</span> Linux</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>变量值列表可以通过空格分隔，也可以使用 <code>seq</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">seq</span> 10 15`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="while循环"><code>while</code>循环</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件文</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    执行文</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="read命令"><code>read</code>命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;Who are you?:&#x27;</span></span><br><span class="line"><span class="built_in">read</span> username</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello, <span class="variable">$username</span>!&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>如果 <code>echo</code> 后面跟 <code>-n</code>，则输入的提示信息和用户输入将在同一行显示。</li>
</ul>
<h2 id="指定执行Shell类型">指定执行Shell类型</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br></pre></td></tr></table></figure>
<p>此行用于指定脚本执行时使用的Shell解释器。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/08/linux/6-Shell%E5%8F%98%E9%87%8F%E4%B8%8EShell%E8%84%9A%E6%9C%AC/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/08/linux/5-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"
                            aria-label=": 5.文件系统与存储管理"
                        >
                            5.文件系统与存储管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T19:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-磁盘配额管理">1. 磁盘配额管理</h2>
<h3 id="1-1-配额概念与类型">1.1 配额概念与类型</h3>
<h4 id="配额类型说明">配额类型说明</h4>
<ul>
<li><strong>硬限制(Hard Limit)</strong>：用户绝对不能超过的磁盘空间限制</li>
<li><strong>软限制(Soft Limit)</strong>：允许用户暂时超过的限制，系统会发出警告</li>
<li><strong>宽限期(Grace Period)</strong>：超过软限制后允许保留的时间（默认7天）</li>
</ul>
<h3 id="1-2-配额实施完整步骤">1.2 配额实施完整步骤</h3>
<ol>
<li>
<p><strong>修改fstab文件</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在/etc/fstab中添加usrquota和/或grpquota选项</span></span><br><span class="line">/dev/sda1 /home ext4 defaults,usrquota,grpquota 0 2</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>重新挂载文件系统</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">umount /home</span><br><span class="line">mount -o remount /home</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>创建配额文件</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /home/aquota.user /home/aquota.group</span><br><span class="line"><span class="built_in">chmod</span> 600 /home/aquota.*</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>初始化配额数据库</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quotacheck -cugm /home</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>启用配额系统</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quotaon -avug</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>为用户设置配额</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edquota username</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="1-3-配额管理命令详解">1.3 配额管理命令详解</h3>
<h4 id="quota-显示配额信息">quota - 显示配额信息</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">quota -u username  <span class="comment"># 显示用户配额</span></span><br><span class="line">quota -g groupname <span class="comment"># 显示组配额</span></span><br><span class="line">quota -v           <span class="comment"># 显示详细信息</span></span><br></pre></td></tr></table></figure>
<h4 id="quotacheck-检查配额">quotacheck - 检查配额</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quotacheck -avug  <span class="comment"># 检查所有文件系统配额</span></span><br><span class="line">quotacheck -cug /home  <span class="comment"># 检查指定文件系统</span></span><br></pre></td></tr></table></figure>
<h4 id="quotaon-quotaoff-启用-禁用配额">quotaon/quotaoff - 启用/禁用配额</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quotaon -avug     <span class="comment"># 启用所有配额</span></span><br><span class="line">quotaoff /home    <span class="comment"># 禁用指定文件系统配额</span></span><br></pre></td></tr></table></figure>
<h4 id="edquota-编辑配额">edquota - 编辑配额</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">edquota -u username  <span class="comment"># 编辑用户配额</span></span><br><span class="line">edquota -p template_user new_user  <span class="comment"># 复制配额设置</span></span><br><span class="line">edquota -t           <span class="comment"># 修改宽限期</span></span><br></pre></td></tr></table></figure>
<h4 id="repquota-报告配额状态">repquota - 报告配额状态</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">repquota -a       <span class="comment"># 报告所有文件系统配额状态</span></span><br><span class="line">repquota -u /home <span class="comment"># 报告/home的用户配额</span></span><br></pre></td></tr></table></figure>
<h2 id="2-文件系统层次标准-FHS">2. 文件系统层次标准(FHS)</h2>
<h3 id="2-1-核心目录结构">2.1 核心目录结构</h3>
<table>
<thead>
<tr>
<th>目录</th>
<th>完整描述</th>
<th>典型内容</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/bin</code></td>
<td>基础命令二进制文件</td>
<td>ls, cp, mv等基本命令</td>
</tr>
<tr>
<td><code>/sbin</code></td>
<td>系统管理二进制文件</td>
<td>fdisk, fsck, ifconfig等</td>
</tr>
<tr>
<td><code>/etc</code></td>
<td>系统配置文件</td>
<td>passwd, fstab, network等配置文件</td>
</tr>
<tr>
<td><code>/dev</code></td>
<td>设备文件</td>
<td>sda, tty, null等设备节点</td>
</tr>
<tr>
<td><code>/lib</code></td>
<td>系统库文件</td>
<td>系统运行所需共享库</td>
</tr>
<tr>
<td><code>/mnt</code></td>
<td>临时挂载点</td>
<td>临时挂载文件系统的目录</td>
</tr>
<tr>
<td><code>/opt</code></td>
<td>可选应用软件包</td>
<td>第三方应用程序</td>
</tr>
<tr>
<td><code>/proc</code></td>
<td>进程和内核信息</td>
<td>虚拟文件系统，提供系统信息</td>
</tr>
<tr>
<td><code>/root</code></td>
<td>root用户主目录</td>
<td>root用户的个人文件和配置</td>
</tr>
<tr>
<td><code>/boot</code></td>
<td>启动加载文件</td>
<td>vmlinuz, initramfs, grub等</td>
</tr>
<tr>
<td><code>/home</code></td>
<td>用户主目录</td>
<td>普通用户的个人目录</td>
</tr>
<tr>
<td><code>/tmp</code></td>
<td>临时文件</td>
<td>系统重启后通常清空</td>
</tr>
<tr>
<td><code>/var</code></td>
<td>可变数据文件</td>
<td>日志、邮件、数据库等</td>
</tr>
<tr>
<td><code>/usr</code></td>
<td>用户程序资源</td>
<td>应用程序、文档、库文件等</td>
</tr>
</tbody>
</table>
<h2 id="3-分区与文件系统管理">3. 分区与文件系统管理</h2>
<h3 id="3-1-分区管理">3.1 分区管理</h3>
<h4 id="fdisk-完整操作流程">fdisk 完整操作流程</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sdb</span><br></pre></td></tr></table></figure>
<p>交互命令列表：</p>
<ul>
<li><code>n</code>：创建新分区</li>
<li><code>d</code>：删除分区</li>
<li><code>p</code>：显示分区表</li>
<li><code>t</code>：更改分区类型</li>
<li><code>a</code>：切换启动标志</li>
<li><code>w</code>：写入并退出</li>
<li><code>q</code>：不保存退出</li>
<li><code>m</code>：显示帮助菜单</li>
</ul>
<h3 id="3-2-文件系统创建与管理">3.2 文件系统创建与管理</h3>
<h4 id="mkfs-命令集">mkfs 命令集</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkfs -t ext4 /dev/sdb1      <span class="comment"># 创建ext4文件系统</span></span><br><span class="line">mkfs.ext4 /dev/sdb1         <span class="comment"># 同上</span></span><br><span class="line">mkfs.xfs /dev/sdb2          <span class="comment"># 创建XFS文件系统</span></span><br><span class="line">mkfs.btrfs /dev/sdb3        <span class="comment"># 创建Btrfs文件系统</span></span><br></pre></td></tr></table></figure>
<h4 id="交换空间管理">交换空间管理</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkswap /dev/sdb4            <span class="comment"># 创建交换分区</span></span><br><span class="line">swapon /dev/sdb4            <span class="comment"># 启用交换分区</span></span><br><span class="line">swapon -s                   <span class="comment"># 显示交换空间状态</span></span><br><span class="line">swapoff /dev/sdb4           <span class="comment"># 禁用交换分区</span></span><br></pre></td></tr></table></figure>
<h3 id="3-3-文件系统检查与维护">3.3 文件系统检查与维护</h3>
<h4 id="fsck-系列命令">fsck 系列命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fsck /dev/sdb1              <span class="comment"># 基本文件系统检查</span></span><br><span class="line">fsck -y /dev/sdb1           <span class="comment"># 自动修复错误</span></span><br><span class="line">e2fsck -p /dev/sdb1         <span class="comment"># ext文件系统自动修复</span></span><br><span class="line">xfs_repair /dev/sdb2        <span class="comment"># XFS文件系统修复</span></span><br></pre></td></tr></table></figure>
<h4 id="tune2fs-调整参数">tune2fs 调整参数</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tune2fs -c 30 /dev/sdb1     <span class="comment"># 设置每30次挂载后检查</span></span><br><span class="line">tune2fs -i 15d /dev/sdb1    <span class="comment"># 设置15天间隔检查</span></span><br><span class="line">tune2fs -L DATA /dev/sdb1   <span class="comment"># 设置卷标为DATA</span></span><br></pre></td></tr></table></figure>
<h3 id="3-4-空间监控命令">3.4 空间监控命令</h3>
<h4 id="df-详细用法">df 详细用法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h                       <span class="comment"># 人类可读格式</span></span><br><span class="line"><span class="built_in">df</span> -i                       <span class="comment"># 显示inode使用情况</span></span><br><span class="line"><span class="built_in">df</span> -T                       <span class="comment"># 显示文件系统类型</span></span><br><span class="line"><span class="built_in">df</span> --total                  <span class="comment"># 显示总计信息</span></span><br></pre></td></tr></table></figure>
<h4 id="du-详细用法">du 详细用法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">du</span> -sh /var/log             <span class="comment"># 显示目录总大小</span></span><br><span class="line"><span class="built_in">du</span> -ah /home                <span class="comment"># 显示所有文件和目录大小</span></span><br><span class="line"><span class="built_in">du</span> -csh *                   <span class="comment"># 显示当前目录各项目大小和总计</span></span><br><span class="line"><span class="built_in">du</span> --max-depth=1 /usr       <span class="comment"># 只显示一级子目录大小</span></span><br></pre></td></tr></table></figure>
<h2 id="4-文件搜索命令">4. 文件搜索命令</h2>
<h3 id="4-1-find-命令完整用法">4.1 find 命令完整用法</h3>
<h4 id="基本语法">基本语法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find [路径] [选项] [操作]</span><br></pre></td></tr></table></figure>
<h4 id="常用示例">常用示例</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;*.conf&quot;</span>               <span class="comment"># 按名称查找</span></span><br><span class="line">find /home -user alice              <span class="comment"># 按属主查找</span></span><br><span class="line">find /var/log -mtime -7             <span class="comment"># 查找7天内修改的文件</span></span><br><span class="line">find /tmp -size +10M                <span class="comment"># 查找大于10MB的文件</span></span><br><span class="line">find . -perm 644                    <span class="comment"># 查找权限为644的文件</span></span><br><span class="line">find /etc -<span class="built_in">type</span> f -<span class="built_in">exec</span> grep -l <span class="string">&quot;error&quot;</span> &#123;&#125; \;  <span class="comment"># 结合grep</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-locate-updatedb-系统">4.2 locate/updatedb 系统</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">locate passwd              <span class="comment"># 快速查找文件</span></span><br><span class="line">updatedb                   <span class="comment"># 更新数据库</span></span><br><span class="line">updatedb -e /mnt           <span class="comment"># 排除/mnt目录</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-which-whereis-type">4.3 which/whereis/type</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> <span class="built_in">ls</span>                   <span class="comment"># 查找命令路径</span></span><br><span class="line">whereis python             <span class="comment"># 查找命令相关文件</span></span><br><span class="line"><span class="built_in">type</span> -a <span class="built_in">cd</span>                 <span class="comment"># 显示命令类型</span></span><br></pre></td></tr></table></figure>
<h2 id="5-挂载管理">5. 挂载管理</h2>
<h3 id="5-1-挂载选项详解">5.1 挂载选项详解</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>完整描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>async/sync</code></td>
<td>异步/同步写入</td>
</tr>
<tr>
<td><code>auto/noauto</code></td>
<td>是否允许mount -a自动挂载</td>
</tr>
<tr>
<td><code>exec/noexec</code></td>
<td>是否允许执行二进制文件</td>
</tr>
<tr>
<td><code>ro/rw</code></td>
<td>只读/读写模式</td>
</tr>
<tr>
<td><code>suid/nosuid</code></td>
<td>是否允许SUID/SGID</td>
</tr>
<tr>
<td><code>user/nouser</code></td>
<td>是否允许普通用户挂载</td>
</tr>
<tr>
<td><code>defaults</code></td>
<td>默认选项(rw,suid,dev,exec,auto,nouser,async)</td>
</tr>
</tbody>
</table>
<h3 id="5-2-mount-umount-完整用法">5.2 mount/umount 完整用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sdb1 /mnt/data           <span class="comment"># 基本挂载</span></span><br><span class="line">mount -o remount,ro /mnt/data       <span class="comment"># 重新挂载为只读</span></span><br><span class="line">mount -t nfs server:/share /mnt/nfs <span class="comment"># 挂载NFS</span></span><br><span class="line">umount /mnt/data                    <span class="comment"># 卸载</span></span><br><span class="line">umount -l /mnt/data                 <span class="comment"># 延迟卸载</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-etc-fstab-文件格式">5.3 /etc/fstab 文件格式</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 设备文件/挂载点/文件系统类型/选项/备份标记/检查顺序</span><br><span class="line">/dev/sdb1  /data  ext4  defaults  0  2</span><br><span class="line">UUID=xxxx  /home  xfs   defaults  0  1</span><br></pre></td></tr></table></figure>
<h2 id="6-逻辑卷管理-LVM">6. 逻辑卷管理(LVM)</h2>
<h3 id="6-1-LVM-基本概念">6.1 LVM 基本概念</h3>
<ol>
<li><strong>PV(Physical Volume)</strong>：物理卷，实际存储设备</li>
<li><strong>VG(Volume Group)</strong>：卷组，由PV组成的存储池</li>
<li><strong>LV(Logical Volume)</strong>：逻辑卷，从VG划分的可挂载空间</li>
<li><strong>PE(Physical Extent)</strong>：物理块，LVM最小分配单元(默认4MB)</li>
<li><strong>LE(Logical Extent)</strong>：逻辑块，与PE一一对应</li>
</ol>
<h3 id="6-2-LVM-完整操作流程">6.2 LVM 完整操作流程</h3>
<h4 id="物理卷-PV-管理">物理卷(PV)管理</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pvcreate /dev/sdb /dev/sdc          <span class="comment"># 创建PV</span></span><br><span class="line">pvdisplay                           <span class="comment"># 显示PV信息</span></span><br><span class="line">pvmove /dev/sdb                     <span class="comment"># 迁移PV数据</span></span><br><span class="line">pvremove /dev/sdb                   <span class="comment"># 删除PV</span></span><br></pre></td></tr></table></figure>
<h4 id="卷组-VG-管理">卷组(VG)管理</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vgcreate vg_data /dev/sdb /dev/sdc  <span class="comment"># 创建VG</span></span><br><span class="line">vgextend vg_data /dev/sdd           <span class="comment"># 扩展VG</span></span><br><span class="line">vgreduce vg_data /dev/sdb           <span class="comment"># 缩减VG</span></span><br><span class="line">vgdisplay                           <span class="comment"># 显示VG信息</span></span><br><span class="line">vgremove vg_data                    <span class="comment"># 删除VG</span></span><br></pre></td></tr></table></figure>
<h4 id="逻辑卷-LV-管理">逻辑卷(LV)管理</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lvcreate -L 50G -n lv_home vg_data  <span class="comment"># 创建50G逻辑卷</span></span><br><span class="line">lvextend -L +10G /dev/vg_data/lv_home <span class="comment"># 扩展10G</span></span><br><span class="line">lvreduce -L -5G /dev/vg_data/lv_home <span class="comment"># 缩减5G</span></span><br><span class="line">lvresize -L 60G /dev/vg_data/lv_home <span class="comment"># 调整到60G</span></span><br><span class="line">lvdisplay                           <span class="comment"># 显示LV信息</span></span><br><span class="line">lvremove /dev/vg_data/lv_home       <span class="comment"># 删除LV</span></span><br></pre></td></tr></table></figure>
<h4 id="文件系统扩展">文件系统扩展</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于ext2/3/4文件系统</span></span><br><span class="line">resize2fs /dev/vg_data/lv_home</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于XFS文件系统</span></span><br><span class="line">xfs_growfs /dev/vg_data/lv_home</span><br></pre></td></tr></table></figure>
<h3 id="6-3-LVM-快照功能">6.3 LVM 快照功能</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lvcreate -L 10G -s -n snap_home /dev/vg_data/lv_home  <span class="comment"># 创建快照</span></span><br><span class="line">mount /dev/vg_data/snap_home /mnt/snapshot           <span class="comment"># 挂载快照</span></span><br><span class="line">umount /mnt/snapshot                                 <span class="comment"># 卸载快照</span></span><br><span class="line">lvremove /dev/vg_data/snap_home                      <span class="comment"># 删除快照</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-LVM-信息查看命令">6.4 LVM 信息查看命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pvs        <span class="comment"># 简要PV信息</span></span><br><span class="line">vgs        <span class="comment"># 简要VG信息</span></span><br><span class="line">lvs        <span class="comment"># 简要LV信息</span></span><br><span class="line">pvdisplay  <span class="comment"># 详细PV信息</span></span><br><span class="line">vgdisplay  <span class="comment"># 详细VG信息</span></span><br><span class="line">lvdisplay  <span class="comment"># 详细LV信息</span></span><br><span class="line">lsblk      <span class="comment"># 块设备层次结构</span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/08/linux/5-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/08/linux/4-%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E7%AE%A1%E7%90%86/"
                            aria-label=": 4.文件和程序管理"
                        >
                            4.文件和程序管理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-08T16:06:24+08:00">
	
		    2020 年 5 月 8 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-用户权限管理">1. 用户权限管理</h2>
<h3 id="1-1-文件权限基础">1.1 文件权限基础</h3>
<h4 id="权限表示法">权限表示法</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">d rwx r-x r--</span><br><span class="line">↑ ↑   ↑   ↑</span><br><span class="line">│ │   │   └─ 其他用户权限(r--)</span><br><span class="line">│ │   └─── 所属组权限(r-x)</span><br><span class="line">│ └────── 所有者权限(rwx)</span><br><span class="line">└──────── 文件类型(d=目录)</span><br></pre></td></tr></table></figure>
<h4 id="权限数值">权限数值</h4>
<ul>
<li>r(读): 4</li>
<li>w(写): 2</li>
<li>x(执行): 1</li>
</ul>
<h3 id="1-2-chmod-命令">1.2 chmod 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> [选项] 权限 文件</span><br></pre></td></tr></table></figure>
<h4 id="常用选项">常用选项</h4>
<ul>
<li><code>-R</code>: 递归修改目录下所有文件</li>
</ul>
<h4 id="权限设置方法">权限设置方法</h4>
<ol>
<li>
<p><strong>符号法</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> u+x file      <span class="comment"># 给所有者添加执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> g-w file      <span class="comment"># 移除组的写权限</span></span><br><span class="line"><span class="built_in">chmod</span> o=rx file     <span class="comment"># 设置其他用户为读执行</span></span><br><span class="line"><span class="built_in">chmod</span> a+r file      <span class="comment"># 给所有用户添加读权限</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>数字法</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 755 file      <span class="comment"># rwxr-xr-x</span></span><br><span class="line"><span class="built_in">chmod</span> 644 file      <span class="comment"># rw-r--r--</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="1-3-特殊权限">1.3 特殊权限</h3>
<table>
<thead>
<tr>
<th>权限</th>
<th>数值</th>
<th>设置方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUID</td>
<td>4000</td>
<td><code>u+s</code></td>
<td>执行时以文件所有者权限运行</td>
</tr>
<tr>
<td>SGID</td>
<td>2000</td>
<td><code>g+s</code></td>
<td>执行时以文件所属组权限运行</td>
</tr>
<tr>
<td>Sticky</td>
<td>1000</td>
<td><code>o+t</code></td>
<td>目录中文件只有所有者能删除</td>
</tr>
</tbody>
</table>
<h3 id="1-4-umask-命令">1.4 umask 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">umask</span>           <span class="comment"># 查看当前umask值</span></span><br><span class="line"><span class="built_in">umask</span> 022       <span class="comment"># 设置新的umask值</span></span><br></pre></td></tr></table></figure>
<ul>
<li>文件默认权限: <code>666 - umask</code></li>
<li>目录默认权限: <code>777 - umask</code></li>
</ul>
<h3 id="1-5-ACL-高级权限控制">1.5 ACL 高级权限控制</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setfacl -m u:user:rwx file   <span class="comment"># 添加用户ACL</span></span><br><span class="line">setfacl -x u:user file       <span class="comment"># 删除用户ACL</span></span><br><span class="line">getfacl file                 <span class="comment"># 查看ACL权限</span></span><br></pre></td></tr></table></figure>
<h3 id="1-6-所有权管理">1.6 所有权管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> user:group file        <span class="comment"># 修改所有者和组</span></span><br><span class="line"><span class="built_in">chown</span> -R user:group <span class="built_in">dir</span>      <span class="comment"># 递归修改</span></span><br><span class="line"><span class="built_in">chgrp</span> group file             <span class="comment"># 修改文件所属组</span></span><br></pre></td></tr></table></figure>
<h2 id="2-链接管理">2. 链接管理</h2>
<h3 id="2-1-链接类型对比">2.1 链接类型对比</h3>
<table>
<thead>
<tr>
<th>特性</th>
<th>硬链接</th>
<th>软链接</th>
</tr>
</thead>
<tbody>
<tr>
<td>inode</td>
<td>相同</td>
<td>不同</td>
</tr>
<tr>
<td>跨文件系统</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>链接目录</td>
<td>不允许</td>
<td>允许</td>
</tr>
<tr>
<td>原文件删除</td>
<td>仍可访问</td>
<td>失效</td>
</tr>
</tbody>
</table>
<h3 id="2-2-ln-命令">2.2 ln 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> <span class="built_in">source</span> <span class="built_in">link</span>        <span class="comment"># 创建硬链接</span></span><br><span class="line"><span class="built_in">ln</span> -s <span class="built_in">source</span> <span class="built_in">link</span>     <span class="comment"># 创建软链接</span></span><br></pre></td></tr></table></figure>
<h2 id="3-进程管理">3. 进程管理</h2>
<h3 id="3-1-ps-命令">3.1 ps 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps aux       <span class="comment"># 查看所有进程</span></span><br><span class="line">ps -ef       <span class="comment"># 完整格式显示</span></span><br><span class="line">ps -u user   <span class="comment"># 查看指定用户进程</span></span><br></pre></td></tr></table></figure>
<h3 id="3-2-top-命令">3.2 top 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top          <span class="comment"># 动态查看进程</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>r</code>: 调整进程优先级</li>
<li><code>k</code>: 终止进程</li>
<li><code>q</code>: 退出</li>
</ul>
<h3 id="3-3-进程控制">3.3 进程控制</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -9 PID          <span class="comment"># 强制终止进程</span></span><br><span class="line">killall process      <span class="comment"># 终止同名所有进程</span></span><br><span class="line">pkill pattern        <span class="comment"># 按模式终止进程</span></span><br></pre></td></tr></table></figure>
<h4 id="常用信号">常用信号</h4>
<table>
<thead>
<tr>
<th>信号</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>HUP</td>
<td>1</td>
<td>重新加载配置</td>
</tr>
<tr>
<td>INT</td>
<td>2</td>
<td>中断(Ctrl+C)</td>
</tr>
<tr>
<td>KILL</td>
<td>9</td>
<td>强制终止</td>
</tr>
<tr>
<td>TERM</td>
<td>15</td>
<td>正常终止</td>
</tr>
</tbody>
</table>
<h3 id="3-4-作业控制">3.4 作业控制</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &amp;       <span class="comment"># 后台运行</span></span><br><span class="line"><span class="built_in">fg</span> %1          <span class="comment"># 前台恢复作业1</span></span><br><span class="line"><span class="built_in">bg</span> %2          <span class="comment"># 后台继续作业2</span></span><br><span class="line"><span class="built_in">jobs</span>           <span class="comment"># 查看后台作业</span></span><br></pre></td></tr></table></figure>
<h3 id="3-5-优先级管理">3.5 优先级管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nice</span> -n 10 <span class="built_in">command</span>   <span class="comment"># 启动低优先级进程</span></span><br><span class="line">renice 15 -p PID     <span class="comment"># 调整运行中进程优先级</span></span><br></pre></td></tr></table></figure>
<h3 id="3-6-终端复用器">3.6 终端复用器</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux                <span class="comment"># 启动新会话</span></span><br></pre></td></tr></table></figure>
<p>常用快捷键:</p>
<ul>
<li><code>Ctrl+b c</code>: 新建窗口</li>
<li><code>Ctrl+b %</code>: 垂直分割</li>
<li><code>Ctrl+b &quot;</code>: 水平分割</li>
<li><code>Ctrl+b d</code>: 分离会话</li>
</ul>
<h2 id="4-压缩与归档">4. 压缩与归档</h2>
<h3 id="4-1-单文件压缩">4.1 单文件压缩</h3>
<h4 id="gzip">gzip</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gzip file            <span class="comment"># 压缩为file.gz</span></span><br><span class="line">gunzip file.gz       <span class="comment"># 解压</span></span><br><span class="line">gzip -d file.gz      <span class="comment"># 解压(同上)</span></span><br></pre></td></tr></table></figure>
<h4 id="bzip2">bzip2</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bzip2 file           <span class="comment"># 压缩为file.bz2</span></span><br><span class="line">bunzip2 file.bz2     <span class="comment"># 解压</span></span><br></pre></td></tr></table></figure>
<h4 id="xz">xz</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xz file              <span class="comment"># 压缩为file.xz</span></span><br><span class="line">unxz file.xz         <span class="comment"># 解压</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-归档工具">4.2 归档工具</h3>
<h4 id="tar-命令">tar 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包压缩</span></span><br><span class="line">tar czvf archive.tar.gz <span class="built_in">dir</span>/     <span class="comment"># gzip压缩</span></span><br><span class="line">tar cjvf archive.tar.bz2 <span class="built_in">dir</span>/    <span class="comment"># bzip2压缩</span></span><br><span class="line">tar cJvf archive.tar.xz <span class="built_in">dir</span>/     <span class="comment"># xz压缩</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar xzvf archive.tar.gz          <span class="comment"># 解压gzip</span></span><br><span class="line">tar xjvf archive.tar.bz2         <span class="comment"># 解压bzip2</span></span><br><span class="line">tar xJvf archive.tar.xz          <span class="comment"># 解压xz</span></span><br></pre></td></tr></table></figure>
<h4 id="cpio-命令">cpio 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . | cpio -ov &gt; backup.cpio      <span class="comment"># 创建归档</span></span><br><span class="line">cpio -idv &lt; backup.cpio              <span class="comment"># 解压归档</span></span><br></pre></td></tr></table></figure>
<h4 id="dd-命令">dd 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda of=disk.img bs=1M     <span class="comment"># 创建磁盘映像</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=disk.img of=/dev/sdb           <span class="comment"># 恢复磁盘映像</span></span><br></pre></td></tr></table></figure>
<h2 id="5-实用技巧">5. 实用技巧</h2>
<h3 id="5-1-nohup-命令">5.1 nohup 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> <span class="built_in">command</span> &amp;      <span class="comment"># 退出终端后继续运行</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-watch-命令">5.2 watch 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 5 <span class="string">&#x27;ls -l&#x27;</span>   <span class="comment"># 每5秒执行一次命令</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-文件传输">5.3 文件传输</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=file.iso | ssh user@host <span class="string">&quot;dd of=file.iso&quot;</span>  <span class="comment"># 通过SSH传输文件</span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/08/linux/4-%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E7%AE%A1%E7%90%86/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../../../../2020/05/07/linux/3-bash/"
                            aria-label=": 3.bash"
                        >
                            3.bash
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-05-07T16:30:52+08:00">
	
		    2020 年 5 月 7 日
    	
    </time>
    
        <span>分類 </span>
        
    <a class="category-link" href="../../">后端</a>, <a class="category-link" href="../../linux/">linux</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1>Bash 命令与 Shell 使用指南</h1>
<h2 id="1-命令组合与控制">1. 命令组合与控制</h2>
<h3 id="1-1-命令组合方式">1.1 命令组合方式</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">命令1 ; 命令2    <span class="comment"># 无论命令1成功与否，都会执行命令2</span></span><br><span class="line">命令1 &amp;&amp; 命令2   <span class="comment"># 只有命令1成功执行(返回0)才会执行命令2</span></span><br><span class="line">命令1 || 命令2   <span class="comment"># 只有命令1执行失败(非0)才会执行命令2</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-引用符号">1.2 引用符号</h3>
<table>
<thead>
<tr>
<th>符号</th>
<th>名称</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>'</code></td>
<td>单引号</td>
<td>内部所有内容视为纯文本，不解释变量和特殊字符</td>
</tr>
<tr>
<td><code>&quot;</code></td>
<td>双引号</td>
<td>会解释$、`和\等特殊字符，变量会被展开</td>
</tr>
<tr>
<td><code>`</code></td>
<td>反引号</td>
<td>执行内部命令并将结果替换到当前位置(等同于<code>$(命令)</code>语法)</td>
</tr>
</tbody>
</table>
<h2 id="2-命令历史">2. 命令历史</h2>
<h3 id="2-1-history-命令">2.1 history 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span>        <span class="comment"># 显示命令历史记录</span></span><br><span class="line">!5            <span class="comment"># 执行历史记录中第5条命令</span></span><br><span class="line">!<span class="built_in">ls</span>           <span class="comment"># 执行最近以ls开头的命令</span></span><br><span class="line">!?config      <span class="comment"># 执行最近包含config的命令</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-历史记录管理">2.2 历史记录管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> -c    <span class="comment"># 清除当前shell的历史记录</span></span><br><span class="line"><span class="built_in">history</span> -d 10 <span class="comment"># 删除第10条历史记录</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-相关环境变量">2.3 相关环境变量</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HISTSIZE=1000       <span class="comment"># 内存中保存的历史记录数量</span></span><br><span class="line">HISTFILESIZE=2000   <span class="comment"># 历史记录文件保存的最大数量</span></span><br><span class="line">HISTFILE=~/.bash_history  <span class="comment"># 历史记录文件路径</span></span><br></pre></td></tr></table></figure>
<h2 id="3-Shell-类型与快捷键">3. Shell 类型与快捷键</h2>
<h3 id="3-1-常见Shell类型">3.1 常见Shell类型</h3>
<ul>
<li><strong>Bourne Shell(sh)</strong>: 经典Unix shell → 衍生出bash</li>
<li><strong>Bash(Bourne-Again Shell)</strong>: Linux默认shell</li>
<li><strong>C Shell(csh)</strong>: 类C语法 → 衍生出tcsh</li>
<li><strong>Korn Shell(ksh)</strong>: 结合sh和csh优点</li>
<li><strong>Z Shell(zsh)</strong>: 功能强大的现代shell</li>
</ul>
<h3 id="3-2-常用快捷键">3.2 常用快捷键</h3>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tab</td>
<td>命令/文件名自动补全</td>
</tr>
<tr>
<td>Ctrl+A</td>
<td>移动到行首</td>
</tr>
<tr>
<td>Ctrl+E</td>
<td>移动到行尾</td>
</tr>
<tr>
<td>Ctrl+D</td>
<td>删除当前字符(相当于Delete)</td>
</tr>
<tr>
<td>Ctrl+H</td>
<td>删除前一个字符(相当于Backspace)</td>
</tr>
<tr>
<td>Ctrl+L</td>
<td>清屏(等同于clear命令)</td>
</tr>
<tr>
<td>Ctrl+C</td>
<td>终止当前命令</td>
</tr>
<tr>
<td>Ctrl+Z</td>
<td>暂停当前命令(可用fg恢复)</td>
</tr>
<tr>
<td>Ctrl+S</td>
<td>暂停屏幕输出</td>
</tr>
<tr>
<td>Ctrl+Q</td>
<td>恢复屏幕输出</td>
</tr>
</tbody>
</table>
<h2 id="4-变量与环境设置">4. 变量与环境设置</h2>
<h3 id="4-1-变量操作">4.1 变量操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> VAR=value    <span class="comment"># 设置环境变量(对新shell有效)</span></span><br><span class="line"><span class="built_in">unset</span> VAR           <span class="comment"># 删除变量</span></span><br><span class="line">PATH=<span class="variable">$PATH</span>:/new/path <span class="comment"># 追加PATH路径</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-set-命令选项">4.2 set 命令选项</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> -o option      <span class="comment"># 启用选项</span></span><br><span class="line"><span class="built_in">set</span> +o option      <span class="comment"># 禁用选项</span></span><br></pre></td></tr></table></figure>
<p>常用选项：</p>
<ul>
<li><code>noclobber</code>/<code>-C</code>: 防止重定向覆盖已有文件</li>
<li><code>histexpand</code>/<code>-H</code>: 启用<code>!</code>历史命令扩展</li>
</ul>
<h3 id="4-3-提示符定制-PS1">4.3 提示符定制(PS1)</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS1=<span class="string">&#x27;[\u@\h \W]\$ &#x27;</span>  <span class="comment"># 常见默认提示符格式</span></span><br></pre></td></tr></table></figure>
<p>可用转义符：</p>
<ul>
<li><code>\s</code>: shell名称</li>
<li><code>\v</code>: bash版本</li>
<li><code>\u</code>: 用户名</li>
<li><code>\h</code>: 主机名</li>
<li><code>\w</code>: 当前工作目录</li>
</ul>
<h3 id="4-4-用户切换">4.4 用户切换</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su user       <span class="comment"># 切换用户(不改变环境变量)</span></span><br><span class="line">su - user     <span class="comment"># 完全切换用户(包括环境)</span></span><br></pre></td></tr></table></figure>
<h2 id="5-帮助命令-man-详解">5.帮助命令 <code>man</code> 详解</h2>
<h3 id="基本用法">基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man <span class="built_in">command</span>      <span class="comment"># 查看命令的手册页(返回第一个匹配的帮助文件)</span></span><br></pre></td></tr></table></figure>
<h3 id="常用选项">常用选项</h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能说明</th>
<th>等价命令</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a</code></td>
<td>显示所有匹配的手册页(按顺序显示)</td>
<td>-</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>查找完全匹配的命令文档</td>
<td><code>whatis</code></td>
</tr>
<tr>
<td><code>-k</code></td>
<td>查找包含关键词的文档</td>
<td><code>apropos</code></td>
</tr>
<tr>
<td><code>-w</code></td>
<td>显示手册页的存储路径</td>
<td>-</td>
</tr>
</tbody>
</table>
<h3 id="指定手册章节">指定手册章节</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">man 5 passwd     <span class="comment"># 查看/etc/passwd文件的格式说明(第5节)</span></span><br><span class="line">man 3 <span class="built_in">printf</span>     <span class="comment"># 查看C库函数printf的文档(第3节)</span></span><br></pre></td></tr></table></figure>
<h3 id="手册章节分类">手册章节分类</h3>
<table>
<thead>
<tr>
<th>Section</th>
<th>内容类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>用户命令</td>
</tr>
<tr>
<td>2</td>
<td>系统调用</td>
</tr>
<tr>
<td>3</td>
<td>C库函数</td>
</tr>
<tr>
<td>4</td>
<td>设备文件</td>
</tr>
<tr>
<td>5</td>
<td>配置文件格式</td>
</tr>
<tr>
<td>6</td>
<td>游戏</td>
</tr>
<tr>
<td>7</td>
<td>杂项</td>
</tr>
<tr>
<td>8</td>
<td>系统管理命令</td>
</tr>
<tr>
<td>9</td>
<td>Linux内核相关</td>
</tr>
</tbody>
</table>
<h3 id="手册页存储位置">手册页存储位置</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/man         <span class="comment"># 系统手册页主目录</span></span><br><span class="line">/usr/local/share/man   <span class="comment"># 本地安装软件的手册页</span></span><br></pre></td></tr></table></figure>
<h3 id="维护whatis数据库">维护whatis数据库</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">makewhatis            <span class="comment"># 生成/更新whatis数据库(供-f/-k使用)</span></span><br><span class="line">mandb                 <span class="comment"># 现代系统中更新手册数据库(替代makewhatis)</span></span><br></pre></td></tr></table></figure>
<h3 id="使用示例">使用示例</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">man -a <span class="built_in">printf</span>        <span class="comment"># 查看所有章节的printf文档</span></span><br><span class="line">man -k <span class="string">&quot;copy&quot;</span>        <span class="comment"># 查找所有包含&quot;copy&quot;关键词的命令</span></span><br><span class="line">man -f <span class="built_in">ls</span>            <span class="comment"># 精确查找ls命令的文档</span></span><br><span class="line">man -w 5 passwd      <span class="comment"># 显示passwd配置文件的文档路径</span></span><br></pre></td></tr></table></figure>
<h2 id="6-管道与重定向">6. 管道与重定向</h2>
<h3 id="6-1-标准文件描述符">6.1 标准文件描述符</h3>
<table>
<thead>
<tr>
<th>文件描述符</th>
<th>名称</th>
<th>默认设备</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>标准输入(stdin)</td>
<td>键盘</td>
</tr>
<tr>
<td>1</td>
<td>标准输出(stdout)</td>
<td>屏幕</td>
</tr>
<tr>
<td>2</td>
<td>标准错误(stderr)</td>
<td>屏幕</td>
</tr>
</tbody>
</table>
<h3 id="6-2-管道">6.2 管道(|)</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令1 | 命令2    <span class="comment"># 将命令1的输出作为命令2的输入</span></span><br></pre></td></tr></table></figure>
<h3 id="6-3-tee命令">6.3 tee命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令 | <span class="built_in">tee</span> 文件    <span class="comment"># 同时输出到屏幕和文件</span></span><br><span class="line">命令 | <span class="built_in">tee</span> -a 文件 <span class="comment"># 追加模式(不覆盖原文件)</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-重定向操作">6.4 重定向操作</h3>
<table>
<thead>
<tr>
<th>语法</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>命令 &gt; 文件</code></td>
<td>标准输出覆盖写入文件</td>
</tr>
<tr>
<td><code>命令 &gt;&gt; 文件</code></td>
<td>标准输出追加写入文件</td>
</tr>
<tr>
<td><code>命令 &lt; 文件</code></td>
<td>从文件读取标准输入</td>
</tr>
<tr>
<td><code>命令 2&gt; 文件</code></td>
<td>标准错误覆盖写入文件</td>
</tr>
<tr>
<td><code>命令 2&gt;&gt; 文件</code></td>
<td>标准错误追加写入文件</td>
</tr>
<tr>
<td><code>命令 &gt; 文件 2&gt;&amp;1</code></td>
<td>标准输出和错误都覆盖写入同一文件</td>
</tr>
<tr>
<td><code>命令 &gt;&gt; 文件 2&gt;&amp;1</code></td>
<td>标准输出和错误都追加写入同一文件</td>
</tr>
<tr>
<td><code>命令 &lt;&lt; 结束标记</code></td>
<td>从标准输入读取直到遇到&quot;结束标记&quot;(here文档)</td>
</tr>
<tr>
<td><code>命令 &amp;&gt; 文件</code></td>
<td>标准输出和错误都覆盖写入文件(bash简写)</td>
</tr>
</tbody>
</table>
<h2 id="7-文件操作命令">7. 文件操作命令</h2>
<h3 id="7-1-ls命令">7.1 ls命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -a    <span class="comment"># 显示所有文件(包括.开头的隐藏文件)</span></span><br><span class="line"><span class="built_in">ls</span> -A    <span class="comment"># 类似-a但不显示.和..</span></span><br><span class="line"><span class="built_in">ls</span> -d    <span class="comment"># 显示目录本身而非内容</span></span><br><span class="line"><span class="built_in">ls</span> -F    <span class="comment"># 显示文件类型标识(/:目录, *:可执行, @:链接)</span></span><br><span class="line"><span class="built_in">ls</span> -i    <span class="comment"># 显示inode编号</span></span><br><span class="line"><span class="built_in">ls</span> -l    <span class="comment"># 长格式显示详细信息</span></span><br><span class="line"><span class="built_in">ls</span> -t    <span class="comment"># 按修改时间排序</span></span><br><span class="line"><span class="built_in">ls</span> -h    <span class="comment"># 人类可读的文件大小(如1K, 2M)</span></span><br></pre></td></tr></table></figure>
<h3 id="7-2-cp命令">7.2 cp命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -f    <span class="comment"># 强制覆盖不提示</span></span><br><span class="line"><span class="built_in">cp</span> -i    <span class="comment"># 覆盖前提示确认</span></span><br><span class="line"><span class="built_in">cp</span> -p    <span class="comment"># 保留原文件属性</span></span><br><span class="line"><span class="built_in">cp</span> -r/R  <span class="comment"># 递归复制目录</span></span><br><span class="line"><span class="built_in">cp</span> -d    <span class="comment"># 保留链接文件</span></span><br><span class="line"><span class="built_in">cp</span> -a    <span class="comment"># 归档模式(相当于-dpR)</span></span><br></pre></td></tr></table></figure>
<h3 id="7-3-mv命令">7.3 mv命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> -f    <span class="comment"># 强制覆盖不提示</span></span><br><span class="line"><span class="built_in">mv</span> -i    <span class="comment"># 覆盖前提示确认</span></span><br></pre></td></tr></table></figure>
<h3 id="7-4-mkdir命令">7.4 mkdir命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -m 755 <span class="built_in">dir</span>   <span class="comment"># 创建指定权限的目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p dir1/dir2 <span class="comment"># 创建多级目录</span></span><br></pre></td></tr></table></figure>
<h3 id="7-5-rm命令">7.5 rm命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -f    <span class="comment"># 强制删除不提示</span></span><br><span class="line"><span class="built_in">rm</span> -i    <span class="comment"># 删除前提示确认</span></span><br><span class="line"><span class="built_in">rm</span> -r/R  <span class="comment"># 递归删除目录</span></span><br></pre></td></tr></table></figure>
<h3 id="7-6-rmdir命令">7.6 rmdir命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> -p dir1/dir2 <span class="comment"># 删除多级空目录</span></span><br></pre></td></tr></table></figure>
<h3 id="7-7-touch命令">7.7 touch命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> -t 202405071530.00 file  <span class="comment"># 设置特定时间戳(YYMMDDhhmm.ss)</span></span><br><span class="line"><span class="built_in">touch</span> -a file       <span class="comment"># 仅更新访问时间</span></span><br><span class="line"><span class="built_in">touch</span> -m file       <span class="comment"># 仅更新修改时间</span></span><br></pre></td></tr></table></figure>
<h3 id="7-8-file命令">7.8 file命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file document.txt   <span class="comment"># 检测文件类型和编码</span></span><br></pre></td></tr></table></figure>
<h2 id="8-元字符-通配符">8. 元字符(通配符)</h2>
<table>
<thead>
<tr>
<th>元字符</th>
<th>功能描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>匹配任意长度字符(包括空字符)</td>
<td><code>ls *.txt</code></td>
</tr>
<tr>
<td><code>?</code></td>
<td>匹配任意单个字符</td>
<td><code>ls file?.txt</code></td>
</tr>
<tr>
<td><code>[]</code></td>
<td>匹配括号内任意一个字符</td>
<td><code>ls file[123].txt</code></td>
</tr>
<tr>
<td><code>[!]</code></td>
<td>匹配不在括号内的任意一个字符</td>
<td><code>ls file[!a-z].txt</code></td>
</tr>
<tr>
<td><code>&#123;&#125;</code></td>
<td>展开括号内逗号分隔的多个模式</td>
<td><code>touch file&#123;1,2,3&#125;</code></td>
</tr>
</tbody>
</table>
<p>示例扩展：</p>
<ul>
<li><code>[a-z]</code>: 任意小写字母</li>
<li><code>[0-9]</code>: 任意数字</li>
<li><code>[a-zA-Z]</code>: 任意字母</li>
<li><code>file&#123;1..3&#125;</code>: 展开为file1, file2, file3</li>
</ul>
<h2 id="9-文档处理命令">9. 文档处理命令</h2>
<h3 id="9-1-文件内容查看">9.1 文件内容查看</h3>
<h4 id="cat-命令">cat 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> -n file.txt  <span class="comment"># 显示文件内容并添加行号</span></span><br></pre></td></tr></table></figure>
<h4 id="nl-命令（行号显示）">nl 命令（行号显示）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nl</span> -b a file.txt    <span class="comment"># 所有行添加行号</span></span><br><span class="line"><span class="built_in">nl</span> -b t file.txt    <span class="comment"># 非空行添加行号</span></span><br><span class="line"><span class="built_in">nl</span> -h a -f a file.txt  <span class="comment"># 为页眉和页脚也添加行号</span></span><br></pre></td></tr></table></figure>
<h4 id="od-命令（二进制查看）">od 命令（二进制查看）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">od</span> -t c file.bin    <span class="comment"># 以ASCII字符显示</span></span><br><span class="line"><span class="built_in">od</span> -t o file.bin    <span class="comment"># 以八进制显示</span></span><br><span class="line"><span class="built_in">od</span> -t x file.bin    <span class="comment"># 以十六进制显示</span></span><br></pre></td></tr></table></figure>
<h3 id="9-2-文件头部-尾部查看">9.2 文件头部/尾部查看</h3>
<h4 id="head-命令">head 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">head</span> -n 10 file.txt    <span class="comment"># 显示前10行</span></span><br><span class="line"><span class="built_in">head</span> -10 file.txt      <span class="comment"># 同上</span></span><br><span class="line"><span class="built_in">head</span> -c 100 file.txt   <span class="comment"># 显示前100字节</span></span><br></pre></td></tr></table></figure>
<h4 id="tail-命令">tail 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -n 10 file.txt    <span class="comment"># 显示最后10行</span></span><br><span class="line"><span class="built_in">tail</span> -10 file.txt      <span class="comment"># 同上</span></span><br><span class="line"><span class="built_in">tail</span> -c 100 file.txt   <span class="comment"># 显示最后100字节</span></span><br><span class="line"><span class="built_in">tail</span> -f log.txt        <span class="comment"># 实时监控日志文件</span></span><br></pre></td></tr></table></figure>
<h3 id="9-3-文本提取与转换">9.3 文本提取与转换</h3>
<h4 id="cut-命令">cut 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -c 1-5 file.txt      <span class="comment"># 提取每行第1-5个字符</span></span><br><span class="line"><span class="built_in">cut</span> -d: -f1 /etc/passwd  <span class="comment"># 以冒号分隔，提取第一个字段</span></span><br></pre></td></tr></table></figure>
<h4 id="join-命令（合并文件）">join 命令（合并文件）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">join</span> -j 1 file1.txt file2.txt  <span class="comment"># 按第一个字段合并两个文件</span></span><br></pre></td></tr></table></figure>
<h4 id="paste-命令">paste 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">paste</span> -d<span class="string">&quot;;&quot;</span> file1.txt file2.txt  <span class="comment"># 用分号分隔合并文件</span></span><br></pre></td></tr></table></figure>
<h4 id="tr-命令（字符转换）">tr 命令（字符转换）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tr</span> <span class="string">&#x27;a-z&#x27;</span> <span class="string">&#x27;A-Z&#x27;</span> &lt; file.txt    <span class="comment"># 小写转大写</span></span><br><span class="line"><span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span> &lt; file.txt        <span class="comment"># 删除回车符</span></span><br><span class="line"><span class="built_in">tr</span> -s <span class="string">&#x27; &#x27;</span> &lt; file.txt         <span class="comment"># 压缩连续空格</span></span><br><span class="line"><span class="built_in">tr</span> -d <span class="string">&#x27;[:digit:]&#x27;</span> &lt; file.txt <span class="comment"># 删除所有数字</span></span><br></pre></td></tr></table></figure>
<h3 id="9-4-文本排序与统计">9.4 文本排序与统计</h3>
<h4 id="sort-命令">sort 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> file.txt          <span class="comment"># 按字母顺序排序</span></span><br><span class="line"><span class="built_in">sort</span> -n file.txt       <span class="comment"># 按数值排序</span></span><br><span class="line"><span class="built_in">sort</span> -r file.txt       <span class="comment"># 反向排序</span></span><br><span class="line"><span class="built_in">sort</span> -t: -k3n /etc/passwd  <span class="comment"># 按冒号分隔的第3列数值排序</span></span><br></pre></td></tr></table></figure>
<h4 id="uniq-命令（去重）">uniq 命令（去重）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> file.txt | <span class="built_in">uniq</span>    <span class="comment"># 去重（需先排序）</span></span><br><span class="line"><span class="built_in">uniq</span> -d file.txt        <span class="comment"># 只显示重复行</span></span><br><span class="line"><span class="built_in">uniq</span> -u file.txt        <span class="comment"># 只显示唯一行</span></span><br></pre></td></tr></table></figure>
<h4 id="wc-命令（统计）">wc 命令（统计）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wc</span> -l file.txt    <span class="comment"># 统计行数</span></span><br><span class="line"><span class="built_in">wc</span> -w file.txt    <span class="comment"># 统计单词数</span></span><br><span class="line"><span class="built_in">wc</span> -c file.txt    <span class="comment"># 统计字节数</span></span><br></pre></td></tr></table></figure>
<h3 id="9-5-文本分割与格式化">9.5 文本分割与格式化</h3>
<h4 id="split-命令">split 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">split</span> -l 1000 bigfile.txt part_  <span class="comment"># 每1000行分割文件</span></span><br></pre></td></tr></table></figure>
<h4 id="pr-命令（分页）">pr 命令（分页）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pr</span> -l 40 file.txt    <span class="comment"># 按每页40行分页显示</span></span><br></pre></td></tr></table></figure>
<h4 id="fmt-命令（格式化）">fmt 命令（格式化）</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fmt</span> -w 80 file.txt   <span class="comment"># 设置每行80个字符</span></span><br></pre></td></tr></table></figure>
<h4 id="expand-unexpand-命令">expand/unexpand 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expand</span> -t 4 file.txt    <span class="comment"># 将tab转为4个空格</span></span><br><span class="line"><span class="built_in">unexpand</span> -t 4 file.txt  <span class="comment"># 将4个空格转为tab</span></span><br></pre></td></tr></table></figure>
<h3 id="8-6-高级文本处理">8.6 高级文本处理</h3>
<h4 id="xargs-命令">xargs 命令</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . -name <span class="string">&quot;*.log&quot;</span> | xargs <span class="built_in">rm</span>    <span class="comment"># 删除所有log文件</span></span><br><span class="line">find . -<span class="built_in">type</span> f | xargs grep <span class="string">&quot;text&quot;</span> <span class="comment"># 在所有文件中搜索文本</span></span><br></pre></td></tr></table></figure>
<h2 id="10-vi-vim-编辑器">10. vi/vim 编辑器</h2>
<h3 id="10-1-基本操作">10.1 基本操作</h3>
<h4 id="启动与退出">启动与退出</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi file.txt        <span class="comment"># 编辑文件</span></span><br><span class="line">vi -R file.txt     <span class="comment"># 只读模式</span></span><br><span class="line">:q                 <span class="comment"># 退出</span></span><br><span class="line">:q!                <span class="comment"># 强制退出</span></span><br><span class="line">:wq 或 ZZ          <span class="comment"># 保存退出</span></span><br></pre></td></tr></table></figure>
<h4 id="模式切换">模式切换</h4>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td>在光标前插入</td>
</tr>
<tr>
<td>a</td>
<td>在光标后插入</td>
</tr>
<tr>
<td>I</td>
<td>在行首插入</td>
</tr>
<tr>
<td>A</td>
<td>在行尾插入</td>
</tr>
<tr>
<td>o</td>
<td>在下一行插入</td>
</tr>
<tr>
<td>O</td>
<td>在上一行插入</td>
</tr>
<tr>
<td>ESC</td>
<td>返回命令模式</td>
</tr>
</tbody>
</table>
<h3 id="10-2-光标移动">10.2 光标移动</h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>h/j/k/l</td>
<td>左/下/上/右</td>
</tr>
<tr>
<td>0</td>
<td>行首</td>
</tr>
<tr>
<td>$</td>
<td>行尾</td>
</tr>
<tr>
<td>gg</td>
<td>文件开头</td>
</tr>
<tr>
<td>G</td>
<td>文件末尾</td>
</tr>
<tr>
<td>50G</td>
<td>跳转到第50行</td>
</tr>
<tr>
<td>Ctrl+b</td>
<td>上一页</td>
</tr>
<tr>
<td>Ctrl+f</td>
<td>下一页</td>
</tr>
</tbody>
</table>
<h3 id="10-3-编辑命令">10.3 编辑命令</h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>删除当前字符</td>
</tr>
<tr>
<td>X</td>
<td>删除前一个字符</td>
</tr>
<tr>
<td>dd</td>
<td>删除当前行</td>
</tr>
<tr>
<td>dw</td>
<td>删除下一个单词</td>
</tr>
<tr>
<td>yy</td>
<td>复制当前行</td>
</tr>
<tr>
<td>p</td>
<td>粘贴到光标后</td>
</tr>
<tr>
<td>P</td>
<td>粘贴到光标前</td>
</tr>
<tr>
<td>u</td>
<td>撤销</td>
</tr>
<tr>
<td>Ctrl+r</td>
<td>重做</td>
</tr>
</tbody>
</table>
<h3 id="10-4-搜索与替换">10.4 搜索与替换</h3>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/pattern</td>
<td>向前搜索</td>
</tr>
<tr>
<td>?pattern</td>
<td>向后搜索</td>
</tr>
<tr>
<td>n</td>
<td>下一个匹配项</td>
</tr>
<tr>
<td>N</td>
<td>上一个匹配项</td>
</tr>
<tr>
<td>:%s/old/new/g</td>
<td>全局替换</td>
</tr>
<tr>
<td>:1,10s/old/new/g</td>
<td>替换1-10行的内容</td>
</tr>
</tbody>
</table>
<h3 id="10-5-设置选项">10.5 设置选项</h3>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">set</span> <span class="keyword">nu</span>        # 显示行号</span><br><span class="line">:<span class="keyword">set</span> nonu      # 隐藏行号</span><br><span class="line">:<span class="keyword">set</span> <span class="keyword">ts</span>=<span class="number">4</span>      # 设置<span class="keyword">tab</span>为<span class="number">4</span>个空格</span><br><span class="line">:<span class="keyword">set</span> <span class="keyword">list</span>      # 显示不可见字符</span><br></pre></td></tr></table></figure>
<h2 id="11-正则表达式与文本搜索">11. 正则表达式与文本搜索</h2>
<h3 id="11-1-基本元字符">11.1 基本元字符</h3>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>匹配任意单个字符</td>
</tr>
<tr>
<td>*</td>
<td>前一个字符0次或多次</td>
</tr>
<tr>
<td>[]</td>
<td>匹配括号内任意一个字符</td>
</tr>
<tr>
<td>[^]</td>
<td>不匹配括号内的字符</td>
</tr>
<tr>
<td>^</td>
<td>行首</td>
</tr>
<tr>
<td>$</td>
<td>行尾</td>
</tr>
<tr>
<td>\</td>
<td>转义特殊字符</td>
</tr>
</tbody>
</table>
<h3 id="11-2-grep-命令">11.2 grep 命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&quot;pattern&quot;</span> file.txt      <span class="comment"># 基本搜索</span></span><br><span class="line">grep -i <span class="string">&quot;pattern&quot;</span> file.txt   <span class="comment"># 忽略大小写</span></span><br><span class="line">grep -v <span class="string">&quot;pattern&quot;</span> file.txt   <span class="comment"># 反向匹配</span></span><br><span class="line">grep -n <span class="string">&quot;pattern&quot;</span> file.txt   <span class="comment"># 显示行号</span></span><br><span class="line">grep -E <span class="string">&quot;regex&quot;</span> file.txt     <span class="comment"># 使用扩展正则</span></span><br><span class="line">grep -r <span class="string">&quot;pattern&quot;</span> /dir       <span class="comment"># 递归搜索目录</span></span><br></pre></td></tr></table></figure>
<h4 id="特殊变体">特殊变体</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">egrep = grep -E       <span class="comment"># 扩展正则表达式</span></span><br><span class="line">fgrep = grep -F       <span class="comment"># 不解析正则，快速搜索</span></span><br><span class="line">pgrep -u root         <span class="comment"># 搜索root用户的进程</span></span><br></pre></td></tr></table></figure>
<h3 id="11-3-sed-流编辑器">11.3 sed 流编辑器</h3>
<h4 id="基本用法-2">基本用法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old/new/&#x27;</span> file.txt       <span class="comment"># 替换第一个匹配</span></span><br><span class="line">sed <span class="string">&#x27;s/old/new/g&#x27;</span> file.txt      <span class="comment"># 替换所有匹配</span></span><br><span class="line">sed <span class="string">&#x27;1,5d&#x27;</span> file.txt             <span class="comment"># 删除1-5行</span></span><br><span class="line">sed <span class="string">&#x27;/pattern/d&#x27;</span> file.txt       <span class="comment"># 删除匹配行</span></span><br></pre></td></tr></table></figure>
<h4 id="高级用法">高级用法</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">&#x27;10,20p&#x27;</span> file.txt       <span class="comment"># 只打印10-20行</span></span><br><span class="line">sed <span class="string">&#x27;y/abc/ABC/&#x27;</span> file.txt      <span class="comment"># 字符转换</span></span><br><span class="line">sed -i.bak <span class="string">&#x27;s/old/new/&#x27;</span> file   <span class="comment"># 直接修改文件并备份</span></span><br><span class="line">sed -e <span class="string">&#x27;cmd1&#x27;</span> -e <span class="string">&#x27;cmd2&#x27;</span> file   <span class="comment"># 执行多个命令</span></span><br></pre></td></tr></table></figure>
<h4 id="脚本示例">脚本示例</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将1-5行行首添加&gt;字符</span></span><br><span class="line">sed <span class="string">&#x27;1,5s/^/&gt;/&#x27;</span> file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将每行的第一个数字替换为#</span></span><br><span class="line">sed <span class="string">&#x27;s/[0-9]/#/&#x27;</span> file.txt</span><br></pre></td></tr></table></figure>
<h3 id="11-4-正则表达式示例">11.4 正则表达式示例</h3>
<ol>
<li>匹配IP地址：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E <span class="string">&#x27;([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;&#x27;</span> file.txt</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>匹配邮箱地址：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E <span class="string">&#x27;[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;&#x27;</span> file.txt</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>提取HTML标签内容：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">&#x27;s/&lt;title&gt;\(.*\)&lt;\/title&gt;/\1/p&#x27;</span> file.html</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="../../../../2020/05/07/linux/3-bash/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                留言與分享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="../../"
                aria-label="上一頁"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>上一頁</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="../3/"
                aria-label="下一頁"
            >
              <span>下一頁</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">第 2 頁 共 3 頁</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Kein Chan. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="../../../../assets/images/profile.jpg" alt="作者的圖片"/>
        
            <h4 id="about-card-name">Kein Chan</h4>
        
            <div id="about-card-bio"><p>這是獨立全棧工程師Kein Chan的技術博客</br>Kein目前居住在東京和澳門.</br>熱愛旅遊.已探訪日本40多個都道府縣.曾自駕環繞日本半個本州.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>全棧工程師</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo/Macao
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="../assets/images/logo-algolia-nebula-blue-full.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">沒有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/linux%E5%9F%BA%E7%A1%80/"
                            aria-label=": linux基础"
                        >
                            <h3 class="media-heading">linux基础</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/04/28/iptables/"
                            aria-label=": iptables"
                        >
                            <h3 class="media-heading">iptables</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年4月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2017/08/12/git%E6%95%99%E7%A8%8B/"
                            aria-label=": git教程"
                        >
                            <h3 class="media-heading">git教程</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年8月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/01/18/Java%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B/"
                            aria-label=": Java变量类型"
                        >
                            <h3 class="media-heading">Java变量类型</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年1月18日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/12/%E6%95%B0%E5%AD%A6/markdown-latex%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BC%8F%E5%86%99%E6%B3%95/"
                            aria-label=": LaTeX的写法"
                        >
                            <h3 class="media-heading">LaTeX的写法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月12日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/13/%E6%95%B0%E5%AD%A6/0-%E4%B8%AD%E5%AD%A6%E6%95%B0%E5%AD%A6%E5%A4%8D%E4%B9%A0/"
                            aria-label=": 0.中学数学复习"
                        >
                            <h3 class="media-heading">0.中学数学复习</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月13日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/1-%E5%88%9D%E7%AD%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%BC%E6%95%B0%E6%8E%A8%E5%AF%BC/"
                            aria-label=": 1.初等函数的导数推导"
                        >
                            <h3 class="media-heading">1.初等函数的导数推导</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/2-%E5%87%BD%E6%95%B0%E7%9A%84%E6%B1%82%E5%AF%BC%E6%B3%95%E5%88%99/"
                            aria-label=": 2.函数的求导法则"
                        >
                            <h3 class="media-heading">2.函数的求导法则</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/3-%E8%8E%B1%E5%B8%83%E5%B0%BC%E5%85%B9%E5%85%AC%E5%BC%8F/"
                            aria-label=": 3.莱布尼兹公式"
                        >
                            <h3 class="media-heading">3.莱布尼兹公式</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a
                            class="link-unstyled"
                            href="https://chankein.github.io/2019/09/28/%E6%95%B0%E5%AD%A6/4-%E5%BE%AE%E5%88%86/"
                            aria-label=": 4.微分"
                        >
                            <h3 class="media-heading">4.微分</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019年9月28日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="沒有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 42 篇文章
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../../../../assets/images/cover.jpeg');"></div>
        <!--SCRIPTS-->

<script src="../../../../assets/js/script-qtzvvb63gamuirvfphht7lytrxkfllzng1escnm2phjtlt4tvvxi5gl0wx4o.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
